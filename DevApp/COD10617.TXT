OBJECT Codeunit 10617 E-Invoice Check Iss. Fin.Chrg.
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVNO8.00;
  }
  PROPERTIES
  {
    TableNo=304;
    OnRun=BEGIN
            CheckCompanyInfo;
            CheckSalesSetup;
            CheckFinChargeMemoHeader(Rec);
          END;

  }
  CODE
  {
    VAR
      InvalidPathErr@1080000 : TextConst 'ENU=does not contain a valid path';
      EInvoiceDocumentEncode@1080001 : Codeunit 10610;

    LOCAL PROCEDURE CheckCompanyInfo@1080000();
    VAR
      CompanyInfo@1080000 : Record 79;
    BEGIN
      CompanyInfo.GET;

      CompanyInfo.TESTFIELD(Name);
      CompanyInfo.TESTFIELD(Address);
      CompanyInfo.TESTFIELD(City);
      CompanyInfo.TESTFIELD("Post Code");
      CompanyInfo.TESTFIELD("Country/Region Code");
      EInvoiceDocumentEncode.GetEInvoiceCountryRegionCode(CompanyInfo."Country/Region Code");
      CompanyInfo.TESTFIELD("VAT Registration No.");
    END;

    LOCAL PROCEDURE CheckSalesSetup@1080001();
    VAR
      SalesSetup@1080001 : Record 311;
      FileMgt@1080000 : Codeunit 419;
    BEGIN
      SalesSetup.GET;
      SalesSetup.TESTFIELD("E-Invoice Fin. Charge Path");
      IF NOT FileMgt.DirectoryExistsOnDotNetClient(SalesSetup."E-Invoice Fin. Charge Path") THEN
        SalesSetup.FIELDERROR("E-Invoice Fin. Charge Path",InvalidPathErr);
    END;

    LOCAL PROCEDURE CheckFinChargeMemoHeader@1080002(IssuedFinChargeMemoHeader@1080000 : Record 304);
    BEGIN
      WITH IssuedFinChargeMemoHeader DO BEGIN
        TESTFIELD(Name);
        TESTFIELD(Address);
        TESTFIELD(City);
        TESTFIELD("Post Code");
        TESTFIELD("Country/Region Code");
        EInvoiceDocumentEncode.GetEInvoiceCountryRegionCode("Country/Region Code");
      END;
    END;

    BEGIN
    END.
  }
}

