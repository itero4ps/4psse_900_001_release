OBJECT Codeunit 10624 E-Invoice Check Serv. Invoice
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVNO8.00;
  }
  PROPERTIES
  {
    TableNo=5992;
    OnRun=VAR
            EInvoiceCheckCommon@1080000 : Codeunit 10629;
          BEGIN
            ReadCompanyInfo;
            ReadGLSetup;

            EInvoiceCheckCommon.CheckCurrencyCode("Currency Code","No.","Posting Date");

            "Currency Code" := EInvoiceDocumentEncode.GetEInvoiceCurrencyCode("Currency Code");

            CompanyInfo.TESTFIELD(Name);
            CompanyInfo.TESTFIELD(Address);
            CompanyInfo.TESTFIELD(City);
            CompanyInfo.TESTFIELD("Post Code");
            CompanyInfo.TESTFIELD("Country/Region Code");
            EInvoiceDocumentEncode.GetEInvoiceCountryRegionCode(CompanyInfo."Country/Region Code");

            CompanyInfo.TESTFIELD("VAT Registration No.");
            IF CompanyInfo.IBAN = '' THEN
              CompanyInfo.TESTFIELD("Bank Account No.");
            CompanyInfo.TESTFIELD("Bank Branch No.");
          END;

  }
  CODE
  {
    VAR
      GLSetup@1080000 : Record 98;
      CompanyInfo@1080001 : Record 79;
      EInvoiceDocumentEncode@1080002 : Codeunit 10610;
      GLSetupRead@1080003 : Boolean;
      CompanyInfoRead@1080004 : Boolean;

    LOCAL PROCEDURE ReadGLSetup@1080006();
    BEGIN
      IF NOT GLSetupRead THEN BEGIN
        GLSetup.GET;
        GLSetupRead := TRUE;
      END;
    END;

    LOCAL PROCEDURE ReadCompanyInfo@1080007();
    BEGIN
      IF NOT CompanyInfoRead THEN BEGIN
        CompanyInfo.GET;
        CompanyInfoRead := TRUE;
      END;
    END;

    BEGIN
    END.
  }
}

