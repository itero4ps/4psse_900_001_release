OBJECT Codeunit 12013602 ExFlow File Management
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EXF350000;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      ExFlowFileMgtCLASSIC@1100285000 : Codeunit 12013618;
      ExFlowFileMgtNAV2009@1100285001 : Codeunit 12013619;
      EXF001@1100285002 : TextConst 'ENU=Saving a report to PDF is only available when using the RTC client.';
      ExFlowFileMgtNAV2009R2@1100285004 : Codeunit 12013626;
      ExFlowFileMgtWebClient@1100285006 : Codeunit 12013634;
      NAVClientVersion@1100285003 : Integer;
      EXF002@1100285005 : TextConst 'ENU=Function not supported with this NAV version.';

    PROCEDURE GetNAVVersion@1100285005() : Integer;
    BEGIN
      IF IsRunFromServiceTier THEN BEGIN
        IF SupportsDotNet THEN BEGIN
          IF IsWebClient THEN
            EXIT(4)
          ELSE
            EXIT(3)
        END
        ELSE
          EXIT(2);
      END
      ELSE
        EXIT(1);
    END;

    PROCEDURE IsRunFromServiceTier@1100285004() : Boolean;
    BEGIN
      EXIT(ExFlowFileMgtNAV2009.IsRunFromServiceTier);
    END;

    PROCEDURE SupportsDotNet@1100285011() : Boolean;
    BEGIN
      EXIT(ExFlowFileMgtNAV2009R2.SupportsDotNet);
    END;

    PROCEDURE IsWebClient@1100285017() : Boolean;
    BEGIN
      EXIT(ExFlowFileMgtWebClient.IsWebClient);
    END;

    PROCEDURE Move@1100285001(FromFile@1100285000 : Text[250];ToFile@1100285001 : Text[250];FromFolder@1100285002 : Text[250];ToFolder@1100285003 : Text[250];RootFolder@1100285004 : Text[250]) ReturnTxt : Text[250];
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ReturnTxt := ExFlowFileMgtCLASSIC.Move(FromFile,ToFile,FromFolder,ToFolder,RootFolder);
        2: ReturnTxt := ExFlowFileMgtNAV2009.Move(FromFile,ToFile,FromFolder,ToFolder,RootFolder);
        3: ReturnTxt := ExFlowFileMgtNAV2009R2.Move(FromFile,ToFile,FromFolder,ToFolder,RootFolder);
        4: ReturnTxt := ExFlowFileMgtWebClient.Move(FromFile,ToFile,FromFolder,ToFolder,RootFolder);
      END;
    END;

    PROCEDURE Copy@1100285002(FromFile@1100285003 : Text[250];ToFile@1100285002 : Text[250];FromFolder@1100285001 : Text[250];ToFolder@1100285000 : Text[250];RootFolder@1100285004 : Text[250]) ReturnTxt : Text[250];
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ReturnTxt := ExFlowFileMgtCLASSIC.Copy(FromFile,ToFile,FromFolder,ToFolder,RootFolder);
        2: ReturnTxt := ExFlowFileMgtNAV2009.Copy(FromFile,ToFile,FromFolder,ToFolder,RootFolder);
        3: ReturnTxt := ExFlowFileMgtNAV2009R2.Copy(FromFile,ToFile,FromFolder,ToFolder,RootFolder);
        4: ReturnTxt := ExFlowFileMgtWebClient.Copy(FromFile,ToFile,FromFolder,ToFolder,RootFolder);
      END;
    END;

    PROCEDURE Delete@1100285048(Path@1100285000 : Text[250];FileName@1100285001 : Text[250]);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ExFlowFileMgtCLASSIC.Delete(Path,FileName);
        2: ExFlowFileMgtNAV2009.Delete(Path,FileName);
        3: ExFlowFileMgtNAV2009R2.Delete(Path,FileName);
        4: ExFlowFileMgtWebClient.Delete(Path,FileName);
      END;
    END;

    PROCEDURE FolderExist@1100285012(Path@1100285000 : Text[250]) : Boolean;
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: EXIT(ExFlowFileMgtCLASSIC.FolderExist(Path));
        2: EXIT(ExFlowFileMgtNAV2009.FolderExist(Path));
        3: EXIT(ExFlowFileMgtNAV2009R2.FolderExist(Path));
        4: EXIT(ExFlowFileMgtWebClient.FolderExist(Path));
      END;
    END;

    PROCEDURE FileExist@1100285013(Path@1100285000 : Text[250];FileName@1100285001 : Text[250]) : Boolean;
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: EXIT(ExFlowFileMgtCLASSIC.FileExist(Path,FileName));
        2: EXIT(ExFlowFileMgtNAV2009.FileExist(Path,FileName));
        3: EXIT(ExFlowFileMgtNAV2009R2.FileExist(Path,FileName));
        4: EXIT(ExFlowFileMgtWebClient.FileExist(Path,FileName));
      END;
    END;

    PROCEDURE NewFolder@1100285010(FolderName@1100285000 : Text[1024];RootFolder@1100285001 : Text[1024]) : Boolean;
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: EXIT(ExFlowFileMgtCLASSIC.NewFolder(FolderName,RootFolder));
        2: EXIT(ExFlowFileMgtNAV2009.NewFolder(FolderName,RootFolder));
        3: EXIT(ExFlowFileMgtNAV2009R2.NewFolder(FolderName,RootFolder));
        4: EXIT(ExFlowFileMgtWebClient.NewFolder(FolderName,RootFolder));
      END;
    END;

    PROCEDURE ShowDoc@1100285020(FileURL@1100285000 : Text[1024]);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ExFlowFileMgtCLASSIC.ShowDoc(FileURL);
        2: ExFlowFileMgtNAV2009.ShowDoc(FileURL);
        3: ExFlowFileMgtNAV2009R2.ShowDoc(FileURL);
        4: ExFlowFileMgtWebClient.ShowDoc(FileURL);
      END;
    END;

    PROCEDURE InsertBLOB@14() : Integer;
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: EXIT(ExFlowFileMgtCLASSIC.InsertBLOB);
        2: EXIT(ExFlowFileMgtNAV2009.InsertBLOB);
        3: EXIT(ExFlowFileMgtNAV2009R2.InsertBLOB);
        4: EXIT(ExFlowFileMgtWebClient.InsertBLOB);
      END;
    END;

    PROCEDURE ImportBLOB@1100285007(VAR ExflowBLOB@1100285000 : Record 12013591;FileName@1100285001 : Text[1024]);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ExFlowFileMgtCLASSIC.ImportBLOB(ExflowBLOB,FileName);
        2: ExFlowFileMgtNAV2009.ImportBLOB(ExflowBLOB,FileName);
        3: ExFlowFileMgtNAV2009R2.ImportBLOB(ExflowBLOB,FileName);
        4: ExFlowFileMgtWebClient.ImportBLOB(ExflowBLOB,FileName);
      END;
    END;

    PROCEDURE SelectFolder@1100285028(VAR FolderTxt@1100285000 : Text[1024]);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ExFlowFileMgtCLASSIC.SelectFolder(FolderTxt);
        2: ExFlowFileMgtNAV2009.SelectFolder(FolderTxt);
        3: ExFlowFileMgtNAV2009R2.SelectFolder(FolderTxt);
        4: ExFlowFileMgtWebClient.SelectFolder(FolderTxt);
      END;
    END;

    PROCEDURE FileNameFromDialog@1100285014(VAR FileName@1100285005 : Text[1024];WindowTitle@1100285004 : Text[50];DefaultFileType@1100285003 : ' ,Text,Excel,Word,Custom,Xml,Htm,Xsd,Xslt';FilterString@1100285002 : Text[250];Action@1100285000 : 'Open,Save');
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ExFlowFileMgtCLASSIC.FileNameFromDialog(FileName,WindowTitle,DefaultFileType,FilterString,Action);
        2: ExFlowFileMgtNAV2009.FileNameFromDialog(FileName,WindowTitle,DefaultFileType,FilterString,Action);
        3: ExFlowFileMgtNAV2009R2.FileNameFromDialog(FileName,WindowTitle,DefaultFileType,FilterString,Action);
        4: ExFlowFileMgtWebClient.FileNameFromDialog(FileName,WindowTitle,DefaultFileType,FilterString,Action);
      END;
    END;

    PROCEDURE ExportBLOB@1100285008(VAR ExflowBLOB@1100285001 : Record 12013591;FileName@1100285000 : Text[1024]);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ExFlowFileMgtCLASSIC.ExportBLOB(ExflowBLOB,FileName);
        2: ExFlowFileMgtNAV2009.ExportBLOB(ExflowBLOB,FileName);
        3: ExFlowFileMgtNAV2009R2.ExportBLOB(ExflowBLOB,FileName);
        4: ExFlowFileMgtWebClient.ExportBLOB(ExflowBLOB,FileName);
      END;
    END;

    PROCEDURE ShowBLOB@1100285006(VAR ExflowBLOB@1100285001 : Record 12013591;FileName@1100285000 : Text[1024]);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ExFlowFileMgtCLASSIC.ShowBLOB(ExflowBLOB,FileName);
        2: ExFlowFileMgtNAV2009.ShowBLOB(ExflowBLOB,FileName);
        3: ExFlowFileMgtNAV2009R2.ShowBLOB(ExflowBLOB,FileName);
        4: ExFlowFileMgtWebClient.ShowBLOB(ExflowBLOB,FileName);
      END;
    END;

    PROCEDURE Path@8(Filename@1102601000 : Text[1024]) Path : Text[1024];
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: EXIT(ExFlowFileMgtCLASSIC.Path(Filename));
        2: EXIT(ExFlowFileMgtNAV2009.Path(Filename));
        3: EXIT(ExFlowFileMgtNAV2009R2.Path(Filename));
        4: EXIT(ExFlowFileMgtWebClient.Path(Filename));
      END;
    END;

    PROCEDURE GetFileName@1100285019(Filename@1102601000 : Text[1024]) : Text[1024];
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: EXIT(ExFlowFileMgtCLASSIC.GetFileName(Filename));
        2: EXIT(ExFlowFileMgtNAV2009.GetFileName(Filename));
        3: EXIT(ExFlowFileMgtNAV2009R2.GetFileName(Filename));
        4: EXIT(ExFlowFileMgtWebClient.GetFileName(Filename));
      END;
    END;

    PROCEDURE CreateImportFileTable@1000000000(ImportPath@1100285000 : Text[1024];VAR TempFileMgtBuffer@1100285003 : TEMPORARY Record 12013593);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ExFlowFileMgtCLASSIC.CreateImportFileTable(ImportPath,TempFileMgtBuffer);
        2: ExFlowFileMgtNAV2009.CreateImportFileTable(ImportPath,TempFileMgtBuffer);
        3: ExFlowFileMgtNAV2009R2.CreateImportFileTable(ImportPath,TempFileMgtBuffer);
        4: ExFlowFileMgtWebClient.CreateImportFileTable(ImportPath,TempFileMgtBuffer);
      END;
    END;

    PROCEDURE ImportXML@1100285015(XMLPortNo@1100285001 : Integer;PathName@1070000 : Text[1024];FileName@1100285000 : Text[1024];ToFolder@1100285002 : Text[1024]);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ExFlowFileMgtCLASSIC.ImportXML(XMLPortNo,PathName,FileName);
        2: ExFlowFileMgtNAV2009.ImportXML(XMLPortNo,PathName,FileName);
        3: ExFlowFileMgtNAV2009R2.ImportXML(XMLPortNo,PathName,FileName);
        4: ExFlowFileMgtWebClient.ImportXML(XMLPortNo,PathName,FileName);
      END;
    END;

    PROCEDURE ClientTempFileName@6(PassedString@1001 : Text[250];FileExtension@1002 : Text[250]) : Text[1024];
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: EXIT(ExFlowFileMgtCLASSIC.ClientTempFileName(PassedString,FileExtension));
        2: EXIT(ExFlowFileMgtNAV2009.ClientTempFileName(PassedString,FileExtension));
        3: EXIT(ExFlowFileMgtNAV2009R2.ClientTempFileName(PassedString,FileExtension));
        4: EXIT(ExFlowFileMgtWebClient.ClientTempFileName(PassedString,FileExtension));
      END;
    END;

    PROCEDURE ServerTempFileName@1100285018(PassedString@1001 : Text[250];FileExtension@1002 : Text[250]) : Text[1024];
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: EXIT(ExFlowFileMgtCLASSIC.ClientTempFileName(PassedString,FileExtension));
        2: EXIT(ExFlowFileMgtNAV2009.ServerTempFileName(PassedString,FileExtension));
        3: EXIT(ExFlowFileMgtNAV2009R2.ServerTempFileName(PassedString,FileExtension));
        4: EXIT(ExFlowFileMgtWebClient.ServerTempFileName(PassedString,FileExtension));
      END;
    END;

    PROCEDURE SaveReportAsPDF@1100285016(ReportNo@1100285000 : Integer;FileName@1100285001 : Text[250];VAR PurchHeader@1100285002 : Record 38;RootFolder@1100285003 : Text[250]);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ERROR(EXF001);
        2: ExFlowFileMgtNAV2009.SaveReportAsPDF(ReportNo,FileName,PurchHeader,RootFolder);
        3: ExFlowFileMgtNAV2009R2.SaveReportAsPDF(ReportNo,FileName,PurchHeader,RootFolder);
        4: ExFlowFileMgtWebClient.SaveReportAsPDF(ReportNo,FileName,PurchHeader,RootFolder);
      END;
    END;

    PROCEDURE CreateDotNetADTable@1100285003(VAR Ex2009AdUsers@1100285005 : Record 12013598);
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ERROR(EXF002);
        2: ERROR(EXF002);
        3: ExFlowFileMgtNAV2009R2.CreateADTable(Ex2009AdUsers);
        4: ExFlowFileMgtWebClient.CreateADTable(Ex2009AdUsers);
      END;
    END;

    PROCEDURE PreviewDoc@1100285000(FileURL@1100285000 : Text[1024]) : Text[1024];
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: ERROR(EXF002);
        2: EXIT('');
        3: EXIT(ExFlowFileMgtNAV2009R2.PreviewDoc(FileURL));
        4: EXIT(ExFlowFileMgtWebClient.PreviewDoc(FileURL));
      END;
    END;

    PROCEDURE TIFConvert@1100285009(_TIFConverter@1100285000 : Text[250];_FromFile@1100285001 : Text[250];_ToFile@1100285002 : Text[250]) : Boolean;
    BEGIN
      NAVClientVersion := GetNAVVersion;
      CASE NAVClientVersion OF
        1: EXIT(ExFlowFileMgtCLASSIC.TIFConvert(_FromFile,_ToFile));
        2: ERROR(EXF002);
        3: EXIT(ExFlowFileMgtNAV2009R2.TIFConvert(_TIFConverter,_FromFile,_ToFile));
        4: EXIT(ExFlowFileMgtWebClient.TIFConvert(_TIFConverter,_FromFile,_ToFile));
      END;
    END;

    BEGIN
    END.
  }
}

