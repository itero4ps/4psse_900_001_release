OBJECT Codeunit 6085783 CEM Database Trigger
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EMW16.00.10.1.03.00;
  }
  PROPERTIES
  {
    Permissions=TableData 6086345=rimd;
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TempChangeLogSetupTable@1160040000 : TEMPORARY Record 403;

    PROCEDURE GetTableTriggerSetup@1(TableID@1000 : Integer;VAR RunInsert@1001 : Boolean;VAR RunModify@1002 : Boolean;VAR RunDelete@1003 : Boolean;VAR RunRename@1004 : Boolean);
    VAR
      FieldType@1160040000 : Record 6086345;
    BEGIN
      IF TableID = DATABASE::"Change Log Entry" THEN
        EXIT;

      IF COMPANYNAME = '' THEN
        EXIT;

      IF NOT TempChangeLogSetupTable.GET(TableID) THEN BEGIN
        TempChangeLogSetupTable.INIT;
        TempChangeLogSetupTable."Table No." := TableID;

        FieldType.SETRANGE("Source Table No.",TableID);
        IF NOT FieldType.ISEMPTY THEN BEGIN
          TempChangeLogSetupTable."Log Insertion" := TempChangeLogSetupTable."Log Insertion"::"All Fields";
          TempChangeLogSetupTable."Log Modification" := TempChangeLogSetupTable."Log Modification"::"All Fields";
          TempChangeLogSetupTable."Log Deletion" := TempChangeLogSetupTable."Log Deletion"::"All Fields";
        END;

        TempChangeLogSetupTable.INSERT;
      END;

      RunInsert := RunInsert OR (TempChangeLogSetupTable."Log Insertion" = TempChangeLogSetupTable."Log Insertion"::"All Fields");
      RunModify := RunModify OR (TempChangeLogSetupTable."Log Modification" = TempChangeLogSetupTable."Log Modification"::"All Fields");
      RunDelete := RunDelete OR (TempChangeLogSetupTable."Log Deletion" = TempChangeLogSetupTable."Log Deletion"::"All Fields");
      RunRename := RunRename OR RunModify;
    END;

    PROCEDURE Insert@1160040007(VAR RecRef@1160040001 : RecordRef) : Boolean;
    BEGIN
      IF RecRef.ISTEMPORARY THEN
        EXIT;

      MarkTableForUpdate(RecRef.NUMBER);
    END;

    PROCEDURE Modify@1160040006(VAR RecRef@1160040001 : RecordRef) : Boolean;
    BEGIN
      IF RecRef.ISTEMPORARY THEN
        EXIT;

      MarkTableForUpdate(RecRef.NUMBER);
    END;

    PROCEDURE Delete@1160040005(VAR RecRef@1160040001 : RecordRef) : Boolean;
    BEGIN
      IF RecRef.ISTEMPORARY THEN
        EXIT;

      MarkTableForUpdate(RecRef.NUMBER);
    END;

    PROCEDURE Rename@1160040003(VAR RecRef@1160040003 : RecordRef;VAR xRecRef@1160040000 : RecordRef) : Boolean;
    BEGIN
      IF RecRef.ISTEMPORARY THEN
        EXIT;

      MarkTableForUpdate(RecRef.NUMBER);
    END;

    LOCAL PROCEDURE MarkTableForUpdate@1160040000(TableID@1160040000 : Integer);
    VAR
      FieldType@1160040001 : Record 6086345;
    BEGIN
      FieldType.SETRANGE("Source Table No.",TableID);
      IF FieldType.FINDFIRST THEN BEGIN
        FieldType."Last Update Date/Time" := CURRENTDATETIME;
        FieldType.MODIFY;
      END;
    END;

    PROCEDURE GetTableTriggerMask@1160040001(VAR tableId@1160040000 : Integer) : Integer;
    BEGIN
      EXIT(0);
    END;

    BEGIN
    END.
  }
}

