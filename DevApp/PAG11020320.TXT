OBJECT Page 11020320 Hour Accounting on Time SF
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS9.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Lines;
    SourceTable=Table11012039;
    PageType=ListPart;
    AutoSplitKey=Yes;
    OnOpenPage=BEGIN
                 IF JobsSetup.GET() THEN;
                 IF ServiceSetup.GET() THEN;
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  Type := xRec.Type;
                  "Connection No." := 0;
                  OnAfterGetCurrRecord;
                END;

    OnInsertRecord=BEGIN
                     "Connection No." := 0;
                   END;

    OnModifyRecord=BEGIN
                     IF NOT LineIsEditable THEN BEGIN
                       CurrPage.UPDATE(FALSE);
                       EXIT(FALSE);
                     END;
                   END;

    OnDeleteRecord=BEGIN
                     IF NOT LineIsEditable THEN BEGIN
                       CurrPage.UPDATE(FALSE);
                       EXIT(FALSE);
                     END;
                   END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100485000;1;Group  ;
                GroupType=Repeater }

    { 1100485044;2;Field  ;
                SourceExpr=Type;
                OnValidate=BEGIN
                             OnAfterGetCurrRecord;
                           END;
                            }

    { 1100485046;2;Field  ;
                SourceExpr="Receiving Company";
                Visible=FALSE }

    { 1100485056;2;Field  ;
                SourceExpr="Cost Code";
                Editable=CostCodeEditable;
                OnValidate=BEGIN
                             CostCodeOnAfterValidate;
                             OnAfterGetCurrRecord;
                           END;
                            }

    { 1100485060;2;Field  ;
                SourceExpr="Cost Code Description";
                Visible=FALSE }

    { 1100485062;2;Field  ;
                SourceExpr="Service Order No.";
                Editable=ServiceRelatedEditable }

    { 1100485064;2;Field  ;
                SourceExpr="Service Order Description";
                Visible=FALSE }

    { 1100485066;2;Field  ;
                SourceExpr="Service Location No.";
                Visible=FALSE;
                Editable=ServiceRelatedEditable }

    { 1210190000;2;Field  ;
                SourceExpr="Service Location Description";
                Visible=FALSE }

    { 1100485072;2;Field  ;
                SourceExpr="Additional Cost (Service)";
                Visible=FALSE }

    { 1100485048;2;Field  ;
                SourceExpr="Project No.";
                Editable=ProjectNoEditable;
                OnValidate=BEGIN
                             OnAfterGetCurrRecord;
                           END;
                            }

    { 1100485074;2;Field  ;
                SourceExpr="Project Description";
                Visible=FALSE }

    { 1210190001;2;Field  ;
                SourceExpr="Project City";
                Visible=FALSE }

    { 1100485050;2;Field  ;
                SourceExpr=Element;
                Editable=ProjectRelatedEditable }

    { 1100525000;2;Field  ;
                DrillDown=No;
                SourceExpr="Element Description";
                Visible=FALSE }

    { 1100485076;2;Field  ;
                SourceExpr="Extension Contract";
                Visible=FALSE;
                Editable=ProjectRelatedEditable }

    { 1100485078;2;Field  ;
                SourceExpr="Rental Unit";
                Visible=FALSE;
                Editable=ProjectRelatedEditable }

    { 1100485080;2;Field  ;
                SourceExpr="Estimate No.";
                Visible=FALSE }

    { 1100485082;2;Field  ;
                SourceExpr="Try-out No.";
                Visible=FALSE }

    { 1100409000;2;Field  ;
                SourceExpr="Department Code" }

    { 1100485052;2;Field  ;
                SourceExpr="Cost Object";
                OnValidate=BEGIN
                             CostObjectOnAfterValidate;
                             CostCodeOnAfterValidate;
                           END;
                            }

    { 1100485084;2;Field  ;
                SourceExpr="Cost Object Description";
                Visible=FALSE }

    { 1100485054;2;Field  ;
                SourceExpr="Cost Component";
                Editable=CostComponentEditable }

    { 1100485058;2;Field  ;
                SourceExpr="Wage Component";
                OnValidate=BEGIN
                             WageComponentOnAfterValidate;
                             CostCodeOnAfterValidate;
                           END;
                            }

    { 1100485086;2;Field  ;
                SourceExpr=Description;
                Visible=FALSE }

    { 1100485088;2;Field  ;
                SourceExpr=Chargeable;
                Visible=FALSE }

    { 1100485090;2;Field  ;
                SourceExpr=Quantity;
                Editable=QuantityEditable }

    { 1100485092;2;Field  ;
                BlankZero=Yes;
                SourceExpr="Amount (LCY)";
                Editable=AmountEditable;
                HideValue=AmountHideValue;
                OnValidate=BEGIN
                             AmountOnAfterValidate;
                           END;
                            }

    { 1100485094;2;Field  ;
                SourceExpr="Posting Date";
                Visible=FALSE;
                Editable=PostingDateEditable }

    { 1100485001;2;Field  ;
                SourceExpr=Day;
                Editable=TimeRelatedEditable;
                OnValidate=BEGIN
                             DayOnAfterValidate;
                           END;
                            }

    { 1100485003;2;Field  ;
                SourceExpr="Time From";
                Editable=TimeRelatedEditable;
                OnValidate=BEGIN
                             TimeFromOnAfterValidate;
                           END;
                            }

    { 1100485005;2;Field  ;
                SourceExpr="Time Until";
                Editable=TimeRelatedEditable;
                OnValidate=BEGIN
                             TimeUntilOnAfterValidate;
                           END;
                            }

    { 1100485007;2;Field  ;
                SourceExpr=Duration;
                Editable=TimeRelatedEditable;
                OnValidate=BEGIN
                             DurationOnAfterValidate;
                           END;
                            }

    { 1100485009;2;Field  ;
                DecimalPlaces=2:4;
                SourceExpr="Total Line" }

    { 1100485096;2;Field  ;
                SourceExpr="Cost Plus Entry Created";
                Visible=FALSE;
                Editable=FALSE }

    { 1100485098;2;Field  ;
                SourceExpr=Correction;
                Visible=FALSE }

    { 1100485100;2;Field  ;
                SourceExpr=Comment;
                Visible=FALSE }

    { 1100485102;2;Field  ;
                SourceExpr="Reason Code";
                Visible=FALSE }

    { 1100485108;2;Field  ;
                SourceExpr="Cost Price Found at";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      DimMgt@1100485003 : Codeunit 408;
      DimValRec@1100485002 : Record 349;
      JobsSetup@1210190010 : Record 315;
      ServiceSetup@1210190011 : Record 11012800;
      AmountHideValue@19020670 : Boolean INDATASET;
      CostCodeEditable@1210190000 : Boolean INDATASET;
      ServiceRelatedEditable@1210190001 : Boolean INDATASET;
      ProjectNoEditable@1210190002 : Boolean INDATASET;
      ProjectRelatedEditable@1210190003 : Boolean INDATASET;
      CostComponentEditable@1210190004 : Boolean INDATASET;
      QuantityEditable@1210190006 : Boolean INDATASET;
      AmountEditable@1210190007 : Boolean INDATASET;
      PostingDateEditable@1210190008 : Boolean INDATASET;
      TimeRelatedEditable@1210190009 : Boolean INDATASET;

    PROCEDURE GetHoursFromPostedHours@1100485001(iHourAccountingRec@1100485000 : Record 11012038);
    BEGIN
      GetHoursFromPostedHours(iHourAccountingRec);
    END;

    LOCAL PROCEDURE CostCodeOnAfterValidate@19058369();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE CostObjectOnAfterValidate@19061648();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE WageComponentOnAfterValidate@19034041();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE AmountOnAfterValidate@19024931();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE DayOnAfterValidate@19004661();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE TimeFromOnAfterValidate@19024703();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE TimeUntilOnAfterValidate@19046260();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE DurationOnAfterValidate@19058585();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    BEGIN
      AmountHideValue := FALSE;
      xRec := Rec;
      CALCFIELDS("Component Type");

      CostCodeEditable := (Type = Type::Indirect);

      ServiceRelatedEditable := (Type = Type::Service);

      ProjectNoEditable := (Type = Type::Project) AND ("Connection No." = 0);

      ProjectRelatedEditable := ("Project No." <> '');

      CostComponentEditable :=
        (("Project No." <> '') AND JobsSetup."Cost Component Editable") OR
        (("Service Order No." <> '') AND ServiceSetup."Cost Component Editable") OR
        (("Project No." = '') AND ("Service Order No." = ''));


      QuantityEditable := ("Component Type" = "Component Type"::Expenses);
      TimeRelatedEditable := ("Component Type" = "Component Type"::Hours );

      IF "Cost Object" = '' THEN BEGIN
        AmountEditable := ("Component Type" = "Component Type"::Expenses);
      END ELSE BEGIN
        DimValRec.CHANGECOMPANY("Receiving Company");
        DimMgt.GetDimValueRec(2, "Cost Object", DimValRec, FALSE, '');
        AmountEditable :=
          (("Component Type" = "Component Type"::Expenses) AND
           (DimValRec.Code <> '') AND
           NOT (DimValRec."Fixed at Hours Accounting"));
      END;

      IF "Component Type" <> "Component Type"::Expenses THEN
        AmountHideValue := TRUE; //to prevent showing people's salary

      PostingDateEditable := CompTypeEditable;
    END;

    BEGIN
    END.
  }
}

