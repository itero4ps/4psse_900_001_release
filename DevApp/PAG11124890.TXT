OBJECT Page 11124890 Assembly Project
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS9.00 (88);
  }
  PROPERTIES
  {
    CaptionML=ENU=Assembly Project;
    SourceTable=Table11072003;
    SourceTableView=WHERE(Assembly Project=CONST(Yes));
    PageType=ListPlus;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=ENU=New,Process,Report,Assembly Project rules,Project Control, Structure and Budget,Buyer Management;
    OnInit=BEGIN
             JobInventoryByStockReleaseEnab := TRUE;
             JobInventoryLocationShelfEnabl := TRUE;
             MapPointVisible := TRUE;
             DropZoneContainerVisible := TRUE;
             "Main ProjectEditable" := TRUE;
             "Affiliation No.Editable" := TRUE;
             CalculateBAmountsbasedonEditab := TRUE;
             "% to B AccountEditable" := TRUE;
             "% LaborEditable" := TRUE;
             "Revision RuleEditable" := TRUE;
             "Progress RegistryEditable" := TRUE;
             ProgressRegistryPTEEditable := TRUE;
           END;

    OnOpenPage=VAR
                 MapMgt@1000 : Codeunit 802;
               BEGIN
                 IF NOT MapMgt.TestSetup THEN
                   MapPointVisible := (FALSE);
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 //**4PS.sn
                 ProjSetUp.GET;

                 InventSetupRec.GET;
                 IF InventSetupRec."Level Job Inventory Loc./Shelf" <> InventSetupRec."Level Job Inventory Loc./Shelf"::Project THEN
                   JobInventoryLocationShelfEnabl := FALSE;
                 IF InventSetupRec."Level Job Inventory Stock Rel." <> InventSetupRec."Level Job Inventory Stock Rel."::Project THEN
                   JobInventoryByStockReleaseEnab := FALSE;
                 //**4PS.en
               END;

    OnAfterGetRecord=BEGIN

                       //**4PS.sn
                       CALCFIELDS(Prospect);
                       "Progress RegistryEditable" := NOT "Progress on base of Tender";
                       ProgressRegistryPTEEditable := "Progress on base of Tender";

                       IF FromReference THEN BEGIN
                         FromReference := FALSE;
                         CurrPage.AssemblyObjects.PAGE.InitSelectionFromReference(
                           YardNo, EntityType, SystemNo, EntityNo);
                       END;
                       //**4PS.en
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02

                  "Assembly Project" := TRUE;
                  OnAfterGetCurrRecord;
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525041;1 ;ActionGroup;
                      CaptionML=ENU=&Advice Orders functions }
      { 1100525015;1 ;ActionGroup;
                      CaptionML=ENU=Navigate }
      { 1100525000;2 ;Action    ;
                      CaptionML=ENU=Material Req. Lines;
                      RunObject=Page 11124944;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Line;
                      PromotedCategory=Category4 }
      { 1100525001;2 ;Action    ;
                      CaptionML=ENU=Advice Orders;
                      RunObject=Page 11124886;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=OrderTracking;
                      PromotedCategory=Category4 }
      { 1100525002;2 ;Action    ;
                      CaptionML=ENU=Purchase Orders;
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowPurchaseOrdersForProject;
                               END;
                                }
      { 1100525005;2 ;Action    ;
                      CaptionML=ENU=Project Inventory;
                      RunObject=Page 11124919;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=ItemWorksheet;
                      PromotedCategory=Category4 }
      { 1100525017;1 ;ActionGroup;
                      CaptionML=ENU=Commission & Invoicing }
      { 1101200084;2 ;Action    ;
                      CaptionML=ENU=&Installments;
                      RunObject=Page 11012025;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=AmountByPeriod }
      { 1000000006;2 ;Action    ;
                      CaptionML=ENU=E&xtensions;
                      RunObject=Page 11012014;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=TransferFunds;
                      PromotedCategory=Category6 }
      { 1000000012;2 ;Action    ;
                      CaptionML=ENU=Principals;
                      Image=TeamSales;
                      OnAction=BEGIN
                                 //**4PS
                                 ProjPrincipRec.RESET;
                                 ProjPrincipRec.SETRANGE("Project No.","No.");
                                 IF "Bill-to Customer No." <> '' THEN
                                   IF NOT ProjPrincipRec.GET("No.", "Bill-to Customer No.") THEN
                                     ProjPrincipRec.SETRANGE(Principal, "Bill-to Customer No.");
                                 PAGE.RUN(PAGE::"Project Principal List",ProjPrincipRec);
                               END;
                                }
      { 1100485141;2 ;ActionGroup;
                      CaptionML=ENU=&Unit Prices;
                      Image=CostCenter }
      { 1100485140;3 ;Action    ;
                      CaptionML=ENU=Project &Unit Prices;
                      RunObject=Page 11072519;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CostCenter }
      { 1100485142;3 ;Action    ;
                      CaptionML=ENU=Production Motivation;
                      Image=CostCenter;
                      OnAction=VAR
                                 ProdMot@1210190000 : Record 11020425;
                               BEGIN
                                 ProdMot.RunUnitPriceProdMotList("No.", '', 0);  //* Level 0=Project
                               END;
                                }
      { 1100485147;2 ;ActionGroup;
                      CaptionML=ENU=&Sales Prices;
                      Image=SalesPrices }
      { 1100485148;3 ;Action    ;
                      CaptionML=ENU=Project - &Employee Sales Prices;
                      RunObject=Page 11072469;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPrices }
      { 1100485149;3 ;Action    ;
                      CaptionML=ENU=Project - Employee - &Cost Object Sales Prices;
                      RunObject=Page 11072497;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPrices }
      { 1100485150;3 ;Action    ;
                      CaptionML=ENU=Project - Employee - Cost Object - &Wage Component Sales Prices;
                      RunObject=Page 11072498;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPrices }
      { 1100485151;3 ;Action    ;
                      CaptionML=ENU=Project - Cost &Object Sales Prices;
                      RunObject=Page 11072467;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPrices }
      { 1100485152;3 ;Action    ;
                      CaptionML=ENU=Project - Cost Object - Wage Co&mponent Sales Prices;
                      RunObject=Page 11072468;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPrices }
      { 1100485138;2 ;ActionGroup;
                      CaptionML=ENU=More;
                      Image=Navigate }
      { 1210190020;3 ;Action    ;
                      CaptionML=ENU=Settlement Sheet;
                      Image=ApplyEntries;
                      OnAction=VAR
                                 SettlementSheet@1210190000 : Record 11012021;
                                 Counter@1210190001 : Integer;
                               BEGIN
                                 //kzwerver, 110524, n, #27458
                                 TESTFIELD("Bill-to Customer No.");

                                 SettlementSheet.RESET;
                                 SettlementSheet.SETRANGE("Project No.", "No.");
                                 Counter := SettlementSheet.COUNT;
                                 IF Counter > 1 THEN BEGIN
                                   PAGE.RUNMODAL(PAGE::"Settlement Sheet List", SettlementSheet);
                                 END ELSE BEGIN
                                   IF Counter = 0 THEN BEGIN
                                     IF CONFIRM(Text11012007,TRUE) THEN BEGIN
                                       InsertSettlementSheet("Bill-to Customer No.");
                                       COMMIT;
                                       IF SettlementSheet.FINDFIRST THEN
                                         Counter := 1;
                                     END;
                                   END;
                                   IF Counter = 1 THEN BEGIN
                                     SettlementSheet.FINDFIRST;
                                     SettlementSheet.SETRANGE(Principal, SettlementSheet.Principal);
                                     SettlementSheet.SETRANGE("Commission No.", SettlementSheet."Commission No.");
                                     PAGE.RUNMODAL(PAGE::"Settlement Sheet", SettlementSheet);
                                   END;
                                 END;
                               END;
                                }
      { 1000000007;3 ;Action    ;
                      CaptionML=ENU=&Cost Plus Entries;
                      RunObject=Page 11012043;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=AdjustEntries }
      { 1000000008;3 ;Action    ;
                      CaptionML=ENU=In&voices;
                      Image=Invoice;
                      OnAction=VAR
                                 lSalesInvHeader@1210190002 : Record 112;
                                 lSalesInvLine@1210190001 : Record 113;
                               BEGIN
                                 //**4PS
                                 lSalesInvHeader.CLEARMARKS;
                                 lSalesInvLine.SETCURRENTKEY("Job No.","Project Invoice","Installment Invoice","Sell-to Customer No.");
                                 lSalesInvLine.SETRANGE("Job No.","No.");
                                 IF lSalesInvLine.FINDSET THEN
                                   REPEAT
                                     IF lSalesInvHeader.GET(lSalesInvLine."Document No.") THEN
                                       lSalesInvHeader.MARK(TRUE);
                                   UNTIL lSalesInvLine.NEXT = 0;

                                 lSalesInvHeader.MARKEDONLY(TRUE);

                                 PAGE.RUNMODAL(PAGE::"Posted Sales Invoices",lSalesInvHeader);
                               END;
                                }
      { 1000000004;3 ;Action    ;
                      CaptionML=ENU=Credit &Memos;
                      Image=CreditMemo;
                      OnAction=VAR
                                 lSalesCrMemoHeader@1210190015 : Record 114;
                                 lSalesCrMemoLine@1210190021 : Record 115;
                               BEGIN
                                 //**4PS
                                 lSalesCrMemoHeader.CLEARMARKS;
                                 lSalesCrMemoLine.SETRANGE("Job No.","No.");
                                 IF lSalesCrMemoLine.FINDSET THEN
                                   REPEAT
                                     IF lSalesCrMemoHeader.GET(lSalesCrMemoLine."Document No.") THEN
                                       lSalesCrMemoHeader.MARK(TRUE);
                                   UNTIL lSalesCrMemoLine.NEXT = 0;

                                 lSalesCrMemoHeader.MARKEDONLY(TRUE);

                                 PAGE.RUNMODAL(PAGE::"Posted Sales Credit Memos",lSalesCrMemoHeader);
                               END;
                                }
      { 1100485133;1 ;ActionGroup;
                      CaptionML=ENU=Project Structure and  Budget }
      { 1210190014;2 ;Action    ;
                      CaptionML=ENU=Sub Projects;
                      Promoted=Yes;
                      Image=Splitlines;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 JobRec@1210190000 : Record 11072003;
                               BEGIN
                                 //**4PS
                                 JobRec.SETRANGE("Single/Main/Sub Project", "Single/Main/Sub Project"::"Sub Project");
                                 JobRec.SETRANGE("Main Project", "No.");
                                 IF JobRec.FINDFIRST THEN
                                   PAGE.RUNMODAL(0, JobRec)
                                 ELSE
                                   MESSAGE(Text11012000);
                               END;
                                }
      { 61      ;2   ;Action    ;
                      CaptionML=ENU=Elements;
                      RunObject=Page 11012028;
                      RunPageView=SORTING(Project No.,Element);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=BOMVersions;
                      PromotedCategory=Category6 }
      { 1101200079;2 ;Action    ;
                      ShortCutKey=Ctrl+B;
                      CaptionML=ENU=Budget;
                      RunObject=Page 11012003;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=LedgerBudget;
                      PromotedCategory=Category6 }
      { 1101200080;2 ;Action    ;
                      CaptionML=ENU=Budget &Adjustments;
                      RunObject=Page 11012011;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Balance;
                      PromotedCategory=Category6 }
      { 1100485122;2 ;ActionGroup;
                      CaptionML=ENU=&Cost Prices;
                      Image=AdjustItemCost }
      { 1100485011;3 ;Action    ;
                      CaptionML=ENU=Project &Budget Rates;
                      RunObject=Page 11020264;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 1100485123;3 ;Action    ;
                      CaptionML=ENU=Project - &Employee Cost Prices;
                      RunObject=Page 11020300;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 1100485026;3 ;Action    ;
                      CaptionML=ENU=Project - Employee - &Wage Component Cost Prices;
                      RunObject=Page 11072435;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 1100485126;3 ;Action    ;
                      CaptionML=ENU=Project - &Cost Object Cost Prices;
                      RunObject=Page 11072434;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 1100485124;3 ;Action    ;
                      CaptionML=ENU=Project - &Trade Association Cost Prices;
                      RunObject=Page 11072432;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 1100485125;3 ;Action    ;
                      CaptionML=ENU=Project - Trade Association - Wage Co&mponent Cost Prices;
                      RunObject=Page 11072433;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 58      ;1   ;ActionGroup;
                      CaptionML=ENU=P&roject }
      { 1100525047;2 ;Action    ;
                      CaptionML=ENU=Project Control;
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 OpenProjectControl; //call 31241
                               END;
                                }
      { 60      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Ledger E&ntries;
                      RunObject=Page 11072005;
                      RunPageView=SORTING(Job No.,Posting Date);
                      RunPageLink=Job No.=FIELD(No.);
                      Image=GLRegisters }
      { 1100525008;2 ;Action    ;
                      CaptionML=ENU=Snapshot;
                      RunObject=Page 11124895;
                      RunPageView=SORTING(Project No.,Snapshot Date);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Picture }
      { 1100528802;2 ;Action    ;
                      CaptionML=ENU=Risks & Opportunities;
                      RunObject=Page 11126567;
                      RunPageLink=Source=CONST(Project),
                                  Source Code=FIELD(No.);
                      Image=OpportunitiesList }
      { 1100485013;2 ;ActionGroup;
                      CaptionML=ENU=Prognosis;
                      Image=CalculateRemainingUsage }
      { 1100525048;3 ;Action    ;
                      CaptionML=ENU=P&rogress;
                      RunObject=Page 11012079;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=EditLines;
                      PromotedCategory=Category5 }
      { 1100525049;3 ;Action    ;
                      CaptionML=ENU=Pr&ognosis;
                      Promoted=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 LaunchPrognosisList;
                               END;
                                }
      { 1100525065;3 ;Action    ;
                      CaptionML=ENU=Liquidity Prognosis;
                      Image=CashFlow;
                      OnAction=VAR
                                 LiqProgProjHead@1100525000 : Record 11020603;
                               BEGIN
                                 TESTFIELD("Liquidity Prognosis", "Liquidity Prognosis"::"Specific Division");

                                 LiqProgProjHead.SETRANGE("Project No.", "No.");
                                 PAGE.RUNMODAL(PAGE::"Liquidity Prognosis Proj Head", LiqProgProjHead);
                               END;
                                }
      { 1100525007;3 ;Action    ;
                      CaptionML=ENU=&Forecast;
                      RunObject=Page 11124951;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Forecast }
      { 1100485134;1 ;ActionGroup;
                      CaptionML=ENU=Engineering and Purc&hase }
      { 1100485032;2 ;Action    ;
                      CaptionML=ENU=Advice Orders;
                      RunObject=Page 11012102;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=OrderTracking }
      { 1101200082;2 ;Action    ;
                      CaptionML=ENU=Purchase A&ctions;
                      RunObject=Page 11012032;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=OrderTracking }
      { 1100485092;2 ;Action    ;
                      CaptionML=ENU=Purchase Quotes;
                      Image=Quote;
                      OnAction=BEGIN
                                 ShowPurchaseQuotesForProject;
                               END;
                                }
      { 11012000;2   ;Action    ;
                      CaptionML=ENU=Purchase Orders;
                      Image=Document;
                      OnAction=BEGIN
                                 ShowPurchaseOrdersForProject;
                               END;
                                }
      { 1100525028;2 ;Action    ;
                      CaptionML=ENU=Purchase Invoices;
                      Image=Invoice;
                      OnAction=BEGIN
                                 TESTFIELD("No.");
                                 ShowPostedPurchaseInvoices("No.");
                               END;
                                }
      { 1100525019;2 ;Action    ;
                      CaptionML=ENU=Purchase Credit Memos;
                      Image=CreditMemo;
                      OnAction=BEGIN
                                 TESTFIELD("No.");
                                 ShowPostedPurchaseCredMemos("No.");
                               END;
                                }
      { 1100525020;2 ;Action    ;
                      CaptionML=ENU=&Planning Activities;
                      RunObject=Page 11072310;
                      RunPageView=SORTING(No.);
                      RunPageLink=No.=FIELD(No.);
                      Image=Planning }
      { 1100409000;2 ;Action    ;
                      CaptionML=ENU=Purchase Text;
                      RunObject=Page 11012126;
                      RunPageLink=Line Type=CONST(Project),
                                  No.=FIELD(No.);
                      Image=Text }
      { 1100525018;2 ;ActionGroup;
                      CaptionML=ENU=More;
                      ActionContainerType=NewDocumentItems;
                      Image=Navigate }
      { 1100485090;3 ;Action    ;
                      CaptionML=ENU=&Activities;
                      Image=TaskList;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowTodos;
                               END;
                                }
      { 1100526121;3 ;Action    ;
                      CaptionML=ENU=Material Monitor;
                      Image=MachineCenterCalendar;
                      OnAction=BEGIN
                                 StartMatMonFromCard;
                               END;
                                }
      { 1100485081;3 ;Action    ;
                      CaptionML=ENU=Matrix Purchase Actions &Document Relations;
                      Image=ShowMatrix;
                      OnAction=VAR
                                 lvMatrixDocRelFrm@1100525000 : Page 11071829;
                               BEGIN
                                 TESTFIELD("No.");
                                 lvMatrixDocRelFrm.SetProjectNo("No.");
                                 lvMatrixDocRelFrm.RUNMODAL;
                               END;
                                }
      { 1100526101;1 ;ActionGroup;
                      CaptionML=ENU=GWW }
      { 1100485063;2 ;Action    ;
                      CaptionML=ENU=Project &Tender Paragraphs;
                      RunObject=Page 11020346;
                      RunPageLink=No.=FIELD(No.);
                      Image=BOMVersions }
      { 1100485132;1 ;ActionGroup;
                      CaptionML=ENU=Tables }
      { 62      ;2   ;Action    ;
                      CaptionML=ENU=Co&mments;
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Job),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1210190007;2 ;Action    ;
                      CaptionML=ENU=Doc&uments;
                      Image=Documents;
                      OnAction=VAR
                                 DocumentFilters@1100525001 : Codeunit 11012432;
                                 RecRef@1100525002 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 // ByCompany changed to FALSE, otherwise documents are not showed in the archive company
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, FALSE);
                               END;
                                }
      { 1100525022;2 ;ActionGroup;
                      CaptionML=ENU=Locations;
                      Image=Addresses }
      { 1210190017;3 ;Action    ;
                      CaptionML=ENU=Project &Locations;
                      RunObject=Page 11012020;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Job }
      { 1210190056;3 ;Action    ;
                      CaptionML=ENU=Plant Locations;
                      Image=SKU;
                      OnAction=VAR
                                 TmpLinkedPlantLoc@1210190000 : TEMPORARY Record 11012657;
                               BEGIN
                                 TESTFIELD("No.");
                                 TmpLinkedPlantLoc.SETRANGE("Link Type", TmpLinkedPlantLoc."Link Type"::Project);
                                 TmpLinkedPlantLoc."Link Type" := TmpLinkedPlantLoc."Link Type"::Project;
                                 TmpLinkedPlantLoc."Project No." := "No.";
                                 PAGE.RUNMODAL(PAGE::"Linked Plant Location List", TmpLinkedPlantLoc);
                               END;
                                }
      { 1100525004;3 ;Action    ;
                      CaptionML=ENU=Job Preferred &Locations;
                      RunObject=Page 11072043;
                      RunPageView=SORTING(Priority);
                      RunPageLink=Type=CONST(Job),
                                  No.=FIELD(No.);
                      Image=Company }
      { 1100525021;2 ;ActionGroup;
                      CaptionML=ENU=More;
                      Image=Navigate }
      { 84      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(11072003),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 1000000010;3 ;Action    ;
                      CaptionML=ENU=&Responsible Persons;
                      RunObject=Page 11012017;
                      RunPageView=SORTING(Project No.,Line No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Users }
      { 1210190053;3 ;Action    ;
                      CaptionML=ENU=Project Material Req. Lines;
                      RunObject=Page 11072352;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Line }
      { 1100485111;3 ;Action    ;
                      CaptionML=ENU=Project &Inventory;
                      RunObject=Page 11012673;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ItemWorksheet }
      { 1210190001;3 ;Action    ;
                      CaptionML=ENU=Project Inventory Entries;
                      RunObject=Page 11012670;
                      RunPageView=SORTING(Project No.,Yard No.)
                                  ORDER(Ascending);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ItemLedger }
      { 1210190065;3 ;Action    ;
                      CaptionML=ENU=Project &Authorities;
                      RunObject=Page 11020231;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ContactPerson }
      { 1210190015;3 ;Action    ;
                      CaptionML=ENU=Project Cost &Objects;
                      RunObject=Page 11012128;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ItemTrackingLedger }
      { 1100525006;3 ;Action    ;
                      CaptionML=ENU=&Features;
                      Image=BulletList;
                      OnAction=BEGIN
                                 ShowFeatures;
                               END;
                                }
      { 1210190008;3 ;Action    ;
                      CaptionML=ENU=&Rental Units;
                      Visible=false;
                      Image=CostCenter;
                      OnAction=BEGIN
                                 //**4PS
                                 ProjSetUp.TESTFIELD("Rental Units active");
                                 RentalUnitRec.SETRANGE("Project No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Rental Unit",RentalUnitRec);
                               END;
                                }
      { 1000000013;3 ;Action    ;
                      CaptionML=ENU=Pic&ture;
                      RunObject=Page 11012030;
                      RunPageLink=No.=FIELD(No.);
                      Image=Picture }
      { 1100528404;3 ;Action    ;
                      CaptionML=ENU=Object Elements;
                      Image=SuggestCapacity;
                      OnAction=VAR
                                 AssemblyYardNumberObject@1100528400 : Record 11020596;
                               BEGIN
                                 AssemblyYardNumberObject.SETRANGE("Project No.", "No.");
                                 PAGE.RUNMODAL(PAGE::"Assemb. Yard No. Obj. Elements", AssemblyYardNumberObject);
                               END;
                                }
      { 1100485027;2 ;ActionGroup;
                      CaptionML=ENU=&Civil Engineering;
                      Visible=FALSE }
      { 1100485028;3 ;Action    ;
                      CaptionML=ENU=Tender Paragraphs;
                      RunObject=Page 11020553;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Payment }
      { 1100485029;3 ;Action    ;
                      CaptionML=ENU=Tender Paragraph &Parts;
                      RunObject=Page 11020554;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Payment }
      { 1100525050;3 ;Action    ;
                      CaptionML=ENU=Project Inspections (Site Mgt.);
                      RunObject=Page 11125538;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CheckRulesSyntax }
      { 1100525051;2 ;ActionGroup;
                      CaptionML=ENU=Site Manager Form;
                      Visible=FALSE }
      { 1100525053;3 ;Action    ;
                      CaptionML=ENU=Project Working Hours;
                      RunObject=Page 11125541;
                      RunPageLink=No.=FIELD(No.);
                      Image=ServiceHours }
      { 1100525052;3 ;Action    ;
                      CaptionML=ENU=Project Inspections;
                      RunObject=Page 11125538;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CheckRulesSyntax }
      { 1100485136;2 ;ActionGroup;
                      CaptionML=ENU=Sales & &Marketing;
                      Visible=FALSE }
      { 1210190033;3 ;Action    ;
                      CaptionML=ENU=Try-out;
                      Image=Quote;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowTryOut(1);
                               END;
                                }
      { 1210190034;3 ;Action    ;
                      CaptionML=ENU=Try-out &Quote;
                      Image=Quote;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowTryOut(2);
                               END;
                                }
      { 1100528300;1 ;ActionGroup;
                      CaptionML=ENU=Document Portal }
      { 1100528301;2 ;Action    ;
                      CaptionML=ENU=Responsible Person Permissions;
                      RunObject=Page 11072411;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Permission }
      { 1100528302;2 ;Action    ;
                      CaptionML=ENU=Responsible Person Filters;
                      RunObject=Page 11072419;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Filter }
      { 1100528303;2 ;Action    ;
                      CaptionML=ENU=Authority Permissions;
                      RunObject=Page 11229190;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Permission }
      { 1100528304;2 ;Action    ;
                      CaptionML=ENU=Authority Filters;
                      RunObject=Page 11229187;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Filter }
      { 1100528305;2 ;Action    ;
                      CaptionML=ENU=Document Versions;
                      RunObject=Page 11229185;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Versions }
      { 1100528306;2 ;Action    ;
                      CaptionML=ENU=Document Updates;
                      RunObject=Page 11229181;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CreateLinesFromJob }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1101200085;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1100525025;1 ;ActionGroup;
                      CaptionML=ENU=General }
      { 1210190019;2 ;Action    ;
                      CaptionML=ENU=Update Delivery Date;
                      Image=RefreshText;
                      OnAction=VAR
                                 ProjectMaterialReqLine@1210190000 : Record 11012526;
                               BEGIN
                                 ProjectMaterialReqLine.UpdateReqDateFromProject("No.");
                               END;
                                }
      { 1100485002;2 ;ActionGroup;
                      CaptionML=ENU=Edit Word Documents;
                      Image=Word }
      { 1100485003;3 ;Action    ;
                      CaptionML=ENU=Delivery Form;
                      Image=Word;
                      OnAction=VAR
                                 Contact@1100528701 : Record 5050;
                                 DocumentTemplate@1100485000 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Bill-to Customer No.");
                                 IF Contact.GetContactByCustomer("Bill-to Customer No.", Contact, TRUE) THEN
                                   EditDocuments(STRSUBSTNO('%1', DocumentTemplate.Type::"Delivery Form"), Contact."No.", '', FALSE, '');
                               END;
                                }
      { 1100525003;3 ;Action    ;
                      CaptionML=ENU=Project Documents;
                      Image=Word;
                      OnAction=VAR
                                 Contact@1100528701 : Record 5050;
                                 DocumentTemplate@1100525002 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Bill-to Customer No.");
                                 IF Contact.GetContactByCustomer("Bill-to Customer No.", Contact, TRUE) THEN
                                   EditDocuments(STRSUBSTNO('%1', DocumentTemplate.Type::Job), Contact."No.", '', FALSE, '');
                               END;
                                }
      { 1100525009;2 ;Action    ;
                      CaptionML=ENU=&Filter on Feature;
                      Image=Filter;
                      OnAction=VAR
                                 lvFeatureRec@1100525001 : Record 11012752;
                                 lvFeatureFilterFrm@1100525000 : Page 11012757;
                               BEGIN
                                 lvFeatureFilterFrm.SetJobFilter(Rec);
                                 lvFeatureFilterFrm.SETTABLEVIEW(lvFeatureRec);
                                 lvFeatureFilterFrm.RUNMODAL;
                                 CLEAR(lvFeatureFilterFrm);
                               END;
                                }
      { 1100525027;1 ;ActionGroup;
                      CaptionML=ENU=Installments }
      { 1101200088;2 ;Action    ;
                      CaptionML=ENU=Generate Installments;
                      Image=AmountByPeriod;
                      OnAction=BEGIN
                                 //**4PS
                                 CLEAR(GenerateProjInstallm);
                                 GenerateProjInstallm.FromProject("No.");
                               END;
                                }
      { 1101200089;2 ;Action    ;
                      CaptionML=ENU=Set Installm. to be Invoiced;
                      Image=BankAccountRec;
                      OnAction=BEGIN
                                 //**4PS
                                 ProjInstalmRec.SETRANGE("Project No.","No.");
                                 REPORT.RUN(REPORT::"Set Installm. to be Invoiced",TRUE,FALSE,ProjInstalmRec);
                               END;
                                }
      { 1100525026;1 ;ActionGroup;
                      CaptionML=ENU=Generate }
      { 1100528700;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Print Project Cost Plus Entries to Create;
                      Image=PrintChecklistReport;
                      OnAction=VAR
                                 Job@1100528704 : Record 11072003;
                                 JobLedgerEntry@1100528703 : Record 11072005;
                                 PostedHourLine@1100528702 : Record 11012085;
                                 HourAccountingLine@1100528701 : Record 11012039;
                                 ProjectCostPlustoCreate@1100528700 : Report 11012137;
                               BEGIN
                                 //**4PS
                                 Job.SETRANGE("No.", "No.");
                                 JobLedgerEntry.SETRANGE("Cost Plus Entry Created", FALSE);
                                 PostedHourLine.SETRANGE("Cost Plus Entry Created", FALSE);
                                 HourAccountingLine.SETRANGE("Cost Plus Entry Created", FALSE);

                                 ProjectCostPlustoCreate.SETTABLEVIEW(Job);
                                 ProjectCostPlustoCreate.SETTABLEVIEW(JobLedgerEntry);
                                 ProjectCostPlustoCreate.SETTABLEVIEW(PostedHourLine);
                                 ProjectCostPlustoCreate.SETTABLEVIEW(HourAccountingLine);
                                 ProjectCostPlustoCreate.SetDefault("No.");
                                 ProjectCostPlustoCreate.RUN;
                               END;
                                }
      { 1000000014;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Generate Cost Plus Entries;
                      Image=SelectEntries;
                      OnAction=VAR
                                 lvProjRec@1210190026 : Record 11072003;
                                 lvProjLedgEntryRec@1210190019 : Record 11072005;
                                 lvPostedHourLineRec@1210190015 : Record 11012085;
                                 lvHourAccLineRec@1210190002 : Record 11012039;
                                 lvCreateCostPlusRpt@1210190001 : Report 11012013;
                               BEGIN
                                 //**4PS
                                 lvProjRec.SETRANGE("No.", "No.");
                                 lvProjLedgEntryRec.SETRANGE("Cost Plus Entry Created", FALSE);
                                 lvPostedHourLineRec.SETRANGE("Cost Plus Entry Created", FALSE);
                                 lvHourAccLineRec.SETRANGE("Cost Plus Entry Created", FALSE);

                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvProjRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvProjLedgEntryRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvPostedHourLineRec);
                                 lvCreateCostPlusRpt.SETTABLEVIEW(lvHourAccLineRec);
                                 lvCreateCostPlusRpt.SetDefault("No.");
                                 lvCreateCostPlusRpt.RUN;
                               END;
                                }
      { 1000000015;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Invoices;
                      Image=CreateJobSalesInvoice;
                      OnAction=VAR
                                 Job@1210190001 : Record 11072003;
                               BEGIN
                                 // jhoek.270611.begin: melding 16372
                                 // ProjPrincipRec.SETRANGE("Project No.","No.");
                                 // REPORT.RUN(REPORT::"Create Project Invoices",TRUE,FALSE,ProjPrincipRec);
                                 Job := Rec;
                                 Job.SETRECFILTER;

                                 REPORT.RUN(REPORT::"Create Project Invoices", TRUE, FALSE, Job);
                                 // jhoek.270611.end
                               END;
                                }
      { 1100485091;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Plant &Location;
                      Image=CreateSKU;
                      OnAction=BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 Rec.RunCreatePlantLocation(Rec);
                               END;
                                }
      { 1100525030;1 ;ActionGroup;
                      CaptionML=ENU=Document Portal;
                      Image=Refresh }
      { 1100485066;2 ;Action    ;
                      CaptionML=ENU=Create Project Site;
                      Image=Web;
                      OnAction=VAR
                                 CRMSetup@1100485000 : Record 5079;
                                 SharePointSetup4PS@1100525000 : Record 11012730;
                                 DocumentPortalProject@1100525001 : Codeunit 11012948;
                                 ProjectSiteHeader@1100409000 : Record 11071872;
                                 ProjectSiteLine@1100409001 : Record 11071873;
                                 ProjectSiteMgt@1100409002 : Codeunit 11012282;
                                 ProjectSiteSeqNo@1100409003 : Integer;
                                 ProjectSiteLineNo@1100409004 : Integer;
                               BEGIN
                                 IF "SharePoint Site URL" <>'' THEN
                                   ERROR(Text11012006)
                                 ELSE BEGIN
                                   //C018523.sn
                                   IF (ProjectSiteMgt.IsInLicense(FALSE)) AND (ProjectSiteMgt.ProjectSiteIsCreated(1, "No.")) THEN BEGIN
                                     IF (NOT ProjectSiteLine.GetProjectSiteLine(1, "No.", COMPANYNAME, ProjectSiteSeqNo, ProjectSiteLineNo)) THEN
                                       ERROR(Text11012008, ProjectSiteLine.TABLECAPTION, TABLECAPTION, "No.");
                                     IF (NOT "SharePoint Site Generated") AND ("SharePoint Site URL" = '') THEN BEGIN
                                       ProjectSiteHeader.GET(ProjectSiteSeqNo);
                                       ProjectSiteLine.GET(ProjectSiteSeqNo, ProjectSiteLineNo);
                                       ProjectSiteHeader.CreateSiteLine(ProjectSiteLine);
                                       "SharePoint Site Generated" := TRUE;
                                       "SharePoint Site URL" := ProjectSiteHeader.GetSiteURL;
                                       MODIFY;
                                     END;
                                   END ELSE BEGIN
                                   //C018523.en
                                     IF (NOT SharePointSetup4PS.GET) THEN  //#DP000319.sn
                                       SharePointSetup4PS.INIT;
                                     IF (SharePointSetup4PS."Use Project Portal") THEN BEGIN
                                       DocumentPortalProject.CreateProjectSite(Rec);
                                     END ELSE BEGIN //#DP000319.en
                                       IF "Make SharePoint Site" AND NOT "SharePoint Site Generated" THEN BEGIN
                                         SharepSetup.GET;
                                         IF (SharepSetup."Path Sitecollection SharePoint" <>'') AND (SharepSetup."SharePoint Template" <> '') THEN
                                           GenerateSharePointSite;
                                       END ELSE BEGIN
                                         CRMSetup.GET;
                                         IF (CRMSetup."Dir. Sharepoint XML Out"<>'') AND (CRMSetup."Codeunit No. Export Sharepoint" <> 0) THEN BEGIN
                                           IF "SharePoint Phase" = "SharePoint Phase"::" " THEN
                                             ERROR(Text11012003);
                                           IF "SharePoint Status" = "SharePoint Status"::New THEN
                                             "SharePoint Status" := "SharePoint Status"::Add;
                                           MODIFY;
                                         END;
                                       END;
                                     END;
                                   END;
                                 END;
                               END;
                                }
      { 1100525031;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Check Project Web Service;
                      Image=Check;
                      OnAction=BEGIN
                                 //**4PS
                                 CheckWebServiceProjectPortal;
                               END;
                                }
      { 1100528309;2 ;Action    ;
                      CaptionML=ENU=Create Quote Subsite;
                      Image=Web;
                      OnAction=VAR
                                 DocumentPortalProject@1100525001 : Codeunit 11012948;
                               BEGIN
                                 //**4PS
                                 DocumentPortalProject.CreateQuoteSubsite(Rec);
                               END;
                                }
      { 1100525032;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Project Authorities;
                      Image=ContactPerson;
                      OnAction=VAR
                                 Job@1100525000 : Record 11072003;
                                 CreateProjectAuthorities@1100525001 : Report 11012368;
                               BEGIN
                                 //**4PS
                                 Job.SETRANGE("No.", "No.");
                                 CreateProjectAuthorities.SETTABLEVIEW(Job);
                                 CreateProjectAuthorities.RUNMODAL;
                               END;
                                }
      { 1100525029;2 ;Action    ;
                      CaptionML=ENU=Update Site Content;
                      Image=BeginningText;
                      OnAction=VAR
                                 Job@1100409000 : Record 11072003;
                               BEGIN
                                 //**4PS
                                 Job.SETRANGE("No.", "No.");
                                 REPORT.RUNMODAL(REPORT::"Update Project Portal Data", TRUE, FALSE, Job);
                               END;
                                }
      { 1100525023;1 ;ActionGroup;
                      CaptionML=ENU=Copy }
      { 1101200086;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Copy &General Data;
                      Image=Copy;
                      OnAction=VAR
                                 CopyGeneralData@1100528400 : Page 11012110;
                               BEGIN
                                 //**4PS
                                 CopyGeneralData.SetProject("No.");
                                 CopyGeneralData.StdDialogRunModal;
                               END;
                                }
      { 1101200087;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Copy Project;
                      Image=Copy;
                      OnAction=BEGIN
                                 //**4PS
                                 CopyProject; //C012513
                               END;
                                }
      { 1100485000;2 ;Action    ;
                      CaptionML=ENU=Copy Standard Delivery;
                      Visible=false;
                      Image=Copy;
                      OnAction=VAR
                                 lStandDeliveryRec@1100485001 : Record 11012507;
                                 lProjPlotDeliveryRec@1100485000 : Record 11012507;
                               BEGIN
                                 //**4PS
                                 lStandDeliveryRec.SETFILTER("Project No.",'%1','');
                                 lStandDeliveryRec.SETFILTER("Plot No.",'%1','');
                                 IF lStandDeliveryRec.FIND('-') THEN
                                   REPEAT
                                     IF NOT lProjPlotDeliveryRec.GET("No.",'', lStandDeliveryRec."Delivery No.") THEN BEGIN
                                       lProjPlotDeliveryRec.INIT;
                                       lProjPlotDeliveryRec."Project No." := "No.";
                                       lProjPlotDeliveryRec."Plot No." := '';
                                       lProjPlotDeliveryRec."Delivery No." := lStandDeliveryRec."Delivery No.";
                                       lProjPlotDeliveryRec.TRANSFERFIELDS(lStandDeliveryRec,FALSE);
                                       lProjPlotDeliveryRec.INSERT;
                                     END;
                                   UNTIL lStandDeliveryRec.NEXT = 0;
                               END;
                                }
      { 1210190064;2 ;Action    ;
                      CaptionML=ENU=Generate Delivered Objects...;
                      Visible=false;
                      Image=MachineCenterLoad;
                      OnAction=VAR
                                 PlotRec@1100485001 : Record 11012500;
                                 GenerateDelObjectsRep@1100485002 : Report 11020224;
                               BEGIN
                                 PlotRec.SETRANGE("Project No.","No.");
                                 GenerateDelObjectsRep.SETTABLEVIEW(PlotRec);
                                 GenerateDelObjectsRep.RUNMODAL;
                               END;
                                }
      { 1100525024;1 ;ActionGroup;
                      CaptionML=ENU=Print }
      { 1210190011;2 ;Action    ;
                      CaptionML=ENU=&Print Worksheet;
                      Promoted=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 CurrPage.SETSELECTIONFILTER(ProjRec);
                                 PrintDoc.PrintAssemblyProjWorksheet(ProjRec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 1100528800;2;Field  ;
                SourceExpr="Description 2";
                Importance=Additional }

    { 1210190101;2;Field  ;
                SourceExpr="Settlement Method";
                OnValidate=BEGIN
                             SettlementMethodOnAfterValidat;
                           END;
                            }

    { 1210190100;2;Field  ;
                SourceExpr="Contract Type";
                OnValidate=BEGIN
                             ContractTypeOnAfterValidate;
                           END;
                            }

    { 32  ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                OnLookup=BEGIN
                           //**4PS
                           CurrPage.SAVERECORD;
                           COMMIT;
                           LookupProjectPrincipal;
                           CurrPage.UPDATE;
                         END;
                          }

    { 1101200030;2;Field  ;
                SourceExpr="Principal Name";
                Importance=Additional;
                Editable=FALSE }

    { 1101200004;2;Field  ;
                SourceExpr="Project Address Code" }

    { 1100485068;2;Field  ;
                CaptionML=ENU=Available Addresses;
                SourceExpr=NumAdrs;
                Importance=Additional;
                Editable=FALSE }

    { 45  ;2   ;Field     ;
                SourceExpr=Address;
                Editable=TRUE }

    { 47  ;2   ;Field     ;
                SourceExpr="Address 2";
                Importance=Additional;
                Editable=TRUE }

    { 55  ;2   ;Field     ;
                SourceExpr="Post Code";
                Editable=TRUE }

    { 49  ;2   ;Field     ;
                SourceExpr=City;
                Editable=TRUE }

    { 1210190041;2;Field  ;
                SourceExpr="Country/Region Code" }

    { 1101200002;2;Field  ;
                SourceExpr="Project Status";
                Importance=Promoted }

    { 10  ;2   ;Field     ;
                SourceExpr="Search Description";
                Importance=Additional }

    { 1101200000;2;Field  ;
                SourceExpr="Project Type";
                OnValidate=BEGIN
                             ProjectTypeOnAfterValidate;
                           END;
                            }

    { 1210190050;2;Field  ;
                SourceExpr="Preclosure Result" }

    { 1100485127;2;Field  ;
                SourceExpr="Blocking Code";
                Importance=Additional }

    { 1210190047;2;Field  ;
                SourceExpr="Provision Loss";
                Importance=Additional }

    { 1101200009;2;Field  ;
                SourceExpr="Territory Code" }

    { 1101200011;2;Field  ;
                SourceExpr=Type }

    { 1210190059;2;Field  ;
                SourceExpr=Discipline }

    { 1101200013;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                Importance=Additional;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1101200021;2;Field  ;
                SourceExpr="Single/Main/Sub Project";
                OnValidate=BEGIN
                             SingleMainSubProjectOnAfterVal;
                           END;
                            }

    { 1101200023;2;Field  ;
                SourceExpr="Main Project";
                Editable="Main ProjectEditable" }

    { 1100525034;1;Part   ;
                Name=AssemblyObjects;
                SubPageLink=Project No.=FIELD(No.);
                PagePartID=Page11072595 }

    { 1903705201;1;Group  ;
                CaptionML=ENU=Personnel }

    { 1210190174;2;Field  ;
                SourceExpr=Estimator;
                OnValidate=BEGIN
                             EstimatorOnAfterValidate;
                           END;
                            }

    { 1210190179;2;Field  ;
                SourceExpr="Name Estimator";
                Importance=Additional;
                Editable=FALSE }

    { 1210190173;2;Field  ;
                SourceExpr="Site Manager";
                OnValidate=BEGIN
                             SiteManagerOnAfterValidate;
                           END;
                            }

    { 1210190177;2;Field  ;
                SourceExpr="Name Site Manager";
                Importance=Additional;
                Editable=FALSE }

    { 1210190175;2;Field  ;
                SourceExpr="Project Manager";
                Importance=Promoted;
                OnValidate=BEGIN
                             ProjectManagerC1210190175OnAft;
                           END;
                            }

    { 1210190178;2;Field  ;
                SourceExpr="Name Project Manager";
                Importance=Additional;
                Editable=FALSE }

    { 1100526105;2;Field  ;
                SourceExpr=Mechanic;
                OnValidate=BEGIN
                             MechanicC1100526105OnAfterVali;
                           END;
                            }

    { 1100526107;2;Field  ;
                SourceExpr="Name Mechanic";
                Importance=Additional }

    { 1210190180;2;Field  ;
                SourceExpr="Project Engineer";
                OnValidate=BEGIN
                             ProjectEngineerOnAfterValidate;
                           END;
                            }

    { 1210190182;2;Field  ;
                SourceExpr="Name Project Engineer";
                Importance=Additional;
                Editable=FALSE }

    { 1210190183;2;Field  ;
                SourceExpr=Supervisor }

    { 1210190185;2;Field  ;
                CaptionML=ENU=Name Supervisor;
                SourceExpr=NameSupervisor;
                Importance=Additional;
                Editable=FALSE }

    { 1210190187;2;Field  ;
                SourceExpr=Buyercontact;
                OnValidate=BEGIN
                             BuyercontactOnAfterValidate;
                           END;
                            }

    { 1210190186;2;Field  ;
                SourceExpr="Name Buyer Contact";
                Importance=Additional;
                Editable=FALSE }

    { 1210190189;2;Field  ;
                SourceExpr="Purchaser Code" }

    { 1210190191;2;Field  ;
                SourceExpr="Name Purchaser";
                Importance=Additional;
                Editable=FALSE }

    { 1100485082;2;Field  ;
                SourceExpr=Expediter;
                OnValidate=BEGIN
                             ExpediterOnAfterValidate;
                           END;
                            }

    { 1100485084;2;Field  ;
                SourceExpr="Name Expediter";
                Importance=Additional;
                Editable=FALSE }

    { 1100485087;2;Field  ;
                SourceExpr=Adviser;
                OnValidate=BEGIN
                             AdviserOnAfterValidate;
                           END;
                            }

    { 1100485089;2;Field  ;
                SourceExpr="Name Adviser";
                Importance=Additional;
                Editable=FALSE }

    { 1100525054;2;Field  ;
                SourceExpr="Salesperson Code" }

    { 1100525056;2;Field  ;
                SourceExpr="Salesperson Name";
                Importance=Additional;
                Editable=FALSE }

    { 1905223301;1;Group  ;
                CaptionML=ENU=Dates }

    { 1210190151;2;Field  ;
                SourceExpr="Creation Date";
                Editable=FALSE }

    { 1210190150;2;Field  ;
                SourceExpr="Last Date Modified";
                Editable=FALSE }

    { 1210190152;2;Field  ;
                SourceExpr="Modified by" }

    { 1210190153;2;Field  ;
                SourceExpr="Status Modification Date" }

    { 1210190155;2;Field  ;
                SourceExpr="Starting Date" }

    { 1210190157;2;Field  ;
                SourceExpr="Ending Date" }

    { 1210190161;2;Field  ;
                SourceExpr="Technical Finished Date" }

    { 1100485010;2;Field  ;
                SourceExpr="Posting Date Closing" }

    { 1210190167;2;Field  ;
                SourceExpr=Text;
                MultiLine=Yes }

    { 1100526119;2;Field  ;
                SourceExpr=Blocked }

    { 1100526104;2;Field  ;
                SourceExpr="Posting Element Mandatory" }

    { 1905601301;1;Group  ;
                CaptionML=ENU=Budget }

    { 1210190143;2;Field  ;
                CaptionML=ENU=Try-Out;
                SourceExpr=GetTryOut(1);
                Editable=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowTryOut(1);
                         END;
                          }

    { 1210190145;2;Field  ;
                CaptionML=ENU=Try-Out Quote;
                SourceExpr=GetTryOut(2);
                Editable=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowTryOut(2);
                         END;
                          }

    { 1210190141;2;Field  ;
                CaptionML=ENU=Estimate No.;
                SourceExpr=GetEstimate();
                Editable=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowEstimate;
                         END;
                          }

    { 1100485024;2;Field  ;
                SourceExpr="Created from Service Loc. No.";
                Editable=FALSE }

    { 1100525016;2;Field  ;
                SourceExpr="Forecast Level" }

    { 1100485109;2;Field  ;
                SourceExpr="Excl. from Project Control" }

    { 1210190137;2;Field  ;
                SourceExpr="Budget Fixed" }

    { 1210190136;2;Field  ;
                SourceExpr="Version Date" }

    { 1100525014;2;Field  ;
                SourceExpr="Prognosis Level";
                Importance=Additional }

    { 1100485086;2;Field  ;
                SourceExpr="Prognosis per Element";
                Importance=Additional }

    { 1100525010;2;Field  ;
                SourceExpr="Progress on base of Tender";
                Importance=Additional;
                OnValidate=BEGIN
                             ProgressonbaseofTenderOnAfterV;
                           END;
                            }

    { 1100525012;2;Field  ;
                SourceExpr="Progress Registry (PTE)";
                Importance=Additional;
                Editable=ProgressRegistryPTEEditable }

    { 1210190139;2;Field  ;
                SourceExpr="Progress Method";
                Importance=Additional }

    { 1210190138;2;Field  ;
                SourceExpr="Progress Registry";
                Editable="Progress RegistryEditable" }

    { 1210190004;2;Field  ;
                SourceExpr="Progress from Instal. Progress";
                Importance=Additional }

    { 1210190057;2;Field  ;
                SourceExpr="Element per Installment" }

    { 1210190140;2;Field  ;
                SourceExpr="Default Rate Code";
                Importance=Additional }

    { 1100485047;2;Field  ;
                SourceExpr="Summary Sheet Project";
                Importance=Additional }

    { 1100485049;2;Field  ;
                SourceExpr="Summary Sheet Contract";
                Importance=Additional }

    { 1100485053;2;Field  ;
                SourceExpr="Summary Sheet Option";
                Importance=Additional }

    { 1900189601;1;Group  ;
                CaptionML=ENU=Receipt }

    { 1100485009;2;Field  ;
                SourceExpr=Deliver;
                Importance=Promoted }

    { 1100485016;2;Field  ;
                SourceExpr="Ship To Location";
                Importance=Promoted }

    { 1100485075;2;Field  ;
                SourceExpr="Shipping Agent Code" }

    { 1100485153;2;Field  ;
                SourceExpr="Job Inventory Location/Shelf";
                Importance=Additional;
                Enabled=JobInventoryLocationShelfEnabl }

    { 1100485155;2;Field  ;
                SourceExpr="Job Inventory By Stock Release";
                Importance=Additional;
                Enabled=JobInventoryByStockReleaseEnab }

    { 1100528500;2;Field  ;
                SourceExpr="Service Warranty Code" }

    { 1905885101;1;Group  ;
                CaptionML=ENU=Invoicing }

    { 1210190102;2;Field  ;
                SourceExpr="Contract Amount";
                Importance=Promoted }

    { 1100485007;2;Field  ;
                SourceExpr="Plot Price" }

    { 1210190103;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1100485110;2;Field  ;
                SourceExpr="Calculate B Amounts based on";
                Editable=CalculateBAmountsbasedonEditab }

    { 1210190105;2;Field  ;
                SourceExpr="% Labor";
                Editable="% LaborEditable" }

    { 1210190107;2;Field  ;
                SourceExpr="% to B Account";
                Editable="% to B AccountEditable" }

    { 1210190109;2;Field  ;
                SourceExpr="Affiliation No.";
                Editable="Affiliation No.Editable" }

    { 1210190111;2;Field  ;
                SourceExpr="SFB Code" }

    { 1210190113;2;Field  ;
                SourceExpr="Location Type 1";
                Importance=Additional }

    { 1210190115;2;Field  ;
                SourceExpr="Location Type 2";
                Importance=Additional }

    { 1210190003;2;Field  ;
                SourceExpr="Print Manday Register" }

    { 1100485043;2;Field  ;
                SourceExpr="Invoice Layout Code";
                Importance=Additional }

    { 1100485145;2;Field  ;
                SourceExpr="Price List";
                Importance=Additional }

    { 1100485146;2;Field  ;
                SourceExpr="Ref. Date Unit Price";
                Importance=Additional }

    { 1100485055;2;Field  ;
                SourceExpr=Revision;
                Importance=Additional;
                OnValidate=BEGIN
                             RevisionOnAfterValidate;
                           END;
                            }

    { 1100485057;2;Field  ;
                SourceExpr="Revision Rule";
                Importance=Additional;
                Editable="Revision RuleEditable" }

    { 1100485059;2;Field  ;
                SourceExpr="Reference Date Revision";
                Importance=Additional }

    { 1100485093;2;Field  ;
                SourceExpr="Long Lease";
                Importance=Additional }

    { 1100525059;2;Field  ;
                SourceExpr="Internal Project";
                Importance=Additional }

    { 1100529000;2;Field  ;
                SourceExpr="Master Company";
                Importance=Additional }

    { 1100525061;2;Field  ;
                SourceExpr="Master Project";
                Importance=Additional }

    { 1100525068;2;Field  ;
                SourceExpr="Cost Object Inter Project Cost";
                Importance=Additional }

    { 1100525070;2;Field  ;
                SourceExpr="Cost Object Inter Project Rev";
                Importance=Additional }

    { 1905052801;1;Group  ;
                CaptionML=ENU=Integration }

    { 1210190025;2;Field  ;
                SourceExpr="SharePoint Phase" }

    { 1210190026;2;Field  ;
                SourceExpr="SharePoint Status";
                Editable=FALSE }

    { 1210190029;2;Field  ;
                SourceExpr="Phase 1 Company" }

    { 1210190031;2;Field  ;
                SourceExpr="Phase 2 Company" }

    { 1210190035;2;Field  ;
                SourceExpr="Phase 3 Company" }

    { 1210190037;2;Field  ;
                SourceExpr="Make SharePoint Site";
                Importance=Promoted }

    { 1210190039;2;Field  ;
                SourceExpr="SharePoint Site Generated";
                Importance=Promoted;
                Editable=FALSE }

    { 1210190040;2;Field  ;
                SourceExpr="SharePoint Site URL";
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               IF "SharePoint Site URL" <> '' THEN
                                 HYPERLINK("SharePoint Site URL");
                             END;
                              }

    { 1100528308;2;Field  ;
                SourceExpr="Quote Subsite Generated";
                Importance=Promoted }

    { 1210190044;2;Field  ;
                SourceExpr="Save Int. Doc In SharePoint" }

    { 1100525013;0;Container;
                ContainerType=FactBoxArea }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100528400;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130124;
                PartType=Page }

    { 1100525011;1;Part   ;
                SubPageLink=Project No.=FIELD(No.);
                PagePartID=Page11130001;
                PartType=Page }

    { 1100528401;1;Part   ;
                SubPageLink=Project No.=FIELD(No.),
                            Principal=FIELD(Bill-to Customer No.);
                PagePartID=Page11130239;
                PartType=Page }

    { 1100528600;1;Part   ;
                AccessByPermission=Page 11130542=X;
                CaptionML=ENU=Service Orders;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130241;
                PartType=Page }

  }
  CODE
  {
    VAR
      Text11012000@11012008 : TextConst 'ENU=For this Project are no Sub Projects present';
      ProjSetUp@1210190002 : Record 315;
      InventSetupRec@1100485011 : Record 313;
      ProjPrincipRec@11012002 : Record 11012005;
      ProjRec@11012004 : Record 11072003;
      RentalUnitRec@1210190004 : Record 11012940;
      ProjInstalmRec@1210190020 : Record 11012018;
      GenerateProjInstallm@1210190025 : Codeunit 11012007;
      PrintDoc@1210190027 : Codeunit 229;
      Text11012003@1100485000 : TextConst 'ENU=Field SharePoint Project Phase is empty.';
      AdrsRec@1100485001 : Record 222;
      NumAdrs@1100485002 : Text[30];
      Text11012006@1100485009 : TextConst 'ENU=A Sharepoint Site is alread made';
      SharepointCU@1100485010 : Codeunit 11020210;
      SharepSetup@1100485006 : Record 11012730;
      DPA_IsHardFilter@1100000999 : Boolean;
      Text11012007@1210190000 : TextConst 'ENU=Add Settlement Sheet?';
      ProgressRegistryPTEEditable@19042199 : Boolean INDATASET;
      "Progress RegistryEditable"@19006260 : Boolean INDATASET;
      "Revision RuleEditable"@19048109 : Boolean INDATASET;
      "% LaborEditable"@19078728 : Boolean INDATASET;
      "% to B AccountEditable"@19001286 : Boolean INDATASET;
      CalculateBAmountsbasedonEditab@19056189 : Boolean INDATASET;
      "Affiliation No.Editable"@19034247 : Boolean INDATASET;
      "Main ProjectEditable"@19070977 : Boolean INDATASET;
      DropZoneContainerVisible@19006404 : Boolean INDATASET;
      MapPointVisible@19022708 : Boolean INDATASET;
      JobInventoryLocationShelfEnabl@19017758 : Boolean INDATASET;
      JobInventoryByStockReleaseEnab@19029955 : Boolean INDATASET;
      FromReference@1100528400 : Boolean;
      YardNo@1100528404 : Code[20];
      EntityType@1100528403 : Integer;
      SystemNo@1100528402 : Code[20];
      EntityNo@1100528401 : Code[20];
      Text11012008@1100409001 : TextConst 'ENU=%1 for %2 %3 not found.';

    PROCEDURE OptionBudget@1210190006();
    VAR
      lvOptionRec@1210190000 : Record 11012502;
    BEGIN
      //**4PS
      lvOptionRec.FILTERGROUP(9);
      lvOptionRec.SETRANGE("Project No.", "No.");
      lvOptionRec.FILTERGROUP(0);
      lvOptionRec.SETRANGE("Plot No.", '');

      PAGE.RUNMODAL(PAGE::"Option Budget", lvOptionRec);
    END;

    PROCEDURE Setfilter@1210190000(lProjCde@1210190000 : Code[20]);
    BEGIN
      //**4PS
      FILTERGROUP(2);
      SETRANGE("No.",lProjCde);
      FILTERGROUP(0);
    END;

    PROCEDURE GenerateSharePointSite@1100485002();
    BEGIN
      SharepointCU.GenerateSharePointSite(Rec);
    END;

    PROCEDURE ShowComments@1100525000();
    BEGIN
      CurrPage.AssemblyObjects.PAGE.ShowComments;
    END;

    LOCAL PROCEDURE ProjectTypeOnAfterValidate@19063423();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SingleMainSubProjectOnAfterVal@19021142();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE SettlementMethodOnAfterValidat@19029111();
    BEGIN
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ContractTypeOnAfterValidate@19077313();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
      IF "Contract Type" = "Contract Type"::Maincontracting THEN BEGIN
        "% Labor" := 0;
        "% to B Account" := 0;
        "Affiliation No." := '';
      END;
    END;

    LOCAL PROCEDURE MechanicC1100526110OnAfterVali@19003368();
    BEGIN
      //**4PS
      CALCFIELDS("Name Mechanic");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE ProjectManagerC1100526112OnAft@19066286();
    BEGIN
      //**4PS
      CALCFIELDS("Name Project Manager");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE SiteManagerOnAfterValidate@19074057();
    BEGIN
      //**4PS
      CALCFIELDS("Name Site Manager");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE EstimatorOnAfterValidate@19077849();
    BEGIN
      //**4PS
      CALCFIELDS("Name Estimator");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE ProjectManagerC1210190175OnAft@19059278();
    BEGIN
      //**4PS
      CALCFIELDS("Name Project Manager");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE ProjectEngineerOnAfterValidate@19046031();
    BEGIN
      //**4PS
      CALCFIELDS("Name Project Engineer");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE BuyercontactOnAfterValidate@19022691();
    BEGIN
      //**4PS
      CALCFIELDS("Name Buyer Contact");
    END;

    LOCAL PROCEDURE ExpediterOnAfterValidate@19017853();
    BEGIN
      //**4PS
      CALCFIELDS("Name Expediter");
    END;

    LOCAL PROCEDURE AdviserOnAfterValidate@19071762();
    BEGIN
      //**4PS
      CALCFIELDS("Name Adviser");
    END;

    LOCAL PROCEDURE MechanicC1100526105OnAfterVali@19076409();
    BEGIN
      //**4PS
      CALCFIELDS("Name Mechanic");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE ProgressonbaseofTenderOnAfterV@19067467();
    BEGIN
      //**4PS.sn
      "Progress RegistryEditable" := NOT "Progress on base of Tender";
      ProgressRegistryPTEEditable := "Progress on base of Tender";
      //**4PS.en
    END;

    LOCAL PROCEDURE RevisionOnAfterValidate@19054813();
    BEGIN
      "Revision RuleEditable" := Revision;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      RecRef@1100528700 : RecordRef;
    BEGIN
      xRec := Rec;
      NumAdrs := AdrsRec.CheckAvailableAddress("Bill-to Customer No.", 2);  //db, 21-12-06

      "% LaborEditable" := "Contract Type" = "Contract Type"::Subcontracting;
      "% to B AccountEditable" := "Contract Type" = "Contract Type"::Subcontracting;
      CalculateBAmountsbasedonEditab := "Contract Type" = "Contract Type"::Subcontracting;
      "Affiliation No.Editable" := "Contract Type" = "Contract Type"::Subcontracting;
      "Main ProjectEditable" := "Single/Main/Sub Project" = "Single/Main/Sub Project"::"Sub Project";
      "Revision RuleEditable" := Revision;

      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(FALSE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");
    END;

    LOCAL PROCEDURE AdviserOnAfterInput@19037857(VAR Text@19037858 : Text[1024]);
    BEGIN
      //**4PS
      CALCFIELDS("Name Adviser");
    END;

    LOCAL PROCEDURE SupervisorOnBeforeInput@19058930();
    BEGIN
      //**4PS
      CALCFIELDS(Prospect);
    END;

    LOCAL PROCEDURE TechnicalFinishedDateOnBeforeI@19050996();
    BEGIN
      //**4PS
      //CurrPage."Technical Finished Date".UPDATEEDITABLE(
      //  ("Project Status" = "Project Status"::"Technical Finished") OR
      //  ("Project Status" = "Project Status"::"Administrative Finished"));
    END;

    PROCEDURE InitSelectionFromReference@1100528400(YardNo2@1100528400 : Code[20];EntityType2@1100528401 : Integer;SystemNo2@1100528402 : Code[20];EntityNo2@1100528403 : Code[20]);
    BEGIN
      FromReference := TRUE;
      YardNo := YardNo2;
      EntityType := EntityType2;
      SystemNo := SystemNo2;
      EntityNo := EntityNo2;
    END;

    BEGIN
    {
      4PS01 MMA 20100510
        Menuoption added Runobject Form 11124841 Material Monitor
    }
    END.
  }
}

