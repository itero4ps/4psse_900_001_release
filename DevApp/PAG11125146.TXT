OBJECT Page 11125146 Service Contract Card
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS9.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Service Contract;
    SourceTable=Table11012812;
    PopulateAllFields=Yes;
    PageType=Document;
    PromotedActionCategoriesML=ENU=New,Process,Report,Contract,Mail Documents;
    OnInit=BEGIN
             "Invoice IntervalEditable" := TRUE;
             "Contract DurationEditable" := TRUE;
             InstallmentBasedOnEditable := TRUE;
             FillShowMandatoryVariables;
           END;

    OnOpenPage=BEGIN
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
               END;

    OnAfterGetRecord=BEGIN
                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  UseServiceContractTemplate;
                  DPA_SetDefaultDepartment;
                  OnAfterGetCurrRecord;
                END;

    OnInsertRecord=VAR
                     ObjectMgt@1100525000 : Codeunit 11012808;
                     xRecRef@1210190001 : RecordRef;
                   BEGIN
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);

                     ObjectMgt.FillDefaultContractData(Rec);
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525063;1 ;ActionGroup;
                      CaptionML=ENU=Contract }
      { 1100526200;2 ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Service and Maintenance &Ledger Entry;
                      RunObject=Page 11012826;
                      RunPageView=SORTING(Service Contract No.,Installment No.);
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=GLRegisters }
      { 1100525073;2 ;Action    ;
                      CaptionML=ENU=Cost and Revenue;
                      RunObject=Page 11125148;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category4 }
      { 1100409002;2 ;Action    ;
                      AccessByPermission=Page 11012754=X;
                      CaptionML=ENU=&Features;
                      Image=QualificationOverview;
                      OnAction=BEGIN
                                 ShowFeatures;
                               END;
                                }
      { 1100525065;2 ;Action    ;
                      CaptionML=ENU=Comments;
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Service Contract),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1100525012;2 ;ActionGroup;
                      CaptionML=ENU=Budget;
                      Image=LedgerBudget }
      { 1100528601;3 ;Action    ;
                      CaptionML=ENU=Budget (Calls);
                      RunObject=Page 11126294;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=LedgerBudget }
      { 1100526201;3 ;Action    ;
                      CaptionML=ENU=Budget (Calls) Release;
                      RunObject=Page 11125192;
                      RunPageLink=Type=CONST(Contract),
                                  Code=FIELD(No.);
                      Image=ActivateDiscounts }
      { 1100528624;3 ;Action    ;
                      CaptionML=ENU=Budget (Category);
                      RunObject=Page 11229351;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=LedgerBudget }
      { 1100528607;2 ;ActionGroup;
                      CaptionML=ENU=Cost Prices;
                      Image=AdjustItemCost }
      { 1100528663;3 ;Action    ;
                      CaptionML=ENU=Service Contract - Employee Cost Prices;
                      RunObject=Page 11020663;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 1100528669;3 ;Action    ;
                      CaptionML=ENU=Service Contract- Trade Association Cost Prices;
                      RunObject=Page 11020664;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 1100528670;3 ;Action    ;
                      CaptionML=ENU=Service Contract - Cost Object Cost Prices;
                      RunObject=Page 11020665;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 1100528671;3 ;Action    ;
                      CaptionML=ENU=Service Contract - Trade Association - Wage Component Cost Prices;
                      RunObject=Page 11020666;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=AdjustItemCost }
      { 1210190000;2 ;ActionGroup;
                      CaptionML=ENU=Sales Prices;
                      Image=SalesPrices }
      { 1210190001;3 ;Action    ;
                      CaptionML=ENU=Service Contract - Employee Sales Prices;
                      RunObject=Page 11020393;
                      RunPageLink=Field10=FIELD(No.);
                      Image=SalesPrices }
      { 1210190002;3 ;Action    ;
                      CaptionML=ENU=Service Contract - Employee - Cost Object Sales Prices;
                      RunObject=Page 11072537;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=SalesPrices }
      { 1210190003;3 ;Action    ;
                      CaptionML=ENU=Service Contract - Employee - Cost Object - Wage Comp. Sales Prices;
                      RunObject=Page 11072538;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=SalesPrices }
      { 1210190004;3 ;Action    ;
                      CaptionML=ENU=Service Contract - Cost Object Sales Prices;
                      RunObject=Page 11020688;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=SalesPrices }
      { 1210190005;3 ;Action    ;
                      CaptionML=ENU=Service Contract - Cost Object - Wage Component Sales Prices;
                      RunObject=Page 11020695;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=SalesPrices }
      { 1210190006;3 ;Action    ;
                      CaptionML=ENU=Service Contract - Hour Rate Code Sales Prices;
                      RunObject=Page 11012875;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=SalesPrices }
      { 1100525014;2 ;ActionGroup;
                      CaptionML=ENU=Invoicing;
                      Image=CreateJobSalesInvoice }
      { 1100528627;3 ;Action    ;
                      CaptionML=ENU=Service Sales Discount;
                      RunObject=Page 11229405;
                      RunPageLink=Type=CONST(Contract),
                                  Code=FIELD(No.);
                      Image=LineDiscount }
      { 1100528657;3 ;Action    ;
                      CaptionML=ENU=Contract Discount;
                      RunObject=Page 11012836;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=Discount }
      { 1100528648;3 ;Action    ;
                      CaptionML=ENU=Extra Cost;
                      RunObject=Page 11125104;
                      RunPageLink=Entity Type=CONST(Service Contract),
                                  Entity Code=FIELD(No.);
                      Promoted=Yes;
                      Image=ChangePaymentTolerance;
                      PromotedCategory=Category4 }
      { 1100525025;3 ;Action    ;
                      CaptionML=ENU=VAT Breakdown;
                      RunObject=Page 11132114;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=VATLedger }
      { 1100525018;3 ;Action    ;
                      AccessByPermission=Page 143=X;
                      CaptionML=ENU=Invoices;
                      Image=Invoice;
                      OnAction=BEGIN
                                 ShowSCInvoices;
                               END;
                                }
      { 1100525022;3 ;Action    ;
                      AccessByPermission=Page 144=X;
                      CaptionML=ENU=Credit Memos;
                      Image=CreditMemo;
                      OnAction=BEGIN
                                 ShowSCCreditMemos;
                               END;
                                }
      { 1100528802;3 ;Action    ;
                      AccessByPermission=Page 11126474=X;
                      CaptionML=ENU=Consumption Rates;
                      Image=SalesPrices;
                      OnAction=VAR
                                 ConsumptionRate@1100528800 : Record 11071970;
                                 ConsumptionRates@1100528801 : Page 11126474;
                               BEGIN
                                 TESTFIELD("No.");
                                 ConsumptionRate.FILTERGROUP(9);
                                 ConsumptionRate.SETRANGE("Service Contract Group", '');
                                 ConsumptionRate.FILTERGROUP(0);
                                 ConsumptionRate.SETRANGE("Service Contract", "No.");
                                 ConsumptionRates.SETTABLEVIEW(ConsumptionRate);
                                 ConsumptionRate."Service Contract" := "No.";
                                 ConsumptionRates.SETRECORD(ConsumptionRate);
                                 ConsumptionRates.SetCalledFromPage(11125146);
                                 ConsumptionRates.RUNMODAL;
                               END;
                                }
      { 1100528611;2 ;ActionGroup;
                      CaptionML=ENU=Pro&gnosis;
                      Image=CalculateRemainingUsage }
      { 1100528612;3 ;Action    ;
                      AccessByPermission=Page 11020698=X;
                      CaptionML=ENU=Prognosis Extra Hours;
                      OnAction=VAR
                                 WorkloadServiceContract@1100528600 : Page 11020698;
                               BEGIN
                                 WorkloadServiceContract.SetContractFilter(Rec);
                                 WorkloadServiceContract.RUNMODAL;
                               END;
                                }
      { 1100528655;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=&Dimensions;
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(11012812),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 1100525016;2 ;Action    ;
                      CaptionML=ENU=Subcontractors;
                      RunObject=Page 11126097;
                      RunPageLink=Service Contract No.=FIELD(No.),
                                  Complex Code=CONST(),
                                  Service Location No.=CONST(),
                                  Object No.=CONST(),
                                  Maintenance Scheme Code=CONST();
                      Image=SubcontractingWorksheet }
      { 1100528000;2 ;Action    ;
                      CaptionML=ENU=&Contacts;
                      RunObject=Page 11012874;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=ContactPerson;
                      PromotedCategory=Process }
      { 1100528662;2 ;Action    ;
                      CaptionML=ENU=Service Surcharges;
                      RunObject=Page 11125205;
                      RunPageView=WHERE(Type=CONST(Contract));
                      RunPageLink=Code=FIELD(No.);
                      Promoted=No;
                      Image=PayrollStatistics }
      { 1100409001;2 ;Action    ;
                      CaptionML=ENU=Surcharges;
                      RunObject=Page 11072426;
                      RunPageLink=Record Type=CONST(ServContr),
                                  Customer No.=FILTER(''),
                                  Code=FIELD(No.);
                      Image=InsertStartingFee }
      { 1210190015;2 ;Action    ;
                      CaptionML=ENU=Source E-Mail;
                      RunObject=Page 11125179;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=MailSetup }
      { 1100528689;2 ;Action    ;
                      CaptionML=ENU=Source Type Setup;
                      RunObject=Page 11126099;
                      RunPageLink=Type=CONST(Contract),
                                  Code=FIELD(No.);
                      Image=JobListSetup }
      { 1100528618;2 ;Action    ;
                      CaptionML=ENU=Clusters;
                      RunObject=Page 11125246;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Promoted=Yes;
                      Image=ServiceItemWorksheet;
                      PromotedCategory=Category4 }
      { 1100526228;2 ;Action    ;
                      CaptionML=ENU=Contract &Terms;
                      RunObject=Page 11125206;
                      RunPageLink=Table Name=CONST(Service Contract),
                                  No.=FIELD(No.),
                                  Table Field=CONST(0);
                      Promoted=Yes;
                      Image=SNInfo;
                      PromotedCategory=Category4 }
      { 1100525028;2 ;Action    ;
                      CaptionML=ENU=Invoice Agreements;
                      RunObject=Page 11125206;
                      RunPageLink=Table Name=CONST(Service Contract),
                                  No.=FIELD(No.),
                                  Table Field=CONST(630);
                      Image=SNInfo }
      { 1100525066;2 ;Action    ;
                      CaptionML=ENU=Priorities;
                      RunObject=Page 11020685;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=SetPriorities }
      { 1100528656;2 ;Action    ;
                      CaptionML=ENU=Reference &Norms;
                      RunObject=Page 11072539;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=CalculatePlan }
      { 1100528688;2 ;Action    ;
                      CaptionML=ENU=&Documents;
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowDocuments;
                               END;
                                }
      { 1210190018;2 ;Action    ;
                      CaptionML=ENU=Installments;
                      RunObject=Page 11125152;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AmountByPeriod;
                      PromotedCategory=Category4 }
      { 1210190017;2 ;Action    ;
                      CaptionML=ENU=Maintenance;
                      RunObject=Page 11125151;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=MaintenanceRegistrations;
                      PromotedCategory=Category4 }
      { 1100525070;2 ;Action    ;
                      AccessByPermission=Page 11125174=X;
                      CaptionML=ENU=All Contract Arrangements;
                      Promoted=Yes;
                      Image=CalculatePlan;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowAllContractArrangements;
                               END;
                                }
      { 1100528617;2 ;Action    ;
                      CaptionML=ENU=Service/Maint. Agreements;
                      RunObject=Page 11126460;
                      RunPageView=SORTING(Type,Code,Line No.)
                                  WHERE(Type=CONST(Contract));
                      RunPageLink=Code=FIELD(No.);
                      Promoted=Yes;
                      Image=CalculatePlan;
                      PromotedCategory=Category4 }
      { 1100525026;2 ;Action    ;
                      Name=Maintenance Plan Matrix;
                      AccessByPermission=Page 11229439=X;
                      CaptionML=ENU=Maintenance Plan Matrix;
                      Image=ShowMatrix;
                      OnAction=VAR
                                 MaintenancePlanMatrixPAGE@1100525000 : Page 11229439;
                               BEGIN
                                 MaintenancePlanMatrixPAGE.SetInitialFilterValues("No.", "Customer No.", "Contract Manager", "Contract Group");
                                 MaintenancePlanMatrixPAGE.RUNMODAL;
                               END;
                                }
      { 1100528803;2 ;Action    ;
                      CaptionML=ENU=Risks & Opportunities;
                      RunObject=Page 11126567;
                      RunPageLink=Source=CONST(Service Contract),
                                  Source Code=FIELD(No.);
                      Promoted=Yes;
                      Image=OpportunitiesList;
                      PromotedCategory=Category4 }
      { 1100525056;1 ;ActionGroup;
                      CaptionML=ENU=Control }
      { 1100528629;2 ;Action    ;
                      CaptionML=ENU=Revenue Division;
                      RunObject=Page 11229332;
                      RunPageLink=Service Contract No.=FIELD(No.);
                      Image=SplitChecks }
      { 1100525058;2 ;Action    ;
                      CaptionML=ENU=Department;
                      Image=PayrollStatistics;
                      OnAction=BEGIN
                                 ServiceContractInfoMngmnt.ShowGlobalDim1Control("Global Dimension 1 Code");
                               END;
                                }
      { 1100525060;2 ;Action    ;
                      CaptionML=ENU=Contract Group;
                      Image=PayrollStatistics;
                      OnAction=BEGIN
                                 ServiceContractInfoMngmnt.ShowContractGroupControl("Contract Group");
                               END;
                                }
      { 1100525061;2 ;Action    ;
                      CaptionML=ENU=Customer;
                      Image=PayrollStatistics;
                      OnAction=BEGIN
                                 ServiceContractInfoMngmnt.ShowCustomerContractControl("Customer No.");
                               END;
                                }
      { 1100528613;2 ;Action    ;
                      AccessByPermission=Page 11126453=X;
                      CaptionML=ENU=Budget Progress Diagram;
                      Image=AnalysisView;
                      OnAction=VAR
                                 SCActualStatusBarChart@1100528600 : Page 11126453;
                               BEGIN
                                 SCActualStatusBarChart.SetContractFilter("No.");
                                 SCActualStatusBarChart.RUNMODAL;
                               END;
                                }
      { 1100528616;2 ;Action    ;
                      AccessByPermission=Page 11126454=X;
                      CaptionML=ENU=Budget vs. Actual Diagram;
                      Image=AnalysisView;
                      OnAction=VAR
                                 SCBudgetActualBarChart@1100528600 : Page 11126454;
                               BEGIN
                                 SCBudgetActualBarChart.SetContractFilter("No.");
                                 SCBudgetActualBarChart.RUNMODAL;
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100525080;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1100526218;2 ;Action    ;
                      AccessByPermission=Report 11012862=X;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Invoice Proposal;
                      Promoted=Yes;
                      Image=CreateJobSalesInvoice;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lvCreateInvProposalRep@1100526201 : Report 11012862;
                                 lvServContractRec@1100526200 : Record 11012812;
                               BEGIN
                                 lvServContractRec.SETRANGE("No.","No.");
                                 lvCreateInvProposalRep.SETTABLEVIEW(lvServContractRec);
                                 lvCreateInvProposalRep.RUNMODAL;
                               END;
                                }
      { 1100528800;2 ;Action    ;
                      AccessByPermission=Report 11012789=X;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Final Invoice Proposal;
                      Promoted=Yes;
                      Image=CreateJobSalesInvoice;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lvCreateFinalInvProposalRep@1100528800 : Report 11012789;
                                 lvServContractRec@1100528801 : Record 11012812;
                               BEGIN
                                 lvServContractRec.SETRANGE("No.","No.");
                                 lvCreateFinalInvProposalRep.SETTABLEVIEW(lvServContractRec);
                                 lvCreateFinalInvProposalRep.RUNMODAL;
                               END;
                                }
      { 1100525082;2 ;Action    ;
                      AccessByPermission=Report 11012863=X;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Maintenance Proposal;
                      Promoted=Yes;
                      Image=MaintenanceRegistrations;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 lvServContractRec@1100525001 : Record 11012812;
                                 lvCreateMaintPropRep@1100525000 : Report 11012863;
                               BEGIN
                                 lvServContractRec.SETRANGE("No.","No.");
                                 lvCreateMaintPropRep.SETTABLEVIEW(lvServContractRec);
                                 lvCreateMaintPropRep.SetContractFilter("No.");
                                 lvCreateMaintPropRep.RUNMODAL;
                               END;
                                }
      { 1100525100;2 ;Action    ;
                      CaptionML=ENU=Build Contract Control;
                      Promoted=Yes;
                      Image=AddAction;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CreateServiceControl@1100528601 : Codeunit 11012845;
                                 ServiceContract@1100528602 : Record 11012812;
                               BEGIN
                                 ServiceContract := Rec;
                                 CreateServiceControl.CreateControlWithLog(ServiceContract, TODAY, TIME, TRUE);
                                 ServiceContract.CALCFIELDS("No. of Control Messages");
                                 IF ServiceContract."No. of Control Messages" = 0 THEN
                                   MESSAGE(Text001)
                                 ELSE
                                   MESSAGE(Text002);
                               END;
                                }
      { 1100525024;2 ;Action    ;
                      CaptionML=ENU=Overlap Conflicts;
                      Image=ShowWarning;
                      OnAction=VAR
                                 MaintenanceManagementCU@1100526200 : Codeunit 11012829;
                               BEGIN
                                 MaintenanceManagementCU.ShowContractObjOverlapConflict("No.", '');
                               END;
                                }
      { 1100528622;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Edit Word Documents;
                      Promoted=Yes;
                      Image=Word;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Contact@1100528600 : Record 5050;
                               BEGIN
                                 TESTFIELD("Customer No.");
                                 IF Contact.GetContactByCustomer("Customer No.", Contact, TRUE) THEN
                                   EditDocuments(Contact."No.", '', FALSE, '');
                               END;
                                }
      { 1100525010;1 ;ActionGroup;
                      CaptionML=ENU=Mail Documents;
                      ActionContainerType=NewDocumentItems }
      { 1100525027;2 ;Action    ;
                      CaptionML=ENU=Bill-to Customer (Contract);
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 Contact@1100525000 : Record 5050;
                                 Customer@1100525001 : Record 18;
                               BEGIN
                                 TESTFIELD("Bill-to Customer No. (Contr.)");
                                 IF Contact.GetContactByCustomer("Bill-to Customer No. (Contr.)", Contact, TRUE) THEN BEGIN
                                   Customer.GET("Bill-to Customer No. (Contr.)");
                                   EditDocuments(Contact."No.", '', TRUE, Customer."E-Mail");
                                 END;
                               END;
                                }
      { 1100528614;1 ;ActionGroup;
                      CaptionML=ENU=&Print }
      { 1100528615;2 ;Action    ;
                      CaptionML=ENU=Service Contract Reports;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 DocumentPrint@1100528600 : Codeunit 229;
                               BEGIN
                                 DocumentPrint.PrintServiceContract_Object(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100525000;1;Group  ;
                CaptionML=ENU=General }

    { 1100525001;2;Field  ;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;

                ShowMandatory=TRUE }

    { 1100525003;2;Field  ;
                SourceExpr=Description;
                ShowMandatory=TRUE }

    { 1100525005;2;Field  ;
                SourceExpr="Description 2";
                Importance=Additional;
                ShowMandatory=Description2Mandatory }

    { 1100525007;2;Field  ;
                SourceExpr="Customer No.";
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;

                ShowMandatory=TRUE }

    { 1100525009;2;Field  ;
                SourceExpr=Name;
                Importance=Additional }

    { 1100525011;2;Field  ;
                SourceExpr="Name 2";
                Importance=Additional }

    { 1100525013;2;Field  ;
                SourceExpr=Address;
                Importance=Additional }

    { 1100525015;2;Field  ;
                SourceExpr="Address 2";
                Importance=Additional }

    { 1100525017;2;Field  ;
                SourceExpr="Post Code";
                Importance=Additional }

    { 1100525019;2;Field  ;
                SourceExpr=City;
                Importance=Additional }

    { 1210190010;2;Field  ;
                SourceExpr="Contract Manager";
                OnValidate=BEGIN
                             ContractManagerOnAfterValidate;
                           END;

                ShowMandatory=ContractManagerMandatory }

    { 1210190009;2;Field  ;
                SourceExpr="Contract Manager Name";
                Importance=Additional;
                Editable=FALSE }

    { 1210190013;2;Field  ;
                SourceExpr="Contract Group";
                OnValidate=BEGIN
                             ContractGroupOnAfterValidate;
                           END;

                ShowMandatory=ContractGroupMandatory }

    { 1210190014;2;Field  ;
                SourceExpr="Contract Group Description";
                Importance=Additional }

    { 1100528676;2;Field  ;
                CaptionML=ENU=Subcontractor;
                SourceExpr=SubcontractorCode;
                Editable=FALSE;
                OnAssistEdit=VAR
                               SubcontractorService@1100528600 : Record 11071789;
                             BEGIN
                               SubcontractorService.AssistEditSubcontractors("No.", '', '', '');
                               CurrPage.UPDATE(TRUE);
                             END;
                              }

    { 1100528675;2;Field  ;
                CaptionML=ENU=Subcontractor Name;
                SourceExpr=SubcontractorName;
                Importance=Additional;
                Editable=FALSE }

    { 1100525021;2;Field  ;
                SourceExpr="Contact Name";
                Importance=Additional;
                OnLookup=BEGIN
                           CALCFIELDS("Contact No.");
                           ShowContact("Customer No.");
                         END;

                ShowMandatory=ContactNameMandatory }

    { 1100525037;2;Field  ;
                SourceExpr="Phone No.";
                ShowMandatory=PhoneNoMandatory }

    { 1100525020;2;Field  ;
                SourceExpr="Phone No. 2";
                Importance=Additional;
                ShowMandatory=PhoneNo2Mandatory }

    { 1100525069;2;Field  ;
                SourceExpr="Mobile Phone No.";
                ShowMandatory=MobilePhoneNoMandatory }

    { 1100525071;2;Field  ;
                SourceExpr="Fax No.";
                ShowMandatory=FaxNoMandatory }

    { 1100525039;2;Field  ;
                SourceExpr="E-Mail";
                ShowMandatory=EMailMandatory }

    { 1100525064;2;Field  ;
                Lookup=No;
                CaptionML=ENU=Preferred Employee;
                SourceExpr=PreferredEmployeeNo;
                Editable=FALSE;
                OnAssistEdit=VAR
                               PreferredEmployee@1100528600 : Record 11012843;
                             BEGIN
                               PreferredEmployee.AssistEditPreferredEmployee("No.", '', '', '', '');
                               CurrPage.UPDATE(FALSE);
                             END;
                              }

    { 1100528630;2;Field  ;
                CaptionML=ENU=Name Preferred Employee;
                SourceExpr=PreferredEmployeeName;
                Editable=FALSE }

    { 1100526206;2;Field  ;
                SourceExpr="Service Package";
                ShowMandatory=ServicePackageMandatory }

    { 1100525089;2;Field  ;
                SourceExpr=Status;
                Importance=Promoted }

    { 1210190008;2;Field  ;
                SourceExpr="Your Reference";
                ShowMandatory=YourReferenceMandatory }

    { 1100525097;2;Field  ;
                SourceExpr=Blocked }

    { 1100525084;1;Part   ;
                Name=Objects;
                CaptionML=ENU=Objects;
                SubPageLink=Service Contract No.=FIELD(No.);
                PagePartID=Page11125169;
                PartType=Page }

    { 1905289801;1;Group  ;
                CaptionML=ENU=Data }

    { 1100526216;2;Field  ;
                SourceExpr="Contract Limit";
                OnValidate=BEGIN
                             ContractLimitOnAfterValidate;
                           END;
                            }

    { 1100525041;2;Field  ;
                SourceExpr="Starting Date";
                Importance=Promoted;
                ShowMandatory=TRUE }

    { 1100525043;2;Field  ;
                SourceExpr="Contract Duration";
                Editable="Contract DurationEditable";
                ShowMandatory=ContractDurationMandatory }

    { 1100525045;2;Field  ;
                SourceExpr="Ending Date";
                Importance=Promoted;
                OnValidate=BEGIN
                             EndingDateOnAfterValidate;
                           END;

                ShowMandatory=EndingDateMandatory }

    { 1100525047;2;Field  ;
                SourceExpr="Termination Period";
                ShowMandatory=TerminationPeriodMandatory }

    { 1100525049;2;Field  ;
                SourceExpr="Termination Date";
                ShowMandatory=TerminationDateMandatory }

    { 1100525051;2;Field  ;
                SourceExpr="Expiring Date";
                ShowMandatory=ExpiringDateMandatory }

    { 1100528600;2;Field  ;
                CaptionML=ENU=Percentage Share Calls;
                SourceExpr=GetPercentageShareCalls(TODAY);
                OnLookup=BEGIN
                           ShowPercentageShareCalls;
                         END;
                          }

    { 1100526220;2;Field  ;
                SourceExpr="Starting Date Control Period";
                ShowMandatory=TRUE }

    { 1100528632;2;Field  ;
                SourceExpr="Control Period Interval";
                ShowMandatory=ControlPeriodIntervalMandatory }

    { 1100528639;2;Field  ;
                SourceExpr="Invoice Base Method";
                Importance=Additional;
                OnValidate=BEGIN
                             UpdateEditable;
                           END;
                            }

    { 1100528640;2;Field  ;
                SourceExpr="Invoice Base Hours";
                Importance=Additional;
                ShowMandatory=InvoiceBaseHoursMandatory }

    { 1100528642;2;Field  ;
                SourceExpr="Invoice Base Amount Labor";
                Importance=Additional;
                Editable=InvoiceBaseAmountLaborEditable;
                ShowMandatory=InvoiceBaseAmountLaborMandatory }

    { 1100528644;2;Field  ;
                SourceExpr="Invoice Base Amount Material";
                Importance=Additional;
                Editable=InvoiceBaseAmountMaterialEdit;
                ShowMandatory=InvoiceBaseAmountMaterialMandatory }

    { 1100528646;2;Field  ;
                SourceExpr="Invoice Base Amount Total";
                Importance=Additional;
                Editable=InvoiceBaseAmountTotalEditable;
                ShowMandatory=InvoiceBaseAmountTotalMandatory }

    { 1100525030;2;Field  ;
                SourceExpr="Limit Budget Hours";
                Importance=Additional;
                ShowMandatory=LimitBudgetHoursMandatory }

    { 1100525031;2;Field  ;
                SourceExpr="Limit Budget Labor";
                Importance=Additional;
                ShowMandatory=LimitBudgetLaborMandatory }

    { 1100525032;2;Field  ;
                SourceExpr="Limit Budget Material";
                Importance=Additional;
                ShowMandatory=LimitBudgetMaterialMandatory }

    { 1100525033;2;Field  ;
                SourceExpr="Limit Budget Total";
                Importance=Additional;
                ShowMandatory=LimitBudgetTotalMandatory }

    { 1100528602;2;Field  ;
                SourceExpr="Plan Method" }

    { 1100409003;2;Field  ;
                SourceExpr="Contract Type";
                ShowMandatory=ContractTypeMandatory }

    { 1100528628;2;Field  ;
                SourceExpr="Last Index Date" }

    { 1210190019;1;Group  ;
                CaptionML=ENU=Invoice To;
                GroupType=Group }

    { 1100528651;2;Group  ;
                CaptionML=ENU=Cost Plus;
                GroupType=Group }

    { 1210190026;3;Field  ;
                SourceExpr="Bill-to Customer No. (CP)";
                Importance=Promoted;
                ShowMandatory=BilltoCustomerNoMandatory }

    { 1210190027;3;Field  ;
                SourceExpr="Alt. Bill-to Address (CP)";
                ShowMandatory=AlternativeBilltoAddressMandatory }

    { 1100409004;3;Field  ;
                SourceExpr="Derived from Cust. No. (CP)" }

    { 1210190025;3;Field  ;
                SourceExpr="Bill-to Name (Cost Plus)";
                Importance=Additional }

    { 1210190024;3;Field  ;
                SourceExpr="Bill-to Name 2 (Cost Plus)";
                Importance=Additional }

    { 1210190023;3;Field  ;
                SourceExpr="Bill-to Address (Cost Plus)";
                Importance=Additional }

    { 1210190022;3;Field  ;
                SourceExpr="Bill-to Address 2 (Cost Plus)";
                Importance=Additional }

    { 1210190021;3;Field  ;
                SourceExpr="Bill-to Post Code (Cost Plus)";
                Importance=Additional }

    { 1210190020;3;Field  ;
                SourceExpr="Bill-to City (Cost Plus)";
                Importance=Additional }

    { 1210190028;3;Field  ;
                SourceExpr="Use Bill-to as Sell-to (CP)" }

    { 1100528650;2;Group  ;
                CaptionML=ENU=Contract;
                GroupType=Group }

    { 1100528649;3;Field  ;
                SourceExpr="Bill-to Customer No. (Contr.)";
                Importance=Promoted;
                ShowMandatory=BilltoCustomerNoContractMandatory }

    { 1100528647;3;Field  ;
                SourceExpr="Alt. Bill-to Address (Contr.)";
                ShowMandatory=AlternativeBilltoAddressContractMandatory }

    { 1100528645;3;Field  ;
                SourceExpr="Derived from Cust. No. (Contr)" }

    { 1100528643;3;Field  ;
                SourceExpr="Bill-to Name (Contract)";
                Importance=Additional }

    { 1100528641;3;Field  ;
                SourceExpr="Bill-to Name 2 (Contract)";
                Importance=Additional }

    { 1100528638;3;Field  ;
                SourceExpr="Bill-to Address (Contract)";
                Importance=Additional }

    { 1100528637;3;Field  ;
                SourceExpr="Bill-to Address 2 (Contract)";
                Importance=Additional }

    { 1100528636;3;Field  ;
                SourceExpr="Bill-to Post Code (Contract)";
                Importance=Additional }

    { 1100528635;3;Field  ;
                SourceExpr="Bill-to City (Contract)";
                Importance=Additional }

    { 1100528634;3;Field  ;
                SourceExpr="Use Bill-to as Sell-to (Contr)" }

    { 1905885101;1;Group  ;
                CaptionML=ENU=Invoicing }

    { 1100525076;2;Field  ;
                CaptionML=ENU=Collect Invoice By;
                SourceExpr="Collect Installment Invoice By" }

    { 1210190016;2;Field  ;
                CaptionML=ENU=Transaction Mode Contract Invoicing;
                SourceExpr="Transaction Mode Installments";
                ShowMandatory=TransactionModeInstallmentsMandatory }

    { 1100526208;2;Field  ;
                SourceExpr="Invoice Type";
                Importance=Promoted;
                OnValidate=BEGIN
                             InvoiceTypeOnAfterValidate;
                             CheckAndResetInstallmBasedOn;
                           END;
                            }

    { 1100525023;2;Field  ;
                SourceExpr="Dynamic Invoice Type" }

    { 1100528400;2;Field  ;
                SourceExpr="Compress Dyn. Inv. Prop. Lines" }

    { 1100528909;2;Field  ;
                SourceExpr="Installment Type";
                Editable=InstallmentTypeEditable }

    { 1100525074;2;Field  ;
                CaptionML=ENU=Invoice Installment;
                SourceExpr="Invoice Period";
                OnValidate=BEGIN
                             CheckAndResetInstallmBasedOn;
                           END;
                            }

    { 1100528603;2;Field  ;
                SourceExpr="Invoicing via Collective List";
                OnValidate=BEGIN
                             UpdateEditable;
                           END;
                            }

    { 1100528300;2;Field  ;
                SourceExpr="Installments based on Progress";
                Editable=InstallmentBasedOnEditable }

    { 1100528610;2;Field  ;
                SourceExpr="Invoice Interval";
                Editable="Invoice IntervalEditable";
                OnValidate=BEGIN
                             InvoiceIntervalOnAfterValidate;
                           END;

                ShowMandatory=InvoiceIntervalMandatory }

    { 1100528604;2;Field  ;
                SourceExpr="Invoice Postpone Period";
                Editable=PostponeInvoicePeriodEditable;
                ShowMandatory=InvoicePostponePeriodMandatory }

    { 1100528626;2;Field  ;
                SourceExpr="Invoiced Until";
                ShowMandatory=InvoicedUntilMandatory }

    { 1100525006;2;Field  ;
                SourceExpr="Currency Code";
                ShowMandatory=CurrencyCodeMandatory }

    { 1100526214;2;Field  ;
                Name=ContrAmnt;
                CaptionML=ENU=Contract Amount;
                SourceExpr=gvMaintManCU.GetContractAmntByDate(Rec,TODAY);
                OnLookup=VAR
                           lvInstallmAmntsByDateFrm@1100526201 : Page 11125153;
                           lvInstallmAmntsByDateRec@1100526200 : Record 11071708;
                         BEGIN
                           //TESTFIELD("Invoice Type", "Invoice Type"::Dynamic);
                           CLEAR(lvInstallmAmntsByDateFrm);
                           lvInstallmAmntsByDateRec.SETRANGE(Type,lvInstallmAmntsByDateRec.Type::"Service Contract");
                           lvInstallmAmntsByDateRec.SETRANGE("Service Contract No.","No.");
                           lvInstallmAmntsByDateRec.SETRANGE("Service Object No.", '');
                           lvInstallmAmntsByDateFrm.SETTABLEVIEW(lvInstallmAmntsByDateRec);
                           lvInstallmAmntsByDateFrm.RUNMODAL;
                           CurrPage.UPDATE;
                         END;
                          }

    { 1100525004;2;Field  ;
                Name=ContrAmntLCY;
                CaptionML=ENU=Contract Amount (LCY);
                SourceExpr=gvMaintManCU.GetContractAmntLCYByDate(Rec,TODAY);
                Importance=Promoted;
                OnLookup=VAR
                           lvInstallmAmntsByDateFrm@1100526201 : Page 11125153;
                           lvInstallmAmntsByDateRec@1100526200 : Record 11071708;
                         BEGIN
                           //TESTFIELD("Invoice Type", "Invoice Type"::Dynamic);
                           CLEAR(lvInstallmAmntsByDateFrm);
                           lvInstallmAmntsByDateRec.SETRANGE(Type,lvInstallmAmntsByDateRec.Type::"Service Contract");
                           lvInstallmAmntsByDateRec.SETRANGE("Service Contract No.","No.");
                           lvInstallmAmntsByDateRec.SETRANGE("Service Object No.", '');
                           lvInstallmAmntsByDateFrm.SETTABLEVIEW(lvInstallmAmntsByDateRec);
                           lvInstallmAmntsByDateFrm.RUNMODAL;
                           CurrPage.UPDATE;
                         END;
                          }

    { 1100526219;2;Field  ;
                SourceExpr="Service Type";
                ShowMandatory=TRUE }

    { 1100528605;2;Field  ;
                SourceExpr="Service Type (Other)";
                ShowMandatory=ServiceTypeOtherMandatory }

    { 1100526202;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                Importance=Promoted;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;

                ShowMandatory=GlobalDimension1CodeMandatory }

    { 1100528608;2;Field  ;
                SourceExpr="Department Code (Other)";
                OnValidate=VAR
                             DPA_IsHardFilter2@1210190000 : Boolean;
                             DPA_ServiceContract@1210190001 : Record 11012812;
                           BEGIN
                             //**4PS.sn DPA
                             DPA_IsHardFilter2 := DPA_ServiceContract.DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                             DPA_ServiceContract."Global Dimension 1 Code" := "Department Code (Other)";
                             DPA_ServiceContract.DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter2);
                             //**4PS.en DPA
                           END;

                ShowMandatory=DepartmentCodeOtherMandatory }

    { 1100525078;2;Field  ;
                SourceExpr="Payment Terms Code";
                ShowMandatory=PaymentTermsCodeMandatory }

    { 1100525079;2;Field  ;
                SourceExpr="VAT Prod. Posting Group";
                ShowMandatory=VATProdPostingGroupMandatory }

    { 1100526230;2;Field  ;
                SourceExpr="% Labor";
                Editable=PercLaborEditable;
                ShowMandatory=LaborMandatory }

    { 1100526229;2;Field  ;
                SourceExpr="% to B Account";
                Enabled=PerctoBAccountEditable;
                ShowMandatory=ToBAccountMandatory }

    { 1100525052;2;Field  ;
                SourceExpr="Invoice Period (Coll. List)";
                ShowMandatory=InvoicePeriodCollListMandatory }

    { 1100525054;2;Field  ;
                SourceExpr="Min. Inv. Amount (Coll. List)";
                ShowMandatory=MinInvAmountCollListMandatory }

    { 1100528621;2;Field  ;
                SourceExpr="Payment Method Code (Con.Inv.)";
                ShowMandatory=PaymentMethodCodeConInvMandatory }

    { 1100528500;2;Field  ;
                SourceExpr="Direct Debit Mandate ID";
                ShowMandatory=DirectDebitMandateIDMandatory }

    { 1904488201;1;Group  ;
                CaptionML=ENU=Surcharge/Discount }

    { 1100528678;2;Field  ;
                SourceExpr="Surcharge % Labor";
                Importance=Promoted;
                ShowMandatory=SurchargeLaborMandatory }

    { 1100528680;2;Field  ;
                SourceExpr="Surcharge % Material";
                Importance=Promoted;
                ShowMandatory=SurchargeMaterialMandatory }

    { 1100528682;2;Field  ;
                SourceExpr="Surcharge % Subcontr.";
                Importance=Promoted;
                ShowMandatory=SurchargeSubcontrMandatory }

    { 1100528684;2;Field  ;
                SourceExpr="Surcharge % Plant";
                Importance=Promoted;
                ShowMandatory=SurchargePlantMandatory }

    { 1100528686;2;Field  ;
                SourceExpr="Surcharge % Sundry";
                Importance=Promoted;
                ShowMandatory=SurchargeSundryMandatory }

    { 1100525050;2;Field  ;
                SourceExpr="Reference Date (Item)";
                ShowMandatory=ReferenceDateItemMandatory }

    { 1100525048;2;Field  ;
                SourceExpr="Reference Date (Customer)" }

    { 1100525046;2;Field  ;
                SourceExpr="Reference Date (Company)" }

    { 1100525083;2;Field  ;
                SourceExpr="Purch Discount Term Group 1";
                ShowMandatory=PurchDiscountTermGroup1Mandatory }

    { 1100525081;2;Field  ;
                SourceExpr="Purch Discount Term Group 2";
                ShowMandatory=PurchDiscountTermGroup2Mandatory }

    { 1100525087;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 0";
                ShowMandatory=PriorityPurchDiscTermGrp0Mandatory }

    { 1100525086;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 1";
                ShowMandatory=PriorityPurchDiscTermGrp1Mandatory }

    { 1100525085;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 2";
                ShowMandatory=PriorityPurchDiscTermGrp2Mandatory }

    { 1100525042;2;Field  ;
                SourceExpr="Sales Discount Term Group 1";
                ShowMandatory=SalesDiscountTermGroup1Mandatory }

    { 1100525040;2;Field  ;
                SourceExpr="Sales Discount Term Group 2";
                ShowMandatory=SalesDiscountTermGroup2Mandatory }

    { 1100525038;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 0";
                ShowMandatory=PrioritySalesDiscTermGrp0Mandatory }

    { 1100525036;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 1";
                ShowMandatory=PrioritySalesDiscTermGrp1Mandatory }

    { 1100525035;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 2";
                ShowMandatory=PrioritySalesDiscTermGrp2Mandatory }

    { 1902859001;1;Group  ;
                CaptionML=ENU=Text }

    { 1100528619;2;Field  ;
                CaptionML=ENU=Invoice Text;
                SourceExpr="Invoice Text Installments";
                Importance=Promoted;
                MultiLine=Yes;
                ShowMandatory=InvoiceTextInstallmentsMandatory }

    { 1903880701;1;Group  ;
                CaptionML=ENU=Other }

    { 1100525053;2;Field  ;
                SourceExpr="Modified by";
                Importance=Additional;
                ShowMandatory=ModifiedbyMandatory }

    { 1100525055;2;Field  ;
                SourceExpr="Last Date Modified";
                Importance=Additional;
                ShowMandatory=LastDateModifiedMandatory }

    { 1100525057;2;Field  ;
                SourceExpr="Input by";
                Importance=Additional;
                ShowMandatory=InputbyMandatory }

    { 1100525059;2;Field  ;
                SourceExpr="Input Date";
                Importance=Additional;
                ShowMandatory=InputDateMandatory }

    { 1100528658;2;Field  ;
                SourceExpr="Send Mail Status Update" }

    { 1100528660;2;Field  ;
                SourceExpr="Send Mail Work Sheet" }

    { 1100525008;2;Field  ;
                SourceExpr="Publish on Service Portal" }

    { 1100409000;2;Field  ;
                SourceExpr="Service Index Method";
                Importance=Promoted;
                ShowMandatory=ServiceIndexMethodMandatory }

    { 1100528623;2;Field  ;
                SourceExpr="Travel Cost Code";
                ShowMandatory=TravelCostCodeMandatory }

    { 1100528606;2;Field  ;
                SourceExpr="Contract Form" }

    { 1100525067;2;Field  ;
                SourceExpr="Use Contract Clusters";
                OnValidate=BEGIN
                             CurrPage.SAVERECORD;
                           END;
                            }

    { 1100525068;2;Field  ;
                SourceExpr=Cluster;
                ShowMandatory=ClusterMandatory }

    { 1100525044;2;Field  ;
                SourceExpr="Always Allow Cls Ord. (Maint.)" }

    { 1100525088;2;Field  ;
                SourceExpr="Always Allow Cls Ord. (Call)" }

    { 1100525090;2;Field  ;
                SourceExpr="Always Allow Cls Ord. (Ext.)" }

    { 1100528911;2;Field  ;
                SourceExpr="Progress % Calculation (Precl)" }

    { 1100528924;2;Field  ;
                CaptionML=ENU=Try-Out;
                SourceExpr=GetTryOut(1);
                OnDrillDown=BEGIN
                              ShowTryOut(1);
                            END;
                             }

    { 1100528625;2;Field  ;
                CaptionML=ENU=Try-Out Quote;
                SourceExpr=GetTryOut(2);
                OnDrillDown=BEGIN
                              ShowTryOut(2);
                            END;
                             }

    { 1100528925;2;Field  ;
                SourceExpr="Budget Based on";
                OnValidate=VAR
                             ServiceCategory@1100528600 : Record 11071985;
                           BEGIN
                           END;
                            }

    { 1100528927;2;Field  ;
                SourceExpr="Service Category (Calls)";
                ShowMandatory=ServiceCategoryCallsMandatory }

    { 1100528928;2;Field  ;
                SourceExpr="Service Category (Extension)";
                ShowMandatory=ServiceCategoryAddMandatory }

    { 1100525072;2;Field  ;
                SourceExpr="Control Build Date";
                ShowMandatory=ControlBuildDateMandatory }

    { 1100525075;2;Field  ;
                SourceExpr="Control Build Time";
                ShowMandatory=ControlBuildTimeMandatory }

    { 1100525077;2;Field  ;
                SourceExpr="No. of Control Messages" }

    { 1100528620;2;Field  ;
                SourceExpr="No. of Batch Logs";
                Importance=Additional }

    { 1100525091;2;Field  ;
                SourceExpr="Service Contract Folder";
                OnAssistEdit=BEGIN
                               AssistEditServContractFolder;
                             END;
                              }

    { 1100528609;2;Field  ;
                SourceExpr="Create Adv./Purch. Subc. Call" }

    { 1100528631;2;Field  ;
                SourceExpr="Create Adv./Purch. Subc. Con." }

    { 1100528633;2;Field  ;
                SourceExpr="Create Adv./Purch. Subc. Dir." }

    { 1100528661;2;Field  ;
                SourceExpr="Price Book Type";
                Importance=Additional }

    { 1100528659;2;Field  ;
                SourceExpr="Price Book Code";
                Importance=Additional }

    { 1100528654;2;Field  ;
                SourceExpr="Price Book Index Date";
                Importance=Additional }

    { 1100528653;2;Field  ;
                SourceExpr="Unit Price Set";
                Importance=Additional }

    { 1100528652;2;Field  ;
                SourceExpr="Unit Price Status";
                Importance=Additional }

    { 1210190007;0;Container;
                ContainerType=FactBoxArea }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190011;1;Part   ;
                CaptionML=ENU=Totals;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130477;
                PartType=Page }

    { 1100525002;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130482;
                PartType=Page }

    { 1100525062;1;Part   ;
                SubPageLink=No.=FIELD(Customer No.);
                PagePartID=Page11229206;
                PartType=Page }

    { 1100525029;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1100525034;1;Part   ;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      gvMaintManCU@1100526200 : Codeunit 11012828;
      Text001@1100528604 : TextConst 'ENU=Service-Contract Control Created';
      Text002@1100528605 : TextConst 'ENU=Service-Contract Control not Created, Errors Detected';
      ServiceContractInfoMngmnt@1100525006 : Codeunit 11012842;
      MaintenanceInvoiceMgt@1100528603 : Codeunit 11012828;
      SubcontractorCode@1100528601 : Code[20];
      SubcontractorName@1100528607 : Text[50];
      PreferredEmployeeNo@1100528602 : Code[20];
      PreferredEmployeeName@1100528606 : Text[50];
      DPA_IsHardFilter@1210190000 : Boolean;
      "Contract DurationEditable"@19003304 : Boolean INDATASET;
      "Invoice IntervalEditable"@19064923 : Boolean INDATASET;
      InvoiceBaseAmountLaborEditable@1100525000 : Boolean INDATASET;
      InvoiceBaseAmountMaterialEdit@1100525001 : Boolean INDATASET;
      InvoiceBaseAmountTotalEditable@1100525002 : Boolean INDATASET;
      PerctoBAccountEditable@1100525003 : Boolean INDATASET;
      PercLaborEditable@1100525004 : Boolean INDATASET;
      InstallmentBasedOnEditable@1100528300 : Boolean INDATASET;
      PostponeInvoicePeriodEditable@1100528608 : Boolean INDATASET;
      DiscountTermGroup0@1100525005 : Code[10];
      InstallmentTypeEditable@1100528600 : Boolean INDATASET;
      Description2Mandatory@1100528400 : Boolean;
      ContractManagerMandatory@1100528401 : Boolean;
      ContractGroupMandatory@1100528402 : Boolean;
      ContactNameMandatory@1100528403 : Boolean;
      PhoneNoMandatory@1100528404 : Boolean;
      PhoneNo2Mandatory@1100528405 : Boolean;
      MobilePhoneNoMandatory@1100528406 : Boolean;
      FaxNoMandatory@1100528407 : Boolean;
      EMailMandatory@1100528408 : Boolean;
      ServicePackageMandatory@1100528410 : Boolean;
      YourReferenceMandatory@1100528411 : Boolean;
      ContractDurationMandatory@1100528412 : Boolean;
      EndingDateMandatory@1100528413 : Boolean;
      TerminationPeriodMandatory@1100528414 : Boolean;
      TerminationDateMandatory@1100528415 : Boolean;
      ExpiringDateMandatory@1100528416 : Boolean;
      ControlPeriodIntervalMandatory@1100528417 : Boolean;
      InvoiceBaseHoursMandatory@1100528418 : Boolean;
      InvoiceBaseAmountLaborMandatory@1100528419 : Boolean;
      InvoiceBaseAmountMaterialMandatory@1100528420 : Boolean;
      InvoiceBaseAmountTotalMandatory@1100528421 : Boolean;
      LimitBudgetHoursMandatory@1100528422 : Boolean;
      LimitBudgetLaborMandatory@1100528423 : Boolean;
      LimitBudgetMaterialMandatory@1100528424 : Boolean;
      LimitBudgetTotalMandatory@1100528425 : Boolean;
      ContractTypeMandatory@1100528426 : Boolean;
      BilltoCustomerNoMandatory@1100528427 : Boolean;
      BilltoCustomerNoContractMandatory@1100528609 : Boolean;
      AlternativeBilltoAddressMandatory@1100528428 : Boolean;
      AlternativeBilltoAddressContractMandatory@1100528610 : Boolean;
      TransactionModeInstallmentsMandatory@1100528429 : Boolean;
      InvoiceIntervalMandatory@1100528430 : Boolean;
      InvoicePostponePeriodMandatory@1100528431 : Boolean;
      InvoicedUntilMandatory@1100528432 : Boolean;
      CurrencyCodeMandatory@1100528433 : Boolean;
      ServiceTypeOtherMandatory@1100528434 : Boolean;
      GlobalDimension1CodeMandatory@1100528435 : Boolean;
      DepartmentCodeOtherMandatory@1100528436 : Boolean;
      PaymentTermsCodeMandatory@1100528437 : Boolean;
      VATProdPostingGroupMandatory@1100528438 : Boolean;
      LaborMandatory@1100528439 : Boolean;
      ToBAccountMandatory@1100528440 : Boolean;
      InvoicePeriodCollListMandatory@1100528441 : Boolean;
      MinInvAmountCollListMandatory@1100528442 : Boolean;
      PaymentMethodCodeConInvMandatory@1100528443 : Boolean;
      DirectDebitMandateIDMandatory@1100528444 : Boolean;
      SurchargeLaborMandatory@1100528445 : Boolean;
      SurchargeMaterialMandatory@1100528446 : Boolean;
      SurchargeSubcontrMandatory@1100528447 : Boolean;
      SurchargePlantMandatory@1100528448 : Boolean;
      SurchargeSundryMandatory@1100528449 : Boolean;
      ReferenceDateItemMandatory@1100528450 : Boolean;
      PurchDiscountTermGroup1Mandatory@1100528451 : Boolean;
      PurchDiscountTermGroup2Mandatory@1100528452 : Boolean;
      PriorityPurchDiscTermGrp0Mandatory@1100528453 : Boolean;
      PriorityPurchDiscTermGrp1Mandatory@1100528454 : Boolean;
      PriorityPurchDiscTermGrp2Mandatory@1100528455 : Boolean;
      SalesDiscountTermGroup1Mandatory@1100528456 : Boolean;
      SalesDiscountTermGroup2Mandatory@1100528457 : Boolean;
      PrioritySalesDiscTermGrp0Mandatory@1100528458 : Boolean;
      PrioritySalesDiscTermGrp1Mandatory@1100528459 : Boolean;
      PrioritySalesDiscTermGrp2Mandatory@1100528460 : Boolean;
      InvoiceTextInstallmentsMandatory@1100528461 : Boolean;
      ModifiedbyMandatory@1100528462 : Boolean;
      LastDateModifiedMandatory@1100528463 : Boolean;
      InputbyMandatory@1100528464 : Boolean;
      InputDateMandatory@1100528465 : Boolean;
      ServiceIndexMethodMandatory@1100528466 : Boolean;
      TravelCostCodeMandatory@1100528467 : Boolean;
      ClusterMandatory@1100528468 : Boolean;
      ServiceCategoryCallsMandatory@1100528469 : Boolean;
      ServiceCategoryAddMandatory@1100528470 : Boolean;
      ControlBuildDateMandatory@1100528471 : Boolean;
      ControlBuildTimeMandatory@1100528472 : Boolean;

    PROCEDURE ShowContractArrangements@1100526200();
    VAR
      ServiceContractArrangement@1100526200 : Record 11071705;
    BEGIN
      ServiceContractArrangement.SETCURRENTKEY("Service Contract No.", "Maintenance Year");
      ServiceContractArrangement.FILTERGROUP(4);
      ServiceContractArrangement.SETRANGE("Service Contract No.", "No.");
      ServiceContractArrangement.FILTERGROUP(0);
      PAGE.RUNMODAL(PAGE::"All Service Contract Arrangem.", ServiceContractArrangement);
    END;

    PROCEDURE UpdateEditable@1100528600();
    BEGIN
      "Contract DurationEditable" := "Contract Limit" = "Contract Limit"::Limited;
      "Invoice IntervalEditable" := "Invoice Type" = "Invoice Type"::Dynamic;
      PostponeInvoicePeriodEditable :=
        ("Invoice Period" = "Invoice Period"::Forehand) AND
        NOT "Invoicing via Collective List";
      InstallmentBasedOnEditable := ("Invoice Type" = "Invoice Type"::Installments) AND
        ("Installment Type" = "Installment Type"::Contract) AND
        ("Invoice Period" = "Invoice Period"::Afterwards);
      InvoiceBaseAmountLaborEditable := "Invoice Base Method" <> "Invoice Base Method"::" ";
      InvoiceBaseAmountMaterialEdit := "Invoice Base Method" <> "Invoice Base Method"::" ";
      InvoiceBaseAmountTotalEditable := "Invoice Base Method" <> "Invoice Base Method"::" ";
      PerctoBAccountEditable := CheckVATReverse(FALSE,TRUE);
      PercLaborEditable := PerctoBAccountEditable;
      InstallmentTypeEditable := "Invoice Type" = "Invoice Type"::Installments;
    END;

    PROCEDURE ShowDocuments@1100525000();
    VAR
      RecRef@1100525000 : RecordRef;
      DocumentFilters@1100525002 : Codeunit 11012432;
    BEGIN
      RecRef.GETTABLE(Rec);
      DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, TRUE);
    END;

    PROCEDURE GetInfo@1100525002() : Integer;
    VAR
      RecRef@1100525000 : RecordRef;
      DocumentLinkMgt@1100525001 : Codeunit 11012401;
    BEGIN
      RecRef.GETTABLE(Rec);

      EXIT(DocumentLinkMgt.GetInfo(RecRef))
    END;

    LOCAL PROCEDURE ContractManagerOnAfterValidate@19074593();
    BEGIN
      CALCFIELDS("Contract Manager Name");
    END;

    LOCAL PROCEDURE ContractGroupOnAfterValidate@19052946();
    BEGIN
      CALCFIELDS("Contract Group Description");
    END;

    LOCAL PROCEDURE EndingDateOnAfterValidate@19076447();
    BEGIN
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ContractLimitOnAfterValidate@19064312();
    BEGIN
      UpdateEditable;
    END;

    LOCAL PROCEDURE InvoiceTypeOnAfterValidate@19044213();
    BEGIN
      UpdateEditable;
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE InvoiceIntervalOnAfterValidate@19012901();
    BEGIN
      CurrPage.Objects.PAGE.UpdateForm;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      SubcontractorService@1100528600 : Record 11071789;
      PreferredEmployee@1100528800 : Record 11012843;
      RecRef@1100529900 : RecordRef;
      MaintenanceInvoiceMgt@1100528601 : Codeunit 11012828;
    BEGIN
      xRec := Rec;
      SubcontractorCode := SubcontractorService.GetSubcontractorForDisplay("No.", '', '', '', SubcontractorName);
      PreferredEmployeeNo :=
        PreferredEmployee.GetPreferredEmployeeForDisplay("No.", '', '', '', '', '', '', 0D, PreferredEmployeeName);
      CheckInvoiceAddress;
      UpdateEditable;
      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");
    END;

    PROCEDURE ShowAllContractArrangements@1210190001();
    VAR
      ServiceContractArrangement@1100526200 : Record 11071705;
    BEGIN
      ServiceContractArrangement.SETCURRENTKEY("Service Contract No.", "Maintenance Year");
      ServiceContractArrangement.FILTERGROUP(4);
      ServiceContractArrangement.SETRANGE("Service Contract No.", "No.");
      ServiceContractArrangement.FILTERGROUP(0);
      PAGE.RUNMODAL(PAGE::"All Service Contract Arrangem.", ServiceContractArrangement);
    END;

    LOCAL PROCEDURE FillShowMandatoryVariables@1100528401();
    BEGIN
      Description2Mandatory := FieldInCompletionControl(FIELDNO("Description 2"));
      ContractManagerMandatory := FieldInCompletionControl(FIELDNO("Contract Manager"));
      ContractGroupMandatory := FieldInCompletionControl(FIELDNO("Contract Group"));
      ContactNameMandatory := FieldInCompletionControl(FIELDNO("Contact Name"));
      PhoneNoMandatory := FieldInCompletionControl(FIELDNO("Phone No."));
      PhoneNo2Mandatory := FieldInCompletionControl(FIELDNO("Phone No. 2"));
      MobilePhoneNoMandatory := FieldInCompletionControl(FIELDNO("Mobile Phone No."));
      FaxNoMandatory := FieldInCompletionControl(FIELDNO("Fax No."));
      EMailMandatory := FieldInCompletionControl(FIELDNO("E-Mail"));
      ServicePackageMandatory := FieldInCompletionControl(FIELDNO("Service Package"));
      YourReferenceMandatory := FieldInCompletionControl(FIELDNO("Your Reference"));
      ContractDurationMandatory := FieldInCompletionControl(FIELDNO("Contract Duration"));
      EndingDateMandatory := FieldInCompletionControl(FIELDNO("Ending Date"));
      TerminationPeriodMandatory := FieldInCompletionControl(FIELDNO("Termination Period"));
      TerminationDateMandatory := FieldInCompletionControl(FIELDNO("Termination Date"));
      ExpiringDateMandatory := FieldInCompletionControl(FIELDNO("Expiring Date"));
      ControlPeriodIntervalMandatory := FieldInCompletionControl(FIELDNO("Control Period Interval"));
      InvoiceBaseHoursMandatory := FieldInCompletionControl(FIELDNO("Invoice Base Hours"));
      InvoiceBaseAmountLaborMandatory := FieldInCompletionControl(FIELDNO("Invoice Base Amount Labor"));
      InvoiceBaseAmountMaterialMandatory := FieldInCompletionControl(FIELDNO("Invoice Base Amount Material"));
      InvoiceBaseAmountTotalMandatory := FieldInCompletionControl(FIELDNO("Invoice Base Amount Total"));
      LimitBudgetHoursMandatory := FieldInCompletionControl(FIELDNO("Limit Budget Hours"));
      LimitBudgetLaborMandatory := FieldInCompletionControl(FIELDNO("Limit Budget Labor"));
      LimitBudgetMaterialMandatory := FieldInCompletionControl(FIELDNO("Limit Budget Material"));
      LimitBudgetTotalMandatory := FieldInCompletionControl(FIELDNO("Limit Budget Total"));
      ContractTypeMandatory := FieldInCompletionControl(FIELDNO("Contract Type"));
      BilltoCustomerNoMandatory := FieldInCompletionControl(FIELDNO("Bill-to Customer No. (CP)"));
      BilltoCustomerNoContractMandatory := FieldInCompletionControl(FIELDNO("Bill-to Customer No. (Contr.)"));
      AlternativeBilltoAddressMandatory := FieldInCompletionControl(FIELDNO("Alt. Bill-to Address (CP)"));
      AlternativeBilltoAddressContractMandatory := FieldInCompletionControl(FIELDNO("Alt. Bill-to Address (Contr.)"));
      TransactionModeInstallmentsMandatory := FieldInCompletionControl(FIELDNO("Transaction Mode Installments"));
      InvoiceIntervalMandatory := FieldInCompletionControl(FIELDNO("Invoice Interval"));
      InvoicePostponePeriodMandatory := FieldInCompletionControl(FIELDNO("Invoice Postpone Period"));
      InvoicedUntilMandatory := FieldInCompletionControl(FIELDNO("Invoiced Until"));
      CurrencyCodeMandatory := FieldInCompletionControl(FIELDNO("Currency Code"));
      ServiceTypeOtherMandatory := FieldInCompletionControl(FIELDNO("Service Type (Other)"));
      GlobalDimension1CodeMandatory := FieldInCompletionControl(FIELDNO("Global Dimension 1 Code"));
      DepartmentCodeOtherMandatory := FieldInCompletionControl(FIELDNO("Department Code (Other)"));
      PaymentTermsCodeMandatory := FieldInCompletionControl(FIELDNO("Payment Terms Code"));
      VATProdPostingGroupMandatory := FieldInCompletionControl(FIELDNO("VAT Prod. Posting Group"));
      LaborMandatory := FieldInCompletionControl(FIELDNO("% Labor"));
      ToBAccountMandatory := FieldInCompletionControl(FIELDNO("% to B Account"));
      InvoicePeriodCollListMandatory := FieldInCompletionControl(FIELDNO("Invoice Period (Coll. List)"));
      MinInvAmountCollListMandatory := FieldInCompletionControl(FIELDNO("Min. Inv. Amount (Coll. List)"));
      PaymentMethodCodeConInvMandatory := FieldInCompletionControl(FIELDNO("Payment Method Code (Con.Inv.)"));
      DirectDebitMandateIDMandatory := FieldInCompletionControl(FIELDNO("Direct Debit Mandate ID"));
      SurchargeLaborMandatory := FieldInCompletionControl(FIELDNO("Surcharge % Labor"));
      SurchargeMaterialMandatory := FieldInCompletionControl(FIELDNO("Surcharge % Material"));
      SurchargeSubcontrMandatory := FieldInCompletionControl(FIELDNO("Surcharge % Subcontr."));
      SurchargePlantMandatory := FieldInCompletionControl(FIELDNO("Surcharge % Plant"));
      SurchargeSundryMandatory := FieldInCompletionControl(FIELDNO("Surcharge % Sundry"));
      ReferenceDateItemMandatory := FieldInCompletionControl(FIELDNO("Reference Date (Item)"));
      PurchDiscountTermGroup1Mandatory := FieldInCompletionControl(FIELDNO("Purch Discount Term Group 1"));
      PurchDiscountTermGroup2Mandatory := FieldInCompletionControl(FIELDNO("Purch Discount Term Group 2"));
      PriorityPurchDiscTermGrp0Mandatory := FieldInCompletionControl(FIELDNO("Priority Purch Disc Term Grp 0"));
      PriorityPurchDiscTermGrp1Mandatory := FieldInCompletionControl(FIELDNO("Priority Purch Disc Term Grp 1"));
      PriorityPurchDiscTermGrp2Mandatory := FieldInCompletionControl(FIELDNO("Priority Purch Disc Term Grp 2"));
      SalesDiscountTermGroup1Mandatory := FieldInCompletionControl(FIELDNO("Sales Discount Term Group 1"));
      SalesDiscountTermGroup2Mandatory := FieldInCompletionControl(FIELDNO("Sales Discount Term Group 2"));
      PrioritySalesDiscTermGrp0Mandatory := FieldInCompletionControl(FIELDNO("Priority Sales Disc Term Grp 0"));
      PrioritySalesDiscTermGrp1Mandatory := FieldInCompletionControl(FIELDNO("Priority Sales Disc Term Grp 1"));
      PrioritySalesDiscTermGrp2Mandatory := FieldInCompletionControl(FIELDNO("Priority Sales Disc Term Grp 2"));
      InvoiceTextInstallmentsMandatory := FieldInCompletionControl(FIELDNO("Invoice Text Installments"));
      ModifiedbyMandatory := FieldInCompletionControl(FIELDNO("Modified by"));
      LastDateModifiedMandatory := FieldInCompletionControl(FIELDNO("Last Date Modified"));
      InputbyMandatory := FieldInCompletionControl(FIELDNO("Input by"));
      InputDateMandatory := FieldInCompletionControl(FIELDNO("Input Date"));
      ServiceIndexMethodMandatory := FieldInCompletionControl(FIELDNO("Service Index Method"));
      TravelCostCodeMandatory := FieldInCompletionControl(FIELDNO("Travel Cost Code"));
      ClusterMandatory := FieldInCompletionControl(FIELDNO(Cluster));
      ServiceCategoryCallsMandatory := FieldInCompletionControl(FIELDNO("Service Category (Calls)"));
      ServiceCategoryAddMandatory := FieldInCompletionControl(FIELDNO("Service Category (Extension)"));
      ControlBuildDateMandatory := FieldInCompletionControl(FIELDNO("Control Build Date"));
      ControlBuildTimeMandatory := FieldInCompletionControl(FIELDNO("Control Build Time"));
    END;

    LOCAL PROCEDURE FieldInCompletionControl@1100528402(FieldNo@1100528400 : Integer) : Boolean;
    VAR
      ExtendedFieldProperty@1100528402 : Record 11020567;
      TableNo@1100528401 : Integer;
    BEGIN
      TableNo := DATABASE::"Service-Contract";
      EXIT(ExtendedFieldProperty.FieldInCompletionControl(TableNo, FieldNo));
    END;

    BEGIN
    END.
  }
}

