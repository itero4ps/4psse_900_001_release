OBJECT Page 11128081 Projects - Summary
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSSE;
  }
  PROPERTIES
  {
    CaptionML=ENU=Projects - Summary;
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table11072003;
    SourceTableView=SORTING(No.);
    PageType=List;
    CardPageID=Job Card;
    PromotedActionCategoriesML=ENU=New,Process,Report,Commission & Invoicing,Budget & Structure,Project control,Engineering & Purchase,Documents;
    ShowFilter=Yes;
    OnInit=BEGIN
             CopyButtonEnable := TRUE;
           END;

    OnOpenPage=BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01
                 //**4PS.sn
                 ProjSetup.GET;
                 IF NOT gCopyServLoc THEN
                   CopyButtonEnable := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       //**4PS.sn
                       NameHideValue := FALSE;

                       IF "Single/Main/Sub Project" <> "Single/Main/Sub Project"::"Main Project" THEN
                         SETRANGE("Project Filter", "No.")
                       ELSE
                         SETRANGE("Project Filter");
                       //140612 CALCFIELDS(Revenues);
                       NameOnFormat;
                       //**4PS.en

                       CalculateProjectValues; // 150326 ITERO.KP
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1100525069;1 ;ActionGroup;
                      CaptionML=ENU=Project }
      { 1100525006;2 ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=Card;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //C011191
                                 OpenCard;
                               END;
                                }
      { 1100525042;1 ;ActionGroup;
                      CaptionML=ENU=Commission & Invoicing }
      { 1101200005;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+P;
                      CaptionML=ENU=Principals;
                      Promoted=Yes;
                      Image=TeamSales;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 //**4PS
                                 ProjPrincipRec.RESET;
                                 ProjPrincipRec.SETRANGE("Project No.","No.");
                                 IF "Bill-to Customer No." <> '' THEN
                                   IF NOT ProjPrincipRec.GET("No.","Bill-to Customer No.") THEN
                                     ProjPrincipRec.SETRANGE(Principal,"Bill-to Customer No.");
                                 PAGE.RUN(PAGE::"Project Principal List",ProjPrincipRec);
                               END;
                                }
      { 1101200023;2 ;Action    ;
                      CaptionML=ENU=&Installments;
                      RunObject=Page 11012025;
                      RunPageView=SORTING(Project No.,Principal,Installment No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=AmountByPeriod;
                      PromotedCategory=Category4 }
      { 1101200017;2 ;Action    ;
                      ShortCutKey=Ctrl+M;
                      CaptionML=ENU=&Extensions;
                      RunObject=Page 11012014;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=TransferFunds;
                      PromotedCategory=Category4 }
      { 1100525043;2 ;ActionGroup;
                      CaptionML=ENU=Cost plus & Unit Prices;
                      Image=CostAccounting }
      { 1101200024;3 ;Action    ;
                      CaptionML=ENU=&Cost Plus Entries;
                      RunObject=Page 11012043;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=ApplyEntries }
      { 1100525036;3 ;Action    ;
                      CaptionML=ENU=Project &Unit Prices;
                      RunObject=Page 11072519;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CostCenter }
      { 1100525037;3 ;Action    ;
                      CaptionML=ENU=Production Motivation;
                      Image=Production;
                      OnAction=VAR
                                 ProdMot@1100525000 : Record 11020425;
                               BEGIN
                                 ProdMot.RunUnitPriceProdMotList("No.", '', 0);  //* Level 0=Project
                               END;
                                }
      { 1100525029;2 ;ActionGroup;
                      CaptionML=ENU=Sales rates;
                      Image=Sales }
      { 1100525030;3 ;Action    ;
                      CaptionML=ENU=Project - &Employee Sales Prices;
                      RunObject=Page 11072469;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPerson }
      { 1100525031;3 ;Action    ;
                      CaptionML=ENU=Project - Employee - &Cost Object Sales Prices;
                      RunObject=Page 11072497;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SalesPrices }
      { 1100525032;3 ;Action    ;
                      CaptionML=ENU=Project - Employee - Cost Object - &Wage Component Sales Prices;
                      RunObject=Page 11072498;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ItemTrackingLedger }
      { 1100525033;3 ;Action    ;
                      CaptionML=ENU=Project - Cost &Object Sales Prices;
                      RunObject=Page 11072467;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Item }
      { 1100525034;3 ;Action    ;
                      CaptionML=ENU=Project - Cost Object - Wage Component Sales Prices;
                      RunObject=Page 11072468;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100525044;2 ;ActionGroup;
                      CaptionML=ENU=More..;
                      Image=Navigate }
      { 1101200002;3 ;Action    ;
                      CaptionML=ENU=Invoices;
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowPostedInvoices;
                               END;
                                }
      { 1101200003;3 ;Action    ;
                      CaptionML=ENU=Credit &Memos;
                      Promoted=No;
                      Image=CreditMemo;
                      OnAction=BEGIN
                                 //**4PS
                                 ShowPostedCreditMemos;
                               END;
                                }
      { 1100285003;3 ;Action    ;
                      CaptionML=ENU=Credit Memos, not posted;
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 SalesLine@1100285000 : Record 37;
                                 SalesHeader@1100285001 : Record 36;
                               BEGIN
                                 //**4PS
                                 //ShowPostedInvoices;


                                 SalesLine.SETCURRENTKEY("Job No.");
                                 SalesLine.SETRANGE("Job No.","No.");
                                 SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::"Credit Memo");
                                 IF SalesLine.FINDSET THEN
                                   REPEAT
                                     IF SalesHeader.GET(SalesLine."Document Type",SalesLine."Document No.") THEN
                                       SalesHeader.MARK(TRUE);
                                   UNTIL SalesLine.NEXT = 0;

                                 SalesHeader.MARKEDONLY(TRUE);
                                 PAGE.RUNMODAL(PAGE::"Sales List",SalesHeader);
                               END;
                                }
      { 1100285004;3 ;Action    ;
                      CaptionML=ENU=Invoices;
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 SalesLine@1100285000 : Record 37;
                                 SalesHeader@1100285001 : Record 36;
                               BEGIN
                                 //**4PS
                                 //ShowPostedInvoices;


                                 SalesLine.SETCURRENTKEY("Job No.");
                                 SalesLine.SETRANGE("Job No.","No.");
                                 SalesLine.SETRANGE("Document Type",SalesLine."Document Type"::Invoice);
                                 IF SalesLine.FINDSET THEN
                                   REPEAT
                                     IF SalesHeader.GET(SalesLine."Document Type",SalesLine."Document No.") THEN
                                       SalesHeader.MARK(TRUE);
                                   UNTIL SalesLine.NEXT = 0;

                                 SalesHeader.MARKEDONLY(TRUE);
                                 PAGE.RUNMODAL(PAGE::"Sales List",SalesHeader);
                               END;
                                }
      { 1210190027;3 ;Action    ;
                      CaptionML=ENU=Rental Units;
                      Image=BlanketOrder;
                      OnAction=VAR
                                 RentalUnitRec@1100485000 : Record 11012940;
                               BEGIN
                                 //**4PS
                                 ProjSetup.TESTFIELD("Rental Units active");
                                 RentalUnitRec.SETRANGE("Project No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Rental Unit",RentalUnitRec);
                               END;
                                }
      { 1100525068;3 ;Action    ;
                      CaptionML=ENU=Exchange Rates;
                      Image=CurrencyExchangeRates;
                      OnAction=BEGIN
                                 ShowCurrencyExchangeRates;
                               END;
                                }
      { 1100525017;1 ;ActionGroup;
                      CaptionML=ENU=Budget & Structure;
                      Image=Administration }
      { 1210190032;2 ;Action    ;
                      CaptionML=ENU=Sub Projects;
                      Promoted=Yes;
                      Image=Splitlines;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 JobRec@1100485000 : Record 11072003;
                               BEGIN
                                 //**4PS
                                 JobRec.SETRANGE("Single/Main/Sub Project", "Single/Main/Sub Project"::"Sub Project");
                                 JobRec.SETRANGE("Main Project", "No.");
                                 IF JobRec.FIND('-') THEN
                                   PAGE.RUNMODAL(PAGE::"Job List", JobRec)
                                 ELSE
                                   MESSAGE(Text11012000);
                               END;
                                }
      { 1101200015;2 ;Action    ;
                      CaptionML=ENU=Elemen&ts;
                      RunObject=Page 11012028;
                      RunPageView=SORTING(Project No.,Element);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=BOMVersions;
                      PromotedCategory=Category5 }
      { 1101200016;2 ;Action    ;
                      ShortCutKey=Ctrl+B;
                      CaptionML=ENU=&Budget;
                      RunObject=Page 11012003;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=LedgerBudget;
                      PromotedCategory=Category5 }
      { 1101200018;2 ;Action    ;
                      CaptionML=ENU=Budget &Adjustments;
                      Promoted=Yes;
                      Image=Balance;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BudgetAdjustment@1100525000 : Record 11012003;
                               BEGIN
                                 BudgetAdjustment.SETRANGE("Project No.", "No.");
                                 IF BudgetAdjustment.FINDLAST THEN;
                                   PAGE.RUNMODAL(PAGE::"Budget Adjustment List", BudgetAdjustment);
                               END;
                                }
      { 1100525023;2 ;ActionGroup;
                      CaptionML=ENU=Rates Cost Prices;
                      Image=CostAccounting }
      { 1100525021;3 ;Action    ;
                      CaptionML=ENU=Project &Budget Rates;
                      RunObject=Page 11020264;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=LedgerBudget }
      { 1100525024;3 ;Action    ;
                      CaptionML=ENU=Project - &Employee Cost Prices;
                      RunObject=Page 11020300;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Employee }
      { 1100525025;3 ;Action    ;
                      CaptionML=ENU=Project - Employee - &Wage Component Cost Prices;
                      RunObject=Page 11072435;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100525026;3 ;Action    ;
                      CaptionML=ENU=Project - &Cost Object Cost Prices;
                      RunObject=Page 11072434;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CostAccountingDimensions }
      { 1100525027;3 ;Action    ;
                      CaptionML=ENU=Project - &Trade Association Cost Prices;
                      RunObject=Page 11072432;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Union }
      { 1100525028;3 ;Action    ;
                      CaptionML=ENU=Project - Trade Association - Wage Co&mponent Cost Prices;
                      RunObject=Page 11072433;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100525045;2 ;ActionGroup;
                      CaptionML=ENU=More..;
                      Image=Navigate }
      { 1210190035;3 ;Action    ;
                      CaptionML=ENU=Project Cost Objects;
                      RunObject=Page 11012128;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Dimensions }
      { 1100525012;1 ;ActionGroup;
                      CaptionML=ENU=Project Control;
                      Image=SNInfo }
      { 1100525013;2 ;Action    ;
                      CaptionML=ENU=Project Control;
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectRec@1100525000 : Record 11072003;
                               BEGIN
                                 OpenProjectControl;
                               END;
                                }
      { 1100285502;2 ;Action    ;
                      CaptionML=ENU=Project Control Overview;
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectRec@1100285500 : Record 11072003;
                               BEGIN
                                 OpenProjectControlOverview;
                               END;
                                }
      { 1100285501;2 ;Action    ;
                      CaptionML=ENU=Project Control Summarized;
                      Promoted=Yes;
                      Image=PayrollStatistics;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ProjectRec@1100285500 : Record 11072003;
                               BEGIN
                                 OpenProjectControlSummarized;
                               END;
                                }
      { 32      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=ENU=Ledger E&ntries;
                      RunObject=Page 11072005;
                      RunPageView=SORTING(Job No.,Posting Date);
                      RunPageLink=Job No.=FIELD(No.);
                      Promoted=Yes;
                      Image=LedgerEntries;
                      PromotedCategory=Category6 }
      { 1100525014;2 ;Action    ;
                      CaptionML=ENU=P&rogress;
                      RunObject=Page 11012079;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=EditLines;
                      PromotedCategory=Category6 }
      { 1100525015;2 ;Action    ;
                      CaptionML=ENU=Pr&ognosis;
                      Promoted=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 LaunchPrognosisList;
                               END;
                                }
      { 1100285002;2 ;Action    ;
                      Promoted=Yes;
                      Image=CalculateRemainingUsage;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 MgtProjdetails@1100285000 : Codeunit 11128091;
                               BEGIN
                                 MgtProjdetails.MgtProjDetail(USERID,"No.");
                               END;
                                }
      { 1100525046;2 ;ActionGroup;
                      CaptionML=ENU=More..;
                      Image=Navigate }
      { 1100525066;3 ;Action    ;
                      CaptionML=ENU=Snapshot;
                      RunObject=Page 11124895;
                      RunPageView=SORTING(Project No.,Snapshot Date);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=SuggestCapacity }
      { 1100525067;3 ;Action    ;
                      CaptionML=ENU=&Forecast;
                      Image=Forecast }
      { 1100525016;3 ;Action    ;
                      CaptionML=ENU=Liquidity Prognosis;
                      Image=PaymentForecast;
                      OnAction=VAR
                                 LiqProgProjHead@1100525000 : Record 11020603;
                               BEGIN
                                 TESTFIELD("Liquidity Prognosis", "Liquidity Prognosis"::"Specific Division");

                                 LiqProgProjHead.SETRANGE("Project No.", "No.");
                                 PAGE.RUNMODAL(PAGE::"Liquidity Prognosis Proj Head", LiqProgProjHead);
                               END;
                                }
      { 1100525051;1 ;ActionGroup;
                      CaptionML=ENU=Engineering & Purchase;
                      Image=Purchasing }
      { 1100525058;2 ;Action    ;
                      CaptionML=ENU=Advice Orders;
                      RunObject=Page 11012102;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=OrderReminder;
                      PromotedCategory=Category7 }
      { 1101200021;2 ;Action    ;
                      CaptionML=ENU=Purchase Actions;
                      RunObject=Page 11012034;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=OrderTracking;
                      PromotedCategory=Category7 }
      { 1210190000;2 ;Action    ;
                      CaptionML=ENU=Purchase Orders;
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=Category7;
                      OnAction=BEGIN
                                 ShowPurchaseOrdersForProject;
                               END;
                                }
      { 1100525059;2 ;Action    ;
                      CaptionML=ENU=Purchase Quotes;
                      Image=Purchase;
                      OnAction=BEGIN
                                 ShowPurchaseQuotesForProject;
                               END;
                                }
      { 1100525041;2 ;Action    ;
                      CaptionML=ENU=Planning Activities;
                      RunObject=Page 11072310;
                      RunPageView=SORTING(No.);
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=JobTimeSheet;
                      PromotedCategory=Category7 }
      { 1100525056;2 ;ActionGroup;
                      CaptionML=ENU=More..;
                      Image=Navigate }
      { 1100525040;3 ;Action    ;
                      CaptionML=ENU=Activities;
                      Image=Task;
                      OnAction=BEGIN
                                 ShowTodos;
                               END;
                                }
      { 1100525005;3 ;Action    ;
                      CaptionML=ENU=Matrix Purchase Actions &Document Relations;
                      Image=Document;
                      OnAction=VAR
                                 MatrixPurchActDocRelations@1100525000 : Page 11071829;
                               BEGIN
                                 TESTFIELD("No.");
                                 MatrixPurchActDocRelations.SetProjectNo("No.");
                                 MatrixPurchActDocRelations.RUNMODAL;
                               END;
                                }
      { 1210190030;1 ;ActionGroup;
                      CaptionML=ENU=Buyer Management;
                      Image=AdministrationSalesPurchases }
      { 1101200011;2 ;Action    ;
                      CaptionML=ENU=Plots;
                      RunObject=Page 11012506;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=AddToHome }
      { 1100525048;2 ;Action    ;
                      CaptionML=ENU=Option Quotes;
                      RunObject=Page 11012546;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Quote }
      { 1100525047;2 ;ActionGroup;
                      CaptionML=ENU=More..;
                      Image=Navigate }
      { 1101200010;3 ;Action    ;
                      CaptionML=ENU=House Types;
                      Promoted=No;
                      Image=NewWarehouse;
                      OnAction=VAR
                                 lvHouseModelRec@1210190000 : Record 11012501;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 lvHouseModelRec.FILTERGROUP(9);
                                 lvHouseModelRec.SETRANGE("Project No.", "No.");
                                 lvHouseModelRec.FILTERGROUP(0);
                                 PAGE.RUNMODAL(PAGE::"House Models by Project List", lvHouseModelRec);
                               END;
                                }
      { 1100525049;3 ;Action    ;
                      CaptionML=ENU=Delivery;
                      RunObject=Page 11012528;
                      RunPageView=WHERE(Plot No.=FILTER(''));
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Delivery }
      { 1210190028;3 ;Action    ;
                      CaptionML=ENU=Project Options;
                      Image=Quote;
                      OnAction=BEGIN
                                 //**4PS
                                 OptionList();
                               END;
                                }
      { 1210190046;3 ;Action    ;
                      CaptionML=ENU=Main Groups;
                      RunObject=Page 11012543;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CustomerGroup }
      { 1101200013;3 ;Action    ;
                      CaptionML=ENU=Groups;
                      RunObject=Page 11012518;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CustomerGroup }
      { 1210190047;3 ;Action    ;
                      CaptionML=ENU=Sub Groups;
                      RunObject=Page 11012542;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CustomerGroup }
      { 1100525002;1 ;ActionGroup;
                      CaptionML=ENU=&Civil Engineering;
                      Image=Travel }
      { 1100525022;2 ;Action    ;
                      CaptionML=ENU=Project &Tender Paragraphs;
                      RunObject=Page 11020346;
                      RunPageLink=No.=FIELD(No.);
                      Image=Job }
      { 1100525003;2 ;Action    ;
                      CaptionML=ENU=Tender Paragraphs;
                      RunObject=Page 11020553;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CalculateCost }
      { 1100525035;2 ;ActionGroup;
                      CaptionML=ENU=More..;
                      Image=Navigate }
      { 1100525004;3 ;Action    ;
                      CaptionML=ENU=Tender Paragraph &Parts;
                      RunObject=Page 11020554;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CalculateCrossDock }
      { 1100525052;3 ;Action    ;
                      CaptionML=ENU=Project Inspections (Site Mgt.);
                      RunObject=Page 11125538;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Check }
      { 1100525053;1 ;ActionGroup;
                      CaptionML=ENU=Site Manager Form }
      { 1100525054;2 ;Action    ;
                      CaptionML=ENU=Project Working Hours;
                      RunObject=Page 11125541;
                      RunPageLink=No.=FIELD(No.);
                      Image=JobTimeSheet }
      { 1100525055;2 ;Action    ;
                      CaptionML=ENU=Project Inspections;
                      RunObject=Page 11125538;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CheckRulesSyntax }
      { 1100525018;1 ;ActionGroup;
                      CaptionML=ENU=&Project Tables;
                      Image=Worksheets }
      { 34      ;2   ;Action    ;
                      CaptionML=ENU=Co&mments;
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Job),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 1210190034;2 ;Action    ;
                      CaptionML=ENU=Do&cuments;
                      Promoted=No;
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1100525001 : RecordRef;
                                 DocumentFilters@1100525002 : Codeunit 11012432;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 // ByCompany changed to FALSE, otherwise documents are not showed in the archive company
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, FALSE);
                               END;
                                }
      { 1100525057;2 ;ActionGroup;
                      CaptionML=ENU=Locations;
                      Image=Addresses }
      { 1210190031;3 ;Action    ;
                      CaptionML=ENU=Project Locations;
                      RunObject=Page 11012020;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Job }
      { 1100525020;3 ;Action    ;
                      CaptionML=ENU=Job Preferred &Locations;
                      RunObject=Page 11072043;
                      RunPageView=SORTING(Priority);
                      RunPageLink=Type=CONST(Job),
                                  No.=FIELD(No.);
                      Image=RoutingVersions }
      { 1100525060;2 ;ActionGroup;
                      CaptionML=ENU=QA;
                      Image=AnalysisView }
      { 1100525050;3 ;Action    ;
                      CaptionML=ENU=Complaint Management;
                      RunObject=Page 11012468;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=No;
                      Image=EditReminder }
      { 1100525061;2 ;ActionGroup;
                      CaptionML=ENU=More..;
                      Image=Navigate }
      { 1101200007;3 ;Action    ;
                      CaptionML=ENU=Responsible Persons;
                      RunObject=Page 11012017;
                      RunPageView=SORTING(Project No.,Line No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=PersonInCharge }
      { 1100525011;3 ;Action    ;
                      CaptionML=ENU=Project &Inventory;
                      RunObject=Page 11012673;
                      RunPageView=SORTING(Project No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Image=LedgerBook }
      { 1100525019;3 ;Action    ;
                      CaptionML=ENU=Project &Authorities;
                      RunObject=Page 11020231;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=IndustryGroups }
      { 13      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(11072003),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 1100525038;3 ;Action    ;
                      CaptionML=ENU=Features;
                      Image=QualificationOverview;
                      OnAction=BEGIN
                                 ShowFeatures;
                               END;
                                }
      { 1101200008;3 ;Action    ;
                      CaptionML=ENU=Picture;
                      RunObject=Page 11012030;
                      RunPageLink=No.=FIELD(No.);
                      Image=Picture }
      { 1100525039;3 ;Action    ;
                      CaptionML=ENU=Exchange Rates;
                      RunObject=Page 11124939;
                      RunPageLink=Project Filter=FIELD(No.);
                      Image=CurrencyExchangeRates }
      { 1100525062;1 ;ActionGroup;
                      CaptionML=ENU=Sales & &Marketing }
      { 1100525063;2 ;Action    ;
                      CaptionML=ENU=Try-out;
                      Image=Quote;
                      OnAction=BEGIN
                                 ShowTryOut(1);
                               END;
                                }
      { 1100525064;2 ;Action    ;
                      CaptionML=ENU=Try-out &Quote;
                      Image=Quote;
                      OnAction=BEGIN
                                 ShowTryOut(2);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1900979604;1 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Copy Project;
                      Promoted=No;
                      Image=Copy;
                      PromotedCategory=New;
                      OnAction=VAR
                                 CopyProject@1100528400 : Page 11012106;
                               BEGIN
                                 //**4PS
                                 CopyProject.FillDefaults("No.");
                                 CopyProject.StdDialogRunModal;
                               END;
                                }
      { 1210190036;1 ;Action    ;
                      Name=CopyButton;
                      CaptionML=ENU=&Copy;
                      Enabled=CopyButtonEnable;
                      Image=Copy;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 //**4PS
                                 CopyServiceLocation;
                                 COMMIT;
                                 CurrPage.CLOSE;
                               END;
                                }
      { 1100285000;1 ;Action    ;
                      Name=<Action1100285000>;
                      ShortCutKey=Ctrl+U;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Sub Project;
                      Promoted=Yes;
                      Image=Splitlines;
                      PromotedCategory=New;
                      OnAction=VAR
                                 Job@1100285003 : Record 11072003;
                                 CreateSubProjFrm@1100285002 : Page 11128005;
                                 CreatedProjNo@1100285001 : Code[20];
                               BEGIN
                                 //**4PSSE
                                 IF CONFIRM(STRSUBSTNO(Text50000,"No.")) THEN BEGIN
                                   CreateSubProjFrm.FillDefaults("No.");
                                   CreateSubProjFrm.CopyProject();
                                   CreateSubProjFrm.GetCreatedProjectNo(CreatedProjNo);
                                   Job.GET(CreatedProjNo);
                                   PAGE.RUN(11072003,Job);
                                   CLEAR(CreateSubProjFrm);
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 10  ;1   ;Field     ;
                CaptionML=ENU=Date Filter;
                SourceExpr=DateFilter;
                Enabled=TRUE;
                Editable=TRUE;
                OnValidate=BEGIN
                             AppMgt.MakeDateFilter(DateFilter);
                             CurrPage.UPDATE;
                           END;
                            }

    { 1   ;1   ;Group     ;
                Editable=FALSE;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 1100528800;2;Field  ;
                SourceExpr="Description 2";
                Visible=FALSE }

    { 1100485008;2;Field  ;
                SourceExpr="Project Address Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Bill-to Customer No.";
                Visible=FALSE }

    { 3   ;2   ;Field     ;
                SourceExpr="Principal Name" }

    { 1100485019;2;Field  ;
                CaptionML=ENU=Name (Small Project);
                SourceExpr=Name;
                Visible=FALSE;
                HideValue=NameHideValue }

    { 1210190013;2;Field  ;
                SourceExpr=Address;
                Visible=FALSE }

    { 1210190019;2;Field  ;
                SourceExpr="Address 2";
                Visible=FALSE }

    { 1210190021;2;Field  ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 1210190011;2;Field  ;
                SourceExpr=City;
                Visible=FALSE }

    { 1210190015;2;Field  ;
                SourceExpr="Phone No.";
                Visible=FALSE }

    { 1210190017;2;Field  ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 19  ;2   ;Field     ;
                SourceExpr="Project Type";
                Visible=FALSE }

    { 1100485006;2;Field  ;
                SourceExpr="Territory Code";
                Visible=FALSE;
                Editable=FALSE }

    { 1210190005;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1210190023;2;Field  ;
                SourceExpr=Type;
                Visible=FALSE }

    { 1210190007;2;Field  ;
                SourceExpr="Project Manager" }

    { 11  ;2   ;Field     ;
                SourceExpr="Name Project Manager" }

    { 4   ;2   ;Field     ;
                SourceExpr="Search Description";
                Visible=FALSE }

    { 1101200000;2;Field  ;
                SourceExpr="Project Status" }

    { 1100485000;2;Field  ;
                SourceExpr="Small Project Status";
                Visible=FALSE }

    { 1100525008;2;Field  ;
                SourceExpr="Urgency Code";
                Visible=FALSE }

    { 1100485004;2;Field  ;
                SourceExpr="Action by";
                Visible=FALSE }

    { 1100525000;2;Field  ;
                SourceExpr="Single/Main/Sub Project";
                Visible=FALSE }

    { 1210190037;2;Field  ;
                SourceExpr="Main Project";
                Visible=FALSE }

    { 1100525065;2;Field  ;
                SourceExpr="Prognosis Level";
                Visible=FALSE }

    { 1100285001;2;Field  ;
                SourceExpr="Forecast Level";
                Visible=FALSE }

    { 1210190009;2;Field  ;
                CaptionML=ENU=Try-Out No.;
                SourceExpr=GetTryOut(1);
                Visible=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowTryOut(1);
                         END;
                          }

    { 1210190025;2;Field  ;
                CaptionML=ENU=Try-Out Quote;
                SourceExpr=GetTryOut(2);
                Visible=FALSE;
                OnLookup=BEGIN
                           //**4PS
                           ShowTryOut(2);
                         END;
                          }

    { 1100485015;2;Field  ;
                SourceExpr="Starting Date";
                Visible=FALSE }

    { 1100485023;2;Field  ;
                SourceExpr="Ending Date";
                Visible=FALSE }

    { 1100485017;2;Field  ;
                SourceExpr="Requested Starting Time";
                Visible=FALSE }

    { 1100485002;2;Field  ;
                SourceExpr="Order No. Customer";
                Visible=FALSE }

    { 1100485010;2;Field  ;
                SourceExpr="Purchaser Code";
                Visible=FALSE }

    { 1210190056;2;Field  ;
                SourceExpr="Offers Expired";
                Visible=FALSE }

    { 1210190043;2;Field  ;
                SourceExpr=Text;
                Visible=FALSE }

    { 1100285500;2;Field  ;
                SourceExpr="Settlement Method";
                Visible=FALSE }

    { 5   ;2   ;Field     ;
                CaptionML=ENU=Profit %;
                SourceExpr=ProfitPct;
                Style=Attention;
                StyleExpr=NegBal }

    { 7   ;2   ;Field     ;
                CaptionML=ENU=Profit/ Hour;
                SourceExpr=ProfitHour;
                Style=Attention;
                StyleExpr=NegBal2 }

    { 9   ;2   ;Field     ;
                CaptionML=ENU=Project Balance;
                SourceExpr=ProjBalance;
                Style=Attention;
                StyleExpr=NegBal3 }

    { 1100285005;2;Field  ;
                SourceExpr=PrognosisRec."Prognosis Date" }

    { 1100285006;2;Field  ;
                SourceExpr=PrognosisRec.Fixed;
                Visible=false }

    { 1100285007;2;Field  ;
                CaptionML=ENU=Prognosis margin %;
                SourceExpr=GetPrognosisTB }

  }
  CODE
  {
    VAR
      ProjSetup@1100485000 : Record 315;
      ProjPrincipRec@11012000 : Record 11012005;
      TryOutRelationRec@1210190001 : Record 11012761;
      TryOutRelation@1210190008 : Code[20];
      TryOutQuoteRelation@1210190002 : Code[20];
      Text11012000@1210190004 : TextConst 'ENU=For this Project are no Sub Projects present';
      gCopyServLoc@1210190000 : Boolean;
      DPA_IsHardFilter@1100000999 : Boolean;
      CopyButtonEnable@19014618 : Boolean INDATASET;
      NameHideValue@19054415 : Boolean INDATASET;
      Text11012001@1100525001 : TextConst 'ENU=Select Records First';
      "*** 4PSSE"@1100285001 : TextConst;
      Text50000@1100285000 : TextConst 'ENU=Do you want create a sub project to project %1?';
      ProfitPct@1000 : Decimal;
      ProfitHour@1001 : Decimal;
      ProjBalance@1002 : Decimal;
      DateFilter@1003 : Text[30];
      AppMgt@1004 : Codeunit 1;
      TestFieldCaption@1005 : Text;
      NegBal@1100285002 : Boolean INDATASET;
      NegBal2@1100285003 : Boolean INDATASET;
      NegBal3@1100285004 : Boolean INDATASET;
      Prognosis@1100285005 : Record 11012034;
      PrognosisRec@1100285006 : Record 11012034;

    PROCEDURE InitSelectionCopyServLoc@1210190001(lvCompName@1210190000 : Text[50]);
    BEGIN
      //**4PS
      gCopyServLoc := TRUE;
      CHANGECOMPANY(lvCompName);
    END;

    PROCEDURE CopyServiceLocation@1210190000();
    VAR
      Job@1100525000 : Record 11072003;
      ImexRec@1210190010 : Record 11012056;
      ProcID@1210190007 : Code[20];
      Text000@1210190009 : TextConst 'ENU=First select records.';
    BEGIN
      //**4PS
      CurrPage.SETSELECTIONFILTER(Job);
      IF NOT Job.FINDFIRST THEN BEGIN
        ERROR(Text000);
        EXIT;
      END;

      ProcID := 'GENSERVLOC_0';

      REPEAT
        ProcID := INCSTR(ProcID);
        ImexRec.INIT;
        ImexRec."User ID" := USERID;
        ImexRec."Process ID" := ProcID;
        ImexRec.Type := ImexRec.Type::Export;
        ImexRec.Description := 'Job';
        ImexRec.Condition := Job."No.";
        ImexRec.INSERT;
      UNTIL Job.NEXT = 0;
    END;

    PROCEDURE OptionList@1210190006();
    VAR
      lvOptionRec@1210190000 : Record 11012502;
    BEGIN
      //**4PS
      lvOptionRec.FILTERGROUP(9);
      lvOptionRec.SETRANGE("Project No.", "No.");
      lvOptionRec.FILTERGROUP(0);
      lvOptionRec.SETRANGE("Plot No.", '');

      PAGE.RUNMODAL(PAGE::"Project Option List", lvOptionRec);
    END;

    LOCAL PROCEDURE NameOnFormat@19039177();
    BEGIN
      IF NOT "Small Project" THEN
        NameHideValue := TRUE;
    END;

    PROCEDURE GetRecordSet@1100528601(VAR Job@1100528600 : Record 11072003);
    BEGIN
      //**4PS
      CurrPage.SETSELECTIONFILTER(Job);
    END;

    PROCEDURE CalculateProjectValues@2();
    VAR
      JobLedgerEntry@1000 : Record 11072005;
      Hours@1001 : Decimal;
      Revenue@1002 : Decimal;
    BEGIN
      ProfitPct :=0;
      ProfitHour := 0;
      ProjBalance :=0;
      Hours := 0;
      Revenue :=0;
      JobLedgerEntry.RESET;
      JobLedgerEntry.SETCURRENTKEY("Job No.","Posting Date");
      //JobLedgerEntry.SETRANGE("Job No.","No.");
      //Job.GET(ProjNo);
      IF "Single/Main/Sub Project"="Single/Main/Sub Project"::"Main Project" THEN
        JobLedgerEntry.SETRANGE("Main Project No.","No.")
      ELSE
        JobLedgerEntry.SETRANGE("Job No.","No.");

      IF DateFilter <> '' THEN
        JobLedgerEntry.SETFILTER("Posting Date",DateFilter);
      IF JobLedgerEntry.FIND('-') THEN REPEAT
        ProjBalance -= JobLedgerEntry."Total Cost (LCY)" + JobLedgerEntry."Total Price (LCY)";
        IF JobLedgerEntry."Cost Type" = JobLedgerEntry."Cost Type"::Labor THEN
          Hours += JobLedgerEntry.Quantity;
        IF JobLedgerEntry."Cost Type" = JobLedgerEntry."Cost Type"::Revenues THEN
          Revenue -= JobLedgerEntry."Total Price (LCY)";
      UNTIL JobLedgerEntry.NEXT=0;

      IF Hours <> 0 THEN
        ProfitHour := ROUND(ProjBalance / Hours,1,'=');

      IF Revenue <> 0 THEN
        ProfitPct:=ROUND((100 * (ProjBalance / Revenue)),0.01,'=');

      IF ProfitPct<0 THEN
        NegBal:=TRUE
      ELSE
        NegBal:=FALSE;

      IF ProfitHour<0 THEN
        NegBal2:=TRUE
      ELSE
        NegBal2:=FALSE;

      IF ProjBalance<0 THEN
        NegBal3:=TRUE
      ELSE
        NegBal3:=FALSE;


      //Progdate:=0D;
      //ProgFixed:=FALSE;
      PrognosisRec.SETRANGE("Project No.","No.");
      IF PrognosisRec.FINDLAST THEN BEGIN
        //Progdate:=PrognosisRec."Prognosis Date";
        //ProgFixed:=PrognosisRec.Fixed;
      END ELSE
        CLEAR(PrognosisRec);
        //PrognosisRec."Prognosis Date":=0D;
        //PrognosisRec.Fixed:=false;
    END;

    LOCAL PROCEDURE GetPrognosisTB@1100285000() : Decimal;
    VAR
      Prognosis@1100285000 : Record 11012034;
    BEGIN
      //>>160607 ITERO.SB RAD-005 Added function GetPrognosisTB (show prognosis margin in project list)

      Prognosis.SETRANGE("Project No.", "No.");
      IF Prognosis.FINDLAST THEN BEGIN
        Prognosis.CALCFIELDS("Prognosis Revenue","Prognosis Total Cost");
        IF Prognosis."Prognosis Revenue"<>0 THEN
          EXIT(((Prognosis."Prognosis Revenue"-Prognosis."Prognosis Total Cost")/Prognosis."Prognosis Revenue")*100)
        ELSE
          EXIT(0);
      END ELSE
        EXIT(0);

      //<<
    END;

    BEGIN
    {
      4PS
      - two buttons (Prices and Planning) removed.
      - 23-02-10 DocumentButton added for intercompany projects
      4PS01 MMA 20100412
        Function added GetSelectionFilter
      4PS, 02-01-2014, C011191, Action 'Card' added.
      IMSE-041  -Itero
      LP 130704 4PSSE Added new action for "Create Sub Project".
      140325, ITERO.DL, ENH-025, added "Settlement Method", visible =no
      140612, ITERO.DL, removed all FlowFields due to performance and 1 CALCFIELDS(Revenues)
            (Re)Print Option List
            Budgetted Options in Order
            Contract Amount
            Invoiced Price
            Name Buyer Contact
            Name Estimator
            Name Project Engineer
            Name Project Manager
            Name Purchaser
            Name Site Manager
            Number of Options in Order
            Number of Options Open
            Principal Name
            Urgency Description
            Revenues
      ITERO.WG 4PS-042 140711 Added page acion OpenProjectControlSummarized and OpenProjectControlOverview
      160607 ITERO.SB RAD-005 Added function GetPrognosisTB (show prognosis margin in project list)
      160921 ITERO.SB RAD-029, RAD-030, RAD-030
    }
    END.
  }
}

