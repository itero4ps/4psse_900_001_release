OBJECT Page 11229520 Major Maint. and Renovation
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS9.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Major Maintenance and Renovation;
    SaveValues=Yes;
    SourceTable=Table11072003;
    PopulateAllFields=Yes;
    SourceTableView=WHERE(Maintenance And Renovation=CONST(Yes));
    PageType=Card;
    PromotedActionCategoriesML=ENU=New,Process,Report,Commission,Budget,Control,Purchase,Documents;
    OnInit=BEGIN
             CurrencyCodeEditable := TRUE;
             InvoiceCurrencyCodeEditable := TRUE;

             RentalUnitInvoiceByEnabled := TRUE;
             JobInventoryByStockReleaseEnab := TRUE;
             JobInventoryLocationShelfEnabl := TRUE;
             VATIndicatorPurchaseEditable := TRUE;
             "Joint CompanyEditable" := TRUE;
             DisableExportLosaCOBRAVisible := TRUE;
             MapPointVisible := TRUE;
             "Main ProjectEditable" := TRUE;
             "Affiliation No.Editable" := TRUE;
             CalculateBAmountsbasedonEditab := TRUE;
             "% to B AccountEditable" := TRUE;
             "% LaborEditable" := TRUE;
             "Revision RuleEditable" := TRUE;
             "Progress RegistryEditable" := TRUE;
             ProgressRegistryPTEEditable := TRUE;
             "Technical Finished DateEditabl"  := TRUE;
           END;

    OnOpenPage=BEGIN
                 MapPointVisible := (FALSE);
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 ProjSetUp.GET;
                 "Joint CompanyEditable" := (ProjSetUp."Company Type" = ProjSetUp."Company Type"::"Development Company");
                 DisableExportLosaCOBRAVisible :=
                   (ProjSetUp."Exchange Salary Application" AND (ProjSetUp."Salary Application" = ProjSetUp."Salary Application"::"LOSA-Cobra"));
                 RentalUnitInvoiceByEnabled := ProjSetUp."Rental Units active";
                 IF PurchSetup.GET THEN BEGIN
                   VATIndicatorPurchaseEditable := (PurchSetup."VAT Indicator (Purchase)" =
                   PurchSetup."VAT Indicator (Purchase)"::"No VAT");
                   //CurrPage."VAT Indicator (Purchase)".VISIBLE(GLSetup."VAT Indicator (Purchase)" = GLSetup."VAT Indicator (Purchase)"::"No VAT")
                 END;

                 RentalUnitInvoiceByEnabled := ProjSetUp."Rental Units active";

                 InventSetupRec.GET;
                 IF InventSetupRec."Level Job Inventory Loc./Shelf" <> InventSetupRec."Level Job Inventory Loc./Shelf"::Project THEN
                   JobInventoryLocationShelfEnabl := FALSE;
                 IF InventSetupRec."Level Job Inventory Stock Rel." <> InventSetupRec."Level Job Inventory Stock Rel."::Project THEN
                   JobInventoryByStockReleaseEnab := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       OptionRec.RESET;
                       OptionRec.SETCURRENTKEY("Main Project No.","Project No.", "Plot No.", Status);
                       OptionRec.SETRANGE("Project No.","No.");
                       OptionRec.SETFILTER(Status,'<%1', OptionRec.Status::Order);
                       OptionRec.SETFILTER("Offering Date",'<>%1', 0D);
                       OptionRec.SETFILTER("End Open Offer Term",'<%1', TODAY);
                       "Offers Expired" := OptionRec.FINDFIRST;


                       CALCFIELDS(Prospect);
                       "Progress RegistryEditable" := (NOT "Progress on base of Tender");
                       ProgressRegistryPTEEditable := ("Progress on base of Tender");

                       OnAfterGetCurrRecord;
                     END;

    OnNewRecord=BEGIN
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                  OnAfterGetCurrRecord; //**4PS.n
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1210190001;1 ;ActionGroup;
                      CaptionML=ENU=Project }
      { 1100525001;2 ;Action    ;
                      CaptionML=ENU=Project;
                      RunObject=Page 11072003;
                      RunPageOnRec=Yes;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Prepayment;
                      PromotedCategory=Process }
      { 1100528201;2 ;Action    ;
                      CaptionML=ENU=Settlement Quantities;
                      RunObject=Page 11229511;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Quote;
                      PromotedCategory=Process }
      { 1100528214;2 ;Action    ;
                      CaptionML=ENU=Project Options;
                      RunObject=Page 11229530;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CustomerList;
                      PromotedCategory=Process }
      { 1210190017;2 ;Action    ;
                      CaptionML=ENU=House Models;
                      RunObject=Page 11229541;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ApplyTemplate;
                      OnAction=VAR
                                 lvHouseModelRec@1100525000 : Record 11012501;
                               BEGIN
                                 TESTFIELD("No.");
                                 lvHouseModelRec.FILTERGROUP(9);
                                 lvHouseModelRec.SETRANGE("Project No.", "No.");
                                 lvHouseModelRec.FILTERGROUP(0);
                                 PAGE.RUNMODAL(PAGE::"House Models by Project List", lvHouseModelRec);
                               END;
                                }
      { 1210190014;2 ;Action    ;
                      CaptionML=ENU=Main Groups;
                      RunObject=Page 11012543;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CustomerGroup }
      { 1210190015;2 ;Action    ;
                      CaptionML=ENU=Groups;
                      RunObject=Page 11012518;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CustomerGroup }
      { 1210190016;2 ;Action    ;
                      CaptionML=ENU=Sub Groups;
                      RunObject=Page 11012542;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CustomerGroup }
      { 1210190003;2 ;Action    ;
                      CaptionML=ENU=Plots;
                      RunObject=Page 11229529;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AddToHome;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1100528228;2 ;Action    ;
                      CaptionML=ENU=Plot Recording Matrix;
                      RunObject=Page 11229536;
                      RunPageView=SORTING(Project No.,Plot No.,Phase,Recording Date,Seq. No.)
                                  ORDER(Ascending)
                                  WHERE(Plot No.=FILTER(''));
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=TaskList;
                      PromotedCategory=Process }
      { 1100528416;1 ;ActionGroup;
                      CaptionML=ENU=Commission & Invoicing }
      { 1100528415;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+P;
                      CaptionML=ENU=Principals;
                      Promoted=Yes;
                      Image=TeamSales;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ProjPrincipRec@1100528200 : Record 11012005;
                               BEGIN
                                 ProjPrincipRec.RESET;
                                 ProjPrincipRec.SETRANGE("Project No.","No.");
                                 IF "Bill-to Customer No." <> '' THEN
                                   IF NOT ProjPrincipRec.GET("No.","Bill-to Customer No.") THEN
                                     ProjPrincipRec.SETRANGE(Principal,"Bill-to Customer No.");
                                 PAGE.RUN(PAGE::"Project Principal List",ProjPrincipRec);
                               END;
                                }
      { 1100528414;2 ;Action    ;
                      CaptionML=ENU=&Installments;
                      RunObject=Page 11012025;
                      RunPageView=SORTING(Project No.,Principal,Installment No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=AmountByPeriod;
                      PromotedCategory=Category4 }
      { 1100528413;2 ;Action    ;
                      ShortCutKey=Ctrl+M;
                      CaptionML=ENU=&Extensions;
                      RunObject=Page 11012014;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=TransferFunds;
                      PromotedCategory=Category4 }
      { 1100528421;2 ;Action    ;
                      CaptionML=ENU=Settlement Sheet;
                      Image=Calculate;
                      OnAction=VAR
                                 SettlementSheet@1100409000 : Record 11012021;
                                 Counter@1100409001 : Integer;
                               BEGIN
                                 TESTFIELD("Bill-to Customer No.");

                                 SettlementSheet.RESET;
                                 SettlementSheet.SETRANGE("Project No.", "No.");
                                 Counter := SettlementSheet.COUNT;
                                 IF Counter > 0 THEN BEGIN
                                   PAGE.RUNMODAL(PAGE::"Settlement Sheet List", SettlementSheet);
                                 END ELSE BEGIN
                                   IF Counter = 0 THEN BEGIN
                                     IF CONFIRM(Text11012007,TRUE) THEN BEGIN
                                       InsertSettlementSheet("Bill-to Customer No.");
                                       COMMIT;
                                       IF SettlementSheet.FINDFIRST THEN
                                         PAGE.RUNMODAL(PAGE::"Settlement Sheet List", SettlementSheet);
                                     END;
                                   END;
                                 END;
                               END;
                                }
      { 1100528420;2 ;Action    ;
                      CaptionML=ENU=&Cost Plus Entries;
                      RunObject=Page 11012043;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=ApplyEntries }
      { 1100528419;2 ;Action    ;
                      CaptionML=ENU=&Installments;
                      RunObject=Page 11012025;
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      Image=AmountByPeriod;
                      PromotedCategory=Category4 }
      { 1100528418;2 ;Action    ;
                      CaptionML=ENU=In&voices;
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 ShowPostedInvoices;
                               END;
                                }
      { 1100528417;2 ;Action    ;
                      CaptionML=ENU=Credit &Memos;
                      Promoted=No;
                      Image=CreditMemo;
                      OnAction=BEGIN
                                 ShowPostedCreditMemos;
                               END;
                                }
      { 1100528227;1 ;ActionGroup;
                      CaptionML=ENU=Budget;
                      Image=Administration }
      { 1100528226;2 ;Action    ;
                      ShortCutKey=Ctrl+B;
                      CaptionML=ENU=Budget;
                      RunObject=Page 11012003;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=LedgerBudget;
                      PromotedCategory=Category5 }
      { 1100528225;2 ;Action    ;
                      CaptionML=ENU=Budget &Adjustments;
                      Promoted=Yes;
                      Image=Balance;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 BudgetAdjustment@1100525000 : Record 11012003;
                               BEGIN
                                 BudgetAdjustment.SETRANGE("Project No.", "No.");
                                 IF BudgetAdjustment.FINDLAST THEN;
                                   PAGE.RUNMODAL(PAGE::"Budget Adjustment List", BudgetAdjustment);
                               END;
                                }
      { 1100528423;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+T;
                      CaptionML=ENU=Total Budget;
                      RunObject=Page 11012005;
                      RunPageView=SORTING(Project No.,Element,Line No.);
                      RunPageLink=Project No.=FIELD(No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=LedgerBudget;
                      PromotedCategory=Category5 }
      { 1100528224;2 ;ActionGroup;
                      CaptionML=ENU=Rates Cost Prices;
                      Image=CostAccounting }
      { 1100528223;3 ;Action    ;
                      CaptionML=ENU=Project Budget Rates;
                      RunObject=Page 11020264;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=LedgerBudget }
      { 1100528222;3 ;Action    ;
                      CaptionML=ENU=Project - Employee Cost Prices;
                      RunObject=Page 11020300;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Employee }
      { 1100528221;3 ;Action    ;
                      CaptionML=ENU=Project - Employee - Wage Component Cost Prices;
                      RunObject=Page 11072435;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100528220;3 ;Action    ;
                      CaptionML=ENU=Project - Cost Object Cost Prices;
                      RunObject=Page 11072434;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=CostAccountingDimensions }
      { 1100528219;3 ;Action    ;
                      CaptionML=ENU=Project - Trade Association Cost Prices;
                      RunObject=Page 11072432;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Union }
      { 1100528218;3 ;Action    ;
                      CaptionML=ENU=Project - Trade Association - Wage Component Cost Prices;
                      RunObject=Page 11072433;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=WageLines }
      { 1100528217;2 ;ActionGroup;
                      CaptionML=ENU=More..;
                      Image=Navigate }
      { 1100528216;3 ;Action    ;
                      CaptionML=ENU=Project Cost Objects;
                      RunObject=Page 11012128;
                      RunPageLink=Project No.=FIELD(No.);
                      Image=Dimensions }
      { 1100525002;1 ;ActionGroup;
                      CaptionML=ENU=Additional Data;
                      Image=Worksheets }
      { 1100525000;2 ;Action    ;
                      CaptionML=ENU=Doc&uments;
                      Promoted=Yes;
                      Image=Documents;
                      PromotedCategory=Category8;
                      OnAction=VAR
                                 DocumentFilters@1100525001 : Codeunit 11012432;
                                 RecRef@1100525002 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 // ByCompany changed to FALSE, otherwise documents are not showed in the archive company
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Global Dimension 1 Code", FALSE, FALSE);
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1100528425;1 ;ActionGroup;
                      CaptionML=ENU=Invoicing;
                      Image=Invoice }
      { 1100528212;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Cost Plus;
                      Image=Invoice;
                      OnAction=VAR
                                 Job@1210190001 : Record 11072003;
                               BEGIN
                                 Job := Rec;
                                 Job.SETRECFILTER;
                                 REPORT.RUN(REPORT::"MMR Create Project Cost Plus", TRUE, FALSE, Job);
                               END;
                                }
      { 1100528422;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Invoices;
                      Image=Invoice;
                      OnAction=VAR
                                 Job@1210190001 : Record 11072003;
                               BEGIN
                                 // jhoek.270611.begin: melding 16372
                                 // ProjPrincipRec.SETRANGE("Project No.","No.");
                                 // REPORT.RUN(REPORT::"Create Project Invoices",TRUE,FALSE,ProjPrincipRec);
                                 Job := Rec;
                                 Job.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Create Project Invoices", TRUE, FALSE, Job);
                                 // jhoek.270611.end
                               END;
                                }
      { 1210190011;1 ;ActionGroup;
                      CaptionML=ENU=F&unctions }
      { 1100528211;2 ;Action    ;
                      CaptionML=ENU=Copy House Models and Groups;
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 lvCopyBuyerMgtDataRpt@1210190000 : Report 11012526;
                               BEGIN
                                 TESTFIELD("No.");
                                 lvCopyBuyerMgtDataRpt.SetDefaults("No.", TRUE, TRUE, TRUE, TRUE);
                                 lvCopyBuyerMgtDataRpt.RUNMODAL;
                               END;
                                }
      { 1100528209;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Copy Settlement Quantitiess;
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 CopyProjectSettlementQuanti@1210190000 : Page 11229521;
                               BEGIN
                                 CopyProjectSettlementQuanti.SetDefaults("No.",'','','');
                                 CopyProjectSettlementQuanti.StdDialogRunModal;
                               END;
                                }
      { 1100528210;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Copy Options;
                      Promoted=Yes;
                      Image=Copy;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 lvCopyProjOptionsFrm@1210190000 : Page 11012544;
                               BEGIN
                                 lvCopyProjOptionsFrm.SetDefaults("No.",'','','','','','','');
                                 lvCopyProjOptionsFrm.StdDialogRunModal;
                               END;
                                }
      { 1100528200;2 ;Action    ;
                      CaptionML=ENU=Import Plot Data;
                      Promoted=No;
                      PromotedIsBig=Yes;
                      Image=Import;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 lvPlot@1100528200 : Record 11012500;
                               BEGIN
                                 TESTFIELD("No.");
                                 lvPlot.SETRANGE("Project No.","No.");
                                 XMLPORT.RUN(XMLPORT::"Import PLot Major Maintenance", TRUE, FALSE, lvPlot);
                               END;
                                }
      { 1100528204;  ;ActionContainer;
                      ActionContainerType=Reports }
      { 1100528202;1 ;ActionGroup;
                      CaptionML=ENU=Project }
      { 1100528203;2 ;Action    ;
                      CaptionML=ENU=Site Tasks List;
                      Promoted=No;
                      Image=List;
                      PromotedCategory=Report;
                      OnAction=VAR
                                 PlotRec@1100525000 : Record 11012500;
                                 PlotTaskList@1100525001 : Report 11071709;
                               BEGIN
                                 PlotRec.SETRANGE("Project No.", "No.");
                                 PlotTaskList.SETTABLEVIEW(PlotRec);
                                 PlotTaskList.RUNMODAL;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1210190040;1;Group  ;
                CaptionML=ENU=General }

    { 1210190000;2;Field  ;
                CaptionML=ENU=Project No.;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1210190018;2;Field  ;
                SourceExpr=Description }

    { 1100528412;2;Field  ;
                SourceExpr="Description 2" }

    { 1100528411;2;Field  ;
                SourceExpr="Settlement Method";
                OnValidate=BEGIN
                             SettlementMethodOnAfterValidat;
                           END;
                            }

    { 1100528410;2;Field  ;
                SourceExpr="Contract Type";
                Visible=TRUE;
                OnValidate=BEGIN
                             ContractTypeOnAfterValidate;
                           END;
                            }

    { 1100528409;2;Field  ;
                SourceExpr="Bill-to Customer No.";
                Importance=Promoted;
                OnValidate=BEGIN
                             CALCFIELDS(Prospect);
                           END;

                OnLookup=BEGIN
                           //**4PS
                           CurrPage.SAVERECORD;
                           COMMIT;
                           LookupProjectPrincipal;
                           CurrPage.UPDATE;
                         END;
                          }

    { 1100528408;2;Field  ;
                DrillDown=No;
                SourceExpr="Principal Name";
                Importance=Promoted;
                Editable=FALSE }

    { 1100528407;2;Field  ;
                SourceExpr="Project Address Code";
                Importance=Additional }

    { 1100528406;2;Field  ;
                CaptionML=ENU=Number of Addresses;
                SourceExpr=NumAdrs;
                Importance=Additional;
                Editable=FALSE }

    { 1100528404;2;Field  ;
                SourceExpr=Address;
                Editable=TRUE }

    { 1100528405;2;Field  ;
                SourceExpr="Address 2" }

    { 1100528402;2;Field  ;
                SourceExpr="Post Code";
                Editable=TRUE }

    { 1100528403;2;Field  ;
                SourceExpr=City;
                Editable=TRUE }

    { 1100528400;2;Field  ;
                SourceExpr="Country/Region Code" }

    { 1100528401;2;Field  ;
                SourceExpr="Phone No." }

    { 1100528398;2;Field  ;
                SourceExpr="Fax No.";
                Importance=Additional }

    { 1100528399;2;Field  ;
                SourceExpr="Home Page";
                Importance=Additional }

    { 1100528397;2;Field  ;
                SourceExpr="Project Status";
                Importance=Promoted;
                OnValidate=BEGIN
                             TechnicalFinishedDateOnBeforeI;
                           END;
                            }

    { 1100528396;2;Field  ;
                SourceExpr="Search Description" }

    { 1100528207;2;Field  ;
                SourceExpr="Maintenance And Renovation" }

    { 1100528206;2;Field  ;
                SourceExpr="Summary Sheet MMR" }

    { 1100528208;2;Field  ;
                SourceExpr="Budget Level for Settl. Q." }

    { 1100528205;2;Field  ;
                SourceExpr="Plots Involved" }

    { 1100528395;2;Field  ;
                SourceExpr="Civil Engineering Project";
                Importance=Additional }

    { 1100528394;2;Field  ;
                SourceExpr=RAW;
                Importance=Additional }

    { 1100528393;2;Field  ;
                SourceExpr="Project Type";
                OnValidate=BEGIN
                             ProjectTypeOnAfterValidate;
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100528392;2;Field  ;
                SourceExpr="Allow Precl. R./Prov. Loss";
                Importance=Additional }

    { 1100528391;2;Field  ;
                SourceExpr="Preclosure Result";
                Importance=Additional }

    { 1100528390;2;Field  ;
                SourceExpr="Provision Loss";
                Importance=Additional }

    { 1100528389;2;Field  ;
                SourceExpr="Blocking Code";
                Importance=Additional }

    { 1100528388;2;Field  ;
                SourceExpr="Territory Code";
                Importance=Additional }

    { 1100528387;2;Field  ;
                SourceExpr=Type;
                Importance=Additional }

    { 1100528386;2;Field  ;
                SourceExpr=Discipline;
                Importance=Additional }

    { 1100528385;2;Field  ;
                SourceExpr="Global Dimension 1 Code";
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                           END;
                            }

    { 1100528384;2;Field  ;
                SourceExpr="Single/Main/Sub Project";
                OnValidate=BEGIN
                             SingleMainSubProjectOnAfterVal;
                           END;
                            }

    { 1100528383;2;Field  ;
                SourceExpr="Main Project";
                Editable="Main ProjectEditable" }

    { 1100528382;2;Field  ;
                SourceExpr="Interest WIP Cost";
                Importance=Additional }

    { 1100528381;2;Field  ;
                SourceExpr="Project Supplier";
                Importance=Additional }

    { 1100528380;2;Field  ;
                SourceExpr="VAT Indicator (Purchase)";
                Importance=Additional;
                Editable=VATIndicatorPurchaseEditable }

    { 1100528379;1;Group  ;
                CaptionML=ENU=Personnel }

    { 1100528378;2;Field  ;
                SourceExpr=Estimator;
                Importance=Standard;
                OnValidate=BEGIN
                             EstimatorOnAfterValidate;
                           END;
                            }

    { 1100528377;2;Field  ;
                SourceExpr="Name Estimator";
                Importance=Standard;
                Editable=FALSE }

    { 1100528376;2;Field  ;
                SourceExpr="Site Manager";
                OnValidate=BEGIN
                             SiteManagerOnAfterValidate;
                           END;
                            }

    { 1100528375;2;Field  ;
                SourceExpr="Name Site Manager";
                Importance=Standard;
                Editable=FALSE }

    { 1100528374;2;Field  ;
                SourceExpr="Project Manager";
                Importance=Promoted;
                OnValidate=BEGIN
                             ProjectManagerOnAfterValidate;
                           END;
                            }

    { 1100528373;2;Field  ;
                SourceExpr="Name Project Manager";
                Importance=Promoted;
                Editable=FALSE }

    { 1100528372;2;Field  ;
                SourceExpr="Project Engineer";
                OnValidate=BEGIN
                             ProjectEngineerOnAfterValidate;
                           END;
                            }

    { 1100528371;2;Field  ;
                SourceExpr="Name Project Engineer";
                Importance=Standard;
                Editable=FALSE }

    { 1100528370;2;Field  ;
                SourceExpr=Supervisor;
                Importance=Additional }

    { 1100528369;2;Field  ;
                SourceExpr="Name Supervisor";
                Importance=Additional;
                Editable=FALSE }

    { 1100528368;2;Field  ;
                SourceExpr=Buyercontact;
                Importance=Standard;
                OnValidate=BEGIN
                             BuyercontactOnAfterValidate;
                           END;
                            }

    { 1100528367;2;Field  ;
                SourceExpr="Name Buyer Contact";
                Importance=Standard;
                Editable=FALSE }

    { 1100528366;2;Field  ;
                SourceExpr="Purchaser Code";
                Importance=Additional }

    { 1100528365;2;Field  ;
                SourceExpr="Name Purchaser";
                Importance=Additional;
                Editable=FALSE }

    { 1100528364;2;Field  ;
                SourceExpr=Expediter;
                Importance=Additional;
                OnValidate=BEGIN
                             ExpediterOnAfterValidate;
                           END;
                            }

    { 1100528363;2;Field  ;
                SourceExpr="Name Expediter";
                Importance=Additional;
                Editable=FALSE }

    { 1100528362;2;Field  ;
                SourceExpr=Adviser;
                Importance=Additional;
                OnValidate=BEGIN
                             AdviserOnAfterValidate;
                           END;
                            }

    { 1100528361;2;Field  ;
                SourceExpr="Name Adviser";
                Importance=Additional;
                Editable=FALSE }

    { 1100528360;2;Field  ;
                SourceExpr="Salesperson Code";
                Importance=Additional }

    { 1100528359;2;Field  ;
                SourceExpr="Salesperson Name";
                Importance=Additional;
                Editable=FALSE }

    { 1100528358;1;Group  ;
                CaptionML=ENU=Budget }

    { 1100528357;2;Field  ;
                SourceExpr="Budget Fixed";
                Importance=Standard }

    { 1100528356;2;Field  ;
                SourceExpr="Version Date";
                Importance=Standard }

    { 1100528355;2;Field  ;
                SourceExpr="Prognosis Level";
                Importance=Additional }

    { 1100528354;2;Field  ;
                SourceExpr="Prognosis per Element";
                Importance=Additional }

    { 1100528353;2;Field  ;
                SourceExpr="Progress on base of Tender";
                Importance=Additional;
                OnValidate=BEGIN
                             ProgressonbaseofTenderOnAfterV;
                           END;
                            }

    { 1100528352;2;Field  ;
                SourceExpr="Progress Registry (PTE)";
                Importance=Additional;
                Editable=ProgressRegistryPTEEditable }

    { 1100528351;2;Field  ;
                SourceExpr="Progress Method";
                Importance=Additional }

    { 1100528350;2;Field  ;
                SourceExpr="Progress Registry";
                Importance=Additional;
                Editable="Progress RegistryEditable" }

    { 1100528349;2;Field  ;
                SourceExpr="Progress from Instal. Progress";
                Importance=Additional }

    { 1100528348;2;Field  ;
                SourceExpr="Default Rate Code";
                Importance=Additional }

    { 1100528347;2;Field  ;
                SourceExpr="Element per Installment";
                Importance=Additional }

    { 1100528346;2;Field  ;
                SourceExpr="Summary Sheet Project";
                Importance=Additional }

    { 1100528345;2;Field  ;
                SourceExpr="Summary Sheet Contract";
                Importance=Additional }

    { 1100528344;2;Field  ;
                SourceExpr="Summary Sheet Option";
                Importance=Additional }

    { 1100528343;2;Field  ;
                SourceExpr="Excl. from Project Control";
                Importance=Additional }

    { 1100528342;2;Field  ;
                CaptionML=ENU=Try-Out;
                SourceExpr=GetTryOut(1);
                Importance=Additional;
                OnLookup=BEGIN
                           ShowTryOut(1);
                         END;
                          }

    { 1100528341;2;Field  ;
                CaptionML=ENU=Try-Out Quote;
                SourceExpr=GetTryOut(2);
                Importance=Additional;
                OnLookup=BEGIN
                           ShowTryOut(2);
                         END;
                          }

    { 1100528340;2;Field  ;
                CaptionML=ENU=Estimate No.;
                SourceExpr=GetEstimate();
                Importance=Additional;
                OnLookup=BEGIN
                           //**4PS
                           ShowEstimate();
                         END;
                          }

    { 1100528339;2;Field  ;
                CaptionML=ENU=Service Location No.;
                SourceExpr=GetServiceLocation();
                Importance=Additional }

    { 1100528338;2;Field  ;
                SourceExpr="Created from Service Loc. No.";
                Importance=Additional }

    { 1100528337;2;Field  ;
                SourceExpr="Forecast Level";
                Importance=Additional }

    { 1100528336;1;Group  ;
                CaptionML=ENU=Dates }

    { 1100528335;2;Field  ;
                SourceExpr="Creation Date";
                Importance=Standard;
                Editable=FALSE }

    { 1100528334;2;Field  ;
                SourceExpr="Last Date Modified";
                Importance=Standard;
                Editable=FALSE }

    { 1100528333;2;Field  ;
                SourceExpr="Modified by";
                Importance=Standard }

    { 1100528332;2;Field  ;
                SourceExpr="Status Modification Date" }

    { 1100528331;2;Field  ;
                SourceExpr="Starting Date" }

    { 1100528330;2;Field  ;
                SourceExpr="Ending Date" }

    { 1100528329;2;Field  ;
                SourceExpr="Technical Finished Date";
                Editable="Technical Finished DateEDITABL" }

    { 1100528328;2;Field  ;
                SourceExpr="Posting Date Closing" }

    { 1100528327;2;Field  ;
                SourceExpr="Archive Location Documents";
                Importance=Additional;
                OnAssistEdit=BEGIN
                               AssistEditProjFolder;
                             END;
                              }

    { 1100528326;2;Field  ;
                SourceExpr="Archive Location";
                Importance=Additional }

    { 1100528325;2;Field  ;
                CaptionML=ENU=Liquidity Prognosis;
                SourceExpr="Liquidity Prognosis";
                Importance=Additional }

    { 1100528324;2;Field  ;
                SourceExpr="Language Code";
                Importance=Additional }

    { 1100528323;2;Field  ;
                SourceExpr=Blocked;
                Importance=Standard }

    { 1100528322;2;Field  ;
                SourceExpr="End Date Guarantee";
                Importance=Additional }

    { 1100528321;2;Field  ;
                SourceExpr="Element Fixed";
                Importance=Additional }

    { 1100528320;2;Field  ;
                SourceExpr="Posting Element Mandatory";
                Importance=Additional }

    { 1100528319;2;Field  ;
                SourceExpr="Project Planning Activities";
                Importance=Additional }

    { 1100528318;2;Field  ;
                SourceExpr="Available as Reference";
                Importance=Additional }

    { 1100528317;2;Field  ;
                SourceExpr="FSC Type Code";
                Importance=Additional }

    { 1100528316;2;Group  ;
                CaptionML=ENU=Default Data Purchase Action }

    { 1100528315;3;Field  ;
                SourceExpr="Requested Quote Receipt Date";
                Importance=Additional }

    { 1100528314;3;Field  ;
                SourceExpr="Vendors React before";
                Importance=Additional }

    { 1100528313;1;Group  ;
                CaptionML=ENU=Receipt }

    { 1100528312;2;Field  ;
                SourceExpr=Deliver;
                Importance=Promoted }

    { 1100528311;2;Field  ;
                SourceExpr="Ship To Location";
                Importance=Promoted }

    { 1100528310;2;Field  ;
                SourceExpr="Use Starting Date ProjectElem";
                Importance=Additional }

    { 1100528309;2;Field  ;
                SourceExpr="Job Inventory Location/Shelf";
                Importance=Additional;
                Enabled=JobInventoryLocationShelfEnabl }

    { 1100528308;2;Field  ;
                SourceExpr="Job Inventory By Stock Release";
                Importance=Additional;
                Enabled=JobInventoryByStockReleaseEnab }

    { 1100528307;2;Field  ;
                SourceExpr="Service Warranty Code";
                Importance=Additional }

    { 1100528306;1;Group  ;
                CaptionML=ENU=Invoicing }

    { 1100528305;2;Field  ;
                SourceExpr="Contract Amount";
                Importance=Promoted }

    { 1100528304;2;Field  ;
                SourceExpr="Plot Price";
                Importance=Additional }

    { 1100528303;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1100528302;2;Field  ;
                SourceExpr="Calculate B Amounts based on";
                Importance=Additional;
                Editable=CalculateBAmountsbasedonEditab }

    { 1100528301;2;Field  ;
                SourceExpr="% Labor";
                Importance=Additional;
                Editable="% LaborEditable" }

    { 1100528300;2;Field  ;
                SourceExpr="% to B Account";
                Importance=Additional;
                Editable="% to B AccountEditable" }

    { 1100528299;2;Field  ;
                SourceExpr="Affiliation No.";
                Importance=Additional;
                Editable="Affiliation No.Editable" }

    { 1100528298;2;Field  ;
                SourceExpr="SFB Code";
                Importance=Additional }

    { 1100528297;2;Field  ;
                SourceExpr="Location Type 1";
                Importance=Additional }

    { 1100528296;2;Field  ;
                SourceExpr="Location Type 2";
                Importance=Additional }

    { 1100528295;2;Field  ;
                SourceExpr="Print Manday Register" }

    { 1100528294;2;Field  ;
                SourceExpr="Invoice Layout Code" }

    { 1100528293;2;Field  ;
                SourceExpr="Rental Unit Invoice by";
                Importance=Additional;
                Enabled=RentalUnitInvoiceByEnabled }

    { 1100528292;2;Field  ;
                SourceExpr="Price List";
                Importance=Additional }

    { 1100528291;2;Field  ;
                SourceExpr="Ref. Date Unit Price";
                Importance=Additional }

    { 1100528290;2;Field  ;
                SourceExpr=Revision;
                Importance=Additional;
                OnValidate=BEGIN
                             RevisionOnAfterValidate;
                           END;
                            }

    { 1100528289;2;Field  ;
                SourceExpr="Revision Rule";
                Importance=Additional;
                Editable="Revision RuleEditable" }

    { 1100528288;2;Field  ;
                SourceExpr="Reference Date Revision";
                Importance=Additional }

    { 1100528287;2;Field  ;
                SourceExpr="Long Lease";
                Importance=Additional }

    { 1100528286;2;Field  ;
                SourceExpr="Internal Project";
                Importance=Additional }

    { 1100528285;2;Field  ;
                SourceExpr="Master Project";
                Importance=Additional }

    { 1100528284;2;Field  ;
                SourceExpr="Master Element";
                Importance=Additional }

    { 1100528283;2;Field  ;
                SourceExpr="Cost Object Inter Project Cost";
                Importance=Additional }

    { 1100528282;2;Field  ;
                SourceExpr="Cost Object Inter Project Rev";
                Importance=Additional }

    { 1100528281;2;Field  ;
                SourceExpr=Text;
                MultiLine=Yes }

    { 1100528280;1;Group  ;
                CaptionML=ENU=Buyer Management }

    { 1100528279;2;Field  ;
                SourceExpr="Housebuilding Project";
                Importance=Additional }

    { 1100528278;2;Field  ;
                SourceExpr="Due Date Plot";
                Importance=Additional }

    { 1100528277;2;Field  ;
                SourceExpr="Interest Before Contract Date";
                Importance=Additional }

    { 1100528276;2;Field  ;
                SourceExpr="Interest Before Transfer Date";
                Importance=Additional }

    { 1100528275;2;Field  ;
                SourceExpr="Payment Terms Code";
                Importance=Additional }

    { 1100528274;2;Field  ;
                SourceExpr="VAT Prod. P. Group Inst. Int.";
                Importance=Additional }

    { 1100528273;2;Field  ;
                SourceExpr="Public notary";
                Importance=Additional }

    { 1100528272;2;Field  ;
                SourceExpr="Method Last Installment";
                Importance=Additional }

    { 1100528271;2;Field  ;
                SourceExpr="Withhold %";
                Importance=Additional }

    { 1100528270;2;Field  ;
                SourceExpr="Budget Level for Options";
                Importance=Standard;
                OnValidate=BEGIN
                             BudgetLevelforOptionsOnAfterVa;
                           END;
                            }

    { 1100528269;2;Field  ;
                SourceExpr="Days Notify Buyer";
                Importance=Additional }

    { 1100528268;2;Field  ;
                SourceExpr="Days Repair Before";
                Importance=Additional }

    { 1100528267;2;Field  ;
                SourceExpr="Days Delayed Repair";
                Importance=Additional }

    { 1100528266;2;Field  ;
                SourceExpr="Days Notify Guarantee Fund";
                Importance=Additional }

    { 1100528265;2;Field  ;
                SourceExpr="Days End Service Period";
                Importance=Additional }

    { 1100528264;2;Field  ;
                SourceExpr="Guarantee Period";
                Importance=Additional }

    { 1100528263;2;Field  ;
                SourceExpr="Conveyance Tax";
                Importance=Additional }

    { 1100528262;2;Field  ;
                SourceExpr="Ready for Building Date";
                Importance=Additional }

    { 1100528261;1;Group  ;
                CaptionML=ENU=Integration;
                Visible=FALSE }

    { 1100528260;2;Field  ;
                SourceExpr="Joint Company";
                Importance=Additional;
                Editable="Joint CompanyEditable" }

    { 1100528259;2;Field  ;
                SourceExpr="Joint Job No.";
                Importance=Additional }

    { 1100528258;2;Field  ;
                SourceExpr="Options Sold By";
                Importance=Additional }

    { 1100528257;2;Field  ;
                SourceExpr="Disable Export Losa (COBRA)";
                Importance=Additional;
                Visible=DisableExportLosaCOBRAVisible }

    { 1100528256;2;Field  ;
                SourceExpr="SharePoint Phase";
                Importance=Additional }

    { 1100528255;2;Field  ;
                SourceExpr="SharePoint Status";
                Importance=Additional;
                Editable=FALSE }

    { 1100528254;2;Field  ;
                SourceExpr="Phase 1 Company";
                Importance=Additional }

    { 1100528253;2;Field  ;
                SourceExpr="Phase 2 Company";
                Importance=Additional }

    { 1100528252;2;Field  ;
                SourceExpr="Phase 3 Company";
                Importance=Additional }

    { 1100528251;2;Field  ;
                SourceExpr="Make SharePoint Site";
                Importance=Additional }

    { 1100528250;2;Field  ;
                SourceExpr="SharePoint Site Generated";
                Importance=Additional }

    { 1100528249;2;Field  ;
                SourceExpr="SharePoint Site URL";
                Importance=Additional }

    { 1100528248;2;Field  ;
                SourceExpr="Quote Subsite Generated";
                Importance=Additional }

    { 1100528247;2;Field  ;
                SourceExpr="Save Int. Doc In SharePoint";
                Importance=Additional }

    { 1100528246;1;Group  ;
                CaptionML=ENU=Price and Discount;
                Visible=FALSE }

    { 1100528245;2;Field  ;
                SourceExpr="Reference Date (Item)";
                Importance=Additional }

    { 1100528244;2;Field  ;
                SourceExpr="Reference Date (Customer)";
                Importance=Additional }

    { 1100528243;2;Field  ;
                SourceExpr="Reference Date (Company)";
                Importance=Additional }

    { 1100528242;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 0";
                Importance=Additional }

    { 1100528241;2;Field  ;
                SourceExpr="Purch Discount Term Group 1";
                Importance=Additional }

    { 1100528240;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 1";
                Importance=Additional }

    { 1100528239;2;Field  ;
                SourceExpr="Purch Discount Term Group 2";
                Importance=Additional }

    { 1100528238;2;Field  ;
                SourceExpr="Priority Purch Disc Term Grp 2";
                Importance=Additional }

    { 1100528237;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 0";
                Importance=Additional }

    { 1100528236;2;Field  ;
                SourceExpr="Sales Discount Term Group 1";
                Importance=Additional }

    { 1100528235;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 1";
                Importance=Additional }

    { 1100528234;2;Field  ;
                SourceExpr="Sales Discount Term Group 2";
                Importance=Additional }

    { 1100528233;2;Field  ;
                SourceExpr="Priority Sales Disc Term Grp 2";
                Importance=Additional }

    { 1100528232;0;Container;
                ContainerType=FactBoxArea }

    { 1100528231;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1100528230;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page11130124;
                PartType=Page }

    { 1100528229;1;Part   ;
                SubPageLink=Project No.=FIELD(No.);
                PagePartID=Page11130001;
                Visible=FALSE;
                PartType=Page }

    { 1100528215;1;Part   ;
                SubPageLink=Project No.=FIELD(No.),
                            Principal=FIELD(Bill-to Customer No.);
                PagePartID=Page11130104;
                Visible=FALSE;
                PartType=Page }

  }
  CODE
  {
    VAR
      Text11012099@1100485000 : TextConst 'ENU=" This function is not neccesary, it is automatically done when changing options to status to order, continue?"';
      OptionRec@1100528200 : Record 11012502;
      InvoiceCurrencyCodeEditable@1100528233 : Boolean INDATASET;
      CurrencyCodeEditable@1100528232 : Boolean INDATASET;
      ProjSetUp@1100528231 : Record 315;
      InventSetupRec@1100528230 : Record 313;
      ProjPrincipRec@1100528229 : Record 11012005;
      ProjRec@1100528228 : Record 11072003;
      RentalUnitRec@1100528227 : Record 11012940;
      ProjInstalmRec@1100528226 : Record 11012018;
      PurchSetup@1100528225 : Record 312;
      GenerateProjInstallm@1100528224 : Codeunit 11012007;
      PrintDoc@1100528223 : Codeunit 229;
      AdrsRec@1100528222 : Record 222;
      NumAdrs@1100528221 : Text[30];
      SharepointCU@1100528220 : Codeunit 11020210;
      SharepSetup@1100528219 : Record 11012730;
      DPA_IsHardFilter@1100528218 : Boolean;
      "Progress RegistryEditable"@1100528216 : Boolean INDATASET;
      ProgressRegistryPTEEditable@1100528215 : Boolean INDATASET;
      "Revision RuleEditable"@1100528214 : Boolean INDATASET;
      VATIndicatorPurchaseEditable@1100528213 : Boolean INDATASET;
      "% LaborEditable"@1100528212 : Boolean INDATASET;
      "% to B AccountEditable"@1100528211 : Boolean INDATASET;
      CalculateBAmountsbasedonEditab@1100528210 : Boolean INDATASET;
      "Affiliation No.Editable"@1100528209 : Boolean INDATASET;
      "Main ProjectEditable"@1100528208 : Boolean INDATASET;
      MapPointVisible@1100528207 : Boolean INDATASET;
      DisableExportLosaCOBRAVisible@1100528206 : Boolean INDATASET;
      "Joint CompanyEditable"@1100528205 : Boolean INDATASET;
      JobInventoryLocationShelfEnabl@1100528204 : Boolean INDATASET;
      JobInventoryByStockReleaseEnab@1100528203 : Boolean INDATASET;
      "Technical Finished DateEditabl"@1100528202 : Boolean INDATASET;
      RentalUnitInvoiceByEnabled@1100528201 : Boolean INDATASET;
      Text11012098@1100528238 : TextConst 'ENU=For this Project are no Sub Projects present';
      Text11012002@1100528237 : TextConst 'ENU=There are already Budget Lines of Options present. Build Budget for Options again ?';
      Text11012003@1100528236 : TextConst 'ENU=Field SharePoint Project Phase is empty.';
      Text11012006@1100528235 : TextConst 'ENU=A Sharepoint Site is alread made';
      Text11012007@1100528234 : TextConst 'ENU=Add Settlement Sheet ?';

    LOCAL PROCEDURE UpdChangedActCapacityByDay@1100528400();
    VAR
      RequestedActivCapbyDay@1100409000 : Record 11125709;
      RequestActivityCapacityMgt@1100528400 : Codeunit 11125707;
      AssignActivityCapacityMgt@1100528401 : Codeunit 11125708;
    BEGIN
      IF NOT RequestedActivCapbyDay.READPERMISSION THEN //call T000465
        EXIT;

      RequestActivityCapacityMgt.UpdAllReqActCapChangedByGPP;
      AssignActivityCapacityMgt.UpdAllAssActCapChangedByGPP;
    END;

    LOCAL PROCEDURE ProjectTypeOnAfterValidate@19063423();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE SingleMainSubProjectOnAfterVal@19021142();
    BEGIN
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE SettlementMethodOnAfterValidat@1100528201();
    BEGIN
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ContractTypeOnAfterValidate@1100528200();
    BEGIN
      CurrPage.UPDATE(TRUE);
      IF "Contract Type" = "Contract Type"::Maincontracting THEN BEGIN
        "% Labor" := 0;
        "% to B Account" := 0;
        "Affiliation No." := '';
      END;
    END;

    LOCAL PROCEDURE SiteManagerOnAfterValidate@19074057();
    BEGIN
      CALCFIELDS("Name Site Manager");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE EstimatorOnAfterValidate@19077849();
    BEGIN
      CALCFIELDS("Name Estimator");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE ProjectManagerOnAfterValidate@19053768();
    BEGIN
      CALCFIELDS("Name Project Manager");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE ProjectEngineerOnAfterValidate@19046031();
    BEGIN
      CALCFIELDS("Name Project Engineer");
      CurrPage.SAVERECORD;
    END;

    LOCAL PROCEDURE BuyercontactOnAfterValidate@19022691();
    BEGIN
      CALCFIELDS("Name Buyer Contact");
    END;

    LOCAL PROCEDURE ExpediterOnAfterValidate@19017853();
    BEGIN
      CALCFIELDS("Name Expediter");
    END;

    LOCAL PROCEDURE AdviserOnAfterValidate@19071762();
    BEGIN
      CALCFIELDS("Name Adviser");
    END;

    LOCAL PROCEDURE ProgressonbaseofTenderOnAfterV@19067467();
    BEGIN
      "Progress RegistryEditable" := (NOT "Progress on base of Tender");
      ProgressRegistryPTEEditable := ("Progress on base of Tender");
    END;

    LOCAL PROCEDURE RevisionOnAfterValidate@19054813();
    BEGIN
      "Revision RuleEditable" := (Revision);
    END;

    LOCAL PROCEDURE BudgetLevelforOptionsOnAfterVa@19031539();
    VAR
      lvBudgetLineRec@1210190000 : Record 11012001;
      lvProjRec@1210190002 : Record 11072003;
      lvCopyOptBudgToBudgetRpt@1210190003 : Report 11012500;
    BEGIN
      IF "Budget Level for Options" <> xRec."Budget Level for Options" THEN BEGIN
        lvBudgetLineRec.SETRANGE("Project No.", "No.");
        lvBudgetLineRec.SETRANGE(Adjustment, '');
        lvBudgetLineRec.SETRANGE("Extension Contract", '');
        lvBudgetLineRec.SETFILTER(Option, '<>%1', '');
        IF lvBudgetLineRec.FINDFIRST THEN BEGIN
          CurrPage.UPDATE(TRUE);
          COMMIT;
          IF CONFIRM(Text11012002, TRUE) THEN BEGIN
            lvProjRec.SETRANGE("No.", "No.");
            lvCopyOptBudgToBudgetRpt.SETTABLEVIEW(lvProjRec);
            lvCopyOptBudgToBudgetRpt.USEREQUESTPAGE(FALSE);
            lvCopyOptBudgToBudgetRpt.RUNMODAL;
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE OnAfterGetCurrRecord@19077479();
    VAR
      RecRef@1100528700 : RecordRef;
    BEGIN
      xRec := Rec;

      NumAdrs := AdrsRec.CheckAvailableAddress("Bill-to Customer No.", 2);  //db, 21-12-06

      "% LaborEditable" := ("Contract Type" = "Contract Type"::Subcontracting);
      "% to B AccountEditable" := ("Contract Type" = "Contract Type"::Subcontracting);
      CalculateBAmountsbasedonEditab := ("Contract Type" = "Contract Type"::Subcontracting);
      "Affiliation No.Editable" := ("Contract Type" = "Contract Type"::Subcontracting);
      "Main ProjectEditable" := ("Single/Main/Sub Project" = "Single/Main/Sub Project"::"Sub Project");

      "Revision RuleEditable" := (Revision);

      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(FALSE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Global Dimension 1 Code");

      TechnicalFinishedDateOnBeforeI;
      CALCFIELDS(Prospect);
    END;

    LOCAL PROCEDURE AdviserOnAfterInput@19037857(VAR Text@19037858 : Text[1024]);
    BEGIN
      CALCFIELDS("Name Adviser");
    END;

    LOCAL PROCEDURE TechnicalFinishedDateOnBeforeI@19050996();
    BEGIN
      "Technical Finished DateEditabl" := (
        ("Project Status" = "Project Status"::"Technical Finished") OR
        ("Project Status" = "Project Status"::"Administrative Finished"));
    END;

    BEGIN
    END.
  }
}

