OBJECT Page 12013610 EX Document Line Approvers
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EXF350000;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=ENU=Approver Lines;
    SourceTable=Table12013610;
    DelayedInsert=Yes;
    PageType=ListPart;
    OnNewRecord=VAR
                  TempNo@1100285001 : Integer;
                BEGIN
                  //342534
                  FILTERGROUP := 4;
                  CLEAR(TempNo);
                  IF EVALUATE(TempNo, GETFILTER("Document Line ID")) THEN;
                  FILTERGROUP := 0;
                  "Document Line ID" := TempNo;
                  InitRecord(xRec,BelowxRec);
                  //342534
                END;

    OnInsertRecord=BEGIN
                     //342508
                     IsUserAllowedToChange(0);
                     //342508

                     //340338
                     InsertDimension;
                     //340338
                   END;

    OnModifyRecord=BEGIN
                     //342508
                     IsUserAllowedToChange(1);
                     //342508
                   END;

    OnDeleteRecord=BEGIN
                     //342508
                     IsUserAllowedToChange(2);
                     //342508
                   END;

    ActionList=ACTIONS
    {
      { 1100285008;  ;ActionContainer;
                      Name=<Action1100285006>;
                      ActionContainerType=ActionItems }
      { 1100285004;1 ;ActionGroup;
                      Name=Line;
                      CaptionML=ENU=&Line;
                      ActionContainerType=NewDocumentItems }
      { 1100285002;2 ;Action    ;
                      Name=<Action1100285007>;
                      CaptionML=ENU=Restart route;
                      OnAction=BEGIN
                                 RestartDocLine;
                               END;
                                }
      { 1100285006;2 ;Action    ;
                      CaptionML=ENU=Complete;
                      OnAction=BEGIN
                                 IF ExFlow.IsUserSuperior(COMPANYNAME,USERID) THEN
                                   FinishDocLine;
                               END;
                                }
      { 1100285010;2 ;Action    ;
                      CaptionML=ENU=Dimension;
                      OnAction=BEGIN
                                 ShowLineDimension;
                               END;
                                }
      { 1100285012;2 ;Action    ;
                      CaptionML=ENU=Hold/Release Approver;
                      OnAction=BEGIN
                                 HoldApprover;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100285000;1;Group  ;
                GroupType=Repeater }

    { 1100285014;2;Field  ;
                SourceExpr="Approver Order";
                Visible=FALSE }

    { 1100285001;2;Field  ;
                SourceExpr=Approver;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                           END;

                OnAssistEdit=BEGIN
                               ChangeTemplate;
                               CurrPage.UPDATE;
                             END;
                              }

    { 1100285003;2;Field  ;
                DrillDown=No;
                SourceExpr="Approver Name";
                Editable=FALSE }

    { 1100285009;2;Field  ;
                SourceExpr=Comment }

    { 1100285005;2;Field  ;
                SourceExpr="Approval Date";
                Editable=FALSE }

    { 1100285007;2;Field  ;
                SourceExpr="Approved By";
                Editable=FALSE }

    { 1100285011;2;Field  ;
                SourceExpr=Flowstatus;
                Editable=FALSE }

    { 1100285017;2;Field  ;
                SourceExpr=ID;
                Visible=FALSE }

    { 1100285013;2;Field  ;
                SourceExpr="Document Line ID";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      ExFlow@1100285001 : Codeunit 12013601;
      Cu609@1100285003 : Codeunit 12013609;

    PROCEDURE RestartDocLine@1100285000();
    VAR
      DocLine@1100285001 : Record 12013609;
    BEGIN
      IF DocLine.RetrieveRecord(DocLine,"Company Name","Document Type","Document No.","Line No.") THEN
        DocLine.RestartApprover(DocLine,"Approver Order");

      CurrPage.UPDATE;
    END;

    PROCEDURE FinishDocLine@1100285001();
    VAR
      DocLine@1100285000 : Record 12013609;
    BEGIN
      IF DocLine.RetrieveRecord(DocLine,"Company Name","Document Type","Document No.","Line No.") THEN
        DocLine.FinishApprover(DocLine);

      CurrPage.UPDATE;
    END;

    PROCEDURE ApproverForm@1000000000();
    VAR
      DocLine@1000000001 : Record 12013609;
    BEGIN
      DocLine.RESET;
      DocLine.SETRANGE("Company Name",COMPANYNAME);
      DocLine.SETRANGE("Document Type","Document Type");
      DocLine.SETRANGE("Document No.","Document No.");
      DocLine.SETRANGE("Line No.","Line No.");
      IF "Line No." <> 0 THEN
        DocLine.RetrieveRecord(DocLine,COMPANYNAME,"Document Type","Document No.","Line No.")
      ELSE
        IF DocLine.FIND('-') THEN;

      PAGE.RUNMODAL(12013609,DocLine);
    END;

    PROCEDURE CopyApprovers@1100285006();
    VAR
      DocLine@1100285000 : Record 12013609;
    BEGIN
      DocLine.RetrieveRecord(DocLine,"Company Name","Document Type","Document No.","Line No.");
      DocLine.CopyApprover(DocLine);
    END;

    PROCEDURE ShowLineDimension@1100285002();
    BEGIN
      Cu609.ShowDocLineDim("Document Type", "Document No.", "Line No.");
    END;

    PROCEDURE TestApprove@1100285004();
    VAR
      DocHead@1100285000 : Record 12013608;
    BEGIN
      IF Flowstatus <> Flowstatus::Current THEN
        EXIT;

      "Approval Date" := CREATEDATETIME(WORKDATE, 0T);

      "Approved By" := USERID;
      Flowstatus := Flowstatus::Approved;
      MODIFY(TRUE);
      ApprovalStatus(Rec,'Update');
      DocHead.RetrieveRecord(DocHead,"Company Name","Document Type","Document No.");
    END;

    PROCEDURE Dump@1100285005();
    VAR
      DocumentLine@1100285000 : Record 12013609;
    BEGIN
      DocumentLine.RESET;
      DocumentLine.SETRANGE("Company Name","Company Name");
      DocumentLine.SETRANGE("Document Type","Document Type");
      DocumentLine.SETRANGE("Document No.","Document No.");
      DocumentLine.SETRANGE("Line No.","Line No.");
      PAGE.RUN(12013651,DocumentLine);
    END;

    PROCEDURE HoldApprover@1100285003();
    VAR
      DocLine@1100285000 : Record 12013609;
    BEGIN
      IF (Flowstatus <> Flowstatus::Current) AND (Flowstatus <> Flowstatus::"On hold") THEN
        EXIT;

      DocLine.HoldLine(Rec);
    END;

    BEGIN
    END.
  }
}

