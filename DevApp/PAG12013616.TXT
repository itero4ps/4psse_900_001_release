OBJECT Page 12013616 Line changes
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EXF350003;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Line changes;
    SourceTable=Table12013609;
    PageType=Card;
    OnInit=BEGIN
             "Periodic Starting DateEditable" := TRUE;
             "Periodic Template CodeEditable" := TRUE;
             "Job No.Editable" := TRUE;
           END;

    OnOpenPage=VAR
                 Account@1100285003 : Record 15;
                 Fixed@1100285002 : Record 5600;
                 Item@1100285001 : Record 27;
                 Charge@1100285000 : Record 5800;
                 ExReqToQuote@1100285004 : Codeunit 12013614;
               BEGIN
                 IF NOT PurchLine.GET("Document Type", "Document No.", "Line No.") THEN
                   CLEAR(PurchLine);

                 //Col := ExFlow.GetColumnID('JOB');
                 //IF Col = 0 THEN
                 //  "Job No.Editable" := FALSE;

                 //Col := ExFlow.GetColumnID('PERCODE');
                 //IF Col = 0 THEN
                 //  BEGIN
                 //    "Periodic Template CodeEditable" := FALSE;
                 //    "Periodic Starting DateEditable" := FALSE;
                 //  END;

                 // Get changes
                 IF Description = '' THEN BEGIN
                 IF DocLineDim.RetrieveRecord(DocLineDim,COMPANYNAME, "Document Type", "Document No.", "Line No.", 'G_LACCOUNT') THEN
                   BEGIN
                     "No." := DocLineDim."Dimension Value";
                     IF Account.GET("No.") THEN
                       Description := Account.Name;
                   END;

                 IF DocLineDim.RetrieveRecord(DocLineDim,COMPANYNAME, "Document Type", "Document No.", "Line No.", 'ITEM') THEN
                   BEGIN
                     "No." := DocLineDim."Dimension Value";
                     IF Item.GET("No.") THEN
                       Description := Item.Description;
                   END;

                 IF DocLineDim.RetrieveRecord(DocLineDim,COMPANYNAME, "Document Type", "Document No.", "Line No.", 'CHARGE') THEN
                   BEGIN
                     "No." := DocLineDim."Dimension Value";
                     IF Charge.GET("No.") THEN
                       Description := Charge.Description;
                   END;

                 IF DocLineDim.RetrieveRecord(DocLineDim,COMPANYNAME, "Document Type", "Document No.", "Line No.", 'FIXEDASSET') THEN
                   BEGIN
                     "No." := DocLineDim."Dimension Value";
                     IF Fixed.GET("No.") THEN
                       Description := Fixed.Description;
                   END;
                 END;

                 IF DocLineDim.RetrieveRecord(DocLineDim,COMPANYNAME, "Document Type", "Document No.", "Line No.", 'JOB') THEN
                   "Job No." := DocLineDim."Dimension Value";

                 IF DocLineDim.RetrieveRecord(DocLineDim,COMPANYNAME, "Document Type", "Document No.", "Line No.", 'PERCODE') THEN
                   "Periodic Template Code" := DocLineDim."Dimension Value";

                 IF DocLineDim.RetrieveRecord(DocLineDim,COMPANYNAME, "Document Type", "Document No.", "Line No.", 'PERDATE') THEN
                   "Periodic Starting Date" := ExReqToQuote.DateField(DocLineDim."Dimension Value");

                 //MODIFY(FALSE);
               END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1100285000;1;Group  ;
                CaptionML=ENU=General }

    { 1100285017;2;Group  ;
                CaptionML=ENU=ExFlow Line }

    { 1100285015;3;Field  ;
                CaptionML=ENU=Line Type;
                SourceExpr="Line Type";
                Editable=FALSE }

    { 1100285013;3;Field  ;
                CaptionML=ENU=No.;
                SourceExpr="No.";
                Editable=FALSE }

    { 1100285011;3;Field  ;
                CaptionML=ENU=Description;
                SourceExpr=Description;
                Editable=FALSE }

    { 1100285009;3;Field  ;
                CaptionML=ENU=Quantity;
                SourceExpr=Quantity;
                Editable=FALSE }

    { 1100285007;3;Field  ;
                CaptionML=ENU=Direct Unit Cost;
                SourceExpr="Direct Unit Cost";
                Editable=FALSE }

    { 1100285005;3;Field  ;
                CaptionML=ENU=Line Discount %;
                SourceExpr="Line Discount %";
                Editable=FALSE }

    { 1100285003;3;Field  ;
                CaptionML=ENU=Job No.;
                SourceExpr="Job No.";
                Editable="Job No.Editable" }

    { 1100285002;3;Field  ;
                CaptionML=ENU=Periodic Template Code;
                SourceExpr="Periodic Template Code";
                Editable="Periodic Template CodeEditable" }

    { 1100285001;3;Field  ;
                CaptionML=ENU=Periodic Starting Date;
                SourceExpr="Periodic Starting Date";
                Editable="Periodic Starting DateEditable" }

    { 1100285023;2;Group  ;
                CaptionML=ENU=Purchase Line }

    { 1100285004;3;Field  ;
                CaptionML=ENU=Line Type;
                SourceExpr=PurchLine.Type;
                Editable=FALSE }

    { 1100285006;3;Field  ;
                CaptionML=ENU=No.;
                SourceExpr=PurchLine."No.";
                Editable=FALSE }

    { 1100285008;3;Field  ;
                CaptionML=ENU=Description;
                SourceExpr=PurchLine.Description;
                Editable=FALSE }

    { 1100285010;3;Field  ;
                CaptionML=ENU=Quantity;
                SourceExpr=PurchLine.Quantity;
                Editable=FALSE }

    { 1100285012;3;Field  ;
                CaptionML=ENU=Direct Unit Cost;
                SourceExpr=PurchLine."Direct Unit Cost";
                Editable=FALSE }

    { 1100285020;3;Field  ;
                CaptionML=ENU=Line Discount %;
                SourceExpr=PurchLine."Line Discount %";
                Editable=FALSE }

    { 1100285014;3;Field  ;
                CaptionML=ENU=Job No.;
                SourceExpr=PurchLine."Job No.";
                Editable=FALSE;
                OnValidate=BEGIN
                             JobNoOnAfterValidate;
                           END;
                            }

    { 1100285016;3;Field  ;
                CaptionML=ENU=Periodic Template Code;
                SourceExpr=PurchLine."Periodic Template Code";
                Editable=FALSE;
                OnValidate=BEGIN
                             PeriodicTemplateCodeOnAfterVal;
                           END;
                            }

    { 1100285018;3;Field  ;
                CaptionML=ENU=Periodic Starting Date;
                SourceExpr=PurchLine."Periodic Starting Date";
                Editable=FALSE;
                OnValidate=BEGIN
                             PeriodicStartingDateOnAfterVal;
                           END;
                            }

  }
  CODE
  {
    VAR
      PurchLine@1100285004 : Record 39;
      DocLineDim@1100285003 : Record 12013611;
      ExFlow@1100285001 : Codeunit 12013601;
      Col@1100285000 : Integer;
      "Job No.Editable"@19002086 : Boolean INDATASET;
      "Periodic Template CodeEditable"@19033098 : Boolean INDATASET;
      "Periodic Starting DateEditable"@19051397 : Boolean INDATASET;

    LOCAL PROCEDURE JobNoOnAfterValidate@19070084();
    BEGIN
      MODIFY;
      UpdateExtraFromDocLine('JOB',xRec,Rec);
    END;

    LOCAL PROCEDURE PeriodicTemplateCodeOnAfterVal@19049868();
    BEGIN
      MODIFY;
      UpdateExtraFromDocLine('PERCODE',xRec,Rec);
    END;

    LOCAL PROCEDURE PeriodicStartingDateOnAfterVal@19065198();
    BEGIN
      MODIFY;
      UpdateExtraFromDocLine('PERDATE',xRec,Rec);
    END;

    BEGIN
    END.
  }
}

