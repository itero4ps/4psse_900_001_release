OBJECT Page 480 Edit Dimension Set Entries
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW17.00,4PS9.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Edit Dimension Set Entries;
    LinksAllowed=No;
    SourceTable=Table480;
    PageType=List;
    SourceTableTemporary=Yes;
    OnOpenPage=BEGIN
                 DimSetID := GETRANGEMIN("Dimension Set ID");
                 DimMgt.GetDimensionSet(Rec,DimSetID);
                 IF FormCaption <> '' THEN
                   CurrPage.CAPTION := FormCaption;
               END;

    OnClosePage=BEGIN
                  DimSetID := DimMgt.GetDimensionSetID(Rec);
                END;

    OnAfterGetRecord=BEGIN
                       SetCompany(ReceivingCompany); //**4PS n RC2013
                     END;

    OnNewRecord=BEGIN
                  "Company Filter" := ReceivingCompany; //**4PS n RC2013
                END;

    OnInsertRecord=BEGIN
                     SetCompany(ReceivingCompany); //**4PS n RC2013
                   END;

    OnAfterGetCurrRecord=BEGIN
                           SetCompany(ReceivingCompany); //**4PS n RC2013
                         END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="Dimension Code" }

    { 4   ;2   ;Field     ;
                SourceExpr="Dimension Name";
                Visible=FALSE }

    { 9   ;2   ;Field     ;
                Name=DimensionValueCode;
                SourceExpr="Dimension Value Code";
                OnValidate=BEGIN
                             CheckDimensionAuthorisation(TableID); //**4PS.n
                           END;

                OnLookup=BEGIN
                           LookupDimensionValueCode; //**4PS.n
                           CheckDimensionAuthorisation(TableID); //**4PS.n
                         END;
                          }

    { 11  ;2   ;Field     ;
                CaptionML=ENU=Dimension Value Name;
                SourceExpr=GetDimensionValueName;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      DimMgt@1004 : Codeunit 408;
      DimSetID@1000 : Integer;
      FormCaption@1005 : Text[250];
      ReceivingCompany@1100525000 : Text[80];
      TableID@1100525001 : Integer;

    PROCEDURE GetDimensionID@2() : Integer;
    BEGIN
      EXIT(DimSetID);
    END;

    PROCEDURE SetFormCaption@3(NewFormCaption@1000 : Text[250]);
    BEGIN
      FormCaption := COPYSTR(NewFormCaption + ' - ' + CurrPage.CAPTION,1,MAXSTRLEN(FormCaption));
    END;

    PROCEDURE SetCompany@1100525000(Company@1100525000 : Text[80]);
    BEGIN
      //**4PS
      ReceivingCompany := Company;
      Rec.SetCompany(ReceivingCompany); //C019894
      DimMgt.SetCompany(ReceivingCompany);
    END;

    PROCEDURE SetTableID@1100525001(NewTableID@1100525000 : Integer);
    BEGIN
      //**4PS
      TableID := NewTableID;
    END;

    PROCEDURE GetDimensionValueName@1100525002() DimensionValueName : Text[50];
    VAR
      DimVal@1100525000 : Record 349;
    BEGIN
      //**4PS n RC2013
      IF "Company Filter" = '' THEN BEGIN
        CALCFIELDS("Dimension Value Name");
        DimensionValueName := "Dimension Value Name";
      END ELSE BEGIN
        DimVal.CHANGECOMPANY( "Company Filter");
        IF NOT DimVal.GET("Dimension Code","Dimension Value Code") THEN
          CLEAR(DimVal);
        DimensionValueName := DimVal.Name;
      END;
    END;

    BEGIN
    END.
  }
}

