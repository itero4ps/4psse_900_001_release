OBJECT Page 51 Purchase Invoice
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00.00.44974,NAVSE9.FI9.DK9.NO9,4PS9.00,4PSSE.NO.DK.FI,EXF400005,PE6;
  }
  PROPERTIES
  {
    CaptionML=ENU=Purchase Invoice;
    SourceTable=Table38;
    SourceTableView=WHERE(Document Type=FILTER(Invoice));
    PageType=Document;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=ENU=New,Process,Report,Approve,Mail Documents;
    OnInit=BEGIN
             DocAmountVATEnable := TRUE;
             DocAmountEnable := TRUE;
             PurchSetup.GET;
             SetExtDocNoMandatoryCondition;

             //**4PS.sn
             FieldsEditable := TRUE;
             BankAccountCodeBPaymentsEditab := TRUE;
             "Invoice Lines InputEditable" := TRUE;
             "Amount excl. VATEditable" := TRUE;
             "VAT AmountEditable" := TRUE;
             MemoWKAEditable := TRUE;
             WageChargetoTaxAuthorityEditab := TRUE;
             WageChargetoBAccountEditable := TRUE;
             "Pay To Tax AuthorityEditable" := TRUE;
             ContributionPercentageEditable := TRUE;
             "Labor AmountEditable" := TRUE;
             "Avg. Wage RateEditable" := TRUE;
             "Number of HoursEditable" := TRUE;
             "Actual End DateEditable" := TRUE;
             "Actual Effective DateEditable" := TRUE;
             "Payment AgreementEditable" := TRUE;
             DocAmountVATVisible := TRUE;
             DocAmountVisible := TRUE;
             PurchLinesEditable := TRUE;
             "Ext. Document IDEditable" := TRUE;
             "Ext. Document IDVisible" := TRUE;
             "Interest DateVisible" := TRUE;
             "On HoldEditable" := TRUE;
             //**4PS.en
           END;

    OnOpenPage=VAR
                 lvInterestCalcMgtCU@1210190000 : Codeunit 11012049;
               BEGIN
                 //**4PS Generated Code. Do Not Change.sn01
                 DPA_IsHardFilter := DPA_SetFilters(CurrPage.OBJECTID(FALSE));
                 //**4PS Generated Code.en01

                 SetDocNoVisible;
                 IF UserMgt.GetPurchasesFilter <> '' THEN BEGIN
                   FILTERGROUP(2);
                   SETRANGE("Responsibility Center",UserMgt.GetPurchasesFilter());
                   FILTERGROUP(0);
                 END;
                 EnableControls;
                 //**4PS.sn
                 PurchSetup.GET;
                 IF NOT lvInterestCalcMgtCU.PermissionInterestGranule() THEN
                   "Interest DateVisible" := FALSE;
                 BankAccountSelectEditable := PurchSetup."Invoices on Bank Account";
                 BankNoCheckEditable := PurchSetup."Bank Account Check";
                 IF PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Other THEN BEGIN
                   "Ext. Document IDEditable" := FALSE;
                   "Ext. Document IDVisible" := FALSE;
                 END;
                 IF (PurchSetup."Approve Purchase Invoices") AND
                    (PurchSetup."VAT Indicator (Purchase)" = PurchSetup."VAT Indicator (Purchase)"::"No VAT") THEN BEGIN
                   PurchLinesEditable := FALSE;
                 END;
                 gWKAPresent := FALSE;
                 //Call C019830 so
                 /// jhoek.110411.begin
                 //IF PurchSetup."Registration per User" THEN
                 //  SETRANGE("Input by", USERID)
                 //ELSE
                 //  SETRANGE("Input by");
                 //// jhoek.110411.end
                 ////**4PS.en
                 //Call C019830 eo

                 OnActivateForm;

                 //4PSSE.NO
                 GLSetup.GET;
                 NORlocalizationEnable := GLSetup."Norwegian Localization Active";
                 DKinfoEnable := GLSetup."Danish localization active";
                 FIinfoEnable := GLSetup."Finnish localization active";
               END;

    OnClosePage=BEGIN
                  WhiteVisionStop;
                END;

    OnAfterGetRecord=BEGIN
                       SetControlAppearance;

                       //**4PS.sn
                       IF gFromReference THEN BEGIN
                         gFromReference := FALSE;
                         CurrPage.PurchLines.PAGE.InitSelectionFromReference(gInvLineNo);
                       END;

                       FillSelectBankAccount;

                       IF ("No." <> xRec."No.") THEN
                         WhiteVisionStop;
                       //**4PS.en
                     END;

    OnNewRecord=BEGIN
                  WhiteVisionStop;

                  "Responsibility Center" := UserMgt.GetPurchasesFilter;
                  //**4PS Generated Code. Do Not Change.sn02
                  DPA_SetDefaultDepartment;
                  //**4PS Generated Code.en02
                  SetFieldsEditable(TRUE);
                  BankAccountSelect := ''; //**4PS.n
                  AfterGetCurrentRecord;
                END;

    OnInsertRecord=VAR
                     xRecRef@1100000999 : RecordRef;
                   BEGIN
                     //**4PS Generated Code. Do Not Change.sn05
                     xRecRef.GETTABLE(xRec);
                     DPA_SetDefaultDpmtFromNoSeries(xRecRef);
                     //**4PS Generated Code.en05
                   END;

    OnDeleteRecord=BEGIN
                     CurrPage.SAVERECORD;
                     EXIT(ConfirmDeletion);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           AfterGetCurrentRecord;
                           CurrPage.IncomingDocAttachFactBox.PAGE.LoadDataFromRecord(Rec);
                           ShowWorkflowStatus := CurrPage.WorkflowStatus.PAGE.SetFilterOnWorkflowRecord(RECORDID);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 55      ;1   ;ActionGroup;
                      CaptionML=ENU=&Invoice;
                      Image=Invoice }
      { 57      ;2   ;Action    ;
                      Name=Statistics;
                      ShortCutKey=F7;
                      CaptionML=ENU=Statistics;
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CalcInvDiscForHeader;
                                 COMMIT;
                                 PAGE.RUNMODAL(PAGE::"Purchase Statistics",Rec);
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                               END;
                                }
      { 58      ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=ENU=Vendor;
                      RunObject=Page 26;
                      RunPageLink=No.=FIELD(Buy-from Vendor No.);
                      Image=Vendor }
      { 59      ;2   ;Action    ;
                      CaptionML=ENU=Co&mments;
                      RunObject=Page 66;
                      RunPageLink=Document Type=FIELD(Document Type),
                                  No.=FIELD(No.),
                                  Document Line No.=CONST(0);
                      Image=ViewComments }
      { 113     ;2   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=ENU=Dimensions;
                      Image=Dimensions;
                      OnAction=BEGIN
                                 ShowDocDim;
                                 CurrPage.SAVERECORD;
                               END;
                                }
      { 45      ;2   ;Action    ;
                      CaptionML=ENU=Approvals;
                      Description=**4PS.o;
                      Visible=false;
                      Image=Approvals;
                      OnAction=VAR
                                 ApprovalEntries@1001 : Page 658;
                               BEGIN
                                 ApprovalEntries.Setfilters(DATABASE::"Purchase Header","Document Type","No.");
                                 ApprovalEntries.RUN;
                               END;
                                }
      { 12013598;2   ;Separator  }
      { 12013599;2   ;Action    ;
                      Name=<Action1100285004>;
                      ShortCutKey=Ctrl+I;
                      CaptionML=ENU=Show document;
                      Image=Document;
                      OnAction=BEGIN
                                 // ExFlow
                                 ExFlow.ShowImageDocument("Document Type","No.");
                               END;
                                }
      { 12013600;2   ;Action    ;
                      Name=<Action1100285005>;
                      ShortCutKey=Ctrl+B;
                      CaptionML=ENU=Attached Fil&es;
                      RunObject=Page 12013644;
                      RunPageView=SORTING(Document Type,Document No.,Attached);
                      RunPageLink=Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Image=Documents }
      { 1100485014;2 ;Separator  }
      { 1100285034;2 ;Action    ;
                      CaptionML=ENU=In&ward Registration;
                      OnAction=BEGIN
                                 //NTR Start
                                 TESTFIELD("Buy-from Vendor No.");
                                 TESTFIELD("Pay-to Vendor No.");
                                 TESTFIELD("VAT Bus. Posting Group");
                                 TESTFIELD("Gen. Bus. Posting Group");
                                 IF ISSERVICETIER THEN BEGIN
                                   InwRegList.PurchHeaderKey("Document Type","No.");
                                   InwRegList.RUN;
                                 END ELSE BEGIN
                                   InwRegForm.PurchHeaderKey("Document Type","No.");
                                   InwRegForm.RUN;
                                 END;
                                 //NTR End
                               END;
                                }
      { 1100285035;2 ;Action    ;
                      CaptionML=ENU=Inward Reg. &Entries;
                      RunObject=Page 11128015;
                      RunPageView=SORTING(Source Type,Source No.);
                      RunPageLink=Source Type=FIELD(Document Type),
                                  Source Type=FIELD(No.) }
      { 1100485011;2 ;Action    ;
                      ShortCutKey=Shift+Ctrl+S;
                      CaptionML=ENU=Scanned Document;
                      Image=Document;
                      OnAction=VAR
                                 lvPurchSetupRec@1100485002 : Record 312;
                               BEGIN
                                 //**4PS
                                 lvPurchSetupRec.GET;
                                 lvPurchSetupRec.ShowScannedDocument(2,"No.","Buy-from Vendor No.","Ext. Document ID");
                               END;
                                }
      { 1100525004;2 ;Action    ;
                      CaptionML=ENU=Subcontracting Hours;
                      Image=SubcontractingWorksheet;
                      OnAction=VAR
                                 SubcontractingHoursInvoice@1100528301 : Record 11020694;
                               BEGIN
                                 //**4PS.n
                                 SubcontractingHoursInvoice.RunPageFromPurchaseHeader(Rec);
                               END;
                                }
      { 1100485012;2 ;ActionGroup;
                      CaptionML=ENU=Consent;
                      Image=BOMLedger }
      { 1100485013;3 ;Action    ;
                      CaptionML=ENU=Consent Lines;
                      Image=BOMLedger;
                      OnAction=VAR
                                 ConsentUserSetup@1100485002 : Record 11012229;
                                 ConsentManCU@1100485000 : Codeunit 11012132;
                               BEGIN
                                 IF ConsentUserSetup.READPERMISSION THEN
                                   ConsentManCU.HandlePurchaseHeader(Rec, 1, TRUE);
                               END;
                                }
      { 1100485003;3 ;Action    ;
                      CaptionML=ENU=Insert Consent Lines;
                      Image=Insert;
                      OnAction=VAR
                                 ConsentLine@1100528400 : Record 11012226;
                               BEGIN
                                 //**4PS
                                 IF ConsentLine.READPERMISSION THEN
                                   EditConsentLines;
                               END;
                                }
      { 1210190020;2 ;Action    ;
                      CaptionML=ENU=&Documents;
                      Image=Documents;
                      OnAction=VAR
                                 RecRef@1210190001 : RecordRef;
                                 DocumentFilters@1210190000 : Codeunit 11012432;
                               BEGIN
                                 //**4PS
                                 RecRef.GETTABLE(Rec);
                                 DocumentFilters.CreateTempFilterAndExecute1(RecRef, "Shortcut Dimension 1 Code", FALSE, TRUE);
                               END;
                                }
      { 106     ;1   ;ActionGroup;
                      CaptionML=ENU=&Line }
      { 1210190015;2 ;Action    ;
                      CaptionML=ENU=ICF Specifications;
                      Image=SetupList;
                      OnAction=BEGIN
                                 ShowICFInvoiceLines;  //**4PS
                               END;
                                }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 25      ;1   ;ActionGroup;
                      CaptionML=ENU=Approval }
      { 23      ;2   ;Action    ;
                      Name=Approve;
                      CaptionML=ENU=Approve;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.ApproveRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 21      ;2   ;Action    ;
                      Name=Reject;
                      CaptionML=ENU=Reject;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      PromotedIsBig=Yes;
                      Image=Reject;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.RejectRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 19      ;2   ;Action    ;
                      Name=Delegate;
                      CaptionML=ENU=Delegate;
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=Delegate;
                      PromotedCategory=Category4;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.DelegateRecordApprovalRequest(RECORDID)
                               END;
                                }
      { 13      ;2   ;Action    ;
                      Name=Comment;
                      CaptionML=ENU=Comments;
                      RunObject=Page 660;
                      RunPageLink=Table ID=CONST(38),
                                  Document Type=FIELD(Document Type),
                                  Document No.=FIELD(No.);
                      Promoted=Yes;
                      Visible=OpenApprovalEntriesExistForCurrUser;
                      Image=ViewComments;
                      PromotedCategory=Category4 }
      { 9       ;1   ;ActionGroup;
                      CaptionML=ENU=Release;
                      Image=Release }
      { 120     ;2   ;Action    ;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=ENU=Re&lease;
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 121     ;2   ;Action    ;
                      CaptionML=ENU=Re&open;
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 60      ;1   ;ActionGroup;
                      CaptionML=ENU=F&unctions;
                      Image=Action }
      { 12047960;2   ;Action    ;
                      CaptionML=ENU=Get latest coding from vendor;
                      Promoted=Yes;
                      Image=CopyWorksheet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 // PEB0042
                                 gBaseMgt.GetLatestCodingFromVendor(Rec);
                                 // 0042
                               END;
                                }
      { 61      ;2   ;Action    ;
                      Name=CalculateInvoiceDiscount;
                      AccessByPermission=TableData 24=R;
                      CaptionML=ENU=Calculate &Invoice Discount;
                      Image=CalculateInvoiceDiscount;
                      OnAction=BEGIN
                                 ApproveCalcInvDisc;
                                 PurchCalcDiscByType.ResetRecalculateInvoiceDisc(Rec);
                                 //CurrPage.PurchLines.PAGE.UpdateAfterChangingHeader;
                               END;
                                }
      { 1100525001;2 ;ActionGroup;
                      CaptionML=ENU=Get;
                      Image=Import }
      { 1210190011;3 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Get Allo&cation;
                      Image=Import;
                      OnAction=VAR
                                 GetAllocation@1210190000 : Codeunit 11012048;
                               BEGIN
                                 //**4PS
                                 GetAllocation.PurchaseHeader(Rec);
                               END;
                                }
      { 132     ;3   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Get St&d. Vend. Purchase Codes;
                      Image=VendorCode;
                      OnAction=VAR
                                 StdVendPurchCode@1000 : Record 175;
                               BEGIN
                                 StdVendPurchCode.InsertPurchLines(Rec);
                               END;
                                }
      { 64      ;3   ;Action    ;
                      ShortCutKey=Ctrl+F11;
                      Ellipsis=Yes;
                      CaptionML=ENU=&Get Receipt Lines;
                      Promoted=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF (PurchSetup."Approve Purchase Invoices") AND
                                    (PurchSetup."VAT Indicator (Purchase)" = PurchSetup."VAT Indicator (Purchase)"::"No VAT") THEN
                                   ERROR(Text11012002);

                                 CurrPage.PurchLines.PAGE.GetReceipt;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 1100485910;3 ;Action    ;
                      CaptionML=ENU=Get Plant Rent Entries;
                      Promoted=Yes;
                      Image=Import;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 GetPlantRentEntries@1100525000 : Report 11012589;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("No.");
                                 TESTFIELD("Buy-from Vendor No.");
                                 GetPlantRentEntries.SetSelections("No.", DATABASE::"Purchase Line", FALSE, SavePeriodPlantRentEntries);
                                 GetPlantRentEntries.RUNMODAL;
                                 SavePeriodPlantRentEntries := TRUE;
                               END;
                                }
      { 136     ;2   ;Separator  }
      { 62      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Copy Document;
                      Promoted=Yes;
                      Image=CopyDocument;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CopyPurchDoc.SetPurchHeader(Rec);
                                 CopyPurchDoc.RUNMODAL;
                                 CLEAR(CopyPurchDoc);
                               END;
                                }
      { 1210190018;2 ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=ENU=Correct Document;
                      Image=ChangeLog;
                      OnAction=BEGIN
                                 //**4PS
                                 CorrectPurchDoc.SetPurchHeader(Rec);
                                 CorrectPurchDoc.RUNMODAL;
                                 CLEAR(CorrectPurchDoc);
                                 GET("Document Type","No.");
                               END;
                                }
      { 112     ;2   ;Action    ;
                      Name=MoveNegativeLines;
                      Ellipsis=Yes;
                      CaptionML=ENU=Move Negative Lines;
                      Image=MoveNegativeLines;
                      OnAction=BEGIN
                                 CLEAR(MoveNegPurchLines);
                                 MoveNegPurchLines.SetPurchHeader(Rec);
                                 MoveNegPurchLines.RUNMODAL;
                                 MoveNegPurchLines.ShowDocument;
                               END;
                                }
      { 137     ;2   ;Separator  }
      { 41      ;2   ;ActionGroup;
                      Name=IncomingDocument;
                      CaptionML=ENU=Incoming Document;
                      ActionContainerType=NewDocumentItems;
                      Image=Documents }
      { 39      ;3   ;Action    ;
                      Name=IncomingDocCard;
                      CaptionML=ENU=View Incoming Document;
                      Enabled=HasIncomingDocument;
                      Image=ViewOrder;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 IncomingDocument.ShowCardFromEntryNo("Incoming Document Entry No.");
                               END;
                                }
      { 37      ;3   ;Action    ;
                      Name=SelectIncomingDoc;
                      AccessByPermission=TableData 130=R;
                      CaptionML=ENU=Select Incoming Document;
                      Image=SelectLineToApply;
                      OnAction=VAR
                                 IncomingDocument@1000 : Record 130;
                               BEGIN
                                 VALIDATE("Incoming Document Entry No.",IncomingDocument.SelectIncomingDocument("Incoming Document Entry No."));
                               END;
                                }
      { 35      ;3   ;Action    ;
                      Name=IncomingDocAttachFile;
                      Ellipsis=Yes;
                      CaptionML=ENU=Create Incoming Document from File;
                      Enabled=NOT HasIncomingDocument;
                      Image=Attach;
                      OnAction=VAR
                                 IncomingDocumentAttachment@1000 : Record 133;
                               BEGIN
                                 IncomingDocumentAttachment.NewAttachmentFromPurchaseDocument(Rec);
                               END;
                                }
      { 29      ;3   ;Action    ;
                      Name=RemoveIncomingDoc;
                      CaptionML=ENU=Remove Incoming Document;
                      Enabled=HasIncomingDocument;
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 "Incoming Document Entry No." := 0;
                               END;
                                }
      { 47      ;1   ;ActionGroup;
                      CaptionML=ENU=Request Approval }
      { 142     ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=ENU=Send A&pproval Request;
                      Description=**4PS.o;
                      Visible=false;
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckPurchaseApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 143     ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=ENU=Cancel Approval Re&quest;
                      Description=**4PS.o;
                      Visible=false;
                      Enabled=OpenApprovalEntriesExist;
                      Image=Cancel;
                      OnAction=VAR
                                 ApprovalsMgmt@1000 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                               END;
                                }
      { 1100485026;2 ;Action    ;
                      CaptionML=ENU=Create Invoice Lines for Sub Projects;
                      Image=Splitlines;
                      OnAction=BEGIN
                                 //**4PS
                                 DistrPurchLinesOverSubProjects(Rec);
                               END;
                                }
      { 1100485025;2 ;Action    ;
                      CaptionML=ENU=Distribute Invoice Amount over Invoice Lines;
                      Image=Split;
                      OnAction=BEGIN
                                 DistributeAmountOverLines;
                               END;
                                }
      { 145     ;2   ;Separator  }
      { 66      ;1   ;ActionGroup;
                      CaptionML=ENU=P&osting;
                      Image=Post }
      { 68      ;2   ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=ENU=P&ost;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post (Yes/No)");
                               END;
                                }
      { 33      ;2   ;Action    ;
                      Name=Preview;
                      CaptionML=ENU=Preview Posting;
                      Image=ViewPostedOrder;
                      OnAction=VAR
                                 PurchPostYesNo@1000 : Codeunit 91;
                               BEGIN
                                 PurchPostYesNo.Preview(Rec);
                               END;
                                }
      { 67      ;2   ;Action    ;
                      Name=TestReport;
                      Ellipsis=Yes;
                      CaptionML=ENU=Test Report;
                      Image=TestReport;
                      OnAction=BEGIN
                                 ReportPrint.PrintPurchHeader(Rec);
                               END;
                                }
      { 1101200046;2 ;Action    ;
                      CaptionML=ENU=Invoice Check List;
                      Image=TestReport;
                      OnAction=VAR
                                 PurchaseHeader@11012003 : Record 38;
                                 CheckPurchInvCreditMemo@1100525000 : Report 11012063;
                               BEGIN
                                 //**4PS
                                 PurchaseHeader.SETRANGE("Document Type", PurchaseHeader."Document Type"::Invoice);
                                 CheckPurchInvCreditMemo.SETTABLEVIEW(PurchaseHeader);
                                 CheckPurchInvCreditMemo.RUN;
                               END;
                                }
      { 69      ;2   ;Action    ;
                      Name=PostAndPrint;
                      ShortCutKey=Shift+F9;
                      CaptionML=ENU=Post and &Print;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostPrint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post + Print");
                               END;
                                }
      { 70      ;2   ;Action    ;
                      Name=PostBatch;
                      Ellipsis=Yes;
                      CaptionML=ENU=Post &Batch;
                      Image=PostBatch;
                      OnAction=VAR
                                 PurchaseHeader@1100528701 : Record 38;
                               BEGIN
                                 //REPORT.RUNMODAL(REPORT::"Batch Post Purchase Invoices",TRUE,TRUE,Rec); //**4PS.o
                                 //**4PS.sn
                                 PurchaseHeader.COPY(Rec);
                                 IF PurchSetup."Registration per User" THEN
                                   PurchaseHeader.SETRANGE("Input by", USERID);
                                 REPORT.RUNMODAL(REPORT::"Batch Post Purchase Invoices",TRUE,TRUE,PurchaseHeader);
                                 //**4PS.en
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 7       ;2   ;Action    ;
                      Name=RemoveFromJobQueue;
                      CaptionML=ENU=Remove From Job Queue;
                      Visible="Job Queue Status" = "Job Queue Status"::"Scheduled For Posting";
                      Image=RemoveLine;
                      OnAction=BEGIN
                                 CancelBackgroundPosting;
                               END;
                                }
      { 1100525003;1 ;ActionGroup;
                      CaptionML=ENU=Electronic Invoice;
                      Image=ElectronicDoc }
      { 1210190016;2 ;Action    ;
                      CaptionML=ENU=&Match ICF Invoice;
                      Image=Link;
                      OnAction=VAR
                                 PurchReceiptCU@1210190000 : Codeunit 74;
                               BEGIN
                                 //**4PS
                                 PurchReceiptCU.MatchReceiptICFInvoice("No.", FALSE);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1100485002;2 ;Action    ;
                      CaptionML=ENU=&Approve ICF Invoice;
                      Image=Approve;
                      OnAction=BEGIN
                                 ApproveICFInvoice;  //**4PS
                               END;
                                }
      { 1100485010;2 ;Action    ;
                      CaptionML=ENU=Import MTC Invoice Specification;
                      Image=Import;
                      OnAction=VAR
                                 ImportMTCInvoiceSpec@1100525501 : XMLport 11012017;
                               BEGIN
                                 //**4PS
                                 ImportMTCInvoiceSpec.SetPurchInvHeader(Rec);
                                 ImportMTCInvoiceSpec.RUN;
                               END;
                                }
      { 1100485029;2 ;Action    ;
                      CaptionML=ENU=Import Invoice;
                      Image=Import;
                      OnAction=VAR
                                 lvImpInvoiceHeadRec@1100485000 : Record 11020430;
                               BEGIN
                                 IF lvImpInvoiceHeadRec.READPERMISSION THEN
                                   REPORT.RUNMODAL(REPORT::"Import Invoice");
                               END;
                                }
      { 1100409001;1 ;ActionGroup;
                      CaptionML=ENU=Mail Documents;
                      ActionContainerType=NewDocumentItems }
      { 1100409000;2 ;Action    ;
                      CaptionML=ENU=Buy-from Vendor;
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 Contact@1100409002 : Record 5050;
                                 Vendor@1100409001 : Record 23;
                                 DocumentTemplate@1100409000 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Vendor No.");
                                 IF Contact.GetContactByVendor("Buy-from Vendor No.", Contact, TRUE) THEN BEGIN
                                   Vendor.GET("Buy-from Vendor No.");
                                   EditDocuments(
                                     "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::Invoice),
                                     Contact."No.", '', TRUE, Vendor."E-Mail");
                                 END;
                               END;
                                }
      { 1100409002;2 ;Action    ;
                      CaptionML=ENU=Buy-from Contact;
                      Promoted=Yes;
                      Image=MailAttachment;
                      PromotedCategory=Category5;
                      OnAction=VAR
                                 Contact@1100409002 : Record 5050;
                                 DocumentTemplate@1100409000 : Record 11012401;
                               BEGIN
                                 //**4PS
                                 TESTFIELD("Buy-from Contact No.");
                                 IF Contact.GET("Buy-from Contact No.") THEN BEGIN
                                   IF Contact.IsContactPerson THEN
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::Invoice),
                                       Contact."Company No.", Contact."No.", TRUE, Contact."E-Mail")
                                    ELSE
                                     EditDocuments(
                                       "Document Type", STRSUBSTNO('%1', DocumentTemplate.Type::Invoice),
                                       Contact."No.", '', TRUE, Contact."E-Mail");
                                 END;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=ENU=General }

    { 2   ;2   ;Field     ;
                Lookup=No;
                SourceExpr="No.";
                Importance=Promoted;
                Visible=DocNoVisible;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 1210190005;2;Field  ;
                SourceExpr="Related Purch. Order No.";
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             //**4PS.n
                             ValidateRelatedPurchOrder;
                           END;

                OnLookup=VAR
                           OldRelatedOrderNo@1100525000 : Code[20];
                         BEGIN
                           //**4PS.n
                           OldRelatedOrderNo := "Related Purch. Order No.";
                           LookupRelatedOrder();
                           IF ("Related Purch. Order No." <> '') AND ("Related Purch. Order No." <> OldRelatedOrderNo) THEN
                             ValidateRelatedPurchOrder;
                         END;
                          }

    { 1210190007;2;Field  ;
                Name=BankAccountSelect;
                CaptionML=ENU=Bank Account No.;
                SourceExpr=BankAccountSelect;
                Editable=BankAccountSelectEditable;
                OnValidate=BEGIN
                             //**4PS
                             HandleSelectedBankAccount(Rec, BankAccountSelect); //call C000319
                           END;
                            }

    { 4   ;2   ;Field     ;
                CaptionML=ENU=Vendor No.;
                SourceExpr="Buy-from Vendor No.";
                Importance=Standard;
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             BuyfromVendorNoOnAfterValidate;
                           END;

                OnLookup=BEGIN
                           //**4PS.sn
                           LookupVendor(xRec);
                           ValidateBuyFromVendorNo;
                           //**4PS.en
                         END;

                ShowMandatory=TRUE }

    { 128 ;2   ;Field     ;
                SourceExpr="Buy-from Contact No.";
                Importance=Additional;
                Editable=FieldsEditable }

    { 6   ;2   ;Field     ;
                SourceExpr="Buy-from Vendor Name";
                Importance=Promoted;
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             //**4PS
                             IF "Buy-from Vendor No." = '' THEN
                               IF VendorRec.ValidateBuyFromVendor(Rec,xRec) THEN
                                 CurrPage.UPDATE;
                           END;
                            }

    { 72  ;2   ;Field     ;
                SourceExpr="Buy-from Address";
                Importance=Additional;
                Editable=FieldsEditable }

    { 74  ;2   ;Field     ;
                SourceExpr="Buy-from Address 2";
                Importance=Additional;
                Editable=FieldsEditable }

    { 77  ;2   ;Field     ;
                CaptionML=ENU=Buy-from Post Code;
                SourceExpr="Buy-from Post Code";
                Importance=Additional;
                Editable=FieldsEditable }

    { 76  ;2   ;Field     ;
                SourceExpr="Buy-from City";
                Editable=FieldsEditable }

    { 8   ;2   ;Field     ;
                SourceExpr="Buy-from Contact";
                Importance=Additional;
                Editable=FieldsEditable }

    { 14  ;2   ;Field     ;
                SourceExpr="Vendor Invoice No.";
                Editable=FieldsEditable;
                OnAssistEdit=VAR
                               RetVal@1100528301 : Text[250];
                             BEGIN
                               WhiteVisionStart;
                               RetVal := WhiteVisionActivateField('Factuurnummer', 0);
                               IF (RetVal <> '') THEN
                                 EVALUATE("Vendor Invoice No.", COPYSTR(RetVal, 1, 20));
                             END;

                ShowMandatory=VendorInvoiceNoMandatory }

    { 1100485015;2;Field  ;
                SourceExpr="Ext. Document ID";
                Visible="Ext. Document IDVisible";
                Editable="Ext. Document IDEditable" }

    { 1101200002;2;Field  ;
                SourceExpr="Subcontracting Invoice";
                OnValidate=BEGIN
                             SubcontractingInvoiceOnAfterVa;
                           END;
                            }

    { 1100485208;2;Field  ;
                CaptionML=ENU=WKA Data present;
                SourceExpr=gWKAPresent;
                Editable=FALSE }

    { 1101200014;2;Field  ;
                SourceExpr="Invoice Lines Input";
                Editable="Invoice Lines InputEditable";
                OnValidate=BEGIN
                             InvoiceLinesInputOnAfterValida;
                           END;
                            }

    { 1000000000;2;Field  ;
                SourceExpr="Amounts only";
                Editable=FieldsEditable }

    { 1100485004;2;Field  ;
                SourceExpr="Bank No. Check";
                Editable=BankNoCheckEditable;
                OnValidate=BEGIN
                             //**4PS
                             FillSelectBankAccount;
                           END;
                            }

    { 1100485031;2;Field  ;
                SourceExpr="Shortcut Dimension 1 Code";
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             //**4PS Generated Code. Do Not Change.sn03
                             DPA_ChkDepartmentCodeAllowed(DPA_IsHardFilter);
                             //**4PS Generated Code.en03
                             ShortcutDimension1CodeOnAfterV;
                           END;
                            }

    { 12  ;2   ;Field     ;
                SourceExpr="Posting Date";
                Importance=Standard;
                Editable=FieldsEditable }

    { 43  ;2   ;Field     ;
                SourceExpr="Document Date";
                Editable=FieldsEditable;
                OnAssistEdit=VAR
                               RetVal@1100528301 : Text[250];
                             BEGIN
                               WhiteVisionStart;
                               RetVal := WhiteVisionActivateField('Factuurdatum', 2);
                               IF (RetVal <> '') THEN
                                 EVALUATE("Document Date", RetVal);
                             END;
                              }

    { 11  ;2   ;Field     ;
                SourceExpr="Incoming Document Entry No.";
                Visible=FALSE }

    { 1101200000;2;Field  ;
                SourceExpr="VAT Prod. Posting Group";
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             VATProdPostingGroupOnAfterVali;
                           END;
                            }

    { 1101200004;2;Field  ;
                SourceExpr="Amount excl. VAT";
                Editable="Amount excl. VATEditable";
                OnValidate=BEGIN
                             AmountexclVATOnAfterValidate;
                           END;
                            }

    { 1101200006;2;Field  ;
                SourceExpr="VAT Amount";
                Editable="VAT AmountEditable";
                OnValidate=BEGIN
                             VATAmountOnAfterValidate;
                           END;
                            }

    { 1101200015;2;Field  ;
                SourceExpr="Amount incl. VAT";
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             AmountinclVATOnAfterValidate;
                           END;

                OnAssistEdit=VAR
                               RetVal@1100528301 : Text[250];
                             BEGIN
                               WhiteVisionStart;
                               RetVal := WhiteVisionActivateField('BrutoBedrag', 3);
                               IF (RetVal <> '') THEN
                                 EVALUATE("Amount incl. VAT", RetVal);
                             END;
                              }

    { 12047963;2;Field    ;
                SourceExpr="Recipient Bank Account";
                Visible=FALSE }

    { 12013591;2;Field    ;
                SourceExpr="Block Document" }

    { 91  ;2   ;Field     ;
                SourceExpr="On Hold";
                Editable="On HoldEditable" }

    { 1100285300;2;Field  ;
                SourceExpr=Approve }

    { 1100285301;2;Field  ;
                Name=<Control12013588>;
                CaptionML=ENU=Approval Status;
                SourceExpr=ExFlowStatusFromPO;
                Editable=FieldsEditable;
                OnDrillDown=BEGIN
                              ExFlowStatusDrillDownFromPO;
                            END;
                             }

    { 12013593;2;Field    ;
                SourceExpr="ExFlow Document Type" }

    { 1101200008;2;Field  ;
                SourceExpr="Approvement Initials";
                Editable=FieldsEditable }

    { 5   ;2   ;Field     ;
                SourceExpr="Job Queue Status";
                Importance=Additional }

    { 1210190002;2;Field  ;
                SourceExpr="Job No.";
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             JobNoOnAfterValidate;
                           END;
                            }

    { 1100525006;2;Field  ;
                SourceExpr="Service Order No.";
                OnValidate=BEGIN
                             //**4PS
                             CurrPage.UPDATE;
                           END;
                            }

    { 1100525007;2;Field  ;
                SourceExpr="Purchaser Code" }

    { 118 ;2   ;Field     ;
                SourceExpr=Status;
                Importance=Promoted }

    { 12047962;2;Field    ;
                SourceExpr="OCR No.";
                Visible=false }

    { 12013589;2;Field    ;
                SourceExpr="Gross Invoice Amount ExFlow" }

    { 12013590;2;Field    ;
                SourceExpr="Import VAT Amount" }

    { 12013592;2;Field    ;
                SourceExpr="Receipt No. Mandatory" }

    { 1100528400;2;Field  ;
                CaptionML=ENU=Open Order Consent Lines;
                SourceExpr=RelatedOrderHasOpenConsentLines }

    { 54  ;1   ;Part      ;
                Name=PurchLines;
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page55;
                Editable=PurchLinesEditable;
                UpdatePropagation=Both }

    { 1905885101;1;Group  ;
                CaptionML=ENU=Invoicing }

    { 16  ;2   ;Field     ;
                SourceExpr="Pay-to Vendor No.";
                Importance=Promoted;
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             PaytoVendorNoOnAfterValidate;
                           END;
                            }

    { 130 ;2   ;Field     ;
                SourceExpr="Pay-to Contact No.";
                Importance=Additional;
                Editable=FieldsEditable }

    { 18  ;2   ;Field     ;
                SourceExpr="Pay-to Name";
                Importance=Promoted;
                Editable=FieldsEditable }

    { 20  ;2   ;Field     ;
                SourceExpr="Pay-to Address";
                Importance=Additional;
                Editable=FieldsEditable }

    { 22  ;2   ;Field     ;
                SourceExpr="Pay-to Address 2";
                Importance=Additional;
                Editable=FieldsEditable }

    { 82  ;2   ;Field     ;
                CaptionML=ENU=Pay-to Post Code;
                SourceExpr="Pay-to Post Code";
                Importance=Additional;
                Editable=FieldsEditable }

    { 24  ;2   ;Field     ;
                SourceExpr="Pay-to City";
                Editable=FieldsEditable }

    { 26  ;2   ;Field     ;
                SourceExpr="Pay-to Contact";
                Importance=Additional;
                Editable=FieldsEditable }

    { 1090000;2;Field     ;
                CaptionML=ENU=Message Type;
                SourceExpr=PurchHeadExtensionRec."Message Type";
                Visible=FIinfoEnable;
                OnValidate=BEGIN
                             PurchHeadExtensionRec.UpdatePurchHeadExtension("Document Type","No.");
                           END;

                ShowMandatory=TRUE }

    { 1090002;2;Field     ;
                Name=Invoice Message;
                CaptionML=ENU=Invoice Message;
                SourceExpr=PurchHeadExtensionRec."Invoice Message";
                Importance=Promoted;
                Visible=FIinfoEnable;
                OnValidate=BEGIN
                             PurchHeadExtensionRec.UpdatePurchHeadExtension("Document Type","No.");
                           END;

                ShowMandatory=TRUE }

    { 1080000;2;Field     ;
                SourceExpr=KID;
                Visible=NORlocalizationEnable }

    { 1101200018;2;Field  ;
                SourceExpr="Transaction Mode B Payments";
                Editable=TransactionModeBPaymentsEditab }

    { 1210190000;2;Field  ;
                SourceExpr="Bank Account Code B Payments";
                Editable=BankAccountCodeBPaymentsEditab }

    { 87  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code";
                Editable=FieldsEditable;
                LookupPageID=Cost Object List;
                OnValidate=BEGIN
                             ShortcutDimension2CodeOnAfterV;
                           END;
                            }

    { 28  ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Importance=Standard;
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             PaymentTermsCodeOnAfterValidat;
                           END;
                            }

    { 30  ;2   ;Field     ;
                SourceExpr="Due Date";
                Importance=Standard;
                Editable=FieldsEditable;
                ShowMandatory=TRUE }

    { 32  ;2   ;Field     ;
                SourceExpr="Payment Discount %";
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             PaymentDiscount37OnAfterValida;
                           END;
                            }

    { 34  ;2   ;Field     ;
                SourceExpr="Pmt. Discount Date";
                Importance=Additional;
                Editable=FieldsEditable }

    { 138 ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Editable=FieldsEditable }

    { 102 ;2   ;Field     ;
                SourceExpr="Payment Method Code";
                Importance=Additional }

    { 1101200020;2;Field  ;
                SourceExpr="Your Reference";
                Editable=FieldsEditable }

    { 17  ;2   ;Field     ;
                SourceExpr="Payment Reference" }

    { 15  ;2   ;Field     ;
                SourceExpr="Creditor No." }

    { 1100485000;2;Field  ;
                SourceExpr="ICF Status";
                Editable=FieldsEditable }

    { 1060000;2;Field     ;
                SourceExpr="Giro Acc. No.";
                Visible=DKinfoEnable }

    { 1102601000;2;Field  ;
                SourceExpr="Campaign No.";
                Importance=Additional }

    { 1100485033;2;Field  ;
                SourceExpr="Responsibility Center";
                Importance=Additional;
                Editable=FieldsEditable }

    { 1100525002;2;Field  ;
                SourceExpr="Reason Code" }

    { 1210190010;2;Field  ;
                SourceExpr="Interest Date";
                Importance=Additional;
                Visible="Interest DateVisible";
                Editable=FieldsEditable }

    { 1100285001;2;Field  ;
                SourceExpr="Prices Including VAT" }

    { 3   ;2   ;Field     ;
                SourceExpr="Periodic Template Code" }

    { 10  ;2   ;Field     ;
                SourceExpr="Periodic Starting Date" }

    { 1100285400;2;Field  ;
                SourceExpr="Export to Symbrio";
                Importance=Additional }

    { 1100285401;2;Field  ;
                SourceExpr="Export to Symbrio Type";
                Importance=Additional }

    { 1906801201;1;Group  ;
                CaptionML=ENU=Shipping }

    { 36  ;2   ;Field     ;
                SourceExpr="Ship-to Name";
                Importance=Promoted;
                Editable=FieldsEditable }

    { 38  ;2   ;Field     ;
                SourceExpr="Ship-to Address";
                Editable=FieldsEditable }

    { 40  ;2   ;Field     ;
                SourceExpr="Ship-to Address 2";
                Editable=FieldsEditable }

    { 94  ;2   ;Field     ;
                CaptionML=ENU=Ship-to Post Code;
                SourceExpr="Ship-to Post Code";
                Editable=FieldsEditable }

    { 42  ;2   ;Field     ;
                SourceExpr="Ship-to City";
                Editable=FieldsEditable }

    { 1100525000;2;Field  ;
                SourceExpr="Ship-to Country/Region Code";
                Editable=FieldsEditable }

    { 44  ;2   ;Field     ;
                SourceExpr="Ship-to Contact";
                Editable=FieldsEditable }

    { 89  ;2   ;Field     ;
                SourceExpr="Location Code";
                Importance=Standard;
                Editable=FieldsEditable }

    { 46  ;2   ;Field     ;
                SourceExpr="Shipment Method Code";
                Editable=FieldsEditable }

    { 48  ;2   ;Field     ;
                SourceExpr="Expected Receipt Date";
                Importance=Promoted;
                Editable=FieldsEditable }

    { 1907468901;1;Group  ;
                CaptionML=ENU=Foreign Trade }

    { 104 ;2   ;Field     ;
                SourceExpr="Currency Code";
                Importance=Promoted;
                Editable=FieldsEditable;
                OnValidate=BEGIN
                             CurrPage.UPDATE;
                             PurchCalcDiscByType.ApplyDefaultInvoiceDiscount(0,Rec);
                           END;

                OnAssistEdit=BEGIN
                               CLEAR(ChangeExchangeRate);
                               IF "Posting Date" <> 0D THEN
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor","Posting Date")
                               ELSE
                                 ChangeExchangeRate.SetParameter("Currency Code","Currency Factor",WORKDATE);
                               IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN BEGIN
                                 VALIDATE("Currency Factor",ChangeExchangeRate.GetParameter);
                                 CurrPage.UPDATE;
                               END;
                               CLEAR(ChangeExchangeRate);
                             END;
                              }

    { 1000001;2;Field     ;
                SourceExpr="EU 3-Party Trade" }

    { 50  ;2   ;Field     ;
                SourceExpr="Transaction Type";
                Importance=Promoted;
                Editable=FieldsEditable }

    { 100 ;2   ;Field     ;
                SourceExpr="Transaction Specification";
                Editable=FieldsEditable }

    { 52  ;2   ;Field     ;
                SourceExpr="Transport Method";
                Editable=FieldsEditable }

    { 96  ;2   ;Field     ;
                SourceExpr="Entry Point";
                Editable=FieldsEditable }

    { 98  ;2   ;Field     ;
                SourceExpr=Area;
                Editable=FieldsEditable }

    { 1100485022;2;Field  ;
                SourceExpr="Company VAT Registration No." }

    { 1100485020;2;Field  ;
                SourceExpr="VAT Registration No.";
                Editable=FieldsEditable }

    { 1100485017;2;Field  ;
                SourceExpr="Country of Origin" }

    { 1100485016;2;Field  ;
                SourceExpr="Country of Destination" }

    { 1100285402;2;Field  ;
                SourceExpr="Payment Type Code Abroad";
                Visible=NORlocalizationEnable }

    { 1100285403;2;Field  ;
                SourceExpr="Specification (Norges Bank)";
                Visible=NORlocalizationEnable }

    { 1905403901;1;Group  ;
                CaptionML=ENU=Subcontracting }

    { 1000000002;2;Field  ;
                SourceExpr="Payment Agreement";
                Importance=Promoted;
                Editable="Payment AgreementEditable";
                OnValidate=BEGIN
                             PaymentAgreementOnAfterValidat;
                           END;
                            }

    { 1000000004;2;Field  ;
                SourceExpr="Actual Effective Date";
                Importance=Promoted;
                Editable="Actual Effective DateEditable" }

    { 1000000006;2;Field  ;
                SourceExpr="Actual End Date";
                Editable="Actual End DateEditable" }

    { 1000000008;2;Field  ;
                SourceExpr="Number of Hours";
                Editable="Number of HoursEditable";
                OnValidate=BEGIN
                             NumberofHoursOnAfterValidate;
                           END;
                            }

    { 1000000010;2;Field  ;
                SourceExpr="Avg. Wage Rate";
                Editable="Avg. Wage RateEditable" }

    { 1000000012;2;Field  ;
                SourceExpr="Labor Amount";
                Editable="Labor AmountEditable";
                OnValidate=BEGIN
                             LaborAmountOnAfterValidate;
                           END;
                            }

    { 1000000014;2;Field  ;
                SourceExpr="Contribution Percentage Labor";
                Editable=ContributionPercentageEditable;
                OnValidate=BEGIN
                             ContributionPercentageLaborOnA;
                           END;
                            }

    { 1210190008;2;Field  ;
                SourceExpr="Contribution Percentage Total";
                Editable=ContributionPercentageTotalEdi;
                OnValidate=BEGIN
                             ContributionPercentageTotalOnA;
                           END;
                            }

    { 1000000024;2;Field  ;
                SourceExpr="Pay To Tax Authority";
                Editable="Pay To Tax AuthorityEditable";
                OnValidate=BEGIN
                             PayToTaxAuthorityOnAfterValida;
                           END;
                            }

    { 1000000016;2;Field  ;
                SourceExpr="Wage Charge (to B Account)";
                Editable=WageChargetoBAccountEditable;
                OnValidate=BEGIN
                             WageChargetoBAccountOnAfterVal;
                           END;
                            }

    { 1000000018;2;Field  ;
                SourceExpr="Wage Charge (to Tax Authority)";
                Editable=WageChargetoTaxAuthorityEditab }

    { 1100525005;2;Field  ;
                Name=MemoWKA;
                CaptionML=ENU=Text;
                SourceExpr=PurchHeadExtensionRec.Memo;
                Editable=MemoWKAEditable;
                MultiLine=Yes;
                OnValidate=BEGIN
                             //**4PS
                             PurchHeadExtensionRec.UpdatePurchHeadExtension("Document Type", "No.");
                             CurrPage.SAVERECORD;
                           END;
                            }

    { 1100528500;2;Field  ;
                SourceExpr="Subcontract No." }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 27  ;1   ;Part      ;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9103;
                Visible=OpenApprovalEntriesExistForCurrUser;
                PartType=Page }

    { 1100529900;1;Part   ;
                Name=RegisterExternalDocumentFB;
                PagePartID=Page11125053;
                PartType=Page }

    { 1210190001;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            Document No.=FIELD(Document No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page11130181;
                ProviderID=54;
                PartType=Page }

    { 1906354007;1;Part   ;
                SubPageLink=Table ID=CONST(38),
                            Document Type=FIELD(Document Type),
                            Document No.=FIELD(No.);
                PagePartID=Page9092;
                Visible=FALSE;
                PartType=Page }

    { 1901138007;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9093;
                Visible=FALSE;
                PartType=Page }

    { 31  ;1   ;Part      ;
                Name=IncomingDocAttachFactBox;
                PagePartID=Page193;
                PartType=Page;
                ShowFilter=No }

    { 1904651607;1;Part   ;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9094;
                Visible=False;
                PartType=Page }

    { 1903435607;1;Part   ;
                SubPageLink=No.=FIELD(Buy-from Vendor No.);
                PagePartID=Page9095;
                Visible=False;
                PartType=Page }

    { 1906949207;1;Part   ;
                SubPageLink=No.=FIELD(Pay-to Vendor No.);
                PagePartID=Page9096;
                Visible=FALSE;
                PartType=Page }

    { 1010009;1;Part      ;
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(No.),
                            Line No.=FIELD(Line No.);
                PagePartID=Page9100;
                ProviderID=54;
                Visible=FALSE;
                PartType=Page }

    { 49  ;1   ;Part      ;
                Name=WorkflowStatus;
                PagePartID=Page1528;
                Visible=ShowWorkflowStatus;
                Enabled=FALSE;
                Editable=FALSE;
                PartType=Page;
                ShowFilter=No }

    { 1100409003;1;Part   ;
                SubPageLink=Document Type=FIELD(Document Type),
                            No.=FIELD(No.);
                PagePartID=Page11130225;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      PurchSetup@150000 : Record 312;
      ChangeExchangeRate@1001 : Page 511;
      CopyPurchDoc@1002 : Report 492;
      CorrectPurchDoc@1210190207 : Report 11012387;
      MoveNegPurchLines@1005 : Report 6698;
      ReportPrint@1003 : Codeunit 228;
      UserMgt@1004 : Codeunit 5700;
      PurchCalcDiscByType@1007 : Codeunit 66;
      VendorRec@11012001 : Record 23;
      ScanAppsSetup@1100525000 : Record 11012134;
      gFromReference@1210190001 : Boolean;
      gInvLineNo@1210190000 : Integer;
      gWKAPresent@1100485001 : Boolean;
      SavePeriodPlantRentEntries@1100485002 : Boolean;
      PurchHeadExtensionRec@1100525001 : Record 11020398;
      Text11012001@1100485003 : TextConst 'ENU=Amount to Distribute is greater than sum of all lines.';
      Text11012002@1100525002 : TextConst 'ENU=Not allowed with Purchase Setup VAT Indicator ''No VAT''';
      DPA_IsHardFilter@1100000999 : Boolean;
      BankAccountSelect@1210190102 : Text[34];
      BankAccountSelectEditable@1100525004 : Boolean INDATASET;
      "Interest DateVisible"@19029017 : Boolean INDATASET;
      BankNoCheckEditable@19051959 : Boolean INDATASET;
      PurchLinesEditable@19017010 : Boolean INDATASET;
      DocAmountVisible@19073433 : Boolean INDATASET;
      DocAmountVATVisible@19002035 : Boolean INDATASET;
      "Payment AgreementEditable"@19078437 : Boolean INDATASET;
      "Actual Effective DateEditable"@19052142 : Boolean INDATASET;
      "Actual End DateEditable"@19011700 : Boolean INDATASET;
      "Number of HoursEditable"@19032395 : Boolean INDATASET;
      "Avg. Wage RateEditable"@19003838 : Boolean INDATASET;
      "Labor AmountEditable"@19041756 : Boolean INDATASET;
      ContributionPercentageEditable@19066713 : Boolean INDATASET;
      "Pay To Tax AuthorityEditable"@19017584 : Boolean INDATASET;
      WageChargetoBAccountEditable@19062124 : Boolean INDATASET;
      WageChargetoTaxAuthorityEditab@19058677 : Boolean INDATASET;
      MemoWKAEditable@19038952 : Boolean INDATASET;
      "VAT AmountEditable"@19075252 : Boolean INDATASET;
      "Amount excl. VATEditable"@19000869 : Boolean INDATASET;
      "Invoice Lines InputEditable"@19022465 : Boolean INDATASET;
      BankAccountCodeBPaymentsEditab@19039773 : Boolean INDATASET;
      TransactionModeBPaymentsEditab@19044846 : Boolean INDATASET;
      DocAmountEnable@19024812 : Boolean INDATASET;
      DocAmountVATEnable@19071676 : Boolean INDATASET;
      HasIncomingDocument@1010 : Boolean;
      DocNoVisible@1006 : Boolean;
      VendorInvoiceNoMandatory@1008 : Boolean;
      OpenApprovalEntriesExist@1009 : Boolean;
      OpenApprovalEntriesExistForCurrUser@1000 : Boolean;
      ShowWorkflowStatus@1011 : Boolean;
      FieldsEditable@1210190002 : Boolean INDATASET;
      "On HoldEditable"@1210190103 : Boolean INDATASET;
      "Ext. Document IDVisible"@1210190104 : Boolean INDATASET;
      "Ext. Document IDEditable"@1210190108 : Boolean INDATASET;
      ContributionPercentageTotalEdi@1210190007 : Boolean INDATASET;
      InwRegList@1070001 : Page 11128014;
      InwRegForm@1100285002 : Page 11128010;
      VendLedgEntry@1100285001 : Record 25;
      GenJnlLine@1100285000 : Record 81;
      GLSetup@111285700 : Record 98;
      DKinfoEnable@11128570 : Boolean INDATASET;
      FIinfoEnable@11128200 : Boolean INDATASET;
      NORlocalizationEnable@1100285500 : Boolean INDATASET;
      "*** ExFlow ***"@12013593 : Integer;
      ExFlow@12013597 : Codeunit 12013601;
      "*** PEB ***"@12047960 : Integer;
      gBaseMgt@12047958 : Codeunit 11128082;

    PROCEDURE LineModified@7();
    BEGIN
    END;

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    BEGIN
      SendToPosting(PostingCodeunitID);
      IF "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting" THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE ApproveCalcInvDisc@1();
    BEGIN
      CurrPage.PurchLines.PAGE.ApproveCalcInvDisc;
    END;

    PROCEDURE EnableControls@1101100000();
    BEGIN
      //**4PS.sn  Setup PurchSetup."Check Doc. Total Amounts" not used by 4PS, so always not visible
      DocAmountVisible := (FALSE);
      DocAmountVATVisible := (FALSE);
      //**4PS.en
    END;

    PROCEDURE BuyfromVendorNoOnAfterValidate@19032492();
    BEGIN
      //**4PS.n Procedure made global
      IF GETFILTER("Buy-from Vendor No.") = xRec."Buy-from Vendor No." THEN
        IF "Buy-from Vendor No." <> xRec."Buy-from Vendor No." THEN
          SETRANGE("Buy-from Vendor No.");
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PurchaserCodeOnAfterValidate@19046120();
    BEGIN
      CurrPage.PurchLines.PAGE.UpdateForm(TRUE);
    END;

    LOCAL PROCEDURE DocAmountInclVATOnAfterValidat@19044073();
    BEGIN
    END;

    LOCAL PROCEDURE PaytoVendorNoOnAfterValidate@19048314();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PaymentTermsCodeOnAfterValidat@19038520();
    BEGIN
    END;

    LOCAL PROCEDURE PaymentDiscount37OnAfterValida@19047460();
    BEGIN
    END;

    LOCAL PROCEDURE ShortcutDimension1CodeOnAfterV@19029405();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE ShortcutDimension2CodeOnAfterV@19008725();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PricesIncludingVATOnAfterValid@19009096();
    BEGIN
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE AfterGetCurrentRecord@19077479();
    VAR
      RecRef@1100528700 : RecordRef;
    BEGIN
      xRec := Rec;

      //**4PS.sn
      PurchHeadExtensionRec.GetPurchHeadExtension("Document Type", "No.");
      SetFieldsEditable(FALSE);
      CheckWKAData;

      RecRef.GETTABLE(Rec);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetRecordReference(RecRef);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetByCompany(TRUE);
      CurrPage.RegisterExternalDocumentFB.PAGE.SetDepartmentCode("Shortcut Dimension 1 Code");
      //**4PS.en
    END;

    LOCAL PROCEDURE OnActivateForm@19002417();
    BEGIN
      EnableControls;
    END;

    LOCAL PROCEDURE SetDocNoVisible@2();
    VAR
      DocumentNoVisibility@1000 : Codeunit 1400;
      DocType@1003 : 'Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order,Reminder,FinChMemo';
    BEGIN
      DocNoVisible := DocumentNoVisibility.PurchaseDocumentNoIsVisible(DocType::Invoice,"No.");
    END;

    LOCAL PROCEDURE SetExtDocNoMandatoryCondition@3();
    VAR
      PurchasesPayablesSetup@1000 : Record 312;
    BEGIN
      PurchasesPayablesSetup.GET;
      VendorInvoiceNoMandatory := PurchasesPayablesSetup."Ext. Doc. No. Mandatory"
    END;

    LOCAL PROCEDURE SetControlAppearance@5();
    VAR
      ApprovalsMgmt@1002 : Codeunit 1535;
    BEGIN
      HasIncomingDocument := "Incoming Document Entry No." <> 0;
      SetExtDocNoMandatoryCondition;

      OpenApprovalEntriesExistForCurrUser := ApprovalsMgmt.HasOpenApprovalEntriesForCurrentUser(RECORDID);
      OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
    END;

    PROCEDURE InitSelectionFromReference@1210190002(IInvLineNo@1210190000 : Integer);
    BEGIN
      //**4PS
      gFromReference := TRUE;
      gInvLineNo := IInvLineNo;
    END;

    PROCEDURE ShowICFInvoiceLines@1210190000();
    VAR
      ICFLineRec@1210190000 : Record 11012327;
    BEGIN
      //**4PS
      ICFLineRec.RESET;
      ICFLineRec.SETRANGE(Vendor, "Pay-to Vendor No.");
      ICFLineRec.SETRANGE("Invoice No.", "No.");
      IF ICFLineRec.FIND('-') THEN
        PAGE.RUNMODAL(PAGE::"ICF Invoices", ICFLineRec);
    END;

    PROCEDURE ApproveICFInvoice@1100485000();
    VAR
      PurchLineRec@1210190003 : Record 39;
    BEGIN
      //**4PS
      PurchLineRec.RESET;
      PurchLineRec.SETRANGE("Document Type", "Document Type");
      PurchLineRec.SETRANGE("Document No.", "No.");
      PurchLineRec.SETFILTER(Type, '<>%1', PurchLineRec.Type::" ");
      IF PurchLineRec.FINDSET(TRUE, FALSE) THEN BEGIN
        REPEAT
          PurchLineRec.VALIDATE("ICF Line Approved", TRUE);
          PurchLineRec.MODIFY(TRUE);
        UNTIL PurchLineRec.NEXT = 0;
      END;
      CurrPage.UPDATE(TRUE);
    END;

    PROCEDURE CheckWKAData@1100485001();
    VAR
      lVendLedgEntryRec@1100485000 : Record 25;
      lvTmpDummyErrorRec@1100485001 : TEMPORARY Record 11012052;
      lvWKACalcCU@1210190004 : Codeunit 11012020;
    BEGIN
      //**4PS
      gWKAPresent := FALSE;
      IF NOT "Subcontracting Invoice" THEN
        EXIT;
      IF "Buy-from Vendor No." = '' THEN
        EXIT;

      lVendLedgEntryRec."Vendor No." := "Buy-from Vendor No.";
      lVendLedgEntryRec."Subcontracting Invoice" := "Subcontracting Invoice";
      lVendLedgEntryRec."Payment Agreement" := "Payment Agreement";
      lVendLedgEntryRec."Actual Effective Date" := "Actual Effective Date";
      lVendLedgEntryRec."Actual End Date" := "Actual End Date";
      lVendLedgEntryRec."Number of Hours" := "Number of Hours";
      lVendLedgEntryRec."Avg. Wage Rate" := "Avg. Wage Rate";
      lVendLedgEntryRec."Labor Amount" := "Labor Amount";
      lVendLedgEntryRec."Contribution Percentage Labor" := "Contribution Percentage Labor";
      lVendLedgEntryRec."Contribution Percentage Total" := "Contribution Percentage Total";
      lVendLedgEntryRec."Pay To Tax Authority" := "Pay To Tax Authority";
      lVendLedgEntryRec."Wage Charge (to B Account)" := "Wage Charge (to B Account)";
      lVendLedgEntryRec."Wage Charge (to Tax Authority)" := "Wage Charge (to Tax Authority)";
      lVendLedgEntryRec."Transaction Mode B Payments" := "Transaction Mode B Payments";
      lVendLedgEntryRec."Bank Account Code B Payments" := "Bank Account Code B Payments";
      IF "Document Type" = "Document Type"::Invoice THEN BEGIN
        lVendLedgEntryRec."Document Type" := lVendLedgEntryRec."Document Type"::Invoice;
        lVendLedgEntryRec.Approved := "Invoice Approved";
      END;
      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
        lVendLedgEntryRec."Document Type" := lVendLedgEntryRec."Document Type"::"Credit Memo";
        lVendLedgEntryRec.Approved := "Credit Memo Approved";
      END;
      lVendLedgEntryRec."Approvement Initials" := "Approvement Initials";
      //lVendLedgEntryRec."Interest Date" := "Interest Date";

      gWKAPresent := lvWKACalcCU.CheckExternal(lVendLedgEntryRec, lvTmpDummyErrorRec);
    END;

    PROCEDURE DistributeAmountOverLines@1100485002();
    VAR
      PurchLineRec@1100485000 : Record 39;
      TotalLineAmount@1100485001 : Decimal;
    BEGIN
      //**4PS
      TESTFIELD("Amounts only",TRUE);
      PurchLineRec.SETRANGE("Document Type", "Document Type");
      PurchLineRec.SETRANGE("Document No.", "No.");
      PurchLineRec.SETFILTER("Amount Including VAT", '<>%1', 0);
      IF PurchLineRec.FINDSET(FALSE, FALSE) THEN BEGIN
        REPEAT
          TotalLineAmount := TotalLineAmount + PurchLineRec."Amount Including VAT";
        UNTIL PurchLineRec.NEXT = 0;

        IF TotalLineAmount < "Amount incl. VAT" THEN
          ERROR(Text11012001);
      END;

      IF TotalLineAmount > 0 THEN
        IF PurchLineRec.FINDSET(TRUE, FALSE) THEN
          REPEAT
            PurchLineRec.VALIDATE(PurchLineRec."Amount Including VAT",
                      "Amount incl. VAT" * (PurchLineRec."Amount Including VAT"/TotalLineAmount));
            PurchLineRec.VALIDATE("Line Amount", PurchLineRec.Amount);
            //**4PS.sn
            PurchLineRec."Modified by" := USERID; //DP00469
            PurchLineRec."Last Date Modified" := TODAY;//DP00469
            //**4PS.en
            PurchLineRec.MODIFY;
          UNTIL PurchLineRec.NEXT = 0;
    END;

    PROCEDURE SetFieldsEditable@1100525001(NewRec@1100525001 : Boolean);
    VAR
      WKA@1100525000 : Boolean;
      RecEditable@1100525002 : Boolean;
    BEGIN
      //**4PS
      IF VendorRec."No." <> "Buy-from Vendor No." THEN
        IF NOT VendorRec.GET("Buy-from Vendor No.") THEN BEGIN
          VendorRec."Security Fund" := FALSE;
          VendorRec.SWP := FALSE;
        END;

      WKA := "Subcontracting Invoice" AND NOT VendorRec."Security Fund";

      "Payment AgreementEditable" := ("Subcontracting Invoice");
      "Actual Effective DateEditable" := (WKA);
      "Actual End DateEditable" := (WKA);
      "Number of HoursEditable" := (WKA);
      "Avg. Wage RateEditable" := (WKA AND NOT VendorRec.SWP);
      "Labor AmountEditable" := (WKA AND NOT VendorRec.SWP);
      ContributionPercentageEditable := (WKA);
      "Pay To Tax AuthorityEditable" := (WKA AND NOT VendorRec.SWP);
      WageChargetoBAccountEditable := (WKA AND NOT VendorRec.SWP AND NOT "Pay To Tax Authority");
      WageChargetoTaxAuthorityEditab := (WKA AND "Pay To Tax Authority");
      MemoWKAEditable := (WKA);
      "VAT AmountEditable" := ("Manually VAT Posting");
      "Amount excl. VATEditable" := ("Manually VAT Posting");
      "Invoice Lines InputEditable" := (PurchSetup."Approve Purchase Invoices");
      BankAccountCodeBPaymentsEditab := (
        "Subcontracting Invoice" AND NOT VendorRec."Security Fund" AND NOT VendorRec.SWP);
      TransactionModeBPaymentsEditab := (
        "Subcontracting Invoice" AND NOT VendorRec."Security Fund" AND NOT VendorRec.SWP);

      BankAccountSelectEditable := PurchSetup."Invoices on Bank Account" AND CurrPage.EDITABLE;

      //Managemind exceptions
      IF PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Managemind THEN
        EXIT;

      IF NOT ScanAppsSetup.GET THEN
        EXIT;

      RecEditable := NewRec OR ("Ext. Document ID" = '');

      CASE ScanAppsSetup."Permissions Invoice Header" OF
        ScanAppsSetup."Permissions Invoice Header"::"On Hold not editable":
          "On HoldEditable" := RecEditable;
        ScanAppsSetup."Permissions Invoice Header"::"Invoice Header not editable":
          BEGIN
            "Amount excl. VATEditable" := (RecEditable AND "Manually VAT Posting");
            "VAT AmountEditable" := (RecEditable AND "Manually VAT Posting");
            "Invoice Lines InputEditable" := (RecEditable AND PurchSetup."Approve Purchase Invoices");
            TransactionModeBPaymentsEditab := (RecEditable AND
              "Subcontracting Invoice" AND NOT VendorRec."Security Fund" AND NOT VendorRec.SWP);
            BankAccountCodeBPaymentsEditab := (RecEditable AND
              "Subcontracting Invoice" AND NOT VendorRec."Security Fund" AND NOT VendorRec.SWP);

            //"Bank No. CheckEditable" := (RecEditable);
            FieldsEditable := RecEditable; //**4PS.djnieuwenhuizen.n RTC 30-06-2011
            "On HoldEditable" := RecEditable; //C003157
          END;
      END;
    END;

    PROCEDURE ValidateRelatedPurchOrder@1100525000();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
      COMMIT; //11-03-2014
      IF GetReceiptsRelatedOrderAutomat(Rec) THEN BEGIN
        GET("Document Type", "No.");
        CurrPage.UPDATE;
      END;
    END;

    PROCEDURE ValidateBuyFromVendorNo@1210190001();
    BEGIN
    END;

    PROCEDURE WhiteVisionStart@1100528300();
    VAR
      WhiteVisionMgt@1100528300 : Codeunit 11012084;
    BEGIN
      //**4PS
      IF (PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Whitevision) THEN
        EXIT;

      WhiteVisionMgt.LoadDocuments("No.", FALSE);
    END;

    PROCEDURE WhiteVisionStop@1100528301();
    VAR
      WhiteVisionMgt@1100528300 : Codeunit 11012084;
    BEGIN
      //**4PS
      IF (PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Whitevision) THEN
        EXIT;

      WhiteVisionMgt.Stop;
    END;

    PROCEDURE WhiteVisionActivateField@1100528303(FieldName@1100528301 : Text[30];FieldType@1100528302 : Option) : Text[250];
    VAR
      WhiteVisionMgt@1100528300 : Codeunit 11012084;
    BEGIN
      //**4PS
      //FieldType:
      //0: Text
      //1: Decimal
      //2: Date
      //3: Money
      //4: RegEx

      IF (PurchSetup."Scanning Application Purch.Inv" <> PurchSetup."Scanning Application Purch.Inv"::Whitevision) THEN
        EXIT('');

      EXIT(WhiteVisionMgt.ActivateField(FieldName, FieldType));
    END;

    LOCAL PROCEDURE VATProdPostingGroupOnAfterVali@19001691();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE SubcontractingInvoiceOnAfterVa@19014981();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE AmountexclVATOnAfterValidate@19044333();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE VATAmountOnAfterValidate@19038655();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE InvoiceLinesInputOnAfterValida@19043059();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE AmountinclVATOnAfterValidate@19037268();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE JobNoOnAfterValidate@19070084();
    BEGIN
      //**4PS
      CurrPage.UPDATE;
    END;

    LOCAL PROCEDURE PaymentAgreementOnAfterValidat@19059474();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE NumberofHoursOnAfterValidate@19014369();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE LaborAmountOnAfterValidate@19042394();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ContributionPercentageLaborOnA@19007239();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE WageChargetoBAccountOnAfterVal@19015148();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE PayToTaxAuthorityOnAfterValida@19033144();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ContributionPercentageTotalOnA@19018232();
    BEGIN
      //**4PS
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE ActualEffectiveDateOnActivate@19016407();
    BEGIN
      //**4PS this is necessary to set fields editable in case a payment agreement is selected with a lookup
      CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE FillSelectBankAccount@1100525002();
    BEGIN
      //**4PS
      IF PurchSetup."Bank Account Check" AND ("Bank No. Check" = '') THEN
        BankAccountSelect := ''
      ELSE
        BankAccountSelect := "Bank Account No.";
    END;

    BEGIN
    {
      4PS 24-09-2009 PS, Approval removed
      4PSSE ITERO.BSL Periodic fields in Invoice tab
      --- ExFlow --->
      Field General : Approve
      Field General : ExFlowStatus
      Field General : Requisition No.
      Field General : Gross Invoice Amount
      Field General : Imported VAT Amount
      Field General : Receipt No. Mandatory
      Field General : Block Document
      Action        : Show Document (Code)
      Action        : Attachments
      Globals
      <-- ExFlow ---
      Version List=NAVW19.00.00.44974,NAVSE9.00.00.44974;
      Version List=NAVW19.00.00.44974,NAVFI9.00.00.44974;
      Version List=NAVW19.00.00.44974,NAVDK9.00.00.44974;
      Version List=NAVW19.00.00.45834,NAVNO9.00.00.44974;
      PEB *** Begin ***
      PEB0010 Arrival Postings
        -OnPush: Invoice/Inward Registration - Faktura/Ankomstregistrering
      PEB0025 "Gross Invioce Amount" and Rounding
      PEB0042 Get Coding from Latest Invoice
      PEB0091 Bankning
        New fields on Page
        General:
         - OCR No.
         - "Recipient Bank Account"
      PEB
        New fields on Page
        General:
         - Due Date
         - Gross Invoice Amount, NextControl=54
         - Next Control on Vendor Invoice No. = 1000000002 (Gross Invoice Amount)
         - Next Control <Undefined> on field Document Date
      PEB *** End ***
    }
    END.
  }
}

