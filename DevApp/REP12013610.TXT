OBJECT Report 12013610 Change Journal Quote
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EXF350000,NAV2013;
  }
  PROPERTIES
  {
    CaptionML=ENU=Change Journal Quote;
    ProcessingOnly=Yes;
    UseRequestPage=No;
  }
  DATASET
  {
    { 4272;    ;DataItem;                    ;
               DataItemTable=Table12013608;
               DataItemTableView=SORTING(Company Name,Document Type,Document No.);
               OnPreDataItem=BEGIN
                               AppSetup.GET(COMPANYNAME, 0);

                               SETRANGE("Company Name", COMPANYNAME);
                               SETRANGE("Document Type", "Document Type"::Quote);
                               SETRANGE(Status, Status::Approved);
                             END;

               OnAfterGetRecord=BEGIN
                                  COMMIT;
                                  CLEARLASTERROR;

                                  CLEAR(cu606);
                                  IF cu606.RUN("EX Document") THEN
                                    BEGIN
                                      COMMIT;
                                      PurchHeader.GET("EX Document"."Document Type", "EX Document"."Document No.");
                                      CLEAR(cuMakeOrder);
                                      IF cuMakeOrder.RUN(PurchHeader) THEN
                                        BEGIN
                                          IF AppSetup."Automatic Receipt Order" IN [AppSetup."Automatic Receipt Order"::"All documents",
                                                                                    AppSetup."Automatic Receipt Order"::"Requisition orders only"] THEN
                                            BEGIN
                                              COMMIT;

                                              DocHeadOrder.RESET;
                                              IF DocHeadOrder.SETCURRENTKEY("Document No.") THEN;
                                              DocHeadOrder.SETRANGE("Company Name",COMPANYNAME);
                                              DocHeadOrder.SETRANGE("Document Type",DocHeadOrder."Document Type"::Order);
                                              DocHeadOrder.SETRANGE("Document No.", PurchHeader."No.");
                                              IF DocHeadOrder.FIND('-') THEN BEGIN
                                                PurchOrderHead.GET(PurchOrderHead."Document Type"::Order, DocHeadOrder."Document No.");
                                                PurchOrderHead.Receive := TRUE;
                                                PurchOrderHead.Invoice := FALSE;
                                                CLEAR(cu90);
                                                IF cu90.RUN(PurchOrderHead) THEN
                                                  BEGIN
                                                    DocHeadOrder.RESET;
                                                    IF DocHeadOrder.SETCURRENTKEY("Document No.") THEN;
                                                    DocHeadOrder.SETRANGE("Company Name",COMPANYNAME);
                                                    DocHeadOrder.SETRANGE("Document Type",DocHeadOrder."Document Type"::Order);
                                                    DocHeadOrder.SETRANGE("Document No.", PurchHeader."No.");
                                                    IF DocHeadOrder.FIND('-') THEN BEGIN
                                                      DocHeadOrder.Status := DocHead.Status::Received;
                                                      DocHeadOrder.MODIFY(FALSE);
                                                    END;
                                                  END
                                                ELSE BEGIN
                                                  IF DocHead.RetrieveRecord(DocHead,COMPANYNAME, PurchOrderHead."Document Type", PurchOrderHead."No.") THEN BEGIN
                                                    DocHead."Error Message" := COPYSTR(GETLASTERRORTEXT,1,MAXSTRLEN(DocHead."Error Message"));
                                                    DocHead.MODIFY(FALSE);
                                                  END;
                                                END;
                                              END;
                                            END;
                                        END
                                      ELSE
                                        BEGIN
                                          IF DocHead.GET(ID) THEN BEGIN
                                            DocHead."Error Message" := COPYSTR(GETLASTERRORTEXT,1,MAXSTRLEN(DocHead."Error Message"));
                                            DocHead.MODIFY(FALSE);
                                          END;
                                        END;
                                    END
                                  ELSE
                                    BEGIN
                                      IF DocHead.GET(ID) THEN BEGIN
                                        DocHead."Error Message" := COPYSTR(GETLASTERRORTEXT,1,MAXSTRLEN(DocHead."Error Message"));
                                        DocHead.MODIFY(FALSE);
                                      END;
                                    END;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      DocHead@1100285001 : Record 12013608;
      cu606@1100285002 : Codeunit 12013606;
      cu90@1100285022 : Codeunit 90;
      cuMakeOrder@1100285020 : Codeunit 12013607;
      PurchHeader@1100285018 : Record 38;
      AppSetup@1100285008 : Record 12013601;
      DocHeadOrder@1100285006 : Record 12013608;
      PurchOrderHead@1100285005 : Record 38;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

