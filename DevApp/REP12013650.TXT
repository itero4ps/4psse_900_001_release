OBJECT Report 12013650 Change Company Name ExF Tables
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EXF350001,NAV2013;
  }
  PROPERTIES
  {
    CaptionML=ENU=Change Company Name in ExFlow Tables;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF OldCompanyName = NewCompanyName THEN
                    ERROR(Text001);

                  IF (OldCompanyName = '') OR (NewCompanyName = '') THEN
                    ERROR(Text002);

                  Window.OPEN(Text004);
                END;

    OnPostReport=BEGIN
                   Window.CLOSE;

                   MESSAGE(Text003);
                 END;

  }
  DATASET
  {
    { 9934;    ;DataItem;                    ;
               DataItemTable=Table12013597;
               DataItemTableView=SORTING(ID);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name",OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExInvCode.GET(ID);
                                  ExInvCode."Company Name" := NewCompanyName;
                                  ExInvCode.MODIFY;
                                END;
                                 }

    { 8833;    ;DataItem;                    ;
               DataItemTable=Table12013600;
               DataItemTableView=SORTING(ID);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name",OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExWebCode.GET(ID);
                                  ExWebCode."Company Name" := NewCompanyName;
                                  ExWebCode.MODIFY;
                                END;
                                 }

    { 7489;    ;DataItem;                    ;
               DataItemTable=Table12013601;
               DataItemTableView=SORTING(Company Name,Primary Key);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF EXApprovalSetup.GET(NewCompanyName,0) THEN
                                    EXApprovalSetup.DELETE;

                                  EXApprovalSetup.INIT;
                                  EXApprovalSetup.TRANSFERFIELDS("EX Approval Setup");
                                  EXApprovalSetup."Company Name" := NewCompanyName;
                                  EXApprovalSetup.INSERT;

                                  EXApprovalSetup.GET("Company Name","Primary Key");
                                  EXApprovalSetup.DELETE;
                                END;
                                 }

    { 3961;    ;DataItem;                    ;
               DataItemTable=Table12013603;
               DataItemTableView=SORTING(Company Name,Code,Line No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  TemplateLines.INIT;
                                  TemplateLines.TRANSFERFIELDS("Template Rule Line");
                                  TemplateLines."Company Name" := NewCompanyName;
                                  TemplateLines.INSERT;

                                  TemplateLines.GET("Company Name",Code,"Line No.");
                                  TemplateLines.DELETE;
                                END;
                                 }

    { 8565;    ;DataItem;                    ;
               DataItemTable=Table12013606;
               DataItemTableView=SORTING(Company Name,Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  EXUserGroup.INIT;
                                  EXUserGroup.TRANSFERFIELDS("EX User Group");
                                  EXUserGroup."Company Name" := NewCompanyName;
                                  EXUserGroup.INSERT;

                                  EXUserGroup.GET("Company Name",Code);
                                  EXUserGroup.DELETE;
                                END;
                                 }

    { 8620;    ;DataItem;                    ;
               DataItemTable=Table12013607;
               DataItemTableView=SORTING(Company Name,Code,Line No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  EXUserGroupLine.INIT;
                                  EXUserGroupLine.TRANSFERFIELDS("EX User Group Line");
                                  EXUserGroupLine."Company Name" := NewCompanyName;
                                  EXUserGroupLine.INSERT;

                                  EXUserGroupLine.GET("Company Name",Code,"Line No.");
                                  EXUserGroupLine.DELETE;
                                END;
                                 }

    { 4272;    ;DataItem;                    ;
               DataItemTable=Table12013608;
               DataItemTableView=SORTING(Company Name,Document Type,Document No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  EXDocument.GET(ID);
                                  EXDocument."Company Name" := NewCompanyName;
                                  EXDocument.MODIFY;
                                END;
                                 }

    { 1621;    ;DataItem;                    ;
               DataItemTable=Table12013609;
               DataItemTableView=SORTING(Company Name,Document Type,Document No.,Line No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  EXDocumentLine.GET(ID);
                                  EXDocumentLine."Company Name" := NewCompanyName;
                                  EXDocumentLine.MODIFY;
                                END;
                                 }

    { 9385;    ;DataItem;                    ;
               DataItemTable=Table12013610;
               DataItemTableView=SORTING(Company Name,Document Type,Document No.,Line No.,Approver Order);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  EXDocumentLineApprover.GET(ID);
                                  EXDocumentLineApprover."Company Name" := NewCompanyName;
                                  EXDocumentLineApprover.MODIFY;
                                END;
                                 }

    { 8302;    ;DataItem;                    ;
               DataItemTable=Table12013611;
               DataItemTableView=SORTING(Company Name,Document Type,Document No.,Line No.,Dimension Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  EXDocumentLineDimension.GET(ID);
                                  EXDocumentLineDimension."Company Name" := NewCompanyName;
                                  EXDocumentLineDimension.MODIFY;
                                END;
                                 }

    { 8414;    ;DataItem;                    ;
               DataItemTable=Table12013612;
               DataItemTableView=SORTING(Document No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExDocument2.GET("Entry No.");
                                  ExDocument2."Company Name" := NewCompanyName;
                                  ExDocument2.MODIFY;
                                END;
                                 }

    { 8098;    ;DataItem;                    ;
               DataItemTable=Table12013613;
               DataItemTableView=SORTING(ID);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name",OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExLocation.GET(ID);
                                  ExLocation."Company Name" := NewCompanyName;
                                  ExLocation.MODIFY;
                                END;
                                 }

    { 4680;    ;DataItem;                    ;
               DataItemTable=Table12013616;
               DataItemTableView=SORTING(ID);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name",OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExCountry.GET(ID);
                                  ExCountry."Company Name" := NewCompanyName;
                                  ExCountry.MODIFY;
                                END;
                                 }

    { 9674;    ;DataItem;                    ;
               DataItemTable=Table12013621;
               DataItemTableView=SORTING(Company Name,Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ReqRule.INIT;
                                  ReqRule.TRANSFERFIELDS("Requisition Rule");
                                  ReqRule."Company Name" := NewCompanyName;
                                  ReqRule.INSERT;

                                  ReqRule.GET("Company Name",Code);
                                  ReqRule.DELETE;
                                END;
                                 }

    { 7251;    ;DataItem;                    ;
               DataItemTable=Table12013622;
               DataItemTableView=SORTING(Company Name,Status,Document Type,Document No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExDelDoc.GET(ID);
                                  ExDelDoc."Company Name" := NewCompanyName;
                                  ExDelDoc.MODIFY;
                                END;
                                 }

    { 6830;    ;DataItem;                    ;
               DataItemTable=Table12013623;
               DataItemTableView=SORTING(Company Name,Document Type,Document No.,Line No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExDelDocLine.GET(ID);
                                  ExDelDocLine."Company Name" := NewCompanyName;
                                  ExDelDocLine.MODIFY;
                                END;
                                 }

    { 3263;    ;DataItem;                    ;
               DataItemTable=Table12013624;
               DataItemTableView=SORTING(Company Name,Document Type,Document No.,Line No.,Approver Order);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExDelDocLineApp.GET(ID);
                                  ExDelDocLineApp."Company Name" := NewCompanyName;
                                  ExDelDocLineApp.MODIFY;
                                END;
                                 }

    { 3414;    ;DataItem;                    ;
               DataItemTable=Table12013625;
               DataItemTableView=SORTING(Company Name,Document Type,Document No.,Line No.,Dimension Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExDelDocLineDim.GET(ID);
                                  ExDelDocLineDim."Company Name" := NewCompanyName;
                                  ExDelDocLineDim.MODIFY;
                                END;
                                 }

    { 6984;    ;DataItem;                    ;
               DataItemTable=Table12013641;
               DataItemTableView=SORTING(Company Name,User ID);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  EXUserCompany.INIT;
                                  EXUserCompany.TRANSFERFIELDS("EX User Company");
                                  EXUserCompany."Company Name" := NewCompanyName;
                                  EXUserCompany.INSERT;

                                  EXUserCompany.GET("Company Name","User ID");
                                  EXUserCompany.DELETE;
                                END;
                                 }

    { 5473;    ;DataItem;                    ;
               DataItemTable=Table12013643;
               DataItemTableView=SORTING(Company Name,Entry No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  AttachedFile.INIT;
                                  AttachedFile.TRANSFERFIELDS("EX Attached File");
                                  AttachedFile."Company Name" := NewCompanyName;
                                  AttachedFile.INSERT;

                                  AttachedFile.GET("Company Name","Entry No.");
                                  AttachedFile.DELETE;
                                END;
                                 }

    { 7935;    ;DataItem;                    ;
               DataItemTable=Table12013645;
               DataItemTableView=SORTING(Company Name,Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  TemplateRule.INIT;
                                  TemplateRule.TRANSFERFIELDS("Template Rule");
                                  TemplateRule."Company Name" := NewCompanyName;
                                  TemplateRule.INSERT;

                                  TemplateRule.GET("Company Name",Code);
                                  TemplateRule.DELETE;
                                END;
                                 }

    { 2926;    ;DataItem;                    ;
               DataItemTable=Table12013660;
               DataItemTableView=SORTING(Company Name,ID);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  EXCodingRule.INIT;
                                  EXCodingRule.TRANSFERFIELDS("EX Coding Rule");
                                  EXCodingRule."Company Name" := NewCompanyName;
                                  EXCodingRule.INSERT;

                                  EXCodingRule.GET("Company Name",ID);
                                  EXCodingRule.DELETE;
                                END;
                                 }

    { 5711;    ;DataItem;                    ;
               DataItemTable=Table12013661;
               DataItemTableView=SORTING(Company Name,ID);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  EXColumn.INIT;
                                  EXColumn.TRANSFERFIELDS("EX Column");
                                  EXColumn."Company Name" := NewCompanyName;
                                  EXColumn.INSERT;

                                  EXColumn.GET("Company Name",ID);
                                  EXColumn.DELETE;
                                END;
                                 }

    { 1686;    ;DataItem;                    ;
               DataItemTable=Table12013663;
               DataItemTableView=SORTING(Company Name,ID,Line No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExCodingRuleLine.INIT;
                                  ExCodingRuleLine.TRANSFERFIELDS("Ex Coding Rule Line");
                                  ExCodingRuleLine."Company Name" := NewCompanyName;
                                  ExCodingRuleLine.INSERT;

                                  ExCodingRuleLine.GET("Company Name",ID,"Line No.");
                                  ExCodingRuleLine.DELETE;
                                END;
                                 }

    { 8740;    ;DataItem;                    ;
               DataItemTable=Table12013664;
               DataItemTableView=SORTING(Company Name,Coding Rule ID,User Group Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ExCodingRuleAppGroup.INIT;
                                  ExCodingRuleAppGroup.TRANSFERFIELDS("Coding Rule Approval Group");
                                  ExCodingRuleAppGroup."Company Name" := NewCompanyName;
                                  ExCodingRuleAppGroup.INSERT;

                                  ExCodingRuleAppGroup.GET("Company Name","Coding Rule ID","User Group Code");
                                  ExCodingRuleAppGroup.DELETE;
                                END;
                                 }

    { 5467;    ;DataItem;                    ;
               DataItemTable=Table12013669;
               DataItemTableView=SORTING(Import Source Type,Import Company Name,Vendor No.,Import No.);
               OnPreDataItem=BEGIN
                               SETRANGE("Import Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  ImportMapping.INIT;
                                  ImportMapping.TRANSFERFIELDS("Import Mapping Table");
                                  ImportMapping."Import Company Name" := NewCompanyName;
                                  ImportMapping.INSERT;

                                  ImportMapping.GET("Import Source Type","Import Company Name","Vendor No.","Import No.");
                                  ImportMapping.DELETE;
                                END;
                                 }

    { 7867;    ;DataItem;                    ;
               DataItemTable=Table12013670;
               DataItemTableView=SORTING(Import Source Type,Import Company Name,Vendor No.,Import No.,Dimension Code);
               OnPreDataItem=BEGIN
                               SETRANGE("Import Company Name", OldCompanyName);
                               Window.UPDATE(1,TABLECAPTION);
                             END;

               OnAfterGetRecord=BEGIN
                                  DefaultMapDim.INIT;
                                  DefaultMapDim.TRANSFERFIELDS("Default Mapping Dimension");
                                  DefaultMapDim."Import Company Name" := NewCompanyName;
                                  DefaultMapDim.INSERT;

                                  DefaultMapDim.GET("Import Source Type","Import Company Name","Vendor No.","Import No.","Dimension Code");
                                  DefaultMapDim.DELETE;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1100285001;0;Container;
                  ContainerType=ContentArea }

      { 1100285005;1;Group  ;
                  CaptionML=ENU=Options }

      { 1100285000;2;Field  ;
                  CaptionML=ENU=Old Company Name;
                  SourceExpr=OldCompanyName;
                  TableRelation="EX Approval Setup";
                  LookupPageID=ExFlow Setup List }

      { 1100285002;2;Field  ;
                  CaptionML=ENU=New Company Name;
                  SourceExpr=NewCompanyName;
                  TableRelation=Company }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      OldCompanyName@1100285000 : Text[50];
      NewCompanyName@1100285002 : Text[50];
      Window@1100285021 : Dialog;
      ExInvCode@1100285019 : Record 12013597;
      ExWebCode@1100285022 : Record 12013600;
      EXApprovalSetup@1100285015 : Record 12013601;
      TemplateLines@1100285016 : Record 12013603;
      EXUserGroup@1100285005 : Record 12013606;
      EXUserGroupLine@1100285013 : Record 12013607;
      EXDocument@1100285014 : Record 12013608;
      EXDocumentLine@1100285011 : Record 12013609;
      EXDocumentLineApprover@1100285024 : Record 12013610;
      EXDocumentLineDimension@1100285025 : Record 12013611;
      ExDocument2@1100285009 : Record 12013612;
      ExLocation@1100285010 : Record 12013613;
      ExCountry@1100285026 : Record 12013616;
      ReqRule@1100285028 : Record 12013621;
      ExDelDoc@1100285029 : Record 12013622;
      ExDelDocLine@1100285030 : Record 12013623;
      ExDelDocLineApp@1100285031 : Record 12013624;
      ExDelDocLineDim@1100285032 : Record 12013625;
      EXUserCompany@1100285007 : Record 12013641;
      AttachedFile@1100285017 : Record 12013643;
      TemplateRule@1100285006 : Record 12013645;
      EXCodingRule@1100285004 : Record 12013660;
      EXColumn@1100285003 : Record 12013661;
      ExCodingRuleLine@1100285001 : Record 12013663;
      Text001@1100285020 : TextConst 'ENU=You cannot have the same company name in both old and new!';
      Text002@1100285023 : TextConst 'ENU=Both New and Old Company names must be populated!';
      Text003@1100285027 : TextConst 'ENU=Rename completed!';
      ExCodingRuleAppGroup@1100285008 : Record 12013664;
      ImportMapping@1100285012 : Record 12013669;
      DefaultMapDim@1100285018 : Record 12013670;
      Text004@1100285033 : TextConst 'ENU=Updating #1##################################';

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

