OBJECT Report 78765 PGL Export
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=XCEL400-IMIND-RJA;
  }
  PROPERTIES
  {
    CaptionML=ENU=PGL Export;
    ProcessingOnly=Yes;
    OnInitReport=BEGIN
                   // 4PS TRU 23-04-2010 BEGIN
                   // ExcludeSubProjClosedInPrevYear := TRUE;
                   // 4PS TRU 23-04-2010 END
                 END;

    OnPreReport=BEGIN
                  JobFilter := Job.GETFILTERS;
                  Dim1Filter := Job.GETFILTER("Global Dimension 1 Code");
                END;

    OnPostReport=BEGIN
                   //xlApp.ActiveWorkbook.Save;
                   xlApp.Calculation := xlCalculationAutomatic;
                   xlApp.ActiveWindow.Zoom := 100;
                   xlApp.Visible := TRUE;
                 END;

  }
  DATASET
  {
    { 8019;    ;DataItem;                    ;
               DataItemTable=Table11072003;
               DataItemTableView=SORTING(Main Project);
               OnPreDataItem=VAR
                               ColCount@1000000000 : Integer;
                               ltxtPeriod@1000000001 : Text[2];
                             BEGIN
                               IF CumulationFilterTxt <> '' THEN
                                 SearchPeriod.FindPeriod(DatFilterStart,DatFilterEnd,CumulationFilterTxt,PeriodFilterTxt,PeriodType,'');

                               CREATE(xlApp, FALSE, TRUE);

                               xlBook := xlApp.Workbooks.Open(Filename);
                               xlApp.Calculation := xlCalculationManual;
                               xlApp.DisplayAlerts := FALSE;
                               xlSheet := xlApp.Worksheets.Item(Sheetname);
                               xlSheet.Range('M1:DZ3').ClearContents;
                               xlSheet.Range('M1:DZ3').NumberFormat := FORMAT('dd-mm-jjjj');
                               xlSheet.Range('A7:DZ9999').ClearContents;
                               xlSheet.Range('A7:DZ9999').Interior.ColorIndex := 0;
                               xlSheet.Range('A7:DZ9999').Font.ColorIndex := 0;
                               xlApp.ActiveWindow.FreezePanes := FALSE;
                               xlSheet.Range('D7').Select;
                               xlApp.ActiveWindow.FreezePanes := TRUE;
                               xlSheet.Range('A:A').ColumnWidth := 10.41;
                               xlSheet.Range('A1').Value := 'ProjectData Report (PDL) '+ COMPANYNAME;
                               IF ExcludeSubProjClosedInPrevYear THEN BEGIN
                                 xlSheet.Range('A4').HorizontalAlignment := xlLeft;
                                 xlSheet.Range('A4').Value := FORMAT(Text060);
                               END;
                               xlSheet.Range('J:GZ').ColumnWidth := 12;

                               Window.OPEN('Report progress @1@@@@@@@@');

                               IF DatFilterEnd = 0D THEN
                                 ERROR(Text004);

                               IYear := DATE2DMY(DatFilterEnd,3);
                               IMonth := DATE2DMY(DatFilterEnd,2);

                               PeriodStartingDate := DMY2DATE(1,1,IYear);
                               AccountingPeriod.RESET;
                               IF NOT AccountingPeriod.GET(PeriodStartingDate) THEN
                                 ERROR(Text005);

                               AccountingPeriod2.SETFILTER("Starting Date",'>=%1',AccountingPeriod."Starting Date");
                               MaxCount := AccountingPeriod2.COUNT;
                               IF MaxCount > IMonth THEN
                                 MaxCount := IMonth;

                               IF MaxCount > 12 THEN
                                 MaxCount := 12;   //4PS.GB 02-12-2009

                               // 4PS TRU 23-04-2010 BEGIN
                               // new calculation MaxCount because period can end in next month.
                               AccountingPeriod3.RESET;
                               AccountingPeriod3.SETRANGE("Starting Date", PeriodStartingDate, DatFilterEnd);
                               intPeriodeInAccYear := AccountingPeriod3.COUNT;
                               IF STRLEN(FORMAT(intPeriodeInAccYear)) = 1 THEN BEGIN;
                                 ltxtPeriod := '0' + FORMAT(intPeriodeInAccYear);
                               END ELSE BEGIN;
                                 ltxtPeriod := FORMAT(intPeriodeInAccYear);
                               END;
                               MaxCount := intPeriodeInAccYear;
                               // 4PS TRU 23-04-2010 END

                               FOR i := 14 TO 20 DO
                                 xlSheet.Range(matrix(i,3)).Value := '..' + FORMAT(PeriodStartingDate - 1);
                               PrevEndDate := PeriodStartingDate - 1;

                               AccountingPeriod4.RESET;
                               AccountingPeriod4.SETRANGE("Starting Date", 0D, PeriodStartingDate -1);
                               IF AccountingPeriod4.FINDLAST THEN
                                 PrevStartDate := AccountingPeriod4."Starting Date";


                               y := 21;
                               FOR i := 1 TO MaxCount DO BEGIN
                                 StartDate[i] := AccountingPeriod."Starting Date";
                                 EndDate[i] := AccPeriodEndDate(StartDate[i]);
                                 PeriodName[i] := AccountingPeriod.Name;
                                 AccountingPeriod.NEXT;
                                 ColCount := 1;
                                 xlSheet.Range(matrix(y,1)).Value := '''' + FORMAT(PeriodName[i]);
                                 xlSheet.Range(matrix(y,1)+':'+matrix(y+8,1)).Columns.Merge := TRUE;
                                 WHILE ColCount < 10 DO BEGIN
                                   xlSheet.Range(matrix(y + ColCount - 1,2)).Value := FORMAT(StartDate[i]);
                                   xlSheet.Range(matrix(y + ColCount - 1,3)).Value := FORMAT(EndDate[i]);

                                   // jhoek.040609.begin
                                   xlSheet.Range(matrix(y + ColCount - 1, 4)).Value := UPPERCASE(GetColumnHeader(ColCount, 1));
                                   xlSheet.Range(matrix(y + ColCount - 1, 5)).Value := UPPERCASE(GetColumnHeader(ColCount, 2));
                                   // jhoek.040609.end

                                   ColCount += 1;
                                 END;
                                 y += 9;
                               END;

                               xlSheet.Range(matrix(4,1)).Value := Dim1Filter;

                               x := 7;
                               y := 1;

                               IF NOT PrintDetails THEN
                                 SETFILTER("Single/Main/Sub Project",'%1|%2',"Single/Main/Sub Project"::Single,"Single/Main/Sub Project"::"Main Project");

                               DPA_SetFilters(CurrReport.OBJECTID(FALSE)); //4PS.n

                               TotalRec := COUNT;
                             END;

               OnAfterGetRecord=VAR
                                  lvPrognosis@1000000000 : ARRAY [2] OF Decimal;
                                  l_PrognRec@1000000001 : Record 11012034;
                                  Employee@1000000007 : Record 5200;
                                  ClosedCosts@1000000002 : Decimal;
                                  ClosedRevenues@1000000003 : Decimal;
                                  ActualCosts@1000000005 : Decimal;
                                  Revenues2@1000000004 : Decimal;
                                  ExpectedCompletionDate@1100525000 : Date;
                                  ExpectedCompletionDate2@1000000006 : Date;
                                  PreviousCostPrognosis@1100525002 : Decimal;
                                  PreviousRevenuePrognosis@1100525001 : Decimal;
                                  PreclosureCosts@1100525003 : Decimal;
                                  PreclosureRevenues@1100525004 : Decimal;
                                  lrecJob@1000000008 : Record 11072003;
                                  lrecAccountingPeriod@1000000009 : Record 50;
                                  ldatStartingDateExpComplDate@1000000010 : Date;
                                  lintPeriodeInAccYear@1000000011 : Integer;
                                  ltxtPeriod@1000000012 : Text[30];
                                BEGIN
                                  CurRec += 1;
                                  Window.UPDATE(1,ROUND(CurRec/TotalRec * 10000,1));

                                  PreviousCostPrognosis := 0;
                                  PreviousRevenuePrognosis := 0;

                                   // 4PS TRU 23-04-2010 BEGIN
                                   // Een compleet in het vorig boekjaar afgesloten project niet afdrukken.
                                  IF (NOT blnShowCompClosPrevYear) AND (Job."Posting Date Closing" <> 0D) THEN BEGIN;
                                    lrecJob.RESET;
                                    lrecJob.SETCURRENTKEY(lrecJob."Main Project");
                                    lrecJob.SETRANGE("Main Project", Job."Main Project");
                                    // 4PS TRU 10-06-2010 BEGIN
                                    // lrecJob.SETFILTER("Posting Date Closing", '%1..', PeriodStartingDate);
                                    lrecJob.SETFILTER("Posting Date Closing", '%1..|%2', PeriodStartingDate, 0D);
                                    // 4PS TRU 10-06-2010 END
                                    IF NOT lrecJob.FINDSET THEN BEGIN;
                                      CurrReport.SKIP;
                                    END;
                                  END;
                                  // 4PS TRU 23-04-2010 END


                                  // jhoek.040609.begin
                                  // Deelproject reeds in vorig jaar afgesloten; niet tonen.
                                  IF PrintDetails THEN
                                    IF ExcludeSubProjClosedInPrevYear THEN
                                      IF "Posting Date Closing" <> 0D THEN
                                        IF "Posting Date Closing" < PeriodStartingDate THEN
                                          CurrReport.SKIP;
                                  // jhoek.040609.end

                                  LastPage:=FALSE;

                                  BufferJobLedgerEntries("Main Project"); // jhoek.110609

                                  FOR Teller := 1 TO 180 DO
                                    CellCde[Teller] := matrix(Teller,x);

                                  xlSheet.Range(CellCde[1]+':'+CellCde[124]).Font.Bold := FALSE;
                                  // jhoek.040609.begin
                                  // xlSheet.Range(CellCde[5]+':'+CellCde[124]).NumberFormat := '#';
                                  xlSheet.Range(CellCde[5]+':'+CellCde[124]).NumberFormat := '#.###';
                                  // jhoek.040609.end

                                  xlSheet.Range(CellCde[1]).Value := ''''+FORMAT("No.");
                                  xlSheet.Range(CellCde[2]).Value := FORMAT(Description);
                                  xlSheet.Range(CellCde[4]).Value := ''''+FORMAT("Bill-to Customer No.");
                                  xlSheet.Range(CellCde[5]).Value := FORMAT("Principal Name");
                                  xlSheet.Range(CellCde[6]).Value := FORMAT("Global Dimension 1 Code"); // jhoek.020709

                                  IF NOT Employee.GET("Project Manager") THEN
                                    Employee.INIT;

                                  xlSheet.Range(CellCde[7]).Value := FORMAT(UPPERCASE(Employee."Full Name"));
                                  xlSheet.Range(CellCde[8]).Value := FORMAT(UPPERCASE(FORMAT("Project Status")));
                                  xlSheet.Range(CellCde[9]).Value := FORMAT(UPPERCASE(Type));

                                  IF FreeFieldRec.GET("No.") THEN BEGIN
                                    xlSheet.Range(CellCde[10]).Value := FORMAT(FreeFieldRec."Market sector");
                                  //  xlSheet.Range(CellCde[11]).Value := FORMAT(FreeFieldRec."Function");
                                  //  xlSheet.Range(CellCde[12]).Value := FORMAT(FreeFieldRec."Technical discipline");
                                  //  xlSheet.Range(CellCde[13]).Value := FORMAT(FreeFieldRec."Business segment");
                                  END;

                                  SETRANGE("Cumulation Filter",0D,PrevEndDate);
                                  CostContrMgt.CalcFieldsProject(Job);

                                  ClosedCosts := CalcClosedCostsRevenues(Job, 0); // jhoek.080609
                                  ClosedRevenues := CalcClosedCostsRevenues(Job, 1); // jhoek.080609
                                  ActualCosts := CalcActualCosts(Job); // jhoek.080609
                                  Revenues2 := CalcRevenues(Job); // jhoek.080609
                                  PreclosureCosts := CalcPreclosureResult(Job, 0); // jhoek.020709
                                  PreclosureRevenues := CalcPreclosureResult(Job, 1); // jhoek.020709

                                  CLEAR(lvPrognosis);

                                  //CalcPrognosisNew(Job,0D,PrevEndDate,lvPrognosis[1],lvPrognosis[2],ExpectedCompletionDate2);
                                  CalcPrognosisNew(Job,PrevStartDate,PrevEndDate,lvPrognosis[1],lvPrognosis[2],ExpectedCompletionDate2);
                                  PreviousCostPrognosis := lvPrognosis[1];
                                  PreviousRevenuePrognosis := lvPrognosis[2];

                                  IF ExpectedCompletionDate2 <> 0D THEN
                                    ExpectedCompletionDate := ExpectedCompletionDate2;
                                  xlSheet.Range(CellCde[14]).Value := FORMAT(lvPrognosis[1]);
                                  xlSheet.Range(CellCde[15]).Value := FORMAT(lvPrognosis[2]);
                                  xlSheet.Range(CellCde[16]).Value := '='+FORMAT(CellCde[15])+'-'+FORMAT(CellCde[14]);
                                  xlSheet.Range(CellCde[17]).Value := FORMAT(ActualCosts - (ClosedCosts * -1) - PreclosureCosts);
                                  xlSheet.Range(CellCde[18]).Value := FORMAT(Revenues2 - ClosedRevenues - PreclosureRevenues);
                                  xlSheet.Range(CellCde[19]).Value := FORMAT(ClosedCosts * -1 + PreclosureCosts);
                                  xlSheet.Range(CellCde[20]).Value := FORMAT(ClosedRevenues + PreclosureRevenues);

                                  y := 21;
                                  FOR i := 1 TO MaxCount DO BEGIN
                                    //SETRANGE("Cumulation Filter",StartDate[i],EndDate[i]);
                                    SETFILTER("Cumulation Filter",'..%1',EndDate[i]);
                                    SETRANGE("Period Filter",StartDate[i],EndDate[i]);
                                    CostContrMgt.CalcFieldsProject(Job);
                                    ClosedCosts := CalcClosedCostsRevenues(Job, 0); // jhoek.080609
                                    ClosedRevenues := CalcClosedCostsRevenues(Job, 1); // jhoek.080609
                                    Revenues2 := CalcRevenues(Job); // jhoek.080609
                                    PreclosureCosts := CalcPreclosureResult(Job, 0); // jhoek.020709
                                    PreclosureRevenues := CalcPreclosureResult(Job, 1); // jhoek.020709

                                    CLEAR(lvPrognosis);
                                    IF NOT CalcPrognosisNew(Job,StartDate[i],EndDate[i],lvPrognosis[1],lvPrognosis[2],ExpectedCompletionDate2) AND
                                      (Job."Single/Main/Sub Project" = Job."Single/Main/Sub Project"::"Main Project") THEN BEGIN
                                      //lvPrognosis[1] := PreviousCostPrognosis;      // gb.080212
                                      //lvPrognosis[2] := PreviousRevenuePrognosis;   // gb.080212
                                    END;

                                    PreviousCostPrognosis := lvPrognosis[1];
                                    PreviousRevenuePrognosis := lvPrognosis[2];

                                    IF ExpectedCompletionDate2 <> 0D THEN
                                      ExpectedCompletionDate := ExpectedCompletionDate2;
                                    xlSheet.Range(CellCde[y]).Value := FORMAT(lvPrognosis[1]);
                                    xlSheet.Range(CellCde[y+1]).Value := FORMAT(lvPrognosis[2]);
                                    xlSheet.Range(CellCde[y+2]).Value := '='+FORMAT(CellCde[y+1])+'-'+FORMAT(CellCde[y]);

                                    IF i = 1 THEN BEGIN
                                      xlSheet.Range(CellCde[y+3]).Value := '='+FORMAT(CellCde[y+2])+'-'+FORMAT(CellCde[16]);
                                      xlSheet.Range(CellCde[y+4]).Value := '='+FORMAT(CellCde[y+1])+'-'+FORMAT(CellCde[15]);
                                    END ELSE BEGIN
                                      xlSheet.Range(CellCde[y+3]).Value := '='+FORMAT(CellCde[y+2])+'-'+FORMAT(CellCde[y+3-10]);
                                      xlSheet.Range(CellCde[y+4]).Value := '='+FORMAT(CellCde[y+1])+'-'+FORMAT(CellCde[y+4-12]);
                                    END;

                                    SETRANGE("Cumulation Filter",0D,EndDate[i]);
                                    ClosedCosts := CalcClosedCostsRevenues(Job, 0); // jhoek.080609
                                    ClosedRevenues := CalcClosedCostsRevenues(Job, 1); // jhoek.080609
                                    ActualCosts := CalcActualCosts(Job); // jhoek.080609
                                    Revenues2 := CalcRevenues(Job); // jhoek.080609

                                    xlSheet.Range(CellCde[y+5]).Value := FORMAT(ActualCosts - (ClosedCosts * -1) - PreclosureCosts);
                                    xlSheet.Range(CellCde[y+6]).Value := FORMAT(Revenues2 - ClosedRevenues - PreclosureRevenues);
                                    xlSheet.Range(CellCde[y+7]).Value := FORMAT(ClosedCosts * -1 + PreclosureCosts);
                                    xlSheet.Range(CellCde[y+8]).Value := FORMAT(ClosedRevenues + PreclosureRevenues);

                                    y := y + 9;
                                  END;

                                  // 4PS TRU 23-04-2010 BEGIN
                                  // xlSheet.Range(CellCde[3]).Value := '''' + FORMAT(ExpectedCompletionDate, 0, '<Year,2><Month,2>');
                                  // Format Expected Completion Date.
                                  IF ExpectedCompletionDate <> 0D THEN BEGIN;
                                    lrecAccountingPeriod.RESET;
                                    ldatStartingDateExpComplDate := DMY2DATE(1, 1, DATE2DWY(ExpectedCompletionDate, 3));
                                    lrecAccountingPeriod.SETRANGE("Starting Date", ldatStartingDateExpComplDate, ExpectedCompletionDate);
                                    lintPeriodeInAccYear := lrecAccountingPeriod.COUNT;
                                    IF lintPeriodeInAccYear = 0 THEN BEGIN;
                                      lintPeriodeInAccYear := DATE2DMY(ExpectedCompletionDate, 2);
                                    END;
                                    IF STRLEN(FORMAT(lintPeriodeInAccYear)) = 1 THEN BEGIN;
                                      ltxtPeriod := '0' + FORMAT(lintPeriodeInAccYear);
                                    END ELSE BEGIN;
                                      ltxtPeriod := FORMAT(lintPeriodeInAccYear);
                                    END;
                                    xlSheet.Range(CellCde[3]).Value := '''' + FORMAT(ExpectedCompletionDate, 0, '<Year,2>') + ltxtPeriod;
                                  END ELSE BEGIN;
                                    xlSheet.Range(CellCde[3]).Value := '''';
                                  END;
                                  // 4PS TRU 23-04-2010 BEGIN

                                  x += 1;
                                END;

               OnPostDataItem=BEGIN
                                IF (NOT PrintDetails) THEN BEGIN // jhoek.080609
                                  x += 2;

                                  xlSheet.Range(matrix(14,x)+':'+matrix(((MaxCount+1)*10)-1,x)).Borders.Item(3).LineStyle := 1;
                                  xlSheet.Range(matrix(14,x)+':'+matrix(((MaxCount+1)*10)-1,x)).Borders.Item(4).LineStyle := 1;
                                  xlSheet.Range(matrix(14,x)+':'+matrix(((MaxCount+1)*10)-1,x)).Borders.Item(4).Weight := 2;
                                  xlSheet.Range(matrix(14,x)+':'+matrix(((MaxCount+1)*10)-1,x)).Borders.Item(4).Weight := 3;
                                  xlSheet.Range(matrix(14,x)+':'+matrix(((MaxCount+1)*10)-1,x)).NumberFormat := '#.###';

                                  FOR i := 14 TO (((MaxCount+1)*10)-1) DO//128 DO
                                  //  CASE FormulaLanguage OF
                                  //    FormulaLanguage::English:
                                  //      xlSheet.Range(matrix(i,x)).Value := '=SUBTOTAL(9;'+FORMAT(matrix(i,7))+':'+FORMAT(matrix(i,x-1))+')';
                                  //    FormulaLanguage::Dutch:
                                        xlSheet.Range(matrix(i,x)).Value := '=SUBTOTAAL(9;'+FORMAT(matrix(i,7))+':'+FORMAT(matrix(i,x-1))+')';
                                  //  END;
                                END; // jhoek.080609

                                Window.CLOSE;
                              END;

               ReqFilterFields=Main Project,Global Dimension 1 Code,Project Type;
               CalcFields=Principal Name,Revenues,Actual Costs }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   Sheetname := 'Datasheet';
                 END;

    }
    CONTROLS
    {
      { 1100409007;;Container;
                  Name=test;
                  ContainerType=ContentArea }

      { 1100409006;1;Group  ;
                  GroupType=Group }

      { 1100409005;2;Field  ;
                  CaptionML=ENU=Cumulation Filter;
                  SourceExpr=CumulationFilterTxt;
                  OnValidate=BEGIN
                               PeriodFilterTxt := CumulationFilterTxt;
                               IF PeriodFilterTxt <> '' THEN BEGIN
                                 PeriodType := PeriodType::Month;

                                 IF CumulationFilterTxt <> '' THEN
                                   SearchPeriod.FindPeriod(DatFilterStart,DatFilterEnd,CumulationFilterTxt,PeriodFilterTxt,PeriodType,PeriodNo);
                               END;
                             END;

                  OnLookup=VAR
                             DateSelectionManagement@1100409000 : Codeunit 11130005;
                           BEGIN
                             //DateSelectionManagement.GetPeriod(CumulationFilterTxt);
                             //Text := CumulationFilterTxt;
                             DateSelectionManagement.GetPeriod(CumulationFilterTxt);
                             PeriodFilterTxt := CumulationFilterTxt;
                             IF PeriodFilterTxt <> '' THEN BEGIN
                               PeriodType := PeriodType::Month;
                               IF CumulationFilterTxt <> '' THEN
                                 SearchPeriod.FindPeriod(DatFilterStart,DatFilterEnd,CumulationFilterTxt,PeriodFilterTxt,PeriodType,PeriodNo);

                             END;
                             Text := CumulationFilterTxt;
                           END;
                            }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Filename;
                  SourceExpr=Filename;
                  OnAssistEdit=VAR
                                 FileMan@1000 : Codeunit 419;
                               BEGIN
                                 CLEAR(Filename);
                                 FileMan.SelectFile('xl*',FileAbsPathName,ShortFileName,Filename);
                               END;
                                }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=Sheetname;
                  SourceExpr=Sheetname }

      { 1100409003;2;Field  ;
                  CaptionML=ENU=Formula Language;
                  SourceExpr=FormulaLanguage }

      { 3   ;2   ;Field     ;
                  CaptionML=ENU=Print Details;
                  SourceExpr=PrintDetails }

      { 1100409000;2;Field  ;
                  CaptionML=ENU=Show Complete Closed Project Previous Year;
                  SourceExpr=blnShowCompClosPrevYear }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      JobSetup@1000000020 : Record 315;
      CompanyInfo@1065 : Record 79;
      AccountingPeriod@1066 : Record 50;
      AccountingPeriod2@1067 : Record 50;
      PeriodStartingDate@1069 : Date;
      StartDate@1070 : ARRAY [20] OF Date;
      EndDate@1071 : ARRAY [20] OF Date;
      JobFilter@1072 : Text[250];
      ColumnValuesAsText@1073 : ARRAY [13] OF Text[30];
      HeaderText@1074 : Text[100];
      RoundingText@1075 : Text[80];
      Header@1076 : ARRAY [13,2] OF Text[100];
      NormalFormatString@1077 : Text[80];
      LastPageText@1078 : Text[30];
      RoundingFactor@1079 : 'None,1,1000,1000000';
      i@1080 : Integer;
      MaxCount@1081 : Integer;
      LastPage@1082 : Boolean;
      Text002@1000000012 : TextConst;
      Text004@1083 : TextConst 'ENU=Enter the starting date for the first period.';
      Text005@1084 : TextConst 'ENU=The starting date is not the starting date of an accounting period.';
      Text006@1085 : TextConst 'ENU=Page %1 %2';
      Text007@1086 : TextConst 'ENU=-1D';
      Text008@1087 : TextConst 'ENU=<Precision,';
      Text009@1088 : TextConst 'ENU=><Standard Format,0>';
      Text010@1089 : TextConst 'ENU=<Precision,1><Standard Format,0>';
      Text011@1090 : TextConst 'ENU=Amounts are rounded to 1';
      Text012@1091 : TextConst 'ENU=Amounts are in whole 1000s';
      Text013@1092 : TextConst 'ENU=Amounts are in whole 1000000s';
      Text014@1093 : TextConst 'ENU=Indentation Level %1 is not used in the Chart of Accounts. This Chart of Accounts uses max. %2 levels.';
      Text015@1094 : TextConst 'ENU=Indentation Level : %1';
      Text050@1095 : TextConst 'ENU=/ Last Page';
      Text051@1096 : TextConst 'ENU=/ Continued';
      "--- Xcel01 -----"@1000000000 : Integer;
      x@1000000001 : Integer;
      y@1000000002 : Integer;
      Teller@1000000003 : Integer;
      Filename@1000000009 : Text[250];
      Sheetname@1000000010 : Text[250];
      CommonDialogMgt@1000000011 : Codeunit 412;
      ExcelBuf@1000000013 : Record 370;
      CellCde@1000000014 : ARRAY [180] OF Code[10];
      Dim1Filter@1000000015 : Text[100];
      IYear@1000000016 : Integer;
      Window@1000000017 : Dialog;
      TotalRec@1000000018 : Integer;
      CurRec@1000000019 : Integer;
      PrevStartDate@1000000039 : Date;
      PrevEndDate@1000000022 : Date;
      FreeFieldRec@1000000021 : Record 50000;
      CostContrMgt@1000000023 : Codeunit 11012006;
      PeriodName@1000000024 : ARRAY [20] OF Text[30];
      SearchPeriod@1000000030 : Codeunit 11012016;
      PeriodType@1000000029 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      PeriodFilterTxt@1000000028 : Text[30];
      CumulationFilterTxt@1000000027 : Text[30];
      DatFilterStart@1000000026 : Date;
      DatFilterEnd@1000000025 : Date;
      PeriodNo@1000000031 : Text[1024];
      IMonth@1000000032 : Integer;
      PrevPrognDate@1000000033 : Date;
      PrintDetails@1000000034 : Boolean;
      ExcludeSubProjClosedInPrevYear@1000000040 : Boolean;
      TempMain@1000000038 : Code[20];
      Text060@1000000041 : TextConst 'ENU=Projects that were closed in previous years are not included in the calculations below.';
      JobLedgerEntryBuffer@1000000042 : TEMPORARY Record 11072005;
      FormulaLanguage@1100525000 : 'English,,,Dutch';
      LastBufferedMainProjectNo@1100525001 : Code[20];
      blnShowCompClosPrevYear@1000000035 : Boolean;
      AccountingPeriod3@1000000036 : Record 50;
      intPeriodeInAccYear@1000000037 : Integer;
      AccountingPeriod4@1000000043 : Record 50;
      FileAbsPathName@1000 : Text;
      ShortFileName@1001 : Text;
      xlApp@1006 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024500-0000-0000-C000-000000000046}:Unknown Automation Server.Application";
      xlBook@1005 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";
      xlSheet@1004 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020820-0000-0000-C000-000000000046}:Unknown Automation Server.Worksheet";
      xlChart@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:Unknown Automation Server.Chart";
      xlRange@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";

    LOCAL PROCEDURE AccPeriodEndDate@1099(UseStartDate@1100 : Date) : Date;
    VAR
      AccountingPeriod2@1101 : Record 50;
    BEGIN
      AccountingPeriod2."Starting Date" := UseStartDate;
      IF AccountingPeriod2.FIND('>') THEN
        EXIT(AccountingPeriod2."Starting Date" - 1);
      EXIT(99991231D);
    END;

    PROCEDURE matrix@1000000002(m_col@1000000000 : Integer;m_row@1000000001 : Integer) m_ret : Code[10];
    VAR
      xx@1000000002 : Integer;
      alf@1000000003 : Code[50];
      m_rest@1000000004 : Decimal;
      m_nu@1000000005 : Decimal;
      m_heel@1000000006 : Decimal;
      m_tus@1000000007 : Code[30];
    BEGIN
      IF m_col > 16384 THEN BEGIN
        m_tus := 'XFD';
        ERROR('Select fewer columns (max 16384)');
      END ELSE BEGIN
        alf := 'ABCDEFGHIJKLMNOPQRSTUVWXYZ ';
        REPEAT
          IF m_col > 676  THEN
            m_heel := ROUND(m_col/(POWER(26.000000001,2)),1,'<')
          ELSE
            m_heel := ROUND(m_col/26.000000001,1,'<');
          IF m_heel > 0 THEN
            m_nu := m_heel
          ELSE
            m_nu := m_col;
          IF m_nu = 0 THEN
            m_nu := 27;
          m_tus := m_tus + COPYSTR(alf,m_nu,1);
          IF m_col > 676 THEN
            m_col := ROUND(m_col-(m_heel*(POWER(26,2))),1)
          ELSE
            m_col := ROUND(m_col-(m_heel*26),1);
        UNTIL m_heel <= 0;
      END;

      m_ret := DELCHR(STRSUBSTNO('%1 %2',m_tus,m_row));
    END;

    PROCEDURE CalcPrognosisNewxx@1100525009(pJob@1100525000 : Record 11072003;FromDate@1100525003 : Date;ToDate@1100525004 : Date;VAR Costs@1100525001 : Decimal;VAR Revenues@1100525002 : Decimal;VAR ExpectedCompletionDate@1100525006 : Date) PrognosisFound : Boolean;
    VAR
      Job2@1100525008 : Record 11072003;
      Prognosis@1100525005 : Record 11012034;
      Prognosis2@1100525009 : Record 11012034;
      PrognosisLine@1100525007 : Record 11012035;
    BEGIN
      Costs := 0;
      Revenues := 0;
      ExpectedCompletionDate := 0D;
      IF pJob."Single/Main/Sub Project" <> pJob."Single/Main/Sub Project"::"Main Project" THEN BEGIN
        Prognosis.SETRANGE("Project No.", pJob."No.");
        Prognosis.SETRANGE("Prognosis Date", FromDate, ToDate);
        IF Prognosis.FINDLAST THEN BEGIN
          PrognosisFound := TRUE;
          ExpectedCompletionDate := Prognosis."Expected Finishing Date";
          CASE Prognosis."Prognosis Level" OF
            Prognosis."Prognosis Level"::Detailed: BEGIN
              PrognosisLine.SETRANGE("Project No.", Prognosis."Project No.");
              PrognosisLine.SETRANGE("Prognosis Date", Prognosis."Prognosis Date");
              IF PrognosisLine.FINDSET THEN BEGIN
                REPEAT
                  CASE PrognosisLine."Cost Type" = PrognosisLine."Cost Type"::Revenue OF
                    TRUE: Revenues := Revenues + PrognosisLine."Amount Revenue" + PrognosisLine.Invoiced; //GB 19-11-09
                    FALSE: Costs := Costs + PrognosisLine."Prognosis Total Cost";  //GB 19-11-09 {+ PrognosisLine.Amount}
                  END;
                UNTIL PrognosisLine.NEXT = 0;
              END;
            END;
            Prognosis."Prognosis Level"::Rough: BEGIN
              Costs := Prognosis."Rough Prognosis Total Cost";
              Revenues := Prognosis."Rough Prognosis Total Revenues";
            END;
          END;
        END;
      END ELSE BEGIN
         Prognosis.SETCURRENTKEY("Main Project No.", "Prognosis Date");
         Prognosis.SETRANGE("Main Project No.", pJob."No.");
         Prognosis.SETRANGE("Prognosis Date", FromDate, ToDate);
         IF Prognosis.FINDSET THEN BEGIN
           PrognosisFound := TRUE;
           REPEAT
             Prognosis.SETRANGE("Project No.", Prognosis."Project No.");
             Job2.GET(Prognosis."Project No.");
             IF (NOT ExcludeSubProjClosedInPrevYear) OR (Job2."Posting Date Closing" = 0D) OR
             (Job2."Posting Date Closing" > PeriodStartingDate) THEN BEGIN
               Prognosis2.SETRANGE("Project No.", Prognosis."Project No.");
               Prognosis2.SETRANGE("Prognosis Date", FromDate, ToDate);
               IF Prognosis2.FINDLAST THEN BEGIN
                 IF Prognosis2."Expected Finishing Date" > ExpectedCompletionDate THEN
                   ExpectedCompletionDate := Prognosis2."Expected Finishing Date";
                   CASE Prognosis2."Prognosis Level" OF Prognosis2."Prognosis Level"::Detailed: BEGIN
                     PrognosisLine.SETRANGE("Project No.", Prognosis2."Project No.");
                     PrognosisLine.SETRANGE("Prognosis Date", Prognosis2."Prognosis Date");
                     IF PrognosisLine.FINDSET THEN BEGIN
                       REPEAT
                         CASE PrognosisLine."Cost Type" = PrognosisLine."Cost Type"::Revenue OF
                           TRUE: Revenues := Revenues + PrognosisLine."Amount Revenue" + PrognosisLine.Invoiced;
                           FALSE: Costs := Costs + PrognosisLine."Prognosis Total Cost";
                         END;
                       UNTIL PrognosisLine.NEXT = 0;
                     END;
                   END;
                   Prognosis2."Prognosis Level"::Rough: BEGIN
                     Costs := Costs + Prognosis2."Rough Prognosis Total Cost";
                     Revenues := Revenues + Prognosis2."Rough Prognosis Total Revenues";
                   END;
                 END;
               END;
             END;
             IF NOT Prognosis.ISEMPTY THEN BEGIN                         //Xcel03.n
               Prognosis.FINDLAST;
               Prognosis.SETRANGE("Project No.");
             END;
           UNTIL Prognosis.NEXT = 0;
         END;
       END;
    END;

    PROCEDURE CalcPrognosisNew@1000000000(pJob@1100525000 : Record 11072003;FromDate@1100525003 : Date;ToDate@1100525004 : Date;VAR Costs@1100525001 : Decimal;VAR Revenues@1100525002 : Decimal;VAR ExpectedCompletionDate@1100525006 : Date) PrognosisFound : Boolean;
    VAR
      Job2@1100525008 : Record 11072003;
      Prognosis@1100525005 : Record 11012034;
      Prognosis2@1100525009 : Record 11012034;
      PrognosisLine@1100525007 : Record 11012035;
      lvJobRec@1000000000 : Record 11072003;
    BEGIN
      Costs := 0;
      Revenues := 0;
      ExpectedCompletionDate := 0D;
      IF pJob."Single/Main/Sub Project" <> pJob."Single/Main/Sub Project"::"Main Project" THEN BEGIN
        Prognosis.SETRANGE("Project No.", pJob."No.");
        IF (pJob."Posting Date Closing" <> 0D) AND  (pJob."Posting Date Closing" < FromDate) THEN
          Prognosis.SETRANGE("Prognosis Date", 0D, FromDate)
        ELSE
          Prognosis.SETRANGE("Prognosis Date", FromDate, ToDate);
        IF Prognosis.FINDLAST THEN BEGIN
          PrognosisFound := TRUE;
          ExpectedCompletionDate := Prognosis."Expected Finishing Date";
          CASE Prognosis."Prognosis Level" OF
            Prognosis."Prognosis Level"::Detailed: BEGIN
              PrognosisLine.SETRANGE("Project No.", Prognosis."Project No.");
              PrognosisLine.SETRANGE("Prognosis Date", Prognosis."Prognosis Date");
              IF PrognosisLine.FINDSET THEN BEGIN
                REPEAT
                  CASE PrognosisLine."Cost Type" = PrognosisLine."Cost Type"::Revenue OF
                    TRUE: Revenues := Revenues + PrognosisLine."Amount Revenue" + PrognosisLine.Invoiced; //GB 19-11-09
                    FALSE: Costs := Costs + PrognosisLine."Prognosis Total Cost";  //GB 19-11-09 {+ PrognosisLine.Amount}
                  END;
                UNTIL PrognosisLine.NEXT = 0;
              END;
            END;
            Prognosis."Prognosis Level"::Rough: BEGIN
              Costs := Prognosis."Rough Prognosis Total Cost";
              Revenues := Prognosis."Rough Prognosis Total Revenues";
            END;
          END;
        END;
      END ELSE BEGIN
         lvJobRec.SETRANGE("Main Project", pJob."No.");
         IF lvJobRec.FINDSET THEN BEGIN
           REPEAT
             //IF (NOT PrintDetails) OR (lvJobRec."Posting Date Closing" = 0D) OR
             IF (lvJobRec."Posting Date Closing" >= FromDate) OR (lvJobRec."Posting Date Closing" = 0D) THEN
               Prognosis2.SETRANGE("Prognosis Date", FromDate, ToDate);
             IF (lvJobRec."Posting Date Closing" <> 0D) AND (lvJobRec."Posting Date Closing" < FromDate) THEN
               Prognosis2.SETRANGE("Prognosis Date", 0D, FromDate);
             Prognosis2.SETRANGE("Project No.", lvJobRec."No.");
             IF Prognosis2.FINDLAST THEN BEGIN
               PrognosisFound := TRUE;
               IF Prognosis2."Expected Finishing Date" > ExpectedCompletionDate THEN
                 ExpectedCompletionDate := Prognosis2."Expected Finishing Date";
                 CASE Prognosis2."Prognosis Level" OF Prognosis2."Prognosis Level"::Detailed: BEGIN
                   PrognosisLine.SETRANGE("Project No.", Prognosis2."Project No.");
                   PrognosisLine.SETRANGE("Prognosis Date", Prognosis2."Prognosis Date");
                   IF PrognosisLine.FINDSET THEN BEGIN
                     REPEAT
                       CASE PrognosisLine."Cost Type" = PrognosisLine."Cost Type"::Revenue OF
                         TRUE: Revenues := Revenues + PrognosisLine."Amount Revenue" + PrognosisLine.Invoiced;
                         FALSE: Costs := Costs + PrognosisLine."Prognosis Total Cost";
                       END;
                     UNTIL PrognosisLine.NEXT = 0;
                   END;
                 END;
                 Prognosis2."Prognosis Level"::Rough: BEGIN
                   Costs := Costs + Prognosis2."Rough Prognosis Total Cost";
                   Revenues := Revenues + Prognosis2."Rough Prognosis Total Revenues";
                 END;
               END;
             END;
           UNTIL lvJobRec.NEXT = 0;
         END;
       END;
    END;

    PROCEDURE GetColumnHeader@1100525000(ColumnNo@1100525000 : Integer;HeaderRowNo@1100525001 : Integer) : Text[30];
    BEGIN
      // jhoek.040609.begin
      // Mooier: waardes van tekstconstanten teruggeven
      CASE ColumnNo OF
        1:
          CASE HeaderRowNo OF
            1: EXIT('Prognosis');
            2: EXIT('costs');
          END;
        2:
          CASE HeaderRowNo OF
            1: EXIT('Prognosis');
            2: EXIT('reveneus');
          END;
        3:
          CASE HeaderRowNo OF
            1: EXIT('Prognosis');
            2: EXIT('margin');
          END;
        4:
          CASE HeaderRowNo OF
            1: EXIT('Change');
            2: EXIT('exp. margin');
          END;
        5:
          CASE HeaderRowNo OF
            1: EXIT('Orderintake');
            2: EXIT('');
          END;
        6:
          CASE HeaderRowNo OF
            1: EXIT('W.I.P.');
            2: EXIT('costs');
          END;
        7:
          CASE HeaderRowNo OF
            1: EXIT('W.I.P.');
            2: EXIT('revenues');
          END;
        8:
          CASE HeaderRowNo OF
            1: EXIT('Completed');
            2: EXIT('costs');
          END;
        9:
          CASE HeaderRowNo OF
            1: EXIT('Completed');
            2: EXIT('revenues');
          END;
      END;
      // jhoek.040609.end
    END;

    PROCEDURE BufferJobLedgerEntries@1000000005(MainProjectNo@1000000000 : Code[20]);
    VAR
      Job@1100525000 : Record 11072003;
      JobLedgerEntry@1000000001 : Record 11072005;
    BEGIN
      // Only use buffering if subprojects closed in previous years
      // should be excluded; otherwise, FlowFields are used instead.
      IF NOT ExcludeSubProjClosedInPrevYear THEN
        EXIT;

      // Check if current project is already in buffer
      IF MainProjectNo = LastBufferedMainProjectNo THEN
        EXIT;

      JobLedgerEntryBuffer.RESET;
      JobLedgerEntryBuffer.DELETEALL;

      JobLedgerEntry.SETCURRENTKEY("Main Project No.", "Job No.");
      JobLedgerEntry.SETRANGE("Main Project No.", MainProjectNo);
      IF NOT JobLedgerEntry.ISEMPTY THEN                           //Xcel03.n
       IF JobLedgerEntry.FINDSET THEN
        REPEAT
          Job.GET(JobLedgerEntry."Job No.");
          IF (Job."Posting Date Closing" = 0D) OR
             (Job."Posting Date Closing" > PeriodStartingDate)
          THEN BEGIN
            //JobLedgerEntry.SETRANGE("Job No.", JobLedgerEntry."Job No.");
            //REPEAT
              JobLedgerEntryBuffer := JobLedgerEntry;
              JobLedgerEntryBuffer.INSERT;
            //UNTIL JobLedgerEntry.NEXT = 0;
            //JobLedgerEntry.SETRANGE("Job No.");
          END;
        UNTIL JobLedgerEntry.NEXT = 0;

      LastBufferedMainProjectNo := MainProjectNo;
    END;

    PROCEDURE CalcClosedCostsRevenues@1000000003(VAR Job@1000000000 : Record 11072003;Type@1000000003 : 'Costs,Revenues') : Decimal;
    BEGIN
      CASE ExcludeSubProjClosedInPrevYear OF
        FALSE:
          BEGIN
            // Gebruik normale FlowFields
            CASE Type OF
              Type::Costs:
                BEGIN
                 Job.CALCFIELDS("Closed Costs");
                 EXIT(Job."Closed Costs");
                END;
              Type::Revenues:
                BEGIN
                  Job.CALCFIELDS("Closed Revenues");
                  EXIT(Job."Closed Revenues");
                END;
            END;
          END;
        TRUE:
          BEGIN
            JobLedgerEntryBuffer.RESET;
            JobLedgerEntryBuffer.SETCURRENTKEY("Main Project No.","Job No.","Entry Type","Cost Type","Posting Date");
            JobLedgerEntryBuffer.SETRANGE("Main Project No.", Job."Main Project");
            JobLedgerEntryBuffer.SETFILTER("Job No.", Job.GETFILTER("Project Filter"));
            JobLedgerEntryBuffer.SETFILTER("Posting Date", Job.GETFILTER("Cumulation Filter"));

            CASE Type OF
              Type::Costs:
                BEGIN
                  JobLedgerEntryBuffer.CALCSUMS("Closed Costs");
                  EXIT(JobLedgerEntryBuffer."Closed Costs");
                END;
              Type::Revenues:
                BEGIN
                  JobLedgerEntryBuffer.CALCSUMS("Closed Revenues");
                  EXIT(JobLedgerEntryBuffer."Closed Revenues");
                END;
            END;
          END;
      END;
    END;

    PROCEDURE CalcPreclosureResult@1100525002(VAR Job@1100525001 : Record 11072003;Type@1100525002 : 'Costs,Revenues') Result : Decimal;
    VAR
      ProjectPreclosureResult@1100525000 : Record 11012093;
      ProjectPreclosureResultBuffer@1100525003 : TEMPORARY Record 11012093;
    BEGIN
      JobLedgerEntryBuffer.RESET;
      JobLedgerEntryBuffer.SETCURRENTKEY("Main Project No.", "Job No.", "Entry Type");
      JobLedgerEntryBuffer.SETRANGE("Main Project No.", Job."Main Project");
      IF Job."Single/Main/Sub Project" <> Job."Single/Main/Sub Project"::"Main Project" THEN
        JobLedgerEntryBuffer.SETRANGE("Job No.", Job."No.");
      JobLedgerEntryBuffer.SETRANGE("Entry Type", JobLedgerEntryBuffer."Entry Type"::Usage);
      JobLedgerEntryBuffer.SETFILTER("Posting Date", '..%1', Job.GETRANGEMAX("Cumulation Filter"));
      JobLedgerEntryBuffer.SETFILTER("Actual Preclosure Result", '<>%1', 0);
      IF NOT JobLedgerEntryBuffer.ISEMPTY THEN                           //Xcel03.n
       IF JobLedgerEntryBuffer.FINDSET THEN BEGIN
        REPEAT
          IF ProjectPreclosureResult.GET(JobLedgerEntryBuffer."Job No.", JobLedgerEntryBuffer."Posting Date") THEN
            IF ProjectPreclosureResult.Posted THEN
              IF ProjectPreclosureResult."Result Type" = ProjectPreclosureResult."Result Type"::"Preclosure Result" THEN
                // potentially two project ledger entries; consider preclosure result only once!
                IF NOT ProjectPreclosureResultBuffer.GET(
                  ProjectPreclosureResult."Project No.",
                  ProjectPreclosureResult."Posting Date")
                THEN BEGIN
                  CASE Type OF
                    Type::Costs: Result := Result + ProjectPreclosureResult.Cost;
                    Type::Revenues: Result := Result + ProjectPreclosureResult.Turnover;
                  END;
                  ProjectPreclosureResultBuffer := ProjectPreclosureResult;
                  ProjectPreclosureResultBuffer.INSERT;
                END;
        UNTIL JobLedgerEntryBuffer.NEXT = 0;
       END;
    END;

    PROCEDURE CalcActualCosts@1000000010(VAR Job@1000000000 : Record 11072003) : Decimal;
    BEGIN
      CASE ExcludeSubProjClosedInPrevYear OF
        FALSE:
          BEGIN
            // Gebruik normale FlowField
            Job.CALCFIELDS("Actual Costs");
            EXIT(Job."Actual Costs");
          END;
        TRUE:
          BEGIN
            JobLedgerEntryBuffer.RESET;
            JobLedgerEntryBuffer.SETCURRENTKEY(
              "Main Project No.","Job No.","Cost Type","Global Dimension 2 Code","Entry Type","Posting Date","Purchase Action");
            JobLedgerEntryBuffer.SETRANGE("Main Project No.", Job."Main Project");
            JobLedgerEntryBuffer.SETFILTER("Job No.", Job.GETFILTER("Project Filter"));
            JobLedgerEntryBuffer.SETRANGE("Entry Type", JobLedgerEntryBuffer."Entry Type"::Usage);
            JobLedgerEntryBuffer.SETFILTER("Posting Date", Job.GETFILTER("Cumulation Filter"));
            JobLedgerEntryBuffer.SETFILTER("Purchase Action", Job.GETFILTER("Purchase Action Filter"));
            JobLedgerEntryBuffer.CALCSUMS("Total Cost (LCY)");
            EXIT(JobLedgerEntryBuffer."Total Cost (LCY)");
          END;
      END;
    END;

    PROCEDURE CalcRevenues@1000000004(VAR Job@1000000000 : Record 11072003) Result : Decimal;
    BEGIN
      CASE ExcludeSubProjClosedInPrevYear OF
        FALSE:
          BEGIN
            // Gebruik normale FlowField
            Job.CALCFIELDS(Revenues);
            EXIT(Job.Revenues);
          END;
        TRUE:
          BEGIN
            JobLedgerEntryBuffer.RESET;
            JobLedgerEntryBuffer.SETCURRENTKEY(
              "Main Project No.","Job No.","Entry Type","Cost Type","Posting Date","Purchase Action","Original Cost Type","Rental Unit");
            JobLedgerEntryBuffer.SETRANGE("Main Project No.", Job."Main Project");
            JobLedgerEntryBuffer.SETFILTER("Job No.", Job.GETFILTER("Project Filter"));
            JobLedgerEntryBuffer.SETRANGE("Entry Type", JobLedgerEntryBuffer."Entry Type"::Sale);
            JobLedgerEntryBuffer.SETFILTER("Posting Date", Job.GETFILTER("Cumulation Filter"));
            JobLedgerEntryBuffer.SETFILTER("Original Cost Type", Job.GETFILTER("Original Cost Type Filter"));
            JobLedgerEntryBuffer.SETFILTER("Rental Unit", Job.GETFILTER("Rental Unit Filter"));
            JobLedgerEntryBuffer.CALCSUMS("Total Price (LCY)");
            EXIT(-JobLedgerEntryBuffer."Total Price (LCY)");
          END;
      END;
    END;

    PROCEDURE xlLeft@1000000001() : Integer;
    BEGIN
      EXIT(-4131);
    END;

    LOCAL PROCEDURE xlCalculationManual@1100525001() : Integer;
    BEGIN
      EXIT(-4135);
    END;

    LOCAL PROCEDURE xlCalculationAutomatic@1100525004() : Integer;
    BEGIN
      EXIT(-4105);
    END;

    EVENT xlChart@1003::Activate@304();
    BEGIN
    END;

    EVENT xlChart@1003::Deactivate@1530();
    BEGIN
    END;

    EVENT xlChart@1003::Resize@256();
    BEGIN
    END;

    EVENT xlChart@1003::MouseDown@1531(Button@1003 : Integer;Shift@1002 : Integer;x@1001 : Integer;y@1000 : Integer);
    BEGIN
    END;

    EVENT xlChart@1003::MouseUp@1532(Button@1003 : Integer;Shift@1002 : Integer;x@1001 : Integer;y@1000 : Integer);
    BEGIN
    END;

    EVENT xlChart@1003::MouseMove@1533(Button@1003 : Integer;Shift@1002 : Integer;x@1001 : Integer;y@1000 : Integer);
    BEGIN
    END;

    EVENT xlChart@1003::BeforeRightClick@1534(VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlChart@1003::BeforeDoubleClick@1537(ElementID@1003 : Integer;Arg1@1002 : Integer;Arg2@1001 : Integer;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlChart@1003::Select@235(ElementID@1002 : Integer;Arg1@1001 : Integer;Arg2@1000 : Integer);
    BEGIN
    END;

    EVENT xlChart@1003::SeriesChange@1538(SeriesIndex@1001 : Integer;PointIndex@1000 : Integer);
    BEGIN
    END;

    EVENT xlChart@1003::Calculate@279();
    BEGIN
    END;

    EVENT xlSheet@1004::SelectionChange@1543(Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlSheet@1004::BeforeDoubleClick@1537(Target@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlSheet@1004::BeforeRightClick@1534(Target@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlSheet@1004::Activate@304();
    BEGIN
    END;

    EVENT xlSheet@1004::Deactivate@1530();
    BEGIN
    END;

    EVENT xlSheet@1004::Calculate@279();
    BEGIN
    END;

    EVENT xlSheet@1004::Change@1545(Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlSheet@1004::FollowHyperlink@1470(Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT xlSheet@1004::PivotTableUpdate@2156(Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlSheet@1004::PivotTableAfterValueChange@2886(TargetPivotTable@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";TargetRange@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlSheet@1004::PivotTableBeforeAllocateChanges@2889(TargetPivotTable@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1002 : Integer;ValueChangeEnd@1001 : Integer;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlSheet@1004::PivotTableBeforeCommitChanges@2892(TargetPivotTable@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1002 : Integer;ValueChangeEnd@1001 : Integer;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlSheet@1004::PivotTableBeforeDiscardChanges@2893(TargetPivotTable@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1001 : Integer;ValueChangeEnd@1000 : Integer);
    BEGIN
    END;

    EVENT xlSheet@1004::PivotTableChangeSync@2894(Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1005::Open@1923();
    BEGIN
    END;

    EVENT xlBook@1005::Activate@304();
    BEGIN
    END;

    EVENT xlBook@1005::Deactivate@1530();
    BEGIN
    END;

    EVENT xlBook@1005::BeforeClose@1546(VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::BeforeSave@1547(SaveAsUI@1001 : Boolean;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::BeforePrint@1549(VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::NewSheet@1550(Sh@1000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlBook@1005::AddinInstall@1552();
    BEGIN
    END;

    EVENT xlBook@1005::AddinUninstall@1553();
    BEGIN
    END;

    EVENT xlBook@1005::WindowResize@1554(Wn@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlBook@1005::WindowActivate@1556(Wn@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlBook@1005::WindowDeactivate@1557(Wn@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlBook@1005::SheetSelectionChange@1558(Sh@1001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlBook@1005::SheetBeforeDoubleClick@1559(Sh@1002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::SheetBeforeRightClick@1560(Sh@1002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::SheetActivate@1561(Sh@1000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlBook@1005::SheetDeactivate@1562(Sh@1000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlBook@1005::SheetCalculate@1563(Sh@1000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlBook@1005::SheetChange@1564(Sh@1001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlBook@1005::SheetFollowHyperlink@1854(Sh@1001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT xlBook@1005::SheetPivotTableUpdate@2157(Sh@1001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1005::PivotTableCloseConnection@2158(Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1005::PivotTableOpenConnection@2159(Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1005::Sync@2266(SyncEventType@1000 : Integer);
    BEGIN
    END;

    EVENT xlBook@1005::BeforeXmlImport@2283(Map@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1002 : Text;IsRefresh@1001 : Boolean;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::AfterXmlImport@2285(Map@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";IsRefresh@1001 : Boolean;Result@1000 : Integer);
    BEGIN
    END;

    EVENT xlBook@1005::BeforeXmlExport@2287(Map@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1001 : Text;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::AfterXmlExport@2288(Map@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1001 : Text;Result@1000 : Integer);
    BEGIN
    END;

    EVENT xlBook@1005::RowsetComplete@2610(Description@1002 : Text;Sheet@1001 : Text;Success@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::SheetPivotTableAfterValueChange@2895(Sh@1002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";TargetRange@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlBook@1005::SheetPivotTableBeforeAllocateChanges@2896(Sh@1004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1002 : Integer;ValueChangeEnd@1001 : Integer;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::SheetPivotTableBeforeCommitChanges@2897(Sh@1004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1002 : Integer;ValueChangeEnd@1001 : Integer;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::SheetPivotTableBeforeDiscardChanges@2898(Sh@1003 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1001 : Integer;ValueChangeEnd@1000 : Integer);
    BEGIN
    END;

    EVENT xlBook@1005::SheetPivotTableChangeSync@2899(Sh@1001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1005::AfterSave@2900(Success@1000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1005::NewChart@2901(Ch@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:Unknown Automation Server.Chart");
    BEGIN
    END;

    EVENT xlApp@1006::NewWorkbook@1565(Wb@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1006::SheetSelectionChange@1558(Sh@1001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlApp@1006::SheetBeforeDoubleClick@1559(Sh@1002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::SheetBeforeRightClick@1560(Sh@1002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::SheetActivate@1561(Sh@1000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlApp@1006::SheetDeactivate@1562(Sh@1000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlApp@1006::SheetCalculate@1563(Sh@1000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlApp@1006::SheetChange@1564(Sh@1001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookOpen@1567(Wb@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookActivate@1568(Wb@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookDeactivate@1569(Wb@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookBeforeClose@1570(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookBeforeSave@1571(Wb@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";SaveAsUI@1001 : Boolean;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookBeforePrint@1572(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookNewSheet@1573(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Sh@1000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookAddinInstall@1574(Wb@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookAddinUninstall@1575(Wb@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1006::WindowResize@1554(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlApp@1006::WindowActivate@1556(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlApp@1006::WindowDeactivate@1557(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlApp@1006::SheetFollowHyperlink@1854(Sh@1001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT xlApp@1006::SheetPivotTableUpdate@2157(Sh@1001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookPivotTableCloseConnection@2160(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookPivotTableOpenConnection@2161(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Target@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookSync@2289(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";SyncEventType@1000 : Integer);
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookBeforeXmlImport@2290(Wb@1004 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1002 : Text;IsRefresh@1001 : Boolean;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookAfterXmlImport@2291(Wb@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";IsRefresh@1001 : Boolean;Result@1000 : Integer);
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookBeforeXmlExport@2292(Wb@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1001 : Text;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookAfterXmlExport@2293(Wb@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1001 : Text;Result@1000 : Integer);
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookRowsetComplete@2611(Wb@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Description@1002 : Text;Sheet@1001 : Text;Success@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::AfterCalculate@2612();
    BEGIN
    END;

    EVENT xlApp@1006::SheetPivotTableAfterValueChange@2895(Sh@1002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";TargetRange@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlApp@1006::SheetPivotTableBeforeAllocateChanges@2896(Sh@1004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1002 : Integer;ValueChangeEnd@1001 : Integer;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::SheetPivotTableBeforeCommitChanges@2897(Sh@1004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1002 : Integer;ValueChangeEnd@1001 : Integer;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::SheetPivotTableBeforeDiscardChanges@2898(Sh@1003 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1001 : Integer;ValueChangeEnd@1000 : Integer);
    BEGIN
    END;

    EVENT xlApp@1006::ProtectedViewWindowOpen@2903(Pvw@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT xlApp@1006::ProtectedViewWindowBeforeEdit@2905(Pvw@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow";VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::ProtectedViewWindowBeforeClose@2906(Pvw@1002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow";Reason@1001 : Integer;VAR Cancel@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::ProtectedViewWindowResize@2908(Pvw@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT xlApp@1006::ProtectedViewWindowActivate@2909(Pvw@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT xlApp@1006::ProtectedViewWindowDeactivate@2910(Pvw@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookAfterSave@2911(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Success@1000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1006::WorkbookNewChart@2912(Wb@1001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Ch@1000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:Unknown Automation Server.Chart");
    BEGIN
    END;

    BEGIN
    {
      Xcel03;RJA;2009-07-16:400-008-08:
      - Performance Enhancements

      // 4PS TRU 23-04-2010:
       - edited Report - OnInitReport()
       - deleted ExcludeSubProjClosedInPrevYear from Request Form
       - added blnShowCompClosPrevYear on Request Form
       - edited Job - OnAfterGetRecord() for Format Expected Completion Date.
       - edited Job - OnPreDataItem()

      // 4PS TRU 10-06-2010:
       - edited Job OnAfterGetRecord
    }
    END.
  }
  RDLDATA
  {
  }
}

