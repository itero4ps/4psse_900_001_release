OBJECT Report 78869 Export Service Order to Excel
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS9.00.BK.OK;
  }
  PROPERTIES
  {
  }
  DATASET
  {
    { 1100525000;;DataItem;                  ;
               DataItemTable=Table11012823;
               OnPreDataItem=BEGIN
                               CREATE(xlApp, FALSE, TRUE);
                               xlBook := xlApp.Workbooks.Add;
                               xlSheet := xlApp.Sheets.Add;
                               xlSheet.Name := 'Service_orders';

                               xlSheet.Range('A1').Value := 'Serviceorderoverzicht';
                               xlSheet.Range('A1').Font.Size := 14;
                               xlSheet.Range('A2').Value := STRSUBSTNO('Export gegenereerd op %1 om %2', TODAY, TIME);
                               xlSheet.Range('A3').Value := STRSUBSTNO('Filters: %1', "Service Order".GETFILTERS);
                               xlSheet.Range('A:A').ColumnWidth := 15;

                               xlSheet.Range('A1:T6').Font.Bold := TRUE;
                               xlSheet.Range('A6').Value := 'Ordernummer';
                               xlSheet.Range('B6').Value := 'Locatienr.';
                               xlSheet.Range('C6').Value := 'Omschrijving';
                               xlSheet.Range('D6').Value := 'Adres';
                               xlSheet.Range('E6').Value := 'Plaats';
                               xlSheet.Range('F6').Value := 'Onderdeelcode';
                               xlSheet.Range('G6').Value := 'Omschrijving';
                               xlSheet.Range('H6').Value := 'Klantnr.';
                               xlSheet.Range('I6').Value := 'Naam';
                               xlSheet.Range('J6').Value := 'Contractnr';
                               xlSheet.Range('K6').Value := 'Orderstatus';
                               xlSheet.Range('L6').Value := 'Prio';
                               xlSheet.Range('M6').Value := 'Soort';
                               xlSheet.Range('N6').Value := 'Type';
                               xlSheet.Range('O6').Value := 'Probleemomschrijving';
                               xlSheet.Range('P6').Value := 'Interne tekst';
                               xlSheet.Range('Q6').Value := 'Oorzaak';
                               xlSheet.Range('R6').Value := 'Oplossing';
                               xlSheet.Range('S6').Value := 'Orderdatum';
                               xlSheet.Range('T6').Value := 'Lokatieopmerking';

                               SOTotalCounter := COUNT;
                               Dialog_.OPEN(Text001, SOcounter, SOTotalCounter);
                               RowNo := 7;
                             END;

               OnAfterGetRecord=BEGIN
                                  SOcounter += 1;
                                  Dialog_.UPDATE(1, SOcounter);

                                  FOR ColNo := 1 TO 20 DO
                                    CellCde[ColNo] := Matrix(ColNo,RowNo);

                                  CALCFIELDS("Customer Name");

                                  xlSheet.Range(CellCde[1]).Value := "No.";
                                  xlSheet.Range(CellCde[2]).Value := "Service Location No.";
                                  xlSheet.Range(CellCde[3]).Value := Name;
                                  xlSheet.Range(CellCde[4]).Value := Address;
                                  xlSheet.Range(CellCde[5]).Value := City;
                                  xlSheet.Range(CellCde[6]).Value := '';//"Installation Part";
                                  xlSheet.Range(CellCde[7]).Value := '';//"Installation Part Description";
                                  xlSheet.Range(CellCde[8]).Value := "Customer No.";
                                  xlSheet.Range(CellCde[9]).Value := "Customer Name";
                                  xlSheet.Range(CellCde[10]).Value := "Service Contract No.";
                                  xlSheet.Range(CellCde[11]).Value := FORMAT(Status);
                                  xlSheet.Range(CellCde[12]).Value := FORMAT(Priority);
                                  xlSheet.Range(CellCde[13]).Value := FORMAT("Order Kind");
                                  xlSheet.Range(CellCde[14]).Value := FORMAT("Order Type");

                                  IF NOT ServOrderExtension.GET("No.") THEN ServOrderExtension.INIT;  //db, 10-12-12

                                  //Probleemtekst
                                  CLEAR(ProblemText);
                                  FillText("No.",1,ProblemText);
                                  xlSheet.Range(CellCde[15]).Value :=
                                    ProblemText[1] + ProblemText[2] + ProblemText[3] +
                                    ProblemText[4] + ProblemText[5] + ProblemText[6] +
                                    ProblemText[7] + ProblemText[8] + ProblemText[9] +
                                    ProblemText[10] + ProblemText[11] + ProblemText[12] +
                                    ProblemText[13] + ProblemText[14] + ProblemText[15] +
                                    ProblemText[16] + ProblemText[17] + ProblemText[18] +
                                    ProblemText[19] + ProblemText[20] + ProblemText[21] +
                                    ProblemText[22] + ProblemText[23] + ProblemText[24] +
                                    ProblemText[25] + ProblemText[26] + ProblemText[27] +
                                    ProblemText[28] + ProblemText[29] + ProblemText[30];

                                  //Internal tekst
                                  CLEAR(InternalText);
                                  FillText("No.",2,InternalText);
                                  xlSheet.Range(CellCde[16]).Value :=
                                    InternalText[1] + InternalText[2] + InternalText[3] +
                                    InternalText[4] + InternalText[5] + InternalText[6] +
                                    InternalText[7] + InternalText[8] + InternalText[9] +
                                    InternalText[10] + InternalText[11] + InternalText[12] +
                                    InternalText[13] + InternalText[14] + InternalText[15] +
                                    InternalText[16] + InternalText[17] + InternalText[18] +
                                    InternalText[19] + InternalText[20] + InternalText[21] +
                                    InternalText[22] + InternalText[23] + InternalText[24] +
                                    InternalText[25] + InternalText[26] + InternalText[27] +
                                    InternalText[28] + InternalText[29] + InternalText[30];

                                  //Oorzaaktekst
                                  CLEAR(CauseText);
                                  FillText("No.",4,CauseText);
                                  xlSheet.Range(CellCde[17]).Value :=
                                    CauseText[1] + CauseText[2] + CauseText[3] +
                                    CauseText[4] + CauseText[5] + CauseText[6] +
                                    CauseText[7] + CauseText[8] + CauseText[9] +
                                    CauseText[10] + CauseText[11] + CauseText[12] +
                                    CauseText[13] + CauseText[14] + CauseText[15] +
                                    CauseText[16] + CauseText[17] + CauseText[18] +
                                    CauseText[19] + CauseText[20] + CauseText[21] +
                                    CauseText[22] + CauseText[23] + CauseText[24] +
                                    CauseText[25] + CauseText[26] + CauseText[27] +
                                    CauseText[28] + CauseText[29] + CauseText[30];

                                  //Oplossingstekst
                                  CLEAR(SolutionText);
                                  FillText("No.",3,SolutionText);
                                  xlSheet.Range(CellCde[18]).Value :=
                                    SolutionText[1] + SolutionText[2] + SolutionText[3] +
                                    SolutionText[4] + SolutionText[5] + SolutionText[6] +
                                    SolutionText[7] + SolutionText[8] + SolutionText[9] +
                                    SolutionText[10] + SolutionText[11] + SolutionText[12] +
                                    SolutionText[13] + SolutionText[14] + SolutionText[15] +
                                    SolutionText[16] + SolutionText[17] + SolutionText[18] +
                                    SolutionText[19] + SolutionText[20] + SolutionText[21] +
                                    SolutionText[22] + SolutionText[23] + SolutionText[24] +
                                    SolutionText[25] + SolutionText[26] + SolutionText[27] +
                                    SolutionText[28] + SolutionText[29] + SolutionText[30];

                                  xlSheet.Range(CellCde[19]).Value := "Order Date";

                                  //Locatie tekst (aanmeldprocedure)
                                  CLEAR(LocatonText);
                                  FillLocationText("Service Location No." , LocatonText);
                                  xlSheet.Range(CellCde[20]).Value :=
                                    LocatonText[1] + LocatonText[2] + LocatonText[3] +
                                    LocatonText[4] + LocatonText[5] + LocatonText[6] +
                                    LocatonText[7] + LocatonText[8] + LocatonText[9] +
                                    LocatonText[10] + LocatonText[11] + LocatonText[12] +
                                    LocatonText[13] + LocatonText[14] + LocatonText[15] +
                                    LocatonText[16] + LocatonText[17] + LocatonText[18] +
                                    LocatonText[19] + LocatonText[20] + LocatonText[21] +
                                    LocatonText[22] + LocatonText[23] + LocatonText[24] +
                                    LocatonText[25] + LocatonText[26] + LocatonText[27] +
                                    LocatonText[28] + LocatonText[29] + LocatonText[30];

                                  RowNo += 1;
                                END;

               OnPostDataItem=VAR
                                TempRange@1100525000 : Code[20];
                              BEGIN
                                TempRange := STRSUBSTNO('A6:T%1',RowNo + 1);
                                xlApp.Range('B7').Select;
                                xlApp.ActiveWindow.FreezePanes := TRUE;
                                xlApp.Visible(TRUE);
                              END;
                               }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN

                   PeriodType := PeriodType::Month;
                   //SearchPeriod.FindPeriod(DatFilterStart,DatFilterEnd,CumulationFilterTxt,PeriodFilterTxt,PeriodType,'>=');
                   SearchPeriod.FindPeriod(DatFilterStart,DatFilterEnd,CumulationFilterTxt,PeriodFilterTxt,PeriodType,'<=')
                 END;

    }
    CONTROLS
    {
      { 1100525000;;Container;
                  Name=Container1;
                  ContainerType=ContentArea }

      { 1100525001;1;Group  ;
                  Name=Options;
                  CaptionML=ENU=Options;
                  GroupType=Group }

      { 1100525002;2;Field  ;
                  Name=PeriodFilterTxt;
                  CaptionML=ENU=Period Filter;
                  SourceExpr=PeriodFilterTxt }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      SOcounter@1100525007 : Integer;
      SOTotalCounter@1100525004 : Integer;
      Dialog_@1100525005 : Dialog;
      Text001@1100525006 : TextConst;
      RowNo@1100525008 : Integer;
      ColNo@1100525009 : Integer;
      CellCde@1100525010 : ARRAY [100] OF Code[100];
      ServOrderExtension@1100525011 : Record 11071727;
      ProblemText@1100525012 : ARRAY [30] OF Text;
      InternalText@1100525013 : ARRAY [30] OF Text;
      CauseText@1100525014 : ARRAY [30] OF Text;
      SolutionText@1100525015 : ARRAY [30] OF Text;
      LocatonText@1100525016 : ARRAY [30] OF Text;
      SearchPeriod@1100525017 : Codeunit 11012016;
      PeriodType@1100525018 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      DatFilterStart@1100525019 : Date;
      EDatFilterStart@1100525020 : Date;
      DatFilterEnd@1100525021 : Date;
      EDatFilterEnd@1100525022 : Date;
      PeriodFilterTxt@1100525023 : Text;
      CumulationFilterTxt@1100525024 : Text;
      xlApp@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024500-0000-0000-C000-000000000046}:Unknown Automation Server.Application";
      xlBook@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";
      xlSheet@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020820-0000-0000-C000-000000000046}:Unknown Automation Server.Worksheet";

    LOCAL PROCEDURE Matrix@1100525001(m_col@1100525000 : Integer;m_row@1100525001 : Integer) m_ret : Code[10];
    VAR
      xx@1100525002 : Integer;
      alf@1100525003 : Code[30];
      m_rest@1100525004 : Decimal;
      m_nu@1100525005 : Decimal;
      m_heel@1100525006 : Decimal;
      m_tus@1100525007 : Code[30];
    BEGIN
      IF m_col > 16384 THEN BEGIN
        m_tus := 'XFD';
        ERROR('Selecteer minder kolommen (max 16384)');
      END ELSE BEGIN
        alf := 'ABCDEFGHIJKLMNOPQRSTUVWXYZ ';
        REPEAT
          IF m_col > 676  THEN
            m_heel := ROUND(m_col/(POWER(26.000000001,2)),1,'<')
          ELSE
            m_heel := ROUND(m_col/26.000000001,1,'<');
          IF m_heel > 0 THEN
            m_nu := m_heel
          ELSE
            m_nu := m_col;
          IF m_nu = 0 THEN
            m_nu := 27;
          m_tus := m_tus + COPYSTR(alf,m_nu,1);
          IF m_col > 676 THEN
            m_col := ROUND(m_col-(m_heel*(POWER(26,2))),1)
          ELSE
            m_col := ROUND(m_col-(m_heel*26),1);
        UNTIL m_heel <= 0;
      END;

      m_ret := DELCHR(STRSUBSTNO('%1 %2',m_tus,m_row));
    END;

    LOCAL PROCEDURE FillText@1100525002(SO@1100525000 : Code[20];TypeInt@1100525001 : Integer;VAR lText@1100525002 : ARRAY [30] OF Text[100]);
    VAR
      ServiceText@1100525003 : Record 11012882;
      i@1100525004 : Integer;
    BEGIN
      ServiceText.SETRANGE("Table Name", ServiceText."Table Name"::"Service Order");
      ServiceText.SETRANGE("No.",SO);
      CASE TypeInt OF
        1:BEGIN    //Probleem
          ServiceText.SETFILTER("Table Field",'90');
        END;
        2:BEGIN    //Interne tekst
          ServiceText.SETFILTER("Table Field",'91');
        END;
        3: BEGIN   //Oplossingstekst
          ServiceText.SETFILTER("Table Field",'92');
        END;

        4: BEGIN   //Oorzaak
          ServiceText.SETFILTER("Table Field",'94');
        END;
      END;

      IF ServiceText.FINDSET THEN BEGIN
        REPEAT
          i := i + 1;
          lText[i] := FORMAT(ServiceText.Date) + ' ' + ServiceText.Comment;
        UNTIL (ServiceText.NEXT = 0) OR (i = 30)
      END;
    END;

    LOCAL PROCEDURE FillLocationText@1100525003(LocCde@1100525000 : Code[20];VAR LocText@1100525001 : ARRAY [30] OF Text[100]);
    VAR
      ServiceText@1100525002 : Record 11012882;
      i@1100525003 : Integer;
    BEGIN
      ServiceText.SETRANGE("Table Name", ServiceText."Table Name"::"Service Location");
      ServiceText.SETRANGE("No.",LocCde);
      IF ServiceText.FINDSET THEN BEGIN
        REPEAT
          i := i + 1;
          LocText[i] := ServiceText.Comment;
        UNTIL (ServiceText.NEXT = 0) OR (i = 30)
      END;
    END;

    EVENT xlSheet@1000000000::SelectionChange@1543(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlSheet@1000000000::BeforeDoubleClick@1537(Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlSheet@1000000000::BeforeRightClick@1534(Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlSheet@1000000000::Activate@304();
    BEGIN
    END;

    EVENT xlSheet@1000000000::Deactivate@1530();
    BEGIN
    END;

    EVENT xlSheet@1000000000::Calculate@279();
    BEGIN
    END;

    EVENT xlSheet@1000000000::Change@1545(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlSheet@1000000000::FollowHyperlink@1470(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT xlSheet@1000000000::PivotTableUpdate@2156(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlSheet@1000000000::PivotTableAfterValueChange@2886(TargetPivotTable@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";TargetRange@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlSheet@1000000000::PivotTableBeforeAllocateChanges@2889(TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlSheet@1000000000::PivotTableBeforeCommitChanges@2892(TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlSheet@1000000000::PivotTableBeforeDiscardChanges@2893(TargetPivotTable@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000001 : Integer;ValueChangeEnd@1000000000 : Integer);
    BEGIN
    END;

    EVENT xlSheet@1000000000::PivotTableChangeSync@2894(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1000000001::Open@1923();
    BEGIN
    END;

    EVENT xlBook@1000000001::Activate@304();
    BEGIN
    END;

    EVENT xlBook@1000000001::Deactivate@1530();
    BEGIN
    END;

    EVENT xlBook@1000000001::BeforeClose@1546(VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::BeforeSave@1547(SaveAsUI@1000000001 : Boolean;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::BeforePrint@1549(VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::NewSheet@1550(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlBook@1000000001::AddinInstall@1552();
    BEGIN
    END;

    EVENT xlBook@1000000001::AddinUninstall@1553();
    BEGIN
    END;

    EVENT xlBook@1000000001::WindowResize@1554(Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlBook@1000000001::WindowActivate@1556(Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlBook@1000000001::WindowDeactivate@1557(Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetSelectionChange@1558(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetBeforeDoubleClick@1559(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetBeforeRightClick@1560(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetActivate@1561(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetDeactivate@1562(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetCalculate@1563(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetChange@1564(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetFollowHyperlink@1854(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetPivotTableUpdate@2157(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1000000001::PivotTableCloseConnection@2158(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1000000001::PivotTableOpenConnection@2159(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1000000001::Sync@2266(SyncEventType@1000000000 : Integer);
    BEGIN
    END;

    EVENT xlBook@1000000001::BeforeXmlImport@2283(Map@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000002 : Text;IsRefresh@1000000001 : Boolean;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::AfterXmlImport@2285(Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";IsRefresh@1000000001 : Boolean;Result@1000000000 : Integer);
    BEGIN
    END;

    EVENT xlBook@1000000001::BeforeXmlExport@2287(Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000001 : Text;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::AfterXmlExport@2288(Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000001 : Text;Result@1000000000 : Integer);
    BEGIN
    END;

    EVENT xlBook@1000000001::RowsetComplete@2610(Description@1000000002 : Text;Sheet@1000000001 : Text;Success@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetPivotTableAfterValueChange@2895(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";TargetRange@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetPivotTableBeforeAllocateChanges@2896(Sh@1000000004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetPivotTableBeforeCommitChanges@2897(Sh@1000000004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetPivotTableBeforeDiscardChanges@2898(Sh@1000000003 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000001 : Integer;ValueChangeEnd@1000000000 : Integer);
    BEGIN
    END;

    EVENT xlBook@1000000001::SheetPivotTableChangeSync@2899(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlBook@1000000001::AfterSave@2900(Success@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlBook@1000000001::NewChart@2901(Ch@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:Unknown Automation Server.Chart");
    BEGIN
    END;

    EVENT xlApp@1000000002::NewWorkbook@1565(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetSelectionChange@1558(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetBeforeDoubleClick@1559(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetBeforeRightClick@1560(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetActivate@1561(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetDeactivate@1562(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetCalculate@1563(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetChange@1564(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookOpen@1567(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookActivate@1568(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookDeactivate@1569(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookBeforeClose@1570(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookBeforeSave@1571(Wb@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";SaveAsUI@1000000001 : Boolean;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookBeforePrint@1572(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookNewSheet@1573(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookAddinInstall@1574(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookAddinUninstall@1575(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT xlApp@1000000002::WindowResize@1554(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlApp@1000000002::WindowActivate@1556(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlApp@1000000002::WindowDeactivate@1557(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetFollowHyperlink@1854(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetPivotTableUpdate@2157(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookPivotTableCloseConnection@2160(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookPivotTableOpenConnection@2161(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookSync@2289(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";SyncEventType@1000000000 : Integer);
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookBeforeXmlImport@2290(Wb@1000000004 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000002 : Text;IsRefresh@1000000001 : Boolean;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookAfterXmlImport@2291(Wb@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";IsRefresh@1000000001 : Boolean;Result@1000000000 : Integer);
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookBeforeXmlExport@2292(Wb@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000001 : Text;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookAfterXmlExport@2293(Wb@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000001 : Text;Result@1000000000 : Integer);
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookRowsetComplete@2611(Wb@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Description@1000000002 : Text;Sheet@1000000001 : Text;Success@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::AfterCalculate@2612();
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetPivotTableAfterValueChange@2895(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";TargetRange@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetPivotTableBeforeAllocateChanges@2896(Sh@1000000004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetPivotTableBeforeCommitChanges@2897(Sh@1000000004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::SheetPivotTableBeforeDiscardChanges@2898(Sh@1000000003 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000001 : Integer;ValueChangeEnd@1000000000 : Integer);
    BEGIN
    END;

    EVENT xlApp@1000000002::ProtectedViewWindowOpen@2903(Pvw@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT xlApp@1000000002::ProtectedViewWindowBeforeEdit@2905(Pvw@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::ProtectedViewWindowBeforeClose@2906(Pvw@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow";Reason@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::ProtectedViewWindowResize@2908(Pvw@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT xlApp@1000000002::ProtectedViewWindowActivate@2909(Pvw@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT xlApp@1000000002::ProtectedViewWindowDeactivate@2910(Pvw@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookAfterSave@2911(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Success@1000000000 : Boolean);
    BEGIN
    END;

    EVENT xlApp@1000000002::WorkbookNewChart@2912(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Ch@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:Unknown Automation Server.Chart");
    BEGIN
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportID>0eeb6585-38ae-40f1-885b-8d50088d51b4</rd:ReportID>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
</Report>
    END_OF_RDLDATA
  }
}

