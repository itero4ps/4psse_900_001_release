OBJECT Table 11020225 Hour Accounting Project Line
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS9.00;
  }
  PROPERTIES
  {
    Permissions=TableData 11012038=rimd,
                TableData 11012039=rimd;
    OnInsert=BEGIN
               UpdateHourLine(UpdateAction::Insert);
             END;

    OnModify=BEGIN
               UpdateHourLine(UpdateAction::Modify);
             END;

    OnDelete=BEGIN
               UpdateHourLine(UpdateAction::Delete);
             END;

    OnRename=BEGIN
               UpdateHourLine(UpdateAction::Rename);
             END;

    CaptionML=ENU=Hour Accounting Project Line;
  }
  FIELDS
  {
    { 10  ;   ;Year                ;Integer       ;CaptionML=ENU=Year }
    { 20  ;   ;Week                ;Integer       ;CaptionML=ENU=Week }
    { 25  ;   ;Supplying Company   ;Text30        ;TableRelation=Company;
                                                   OnValidate=VAR
                                                                ICLicenceCu@1210190000 : Codeunit 11012780;
                                                              BEGIN
                                                                IF "Supplying Company" <> '' THEN
                                                                  ICLicenceCu.CheckICEntry("Supplying Company");

                                                                IF ("Supplying Company" <> '') AND ("Receiving Company" <> '') THEN
                                                                  FIELDERROR("Supplying Company", STRSUBSTNO(Text005,"Receiving Company")); // 'Double IC' not allowed.
                                                              END;

                                                   CaptionML=ENU=Supplying Company }
    { 30  ;   ;Employee No.        ;Code20        ;TableRelation=IF (Supplying Company=FILTER('')) Employee;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Employee No."));

                                                                IF "Employee No." <> '' THEN BEGIN
                                                                  EmplRec.CHANGECOMPANY("Supplying Company");
                                                                  EmplRec.GET("Employee No.");
                                                                  IF "Supplying Company" <> '' THEN
                                                                    EmplRec.TESTFIELD(External,FALSE);
                                                                END;

                                                                CALCFIELDS("Full Name");
                                                                EmplNameOtherCompany;
                                                              END;

                                                   OnLookup=VAR
                                                              MultipleEmployeesCopied@1100528400 : Boolean;
                                                            BEGIN
                                                              LookupEmployee(FALSE, MultipleEmployeesCopied);
                                                            END;

                                                   CaptionML=ENU=Employee No. }
    { 31  ;   ;Full Name           ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Full Name" WHERE (No.=FIELD(Employee No.)));
                                                   CaptionML=ENU=Employee Name;
                                                   Description=Project Line Specific;
                                                   Editable=No }
    { 35  ;   ;Header Project No.  ;Code20        ;TableRelation=Job.No.;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Project No."));
                                                              END;

                                                   CaptionML=ENU=Header Project No.;
                                                   Description=Project Line Specific }
    { 36  ;   ;Hour Set            ;Code10        ;TableRelation="Hour Set";
                                                   CaptionML=ENU=Hour Set }
    { 37  ;   ;Connection No.      ;Integer       ;CaptionML=ENU=Connection No. }
    { 40  ;   ;Line No.            ;Integer       ;TableRelation="Hour Accounting Project" WHERE (Year=FIELD(Year),
                                                                                                  Week=FIELD(Week),
                                                                                                  Project No.=FIELD(Header Project No.));
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Line No. }
    { 41  ;   ;Document No.        ;Code20        ;CaptionML=ENU=Document No.;
                                                   Editable=No }
    { 42  ;   ;Posting Date        ;Date          ;OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Posting Date"));
                                                              END;

                                                   CaptionML=ENU=Posting Date }
    { 50  ;   ;Receiving Company   ;Text30        ;TableRelation=Company;
                                                   OnValidate=BEGIN
                                                                IF ("Supplying Company" <> '') AND ("Receiving Company" <> '') THEN
                                                                  FIELDERROR("Receiving Company", STRSUBSTNO(Text005,"Supplying Company")); // 'Double IC' not allowed.
                                                              END;

                                                   CaptionML=ENU=Receiving Company;
                                                   Editable=No }
    { 65  ;   ;Calculate Wage Costs;Option        ;CaptionML=ENU=Calculate Wage Costs;
                                                   OptionCaptionML=ENU=Fixed Rate,Actual Rate;
                                                   OptionString=Fixed Rate,Actual Rate }
    { 70  ;   ;Project No.         ;Code20        ;TableRelation=Job.No.;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Project No."));
                                                              END;

                                                   CaptionML=ENU=Project No.;
                                                   Editable=No }
    { 71  ;   ;Element             ;Code20        ;TableRelation="Project Element".Element WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Element));
                                                                IF Element <> '' THEN BEGIN

                                                                  ProjElemRec.GET("Project No.",Element);
                                                                  ProjElemRec.CheckProjectElementBlocked;     //Call 6564

                                                                  "Element Description" := ProjElemRec.Description;
                                                                END ELSE
                                                                  "Element Description" := '';
                                                              END;

                                                   OnLookup=VAR
                                                              ProjElement@1100525000 : Record 11012010;
                                                            BEGIN
                                                              ProjElement.SETRANGE("Project No.", "Project No.");
                                                              ProjElement."Project No." := "Project No.";
                                                              ProjElement.SETRANGE(Blocked, FALSE);
                                                              ProjElement.Element := Element;
                                                              IF PAGE.RUNMODAL(0, ProjElement) = ACTION::LookupOK THEN
                                                                IF (Type = Type::Project) THEN  //db, 25-07-05
                                                                  VALIDATE(Element, ProjElement.Element);
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=ENU=Element }
    { 72  ;   ;Cost Object         ;Code20        ;TableRelation=IF (Receiving Company=FILTER('')) "Dimension Value".Code WHERE (Cost Type=FILTER(Labor|Subcontracting|Plant|Sundry),
                                                                                                                                 Global Dimension No.=CONST(2),
                                                                                                                                 Project Filter=FIELD(Header Project No.));
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Cost Object"));
                                                              END;

                                                   CaptionML=ENU=Cost Object }
    { 73  ;   ;Wage Component      ;Code10        ;TableRelation="Wage Component".Code WHERE (Component Type=FILTER(Hours|Expenses|Expense hours));
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Wage Component"));
                                                              END;

                                                   CaptionML=ENU=Wage Component }
    { 74  ;   ;Overtime            ;Boolean       ;FieldClass=Normal;
                                                   CaptionML=ENU=Overtime;
                                                   Editable=No }
    { 75  ;   ;Extension Contract  ;Code10        ;TableRelation="Extension Contract"."Contract No." WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Extension Contract"));
                                                              END;

                                                   CaptionML=ENU=Extension Contract }
    { 80  ;   ;Description         ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Wage Component".Description WHERE (Code=FIELD(Wage Component)));
                                                   CaptionML=ENU=Description;
                                                   Editable=No }
    { 85  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=ENU=Currency Code }
    { 110 ;   ;Monday              ;Decimal       ;FieldClass=Normal;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Monday));
                                                              END;

                                                   CaptionML=ENU=Monday;
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 120 ;   ;Tuesday             ;Decimal       ;FieldClass=Normal;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Tuesday));
                                                              END;

                                                   CaptionML=ENU=Tuesday;
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 130 ;   ;Wednesday           ;Decimal       ;FieldClass=Normal;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Wednesday));
                                                              END;

                                                   CaptionML=ENU=Wednesday;
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 140 ;   ;Thursday            ;Decimal       ;FieldClass=Normal;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Thursday));
                                                              END;

                                                   CaptionML=ENU=Thursday;
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 150 ;   ;Friday              ;Decimal       ;FieldClass=Normal;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Friday));
                                                              END;

                                                   CaptionML=ENU=Friday;
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 160 ;   ;Saturday            ;Decimal       ;FieldClass=Normal;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Saturday));
                                                              END;

                                                   CaptionML=ENU=Saturday;
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 170 ;   ;Sunday              ;Decimal       ;FieldClass=Normal;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Sunday));
                                                              END;

                                                   CaptionML=ENU=Sunday;
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 180 ;   ;Total Line          ;Decimal       ;CaptionML=ENU=Total Line;
                                                   DecimalPlaces=0:3;
                                                   Editable=No }
    { 190 ;   ;Project Total Monday;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Monday WHERE (Year=FIELD(Year),
                                                                                                                Week=FIELD(Week),
                                                                                                                Header Project No.=FIELD(Header Project No.),
                                                                                                                Overtime=CONST(No),
                                                                                                                Excl. from Normal&Extra Hours=CONST(No),
                                                                                                                Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Project Total Monday;
                                                   Editable=No }
    { 200 ;   ;Project Total Tuesday;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Tuesday WHERE (Year=FIELD(Year),
                                                                                                                 Week=FIELD(Week),
                                                                                                                 Header Project No.=FIELD(Header Project No.),
                                                                                                                 Overtime=CONST(No),
                                                                                                                 Excl. from Normal&Extra Hours=CONST(No),
                                                                                                                 Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Project Total Tuesday;
                                                   Editable=No }
    { 210 ;   ;Project Total Wednesday;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Wednesday WHERE (Year=FIELD(Year),
                                                                                                                   Week=FIELD(Week),
                                                                                                                   Header Project No.=FIELD(Header Project No.),
                                                                                                                   Overtime=CONST(No),
                                                                                                                   Excl. from Normal&Extra Hours=CONST(No),
                                                                                                                   Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Project Total Wednesday;
                                                   Editable=No }
    { 220 ;   ;Project Total Thursday;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Thursday WHERE (Year=FIELD(Year),
                                                                                                                  Week=FIELD(Week),
                                                                                                                  Header Project No.=FIELD(Header Project No.),
                                                                                                                  Overtime=CONST(No),
                                                                                                                  Excl. from Normal&Extra Hours=CONST(No),
                                                                                                                  Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Project Total Thursday;
                                                   Editable=No }
    { 230 ;   ;Project Total Friday;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Friday WHERE (Year=FIELD(Year),
                                                                                                                Week=FIELD(Week),
                                                                                                                Header Project No.=FIELD(Header Project No.),
                                                                                                                Overtime=CONST(No),
                                                                                                                Excl. from Normal&Extra Hours=CONST(No),
                                                                                                                Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Project Total Friday;
                                                   Editable=No }
    { 240 ;   ;Project Total Saturday;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Saturday WHERE (Year=FIELD(Year),
                                                                                                                  Week=FIELD(Week),
                                                                                                                  Header Project No.=FIELD(Header Project No.),
                                                                                                                  Overtime=CONST(No),
                                                                                                                  Excl. from Normal&Extra Hours=CONST(No),
                                                                                                                  Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Project Total Saturday;
                                                   Editable=No }
    { 250 ;   ;Project Total Sunday;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Sunday WHERE (Year=FIELD(Year),
                                                                                                                Week=FIELD(Week),
                                                                                                                Header Project No.=FIELD(Header Project No.),
                                                                                                                Overtime=CONST(No),
                                                                                                                Excl. from Normal&Extra Hours=CONST(No),
                                                                                                                Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Project Total Sunday;
                                                   Editable=No }
    { 260 ;   ;Project Overtime Monday;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Monday WHERE (Year=FIELD(Year),
                                                                                                                Week=FIELD(Week),
                                                                                                                Header Project No.=FIELD(Header Project No.),
                                                                                                                Overtime=CONST(Yes),
                                                                                                                Excl. from Normal&Extra Hours=CONST(No)));
                                                   CaptionML=ENU=Project Overtime Monday;
                                                   Editable=No }
    { 270 ;   ;Project Overtime Tuesday;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Tuesday WHERE (Year=FIELD(Year),
                                                                                                                 Week=FIELD(Week),
                                                                                                                 Header Project No.=FIELD(Header Project No.),
                                                                                                                 Overtime=CONST(Yes),
                                                                                                                 Excl. from Normal&Extra Hours=CONST(No)));
                                                   CaptionML=ENU=Project Overtime Tuesday;
                                                   Editable=No }
    { 280 ;   ;Project Overtime Wednesday;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Wednesday WHERE (Year=FIELD(Year),
                                                                                                                   Week=FIELD(Week),
                                                                                                                   Header Project No.=FIELD(Header Project No.),
                                                                                                                   Overtime=CONST(Yes),
                                                                                                                   Excl. from Normal&Extra Hours=CONST(No)));
                                                   CaptionML=ENU=Project Overtime Wednesday;
                                                   Editable=No }
    { 290 ;   ;Project Overtime Thursday;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Thursday WHERE (Year=FIELD(Year),
                                                                                                                  Week=FIELD(Week),
                                                                                                                  Header Project No.=FIELD(Header Project No.),
                                                                                                                  Overtime=CONST(Yes),
                                                                                                                  Excl. from Normal&Extra Hours=CONST(No)));
                                                   CaptionML=ENU=Project Overtime Thursday;
                                                   Editable=No }
    { 300 ;   ;Project Overtime Friday;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Friday WHERE (Year=FIELD(Year),
                                                                                                                Week=FIELD(Week),
                                                                                                                Header Project No.=FIELD(Header Project No.),
                                                                                                                Overtime=CONST(Yes),
                                                                                                                Excl. from Normal&Extra Hours=CONST(No)));
                                                   CaptionML=ENU=Project Overtime Friday;
                                                   Editable=No }
    { 310 ;   ;Project Overtime Saturday;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Saturday WHERE (Year=FIELD(Year),
                                                                                                                  Week=FIELD(Week),
                                                                                                                  Header Project No.=FIELD(Header Project No.),
                                                                                                                  Overtime=CONST(Yes),
                                                                                                                  Excl. from Normal&Extra Hours=CONST(No)));
                                                   CaptionML=ENU=Project Overtime Saturday;
                                                   Editable=No }
    { 320 ;   ;Project Overtime Sunday;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line".Sunday WHERE (Year=FIELD(Year),
                                                                                                                Week=FIELD(Week),
                                                                                                                Header Project No.=FIELD(Header Project No.),
                                                                                                                Overtime=CONST(Yes),
                                                                                                                Excl. from Normal&Extra Hours=CONST(No)));
                                                   CaptionML=ENU=Project Overtime Sunday;
                                                   Editable=No }
    { 340 ;   ;Project Overtime Hours;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line"."Total Line" WHERE (Year=FIELD(Year),
                                                                                                                      Week=FIELD(Week),
                                                                                                                      Header Project No.=FIELD(Header Project No.),
                                                                                                                      Overtime=FILTER(Yes),
                                                                                                                      Excl. from Normal&Extra Hours=CONST(No)));
                                                   CaptionML=ENU=Project Overtime Hours;
                                                   Editable=No }
    { 360 ;   ;Component Type      ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Wage Component"."Component Type" WHERE (Code=FIELD(Wage Component)));
                                                   CaptionML=ENU=Component Type;
                                                   OptionCaptionML=ENU=Hours,Days,Expenses,Expense hours;
                                                   OptionString=Hours,Days,Expenses,Expense hours;
                                                   Editable=No }
    { 370 ;   ;Overtime Surcharge %;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Wage Component"."Overtime Surcharge %" WHERE (Code=FIELD(Wage Component)));
                                                   CaptionML=ENU=Overtime Surcharge %;
                                                   Editable=No }
    { 390 ;   ;Project Normal Hours;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Project Line"."Total Line" WHERE (Year=FIELD(Year),
                                                                                                                      Week=FIELD(Week),
                                                                                                                      Header Project No.=FIELD(Header Project No.),
                                                                                                                      Overtime=CONST(No),
                                                                                                                      Excl. from Normal&Extra Hours=CONST(No),
                                                                                                                      Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Project Normal Hours;
                                                   Editable=No }
    { 421 ;   ;Source Code         ;Code10        ;TableRelation="Source Code".Code;
                                                   CaptionML=ENU=Source Code }
    { 422 ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code".Code;
                                                   CaptionML=ENU=Reason Code }
    { 423 ;   ;Name                ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Last Name" WHERE (No.=FIELD(Employee No.)));
                                                   CaptionML=ENU=Name;
                                                   Editable=No }
    { 424 ;   ;External            ;Boolean       ;FieldClass=Normal;
                                                   CaptionML=ENU=External;
                                                   Editable=No }
    { 425 ;   ;Employer            ;Code20        ;TableRelation=IF (External=CONST(Yes)) Vendor.No.
                                                                 ELSE IF (External=CONST(No)) Employer.Code;
                                                   CaptionML=ENU=Employer }
    { 430 ;   ;Comment             ;Text50        ;CaptionML=ENU=Comment }
    { 440 ;   ;Project Description ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Job.Description WHERE (No.=FIELD(Project No.)));
                                                   CaptionML=ENU=Project Description;
                                                   Editable=No }
    { 445 ;   ;Project City        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Job.City WHERE (No.=FIELD(Project No.)));
                                                   CaptionML=ENU=Project City;
                                                   Editable=No }
    { 490 ;   ;Try-out No.         ;Code20        ;TableRelation=Try-out;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Try-out No."));
                                                              END;

                                                   CaptionML=ENU=Try-out No. }
    { 500 ;   ;Estimate No.        ;Code20        ;TableRelation=Estimate;
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Estimate No."));
                                                              END;

                                                   CaptionML=ENU=Estimate No. }
    { 510 ;   ;Export Document No. ;Code20        ;CaptionML=ENU=Export Document No. }
    { 520 ;   ;Department Code Employee;Code20    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Global Dimension 1 Code" WHERE (No.=FIELD(Employee No.)));
                                                   CaptionML=ENU=Department Code Employee;
                                                   Editable=No }
    { 530 ;   ;Department Code     ;Code20        ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=ENU=Department Code }
    { 540 ;   ;Cost Code           ;Code10        ;TableRelation="Cost Code";
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Cost Code"));
                                                              END;

                                                   CaptionML=ENU=Cost Code }
    { 545 ;   ;Cost Code Description;Text30       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Cost Code".Description WHERE (Code=FIELD(Cost Code)));
                                                   CaptionML=ENU=Cost Code Description;
                                                   Editable=No }
    { 550 ;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Type));
                                                                CASE Type OF
                                                                  Type::Indirect: VALIDATE("Project No.",'');
                                                                  Type::Project:
                                                                    BEGIN
                                                                      VALIDATE("Project No.", "Header Project No.");
                                                                      VALIDATE("Employee No."); //gets default element etc.
                                                                    END;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Type;
                                                   OptionCaptionML=ENU=Project,,Indirect;
                                                   OptionString=Project,,Indirect }
    { 555 ;   ;Unit Cost (LCY)     ;Decimal       ;CaptionML=ENU=Unit Cost (LCY);
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 557 ;   ;Unit Cost           ;Decimal       ;CaptionML=ENU=Unit Cost;
                                                   Editable=No;
                                                   AutoFormatType=2 }
    { 560 ;   ;Amount (LCY)        ;Decimal       ;OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Amount (LCY)"));
                                                              END;

                                                   CaptionML=ENU=Amount (LCY);
                                                   AutoFormatType=1 }
    { 561 ;   ;Amount              ;Decimal       ;OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Amount));
                                                              END;

                                                   CaptionML=ENU=Amount;
                                                   AutoFormatType=1 }
    { 570 ;   ;Quantity            ;Decimal       ;OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION(Quantity));
                                                              END;

                                                   CaptionML=ENU=Quantity;
                                                   DecimalPlaces=0:3;
                                                   BlankZero=Yes }
    { 580 ;   ;Overhead Surcharge Project;Decimal ;CaptionML=ENU=Overhead Surcharge Project;
                                                   Editable=No }
    { 600 ;   ;Cost Plus Entry Created;Boolean    ;CaptionML=ENU=Cost Plus Entry Created;
                                                   Editable=No }
    { 610 ;   ;Cost Type           ;Option        ;CaptionML=ENU=Cost Type;
                                                   OptionCaptionML=ENU=Labor,Material,Subcontracting,Plant,Sundry,Revenue;
                                                   OptionString=Labor,Material,Subcontracting,Plant,Sundry,Revenue }
    { 630 ;   ;Cost Object Description;Text50     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Dimension Value".Name WHERE (Global Dimension No.=FILTER(2),
                                                                                                    Code=FIELD(Cost Object)));
                                                   CaptionML=ENU=Cost Object Description;
                                                   Editable=No }
    { 640 ;   ;Chargeable          ;Boolean       ;CaptionML=ENU=Chargeable;
                                                   Editable=No }
    { 650 ;   ;Correction          ;Boolean       ;CaptionML=ENU=Correction }
    { 660 ;   ;Cost Component      ;Code20        ;TableRelation="Cost Component".Code;
                                                   CaptionML=ENU=Cost Component;
                                                   NotBlank=Yes }
    { 700 ;   ;Employee Total Monday;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Monday WHERE (Year=FIELD(Year),
                                                                                                        Week=FIELD(Week),
                                                                                                        Employee No.=FIELD(Employee No.),
                                                                                                        Overtime=CONST(No),
                                                                                                        Excl. from Normal&Extra Hours=CONST(No),
                                                                                                        Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Total Monday;
                                                   Editable=No }
    { 701 ;   ;Employee Total Tuesday;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Tuesday WHERE (Year=FIELD(Year),
                                                                                                         Week=FIELD(Week),
                                                                                                         Employee No.=FIELD(Employee No.),
                                                                                                         Overtime=CONST(No),
                                                                                                         Excl. from Normal&Extra Hours=CONST(No),
                                                                                                         Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Total Tuesday;
                                                   Editable=No }
    { 702 ;   ;Employee Total Wednesday;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Wednesday WHERE (Year=FIELD(Year),
                                                                                                           Week=FIELD(Week),
                                                                                                           Employee No.=FIELD(Employee No.),
                                                                                                           Overtime=CONST(No),
                                                                                                           Excl. from Normal&Extra Hours=CONST(No),
                                                                                                           Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Total Wednesday;
                                                   Editable=No }
    { 703 ;   ;Employee Total Thursday;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Thursday WHERE (Year=FIELD(Year),
                                                                                                          Week=FIELD(Week),
                                                                                                          Employee No.=FIELD(Employee No.),
                                                                                                          Overtime=CONST(No),
                                                                                                          Excl. from Normal&Extra Hours=CONST(No),
                                                                                                          Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Total Thursday;
                                                   Editable=No }
    { 704 ;   ;Employee Total Friday;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Friday WHERE (Year=FIELD(Year),
                                                                                                        Week=FIELD(Week),
                                                                                                        Employee No.=FIELD(Employee No.),
                                                                                                        Overtime=CONST(No),
                                                                                                        Excl. from Normal&Extra Hours=CONST(No),
                                                                                                        Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Total Friday;
                                                   Editable=No }
    { 705 ;   ;Employee Total Saturday;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Saturday WHERE (Year=FIELD(Year),
                                                                                                          Week=FIELD(Week),
                                                                                                          Employee No.=FIELD(Employee No.),
                                                                                                          Overtime=CONST(No),
                                                                                                          Excl. from Normal&Extra Hours=CONST(No),
                                                                                                          Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Total Saturday;
                                                   Editable=No }
    { 706 ;   ;Employee Total Sunday;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Sunday WHERE (Year=FIELD(Year),
                                                                                                        Week=FIELD(Week),
                                                                                                        Employee No.=FIELD(Employee No.),
                                                                                                        Overtime=CONST(No),
                                                                                                        Excl. from Normal&Extra Hours=CONST(No),
                                                                                                        Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Total Sunday;
                                                   Editable=No }
    { 707 ;   ;Employee Normal Hours;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line"."Total Line" WHERE (Year=FIELD(Year),
                                                                                                              Week=FIELD(Week),
                                                                                                              Employee No.=FIELD(Employee No.),
                                                                                                              Overtime=CONST(No),
                                                                                                              Excl. from Normal&Extra Hours=CONST(No),
                                                                                                              Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Normal Hours;
                                                   Editable=No }
    { 710 ;   ;Employee Overtime Monday;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Monday WHERE (Year=FIELD(Year),
                                                                                                        Week=FIELD(Week),
                                                                                                        Employee No.=FIELD(Employee No.),
                                                                                                        Overtime=CONST(Yes),
                                                                                                        Excl. from Normal&Extra Hours=CONST(No),
                                                                                                        Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Overtime Monday;
                                                   Editable=No }
    { 711 ;   ;Employee Overtime Tuesday;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Tuesday WHERE (Year=FIELD(Year),
                                                                                                         Week=FIELD(Week),
                                                                                                         Employee No.=FIELD(Employee No.),
                                                                                                         Overtime=CONST(Yes),
                                                                                                         Excl. from Normal&Extra Hours=CONST(No),
                                                                                                         Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Overtime Tuesday;
                                                   Editable=No }
    { 712 ;   ;Employee Overtime Wednesday;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Wednesday WHERE (Year=FIELD(Year),
                                                                                                           Week=FIELD(Week),
                                                                                                           Employee No.=FIELD(Employee No.),
                                                                                                           Overtime=CONST(Yes),
                                                                                                           Excl. from Normal&Extra Hours=CONST(No),
                                                                                                           Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Overtime Wednesday;
                                                   Editable=No }
    { 713 ;   ;Employee Overtime Thursday;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Thursday WHERE (Year=FIELD(Year),
                                                                                                          Week=FIELD(Week),
                                                                                                          Employee No.=FIELD(Employee No.),
                                                                                                          Overtime=CONST(Yes),
                                                                                                          Excl. from Normal&Extra Hours=CONST(No),
                                                                                                          Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Overtime Thursday;
                                                   Editable=No }
    { 714 ;   ;Employee Overtime Friday;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Friday WHERE (Year=FIELD(Year),
                                                                                                        Week=FIELD(Week),
                                                                                                        Employee No.=FIELD(Employee No.),
                                                                                                        Overtime=CONST(Yes),
                                                                                                        Excl. from Normal&Extra Hours=CONST(No),
                                                                                                        Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Overtime Friday;
                                                   Editable=No }
    { 715 ;   ;Employee Overtime Saturday;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Saturday WHERE (Year=FIELD(Year),
                                                                                                          Week=FIELD(Week),
                                                                                                          Employee No.=FIELD(Employee No.),
                                                                                                          Overtime=CONST(Yes),
                                                                                                          Excl. from Normal&Extra Hours=CONST(No),
                                                                                                          Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Overtime Saturday;
                                                   Editable=No }
    { 716 ;   ;Employee Overtime Sunday;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line".Sunday WHERE (Year=FIELD(Year),
                                                                                                        Week=FIELD(Week),
                                                                                                        Employee No.=FIELD(Employee No.),
                                                                                                        Overtime=CONST(Yes),
                                                                                                        Excl. from Normal&Extra Hours=CONST(No),
                                                                                                        Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Overtime Sunday;
                                                   Editable=No }
    { 720 ;   ;Employee Overtime Hours;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Hour Accounting Line"."Total Line" WHERE (Year=FIELD(Year),
                                                                                                              Week=FIELD(Week),
                                                                                                              Employee No.=FIELD(Employee No.),
                                                                                                              Overtime=CONST(Yes),
                                                                                                              Excl. from Normal&Extra Hours=CONST(No),
                                                                                                              Cost Type=FILTER(Labor|Subcontracting|Sundry)));
                                                   CaptionML=ENU=Employee Overtime Hours;
                                                   Editable=No }
    { 800 ;   ;Leave Type          ;Code10        ;TableRelation="Leave Type";
                                                   CaptionML=ENU=Leave Type;
                                                   Editable=No }
    { 810 ;   ;Leave Factor        ;Decimal       ;CaptionML=ENU=Leave Factor;
                                                   Editable=No }
    { 900 ;   ;Precalc. Surcharge Rate;Decimal    ;CaptionML=ENU=Precalc. Surcharge Rate }
    { 901 ;   ;Precalc. Surcharge Expenses;Decimal;CaptionML=ENU=Precalc. Surcharge Expenses }
    { 940 ;   ;Rental Unit         ;Code20        ;TableRelation="Rental Unit"."Rental Unit" WHERE (Project No.=FIELD(Project No.));
                                                   OnValidate=BEGIN
                                                                ValidateFields(FIELDCAPTION("Rental Unit"));
                                                              END;

                                                   CaptionML=ENU=Rental Unit }
    { 1020;   ;Cost Price Found at ;Text250       ;CaptionML=ENU=Cost Price Found at;
                                                   Editable=No }
    { 1030;   ;Element Description ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Project Element".Description WHERE (Project No.=FIELD(Project No.),
                                                                                                           Element=FIELD(Element)));
                                                   CaptionML=ENU=Element Description;
                                                   Editable=No }
    { 11128230;;Team Code          ;Code10        ;TableRelation="Team Code";
                                                   CaptionML=ENU=Team Code;
                                                   Description=SESB.I037 }
    { 11128231;;Excl. from Normal&Extra Hours;Boolean;
                                                   CaptionML=ENU=Exclude from Normal&Extra Hours;
                                                   Description=SESB.I038 }
  }
  KEYS
  {
    {    ;Year,Week,Header Project No.,Line No.   ;Clustered=Yes }
    {    ;Year,Week,Header Project No.,Overtime,Cost Type;
                                                   SumIndexFields=Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday,Total Line }
    {    ;Year,Week,Header Project No.,Overtime,Cost Type,Excl. from Normal&Extra Hours;
                                                   SumIndexFields=Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday,Total Line }
    {    ;Connection No.                           }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      EmplRec@1210190008 : Record 5200;
      HourProjHeader@1210190003 : Record 11020224;
      HourHeader@1210190006 : Record 11012038;
      HourHeader2@1100525001 : Record 11012038;
      HourLine@1210190004 : Record 11012039;
      TmpHourHeader@1210190001 : TEMPORARY Record 11012038;
      TmpHourLine@1210190000 : TEMPORARY Record 11012039;
      DimValRec@1100485002 : Record 349;
      PostingDateRec@1100485000 : Record 11020202;
      DimMgt@1100485003 : Codeunit 408;
      UpdateAction@1210190002 : 'Insert,Modify,Delete,Rename';
      Text005@1100485001 : TextConst 'ENU=and %1 may not be filled both';
      Text006@1100525000 : TextConst 'ENU=%1 %2 is already used at %3 %4.';
      ProjElemRec@1100525002 : Record 11012010;

    PROCEDURE ValidateFields@1210190001(ChangedFieldName@1210190000 : Text[100]);
    BEGIN
      CLEAR(TmpHourLine);
      TmpHourLine.TRANSFERFIELDS(Rec);
      TmpHourLine.TestStatusOpen(FALSE);
      TmpHourLine.SetFromHourAccByProj(CurrFieldNo);
      CASE ChangedFieldName OF
        'INSERT' :
          BEGIN
            TmpHourLine.InitRecord;
            TmpHourLine.FillDocNoPostingDate(TRUE);
            TmpHourLine."Supplying Company" := "Supplying Company";
          END;
        'MODIFY' : TmpHourLine.CheckPostingDate;
        FIELDCAPTION("Employee No.") :
          BEGIN
            HourProjHeader.GET(Year, Week, "Header Project No.");
            TmpHourHeader.TRANSFERFIELDS(HourProjHeader);
            TmpHourHeader."Supplying Company" := "Supplying Company";
            TmpHourHeader.VALIDATE("Employee No.", "Employee No.");
            TmpHourHeader.CheckPostedHours;
            HourHeader2 := TmpHourHeader;
            IF HourHeader2.FIND('=') THEN
              IF (HourHeader2."Supplying Company" <> "Supplying Company") AND
                 ("Employee No." <> '')
              THEN
                ERROR(
                  Text006,
                  FIELDCAPTION("Employee No."), "Employee No.", FIELDCAPTION("Supplying Company"), HourHeader2."Supplying Company");

            TmpHourLine.TRANSFERFIELDS(Rec);
            TmpHourLine."Document No." := HourProjHeader."Document No.";
            TmpHourLine.VALIDATE("Employee No.", "Employee No.");
          END;
        FIELDCAPTION("Project No.") : TmpHourLine.VALIDATE("Project No.");
        FIELDCAPTION("Cost Object") : TmpHourLine.VALIDATE("Cost Object");
        FIELDCAPTION("Wage Component") : TmpHourLine.VALIDATE("Wage Component");
        FIELDCAPTION(Element) : TmpHourLine.VALIDATE(Element);
        FIELDCAPTION("Extension Contract") : TmpHourLine.VALIDATE("Extension Contract");
        FIELDCAPTION("Rental Unit") : TmpHourLine.VALIDATE("Rental Unit");

        FIELDCAPTION(Monday) : TmpHourLine.VALIDATE(Monday);
        FIELDCAPTION(Tuesday) : TmpHourLine.VALIDATE(Tuesday);
        FIELDCAPTION(Wednesday) : TmpHourLine.VALIDATE(Wednesday);
        FIELDCAPTION(Thursday) : TmpHourLine.VALIDATE(Thursday);
        FIELDCAPTION(Friday) : TmpHourLine.VALIDATE(Friday);
        FIELDCAPTION(Saturday) : TmpHourLine.VALIDATE(Saturday);
        FIELDCAPTION(Sunday) : TmpHourLine.VALIDATE(Sunday);
        FIELDCAPTION("Try-out No.") : TmpHourLine.VALIDATE("Try-out No.");
        FIELDCAPTION("Estimate No.") : TmpHourLine.VALIDATE("Estimate No.");
        FIELDCAPTION("Cost Code") : TmpHourLine.VALIDATE("Cost Code");
        FIELDCAPTION(Type) :
          BEGIN
            TmpHourLine.Type := xRec.Type;
            TmpHourLine.VALIDATE(Type,Type);
          END;
        FIELDCAPTION("Amount (LCY)") : TmpHourLine.VALIDATE("Amount (LCY)");
        FIELDCAPTION(Quantity) : TmpHourLine.VALIDATE(Quantity);
        FIELDCAPTION("Posting Date") : TmpHourLine.VALIDATE("Posting Date");
      END;
      TRANSFERFIELDS(TmpHourLine);
    END;

    PROCEDURE UpdateHourLine@1210190000(UpdateAction@1210190001 : 'Insert,Modify,Delete,Rename');
    VAR
      HourProjLine2@1210190002 : Record 11020225;
      LineNo@1210190007 : Integer;
    BEGIN
      CASE UpdateAction OF
        UpdateAction::Insert:
          BEGIN

            //Create Hour Header if necessary
            IF HourProjHeader.GET(Year, Week, "Header Project No.") THEN;
            //While renaming the hour header .GET without IF would result into an error message
            HourHeader.TRANSFERFIELDS(HourProjHeader);
            HourHeader."Supplying Company" := "Supplying Company";
            HourHeader."Employee No." := "Employee No.";
            HourHeader.FillEmployeeRelatedFields;
            HourHeader2 := HourHeader;
            IF HourHeader2.FIND('=') THEN BEGIN
              IF (HourHeader2."Supplying Company" <> "Supplying Company") AND
                 ("Employee No." <> '')
              THEN
                ERROR(
                  Text006,
                  FIELDCAPTION("Employee No."), "Employee No.", FIELDCAPTION("Supplying Company"), HourHeader2."Supplying Company");
            END ELSE
              HourHeader.INSERT;

            //Validate
            ValidateFields('INSERT');

            //Write Connection No
            HourProjLine2.SETCURRENTKEY("Connection No.");
            IF HourProjLine2.FINDLAST THEN
              "Connection No." := HourProjLine2."Connection No." + 1
            ELSE
              "Connection No." := 1;

            //Create Hour Line
            HourLine.RESET;
            HourLine.SETRANGE(Year, Year);
            HourLine.SETRANGE(Week, Week);
            HourLine.SETRANGE("Employee No.", "Employee No.");
            IF HourLine.FINDLAST THEN
              LineNo := HourLine."Line No." + 10000
            ELSE
              LineNo := 10000;

            CLEAR(HourLine);
            HourLine.SetUpdateFromProjHourLine(TRUE);
            HourLine.TRANSFERFIELDS(Rec);
            HourLine."Line No." := LineNo;
            HourLine.FillMainProject;
            HourLine.FillDepartmentCode();
            HourLine.TestStatusOpen(FALSE);
            HourLine.INSERT(TRUE);
          END;
        UpdateAction::Modify:
          BEGIN
            ValidateFields('MODIFY');
            IF "Connection No." = 0 THEN
              UpdateHourLine(UpdateAction::Insert)
            ELSE BEGIN
              HourLine.RESET;
              HourLine.SETCURRENTKEY("Connection No.");
              HourLine.SETRANGE("Connection No.", "Connection No.");
              IF NOT HourLine.FINDFIRST THEN
                UpdateHourLine(UpdateAction::Insert)
              ELSE BEGIN
                IF ("Employee No." = HourLine."Employee No.") AND
                  ("Supplying Company" = HourLine."Supplying Company")
                THEN BEGIN
                  HourLine.SetUpdateFromProjHourLine(TRUE);
                  HourLine.TRANSFERFIELDS(Rec,FALSE);
                  HourLine.FillMainProject;
                  HourLine.FillDepartmentCode();
                  HourLine.TestStatusOpen(FALSE);
                  HourLine.MODIFY(TRUE);
                END ELSE BEGIN
                  UpdateHourLine(UpdateAction::Delete);
                  UpdateHourLine(UpdateAction::Insert);
                END;
              END;
            END;
          END;
        UpdateAction::Delete:
          IF "Connection No." > 0 THEN BEGIN
            HourLine.RESET;
            HourLine.SETCURRENTKEY("Connection No.");
            HourLine.SETRANGE("Connection No.", "Connection No.");
            IF HourLine.FINDFIRST THEN BEGIN
              HourLine.SetUpdateFromProjHourLine(TRUE);
              HourLine.TestStatusOpen(FALSE);
              HourLine.DELETE(TRUE);
              HourLine.RESET;
              HourLine.SETRANGE(Year, HourLine.Year);
              HourLine.SETRANGE(Week, HourLine.Week);
              HourLine.SETRANGE("Employee No.", HourLine."Employee No.");
              IF NOT HourLine.FINDFIRST THEN
                IF HourHeader.GET(HourLine.Year, HourLine.Week, HourLine."Employee No.") THEN
                  HourHeader.DELETE;
            END;
          END;
        UpdateAction::Rename:
          BEGIN
            UpdateHourLine(UpdateAction::Delete);
            UpdateHourLine(UpdateAction::Insert);
          END;
      END;
    END;

    PROCEDURE SetHeaderForRenameHourLine@1210190002(lHourProjHeader@1210190001 : Record 11020224);
    BEGIN
      HourProjHeader := lHourProjHeader;
    END;

    PROCEDURE EmplNameOtherCompany@1210190005();
    BEGIN
      IF "Supplying Company" = '' THEN
        EXIT;

      "Full Name" := '';
      IF "Employee No." <> '' THEN BEGIN
        EmplRec.CHANGECOMPANY("Supplying Company");
        IF EmplRec.GET("Employee No.") THEN
          "Full Name" := EmplRec."Full Name";
      END;
    END;

    PROCEDURE GetHoursFromPlanning@1100485001(iHourAccountingProject@1100485000 : Record 11020224);
    VAR
      HourAccountingProjLineRec@1100485002 : Record 11020225;
      NextLineNo@1100485004 : Integer;
    BEGIN
      ERROR('Function GetHoursFromPlanning is expired');
    END;

    PROCEDURE GetHoursFromPostedProjHrs@1100485011(iHourAccProjRec@1100485000 : Record 11020224);
    VAR
      TempHourAccLineRec@1100485001 : TEMPORARY Record 11012085;
      PostedHourLineRec@1100485002 : Record 11012085;
      PrevYear@1100485005 : Integer;
      PrevWeek@1100485006 : Integer;
      HourAccountingProjLineRec@1100485007 : Record 11020225;
      NextLineNo@1100485008 : Integer;
    BEGIN
      //**4PS01.sn
      //fill temp table
      PostedHourLineRec.SETCURRENTKEY(Year,Week,"Project No.","Employee No.");
      PostedHourLineRec.SETRANGE("Project No.", iHourAccProjRec."Project No.");
      IF PostedHourLineRec.FIND('-') THEN BEGIN
        REPEAT
          IF (PrevWeek <>  PostedHourLineRec.Week) OR
             (PrevYear <>  PostedHourLineRec.Year) THEN BEGIN
            //only insert one record in the temp table per project
            TempHourAccLineRec := PostedHourLineRec;
            TempHourAccLineRec.INSERT;
            PrevWeek := PostedHourLineRec.Week;
            PrevYear :=  PostedHourLineRec.Year;
          END;
        UNTIL PostedHourLineRec.NEXT = 0;
      END;

      //start lookup form with temp table
      IF TempHourAccLineRec.FINDLAST THEN;
      //PostedHoursListFrm.SETRECORD(TempHourAccLineRec);
      //PostedHoursListFrm.LOOKUPMODE := TRUE;
      IF NOT (PAGE.RUNMODAL(PAGE::"Posted Project Hours List",TempHourAccLineRec) = ACTION::LookupOK) THEN
        EXIT;

      //copy hours from selected week
      PostedHourLineRec.SETRANGE(Year,TempHourAccLineRec.Year);
      PostedHourLineRec.SETRANGE(Week,TempHourAccLineRec.Week);
      PostedHourLineRec.SETRANGE("Project No.",TempHourAccLineRec."Project No.");
      PostedHourLineRec.SETFILTER("Component Type", '<>%1', PostedHourLineRec."Component Type"::Days);
      IF PostedHourLineRec.FINDSET THEN BEGIN
        HourAccountingProjLineRec.SETCURRENTKEY(Year, Week, "Header Project No.");
        HourAccountingProjLineRec.SETRANGE(Year, iHourAccProjRec.Year);
        HourAccountingProjLineRec.SETRANGE(Week, iHourAccProjRec.Week);
        HourAccountingProjLineRec.SETRANGE("Header Project No.", iHourAccProjRec."Project No.");
        IF HourAccountingProjLineRec.FINDLAST THEN
          NextLineNo := HourAccountingProjLineRec."Line No."
        ELSE
          NextLineNo := 0;
        REPEAT
          HourAccountingProjLineRec.INIT;
          HourAccountingProjLineRec.TRANSFERFIELDS(PostedHourLineRec);
          HourAccountingProjLineRec.Year := iHourAccProjRec.Year;
          HourAccountingProjLineRec.Week := iHourAccProjRec.Week;
          HourAccountingProjLineRec."Header Project No." := iHourAccProjRec."Project No.";
          NextLineNo += 10000;
          //don't understand next two lines, copied from "Hour Accounting Line".GetHoursFromPosterHours
          IF HourAccountingProjLineRec.Type = 3 THEN
            HourAccountingProjLineRec.Type := HourAccountingProjLineRec.Type::Indirect;
          HourAccountingProjLineRec."Line No." := NextLineNo;
          HourAccountingProjLineRec.INSERT(TRUE);
        UNTIL PostedHourLineRec.NEXT = 0;
      END;
      //**4PS01.en
    END;

    PROCEDURE HourAccountingProjLineExist@1100485002(VAR vHourAccountingProjLineRec@1100485000 : Record 11020225) : Boolean;
    VAR
      iHourAccountingProjLineRec@1100485001 : Record 11020225;
    BEGIN
      WITH iHourAccountingProjLineRec DO BEGIN
        RESET;
        SETRANGE(Year,vHourAccountingProjLineRec.Year);
        SETRANGE(Week,vHourAccountingProjLineRec.Week);
        SETRANGE("Employee No.",vHourAccountingProjLineRec."Employee No.");
        SETRANGE("Project No.",vHourAccountingProjLineRec."Project No.");
        SETRANGE(Element,vHourAccountingProjLineRec.Element);
        SETRANGE("Cost Object",vHourAccountingProjLineRec."Cost Object");
        SETRANGE("Wage Component",vHourAccountingProjLineRec."Wage Component");
        SETRANGE("Cost Code",vHourAccountingProjLineRec."Cost Code");
        SETRANGE("Cost Component",vHourAccountingProjLineRec."Cost Component");
        SETRANGE(Type,vHourAccountingProjLineRec.Type);
        IF FINDFIRST THEN BEGIN
          vHourAccountingProjLineRec := iHourAccountingProjLineRec;
          EXIT(TRUE);
        END;
      END;
      EXIT(FALSE);
    END;

    PROCEDURE CompTypeEditable@1100485007() : Boolean;
    BEGIN
      CALCFIELDS("Component Type");
      IF "Component Type" = "Component Type"::Expenses THEN
        EXIT(NOT ( (PostingDateRec.GET(Year, Week)) AND (PostingDateRec."Posting Date" <> 0D)))
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE CostObjDescr@1100485000();
    BEGIN
      "Cost Object Description" := '';
      IF "Cost Object" = '' THEN
        EXIT;

      DimValRec.CHANGECOMPANY("Receiving Company");
      DimMgt.GetDimValueRec(2, "Cost Object", DimValRec, FALSE, "Project No.");
      "Cost Object Description" := DimValRec.Name;
    END;

    PROCEDURE ElementDescription@1100525000();
    BEGIN
      IF "Receiving Company" = '' THEN
        EXIT;

      "Element Description" := '';

      IF Element = '' THEN
        EXIT;

      ProjElemRec.CHANGECOMPANY("Receiving Company");
      IF ProjElemRec.GET("Project No.",Element) THEN
        "Element Description" := ProjElemRec.Description;
    END;

    PROCEDURE LookupEmployee@1100528404(AllowMultiCopy@1100528403 : Boolean;VAR MultipleEmployeesCopied@1100528402 : Boolean);
    VAR
      EmployeeList@1100528401 : Page 5201;
      Employee@1100528400 : Record 5200;
    BEGIN
      Employee.CHANGECOMPANY("Supplying Company");
      Employee."No." := "Employee No.";
      EmployeeList.LOOKUPMODE(TRUE);
      IF AllowMultiCopy THEN
        EmployeeList.InitSelectionCopyHourAccountingProject(Rec);
      EmployeeList.SETRECORD(Employee);
      IF EmployeeList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        EmployeeList.GETRECORD(Employee);
        VALIDATE("Employee No.", Employee."No.");
      END ELSE
        MultipleEmployeesCopied := EmployeeList.GetMultipleEmployeesCopied;
    END;

    BEGIN
    {
      db, 17-01-03: receiving company not anymore for Kropman; only for real IC-postings.
      4PS01, JD 22-11-2006, Call C-007214, It must be possible to copy Project hours from posted project hours

      SESB.I037 Enter LAG Number
         ASH 04.07.2013 Field 11128230 "Team Code" added

      SESB.I038 New Wage Component type
         ASH 04.07.2013 Field 360 "Component Type" changed - option "Expense hours" added
         ASH 04.07.2013 Field 11128231 "Excl. from Normal&Extra Hours" added
         ASH 04.07.2013 Key "Year,Week,Header Project No.,Overtime,Cost Type,NonCalculate" added
         ASH 04.07.2013 CalcFormula changed for Normal and Overtime hours sum fields
    }
    END.
  }
}

