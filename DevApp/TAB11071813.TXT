OBJECT Table 11071813 Serv. Surv. Location Object
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS9.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF "Seq. No." = 0 THEN
                 "Seq. No." := GetNextSeqNo();
               IF Quantity = 0 THEN
                 Quantity := 1;
               IF "Correction Factor" = 0 THEN
                 "Correction Factor" := 1;
               TESTFIELD("Location Code");
             END;

    OnModify=BEGIN
               TestObjectsNotCreated;
               UpdateTotals;
             END;

    OnDelete=BEGIN
               DeleteDetailLines;
               IF NOT RemovedFromStructureLine THEN
                 DeleteStructureLines;
             END;

    CaptionML=ENU=Service Site Survey Location Object;
    LookupPageID=Page11126130;
    DrillDownPageID=Page11126130;
  }
  FIELDS
  {
    { 10  ;   ;Survey No.          ;Code20        ;TableRelation="Service Survey";
                                                   CaptionML=ENU=Survey No.;
                                                   NotBlank=Yes }
    { 20  ;   ;Location Code       ;Code10        ;TableRelation="Service Survey Location"."Location Code" WHERE (Survey No.=FIELD(Survey No.));
                                                   CaptionML=ENU=Location Code }
    { 30  ;   ;Seq. No.            ;Integer       ;CaptionML=ENU=Seq. No. }
    { 40  ;   ;Description         ;Text50        ;CaptionML=ENU=Description }
    { 45  ;   ;Description 2       ;Text50        ;CaptionML=ENU=Description 2 }
    { 50  ;   ;Standard Object No. ;Code20        ;TableRelation="Standard Object";
                                                   OnValidate=VAR
                                                                StandardObject@1100528600 : Record 11020334;
                                                                ServiceSurvey@1100409000 : Record 11071803;
                                                              BEGIN
                                                                IF "Standard Object No." <> '' THEN BEGIN
                                                                  TESTFIELD("Location Code");
                                                                  CALCFIELDS("Standard Object Description", "Standard Object Description 2");
                                                                  Description := "Standard Object Description";
                                                                  "Description 2" := "Standard Object Description 2";

                                                                  StandardObject.GET("Standard Object No.");
                                                                  "Tender Code System 1" := StandardObject."Tender Code System 1";
                                                                  "Tender Code 1" := StandardObject."Tender Code 1";
                                                                  "Tender Code System 2" := StandardObject."Tender Code System 2";
                                                                  "Tender Code 2" := StandardObject."Tender Code 2";
                                                                  Subcontracting := StandardObject.Subcontracting;

                                                                  IF ServiceSurvey.GET("Survey No.") THEN
                                                                    IF ServiceSurvey."Service Package" <> '' THEN
                                                                      VALIDATE("Service Package", ServiceSurvey."Service Package");
                                                                  UpdateTotals;

                                                                  CopyObjectLevelSpecs;
                                                                END;
                                                              END;

                                                   OnLookup=VAR
                                                              ServiceObjectManagement@1100528600 : Codeunit 11012808;
                                                            BEGIN
                                                              ServiceObjectManagement.HandleLookupStandardObject('', TRUE, "Standard Object No.");
                                                            END;

                                                   CaptionML=ENU=Standard Object No. }
    { 60  ;   ;Standard Object Description;Text50 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object".Description WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=ENU=Standard Object Description;
                                                   Editable=No }
    { 65  ;   ;Standard Object Description 2;Text50;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Description 2" WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=ENU=Standard Object Description 2;
                                                   Editable=No }
    { 70  ;   ;Quantity            ;Integer       ;CaptionML=ENU=Quantity;
                                                   BlankZero=Yes }
    { 80  ;   ;Quantity per Object ;Integer       ;InitValue=1;
                                                   CaptionML=ENU=Quantity per Object;
                                                   MinValue=1;
                                                   BlankZero=Yes }
    { 90  ;   ;Service Package     ;Code10        ;TableRelation="Service Package" WHERE (Select for Maint. Sales Rate=CONST(Yes));
                                                   OnValidate=VAR
                                                                ServiceObjectManagement@1100528600 : Codeunit 11012808;
                                                              BEGIN
                                                                IF "Service Package" <> '' THEN
                                                                  ServiceObjectManagement.TestServicePackageOfStdObj("Standard Object No.", "Service Package");
                                                                IF xRec."Service Package" <> '' THEN
                                                                  DeleteDetailLines();
                                                                IF "Service Package" <> '' THEN
                                                                  AddDetailLines();
                                                              END;

                                                   OnLookup=VAR
                                                              ServiceObjectManagementCU@1100528601 : Codeunit 11012808;
                                                              ServicePackage@1100528600 : Code[20];
                                                            BEGIN
                                                              ServicePackage := "Service Package";
                                                              IF ServiceObjectManagementCU.LookupServicePackageStdObj("Standard Object No.", ServicePackage) THEN
                                                                VALIDATE("Service Package", ServicePackage);
                                                            END;

                                                   CaptionML=ENU=Service Package }
    { 100 ;   ;Object Customer     ;Code20        ;CaptionML=ENU=Object Customer }
    { 110 ;   ;In use since        ;Date          ;CaptionML=ENU=In use since }
    { 120 ;   ;Warranty Starting Date;Date        ;CaptionML=ENU=Warranty Starting Date }
    { 130 ;   ;Warranty Code       ;Code10        ;TableRelation="Service Warranty";
                                                   CaptionML=ENU=Warranty Code }
    { 140 ;   ;Building            ;Text30        ;CaptionML=ENU=Building }
    { 150 ;   ;Floor               ;Text30        ;CaptionML=ENU=Floor }
    { 160 ;   ;Room                ;Text30        ;CaptionML=ENU=Room }
    { 170 ;   ;Customer Feature    ;Text30        ;CaptionML=ENU=Customer Feature }
    { 175 ;   ;Serial No.          ;Text30        ;CaptionML=ENU=Serial No. }
    { 180 ;   ;Year of Manufacture ;Integer       ;CaptionML=ENU=Year of Manufacture;
                                                   BlankZero=Yes }
    { 190 ;   ;Object Group        ;Code10        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Standard Object"."Object Group" WHERE (No.=FIELD(Standard Object No.)));
                                                   CaptionML=ENU=Object Group;
                                                   Editable=No }
    { 200 ;   ;Nett Cost Price     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Cost" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                      Location Code=FIELD(Location Code),
                                                                                                                      Seq. No.=FIELD(Seq. No.),
                                                                                                                      Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Cost Price;
                                                   Editable=No }
    { 210 ;   ;Surcharge Amount    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Surcharge" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                           Location Code=FIELD(Location Code),
                                                                                                                           Seq. No.=FIELD(Seq. No.),
                                                                                                                           Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Surcharge Amount;
                                                   Editable=No }
    { 215 ;   ;Cost Price          ;Decimal       ;CaptionML=ENU=Cost Price;
                                                   Editable=No }
    { 217 ;   ;Sales Surcharge Amount;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Sales Surcharge" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                 Location Code=FIELD(Location Code),
                                                                                                                                 Seq. No.=FIELD(Seq. No.),
                                                                                                                                 Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Sales Surcharge Amount;
                                                   Editable=No }
    { 220 ;   ;Base Sales Price    ;Decimal       ;CaptionML=ENU=Base Sales Price;
                                                   Editable=No }
    { 225 ;   ;Correction Factor   ;Decimal       ;OnValidate=BEGIN
                                                                UpdateTotals;
                                                              END;

                                                   CaptionML=ENU=Correction Factor }
    { 230 ;   ;Sales Price         ;Decimal       ;OnValidate=BEGIN
                                                                UpdateTotals;
                                                              END;

                                                   CaptionML=ENU=Sales Price }
    { 240 ;   ;Cost Amount         ;Decimal       ;CaptionML=ENU=Cost Amount;
                                                   Editable=No }
    { 250 ;   ;Sales Amount        ;Decimal       ;CaptionML=ENU=Sales Amount;
                                                   Editable=No }
    { 260 ;   ;Customer Object Group;Code10       ;TableRelation="Service Group".No.;
                                                   OnValidate=BEGIN
                                                                UpdateTotals;
                                                              END;

                                                   OnLookup=VAR
                                                              ServiceSurvey@1100528601 : Record 11071803;
                                                              ServiceGroup@1100528600 : Record 11012830;
                                                            BEGIN
                                                              IF NOT ServiceSurvey.GET("Survey No.") THEN
                                                                ServiceSurvey.INIT;
                                                              ServiceSurvey.TESTFIELD("Customer No.");
                                                              ServiceGroup.SETCURRENTKEY("Customer No.");
                                                              ServiceGroup.SETRANGE("Customer No.", ServiceSurvey."Customer No.");
                                                              IF PAGE.RUNMODAL(PAGE::"Service Groups", ServiceGroup) = ACTION::LookupOK THEN BEGIN
                                                                ServiceGroup.TESTFIELD("Customer No.", ServiceSurvey."Customer No.");
                                                                VALIDATE("Customer Object Group", ServiceGroup."No.");
                                                              END;
                                                            END;

                                                   CaptionML=ENU=Customer Object Group }
    { 270 ;   ;Service Rate        ;Decimal       ;CaptionML=ENU=Service Rate;
                                                   Editable=No }
    { 280 ;   ;Service Amount      ;Decimal       ;CaptionML=ENU=Service Amount;
                                                   Editable=No }
    { 290 ;   ;Include in Contract ;Boolean       ;InitValue=Yes;
                                                   OnValidate=VAR
                                                                ServiceSurveyLocation@1100528600 : Record 11071804;
                                                                SurveyLocationObjectDetail@1100525000 : Record 11071807;
                                                              BEGIN
                                                                UpdateTotals;

                                                                IF "Include in Contract" THEN
                                                                  IF ServiceSurveyLocation.GET("Survey No.", "Location Code") THEN
                                                                    IF NOT ServiceSurveyLocation."Include in Contract" THEN BEGIN
                                                                      ServiceSurveyLocation."Include in Contract" := TRUE;
                                                                      ServiceSurveyLocation.MODIFY(TRUE);
                                                                    END;

                                                                //DP00978.sn
                                                                //SurveyLocationObjectDetail.SETRANGE("Survey No.", "Survey No.");
                                                                //SurveyLocationObjectDetail.SETRANGE("Location Code", "Location Code");
                                                                //SurveyLocationObjectDetail.SETRANGE("Seq. No.", "Seq. No.");
                                                                //SurveyLocationObjectDetail.MODIFYALL("Include in Contract", "Include in Contract");  //C029294: skip update same field on detail line
                                                                //DP00978.en
                                                              END;

                                                   CaptionML=ENU=Include in Contract }
    { 300 ;   ;Objects Created     ;Boolean       ;CaptionML=ENU=Objects Created;
                                                   Editable=No }
    { 310 ;   ;Service Contract No.;Code20        ;TableRelation=Service-Contract;
                                                   OnLookup=VAR
                                                              ServiceContract@1100528600 : Record 11012812;
                                                            BEGIN
                                                              IF "Service Contract No." <> '' THEN
                                                                ServiceContract.GET("Service Contract No.");
                                                              PAGE.RUN(0, ServiceContract);
                                                            END;

                                                   CaptionML=ENU=Service Contract No.;
                                                   Editable=No }
    { 320 ;   ;Tender Code System 1;Code10        ;TableRelation="Coding System"."Coding System";
                                                   CaptionML=ENU=Tender Code System 1 }
    { 330 ;   ;Tender Code 1       ;Code20        ;TableRelation="Code per Coding System".Code WHERE (Coding System=FIELD(Tender Code System 1));
                                                   CaptionML=ENU=Tender Code 1 }
    { 340 ;   ;Tender Code System 2;Code10        ;TableRelation="Coding System"."Coding System";
                                                   CaptionML=ENU=Tender Code System 2 }
    { 350 ;   ;Tender Code 2       ;Code20        ;TableRelation="Code per Coding System".Code WHERE (Coding System=FIELD(Tender Code System 2));
                                                   CaptionML=ENU=Tender Code 2 }
    { 360 ;   ;Additional Activities;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Serv. Surv. Object Add. Act." WHERE (Survey No.=FIELD(Survey No.),
                                                                                                           Location Code=FIELD(Location Code),
                                                                                                           Seq. No.=FIELD(Seq. No.)));
                                                   CaptionML=ENU=Additional Activities;
                                                   Editable=No }
    { 370 ;   ;Subcontracting      ;Boolean       ;OnValidate=BEGIN
                                                                VALIDATE("Service Package");
                                                              END;

                                                   CaptionML=ENU=Subcontracting }
    { 380 ;   ;Hours               ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Hours" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                       Location Code=FIELD(Location Code),
                                                                                                                       Seq. No.=FIELD(Seq. No.),
                                                                                                                       Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Hours;
                                                   Editable=No }
    { 390 ;   ;Total Hours         ;Decimal       ;CaptionML=ENU=Total Hours;
                                                   Editable=No }
    { 400 ;   ;Nett Cost Price (Material);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Material" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                          Location Code=FIELD(Location Code),
                                                                                                                          Seq. No.=FIELD(Seq. No.),
                                                                                                                          Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Cost Price (Material);
                                                   Editable=No }
    { 410 ;   ;Nett Cost Price (Labor);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Labor" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                       Location Code=FIELD(Location Code),
                                                                                                                       Seq. No.=FIELD(Seq. No.),
                                                                                                                       Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Cost Price (Labor);
                                                   Editable=No }
    { 420 ;   ;Nett Cost Price (Subcontr.);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Subcontracting" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                Location Code=FIELD(Location Code),
                                                                                                                                Seq. No.=FIELD(Seq. No.),
                                                                                                                                Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Cost Price (Subcontracting);
                                                   Editable=No }
    { 430 ;   ;Nett Cost Price (Plant);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Plant" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                       Location Code=FIELD(Location Code),
                                                                                                                       Seq. No.=FIELD(Seq. No.),
                                                                                                                       Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Cost Price (Plant);
                                                   Editable=No }
    { 440 ;   ;Nett Cost Price (Sundry);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Sundry" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                        Location Code=FIELD(Location Code),
                                                                                                                        Seq. No.=FIELD(Seq. No.),
                                                                                                                        Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Cost Price (Sundry);
                                                   Editable=No }
    { 450 ;   ;Total Cost (Material);Decimal      ;CaptionML=ENU=Total Cost (Material) }
    { 460 ;   ;Total Cost (Labor)  ;Decimal       ;CaptionML=ENU=Total Cost (Labor) }
    { 470 ;   ;Total Cost (Subcontr.);Decimal     ;CaptionML=ENU=Total Cost (Subcontracting) }
    { 480 ;   ;Total Cost (Plant)  ;Decimal       ;CaptionML=ENU=Total Cost (Plant) }
    { 490 ;   ;Total Cost (Sundry) ;Decimal       ;CaptionML=ENU=Total Cost (Sundry) }
    { 500 ;   ;Total Cost          ;Decimal       ;CaptionML=ENU=Total Cost;
                                                   Editable=No }
    { 520 ;   ;Surcharge Amount (Material);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Surcharge (Material)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                      Location Code=FIELD(Location Code),
                                                                                                                                      Seq. No.=FIELD(Seq. No.),
                                                                                                                                      Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Surcharge Amount (Material);
                                                   Editable=No }
    { 530 ;   ;Surcharge Amount (Labor);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Surcharge (Labor)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                   Location Code=FIELD(Location Code),
                                                                                                                                   Seq. No.=FIELD(Seq. No.),
                                                                                                                                   Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Surcharge Amount (Labor);
                                                   Editable=No }
    { 540 ;   ;Surcharge Amount (Subcontr.);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Surcharge (Subcontr.)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                       Location Code=FIELD(Location Code),
                                                                                                                                       Seq. No.=FIELD(Seq. No.),
                                                                                                                                       Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Surcharge Amount (Subcontrating);
                                                   Editable=No }
    { 550 ;   ;Surcharge Amount (Plant);Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Surcharge (Plant)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                   Location Code=FIELD(Location Code),
                                                                                                                                   Seq. No.=FIELD(Seq. No.),
                                                                                                                                   Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Surcharge Amount (Plant);
                                                   Editable=No }
    { 560 ;   ;Surcharge Amount (Sundry);Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Surcharge (Sundry)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                    Location Code=FIELD(Location Code),
                                                                                                                                    Seq. No.=FIELD(Seq. No.),
                                                                                                                                    Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Surcharge Amount (Sundry);
                                                   Editable=No }
    { 570 ;   ;Sales Surch. Amount (Material);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Sales Surch. (Material)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                         Location Code=FIELD(Location Code),
                                                                                                                                         Seq. No.=FIELD(Seq. No.),
                                                                                                                                         Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Sales Surcharge Amount (Material);
                                                   Editable=No }
    { 580 ;   ;Sales Surch. Amount (Labor);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Sales Surch. (Labor)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                      Location Code=FIELD(Location Code),
                                                                                                                                      Seq. No.=FIELD(Seq. No.),
                                                                                                                                      Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Sales Surcharge Amount (Labor);
                                                   Editable=No }
    { 590 ;   ;Sales Surch. Amount (Subc.);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Sales Surch. (Subcontr.)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                          Location Code=FIELD(Location Code),
                                                                                                                                          Seq. No.=FIELD(Seq. No.),
                                                                                                                                          Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Sales Surcharge Amount (Subcontrating);
                                                   Editable=No }
    { 600 ;   ;Sales Surch. Amount (Plant);Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Sales Surch. (Plant)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                      Location Code=FIELD(Location Code),
                                                                                                                                      Seq. No.=FIELD(Seq. No.),
                                                                                                                                      Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Sales Surcharge Amount (Plant);
                                                   Editable=No }
    { 610 ;   ;Sales Surch. Amount (Sundry);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Serv. Surv. Loc. Obj. Detail"."Total Sales Surch. (Sundry)" WHERE (Survey No.=FIELD(Survey No.),
                                                                                                                                       Location Code=FIELD(Location Code),
                                                                                                                                       Seq. No.=FIELD(Seq. No.),
                                                                                                                                       Include in Contract=CONST(Yes)));
                                                   CaptionML=ENU=Sales Surcharge Amount (Sundry);
                                                   Editable=No }
    { 620 ;   ;Total Surcharge Amount;Decimal     ;CaptionML=ENU=Surcharge Amount;
                                                   Editable=No }
    { 630 ;   ;Total Surch. Amount (Material);Decimal;
                                                   CaptionML=ENU=Surcharge Amount (Material);
                                                   Editable=No }
    { 640 ;   ;Total Surch. Amount (Labor);Decimal;CaptionML=ENU=Surcharge Amount (Labor);
                                                   Editable=No }
    { 650 ;   ;Total Surch. Amount (Subc.);Decimal;CaptionML=ENU=Surcharge Amount (Subcontrating);
                                                   Editable=No }
    { 660 ;   ;Total Surch. Amount (Plant);Decimal;CaptionML=ENU=Surcharge Amount (Plant);
                                                   Editable=No }
    { 670 ;   ;Total Surch. Amount (Sundry);Decimal;
                                                   CaptionML=ENU=Surcharge Amount (Sundry);
                                                   Editable=No }
    { 680 ;   ;Total Sales Surch. Amount;Decimal  ;CaptionML=ENU=Total Sales Surcharge Amount }
    { 700 ;   ;Total Sales Surch. Amt. (Mat.);Decimal;
                                                   CaptionML=ENU=Sales Surcharge Amount (Material);
                                                   Editable=No }
    { 710 ;   ;Total Sales Surch. Amt. (Lab.);Decimal;
                                                   CaptionML=ENU=Sales Surcharge Amount (Labor);
                                                   Editable=No }
    { 720 ;   ;Total Sales Surch. Amt. (Sub.);Decimal;
                                                   CaptionML=ENU=Sales Surcharge Amount (Subcontrating);
                                                   Editable=No }
    { 730 ;   ;Total Sales Surch. Amt. (Plt.);Decimal;
                                                   CaptionML=ENU=Sales Surcharge Amount (Plant);
                                                   Editable=No }
    { 740 ;   ;Total Sales Surch. Amt. (Sun.);Decimal;
                                                   CaptionML=ENU=Sales Surcharge Amount (Sundry);
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Survey No.,Location Code,Seq. No.       ;SumIndexFields=Cost Amount,Sales Amount,Service Amount,Total Hours;
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      RemovedFromStructureLine@1100528600 : Boolean;
      Text000@1100528601 : TextConst 'ENU=First select line(s).';
      Text002@1100525000 : TextConst 'ENU=First select records';
      Text003@1210190000 : TextConst 'ENU=Selected Objects already created';

    PROCEDURE GetNextSeqNo@1100528600() : Decimal;
    VAR
      ServSurvLocationObject@1100528600 : Record 11071813;
    BEGIN
      ServSurvLocationObject.SETRANGE("Survey No.", "Survey No.");
      ServSurvLocationObject.SETRANGE("Location Code", "Location Code");
      IF ServSurvLocationObject.FINDLAST THEN
        EXIT(ServSurvLocationObject."Seq. No." +1)
      ELSE
        EXIT(1);
    END;

    PROCEDURE DeleteDetailLines@1100528603();
    VAR
      ServSurvLocObjDetail@1100528600 : Record 11071807;
    BEGIN
      ServSurvLocObjDetail.SETRANGE("Survey No.", "Survey No.");
      ServSurvLocObjDetail.SETRANGE("Location Code", "Location Code");
      ServSurvLocObjDetail.SETRANGE("Seq. No.", "Seq. No.");
      ServSurvLocObjDetail.DELETEALL(TRUE);
    END;

    PROCEDURE AddDetailLines@1100528602();
    VAR
      ServSurvLocObjDetail@1100528600 : Record 11071807;
      StdObjectMaintenanceScheme@1100528601 : Record 11071703;
    BEGIN
      IF "Standard Object No." = '' THEN
        EXIT;
      IF "Seq. No." = 0 THEN
        "Seq. No." := GetNextSeqNo();
      StdObjectMaintenanceScheme.SETRANGE("Object No.", "Standard Object No.");
      StdObjectMaintenanceScheme.SETRANGE("Service Package", "Service Package");
      StdObjectMaintenanceScheme.SETRANGE(Subcontracting, Subcontracting);
      IF StdObjectMaintenanceScheme.FINDSET THEN
        REPEAT
          ServSurvLocObjDetail.INIT;
          ServSurvLocObjDetail."Survey No." := "Survey No.";
          ServSurvLocObjDetail."Location Code" := "Location Code";
          ServSurvLocObjDetail."Seq. No." := "Seq. No.";
          ServSurvLocObjDetail."Service Package" := StdObjectMaintenanceScheme."Service Package";
          ServSurvLocObjDetail."Maintenance Scheme Code" := StdObjectMaintenanceScheme."Maintenance Scheme";
          ServSurvLocObjDetail.Subcontracting := Subcontracting;
          ServSurvLocObjDetail.INSERT(TRUE);
          ServSurvLocObjDetail.VALIDATE("Service Package");
          ServSurvLocObjDetail.VALIDATE("Maintenance Scheme Code");
          ServSurvLocObjDetail.MODIFY(TRUE);
        UNTIL StdObjectMaintenanceScheme.NEXT = 0;
    END;

    PROCEDURE DeleteStructureLines@1100528601();
    VAR
      ServiceSurveyStructureLine@1100528600 : Record 11071806;
    BEGIN
      ServiceSurveyStructureLine.SETRANGE("Survey No.", "Survey No.");
      ServiceSurveyStructureLine.SETRANGE("Location Code", "Location Code");
      ServiceSurveyStructureLine.SETRANGE("Seq. No.", "Seq. No.");
      ServiceSurveyStructureLine.DELETEALL;
    END;

    PROCEDURE UpdateTotals@1100528604();
    VAR
      ServiceSurvey@1100528601 : Record 11071803;
      ServiceSurveyManagement@1100528600 : Codeunit 11012852;
    BEGIN
      ServiceSurvey.GET("Survey No.");

      CALCFIELDS("Nett Cost Price", "Surcharge Amount", "Sales Surcharge Amount", Hours);
      CALCFIELDS("Nett Cost Price (Material)", "Nett Cost Price (Labor)", "Nett Cost Price (Subcontr.)", "Nett Cost Price (Plant)",
        "Nett Cost Price (Sundry)");
      CALCFIELDS("Surcharge Amount (Material)", "Surcharge Amount (Labor)", "Surcharge Amount (Subcontr.)", "Surcharge Amount (Plant)",
        "Surcharge Amount (Sundry)");
      CALCFIELDS("Sales Surch. Amount (Material)", "Sales Surch. Amount (Labor)", "Sales Surch. Amount (Subc.)",
        "Sales Surch. Amount (Plant)", "Sales Surch. Amount (Sundry)");

      "Service Rate" := ServiceSurveyManagement.GetServiceRate(Rec);
      "Cost Price" := "Nett Cost Price" + "Surcharge Amount";
      IF ServiceSurvey."Sales Price Based On" = ServiceSurvey."Sales Price Based On"::"Service Rate" THEN
        "Base Sales Price" := "Service Rate"
      ELSE
        "Base Sales Price" := "Cost Price" + "Sales Surcharge Amount";
      IF CurrFieldNo = FIELDNO("Sales Price") THEN BEGIN
        IF "Base Sales Price" <> 0 THEN
          "Correction Factor" := "Sales Price" / "Base Sales Price"
        ELSE
          "Correction Factor" := 1;
      END;
      "Sales Price" := ROUND("Base Sales Price" * "Correction Factor");
      IF "Include in Contract" THEN BEGIN
        "Cost Amount" := ROUND("Cost Price" * Quantity * "Quantity per Object");
        "Sales Amount" := ROUND("Sales Price" * Quantity * "Quantity per Object");
        "Service Amount" := ROUND("Service Rate" * Quantity * "Quantity per Object");
        "Total Hours" := ROUND(Hours * Quantity * "Quantity per Object");

        "Total Cost" := ROUND("Nett Cost Price" * Quantity * "Quantity per Object");
        "Total Cost (Material)" := ROUND("Nett Cost Price (Material)" * Quantity * "Quantity per Object");
        "Total Cost (Labor)" := ROUND("Nett Cost Price (Labor)" * Quantity * "Quantity per Object");
        "Total Cost (Subcontr.)" := ROUND("Nett Cost Price (Subcontr.)" * Quantity * "Quantity per Object");
        "Total Cost (Plant)" := ROUND("Nett Cost Price (Plant)" * Quantity * "Quantity per Object");
        "Total Cost (Sundry)" := ROUND("Nett Cost Price (Sundry)" * Quantity * "Quantity per Object");

        "Total Surcharge Amount" := ROUND("Surcharge Amount" * Quantity * "Quantity per Object");
        "Total Surch. Amount (Material)" := ROUND("Surcharge Amount (Material)" * Quantity * "Quantity per Object");
        "Total Surch. Amount (Labor)" := ROUND("Surcharge Amount (Labor)" * Quantity * "Quantity per Object");
        "Total Surch. Amount (Subc.)" := ROUND("Surcharge Amount (Subcontr.)" * Quantity * "Quantity per Object");
        "Total Surch. Amount (Plant)" := ROUND("Surcharge Amount (Plant)" * Quantity * "Quantity per Object");
        "Total Surch. Amount (Sundry)" := ROUND("Surcharge Amount (Sundry)" * Quantity * "Quantity per Object");

        "Total Sales Surch. Amount" := ROUND("Sales Surcharge Amount" * Quantity * "Quantity per Object");
        "Total Sales Surch. Amt. (Mat.)" := ROUND("Sales Surch. Amount (Material)" * Quantity * "Quantity per Object");
        "Total Sales Surch. Amt. (Lab.)" := ROUND("Sales Surch. Amount (Labor)" * Quantity * "Quantity per Object");
        "Total Sales Surch. Amt. (Sub.)" := ROUND("Sales Surch. Amount (Subc.)" * Quantity * "Quantity per Object");
        "Total Sales Surch. Amt. (Plt.)" := ROUND("Sales Surch. Amount (Plant)" * Quantity * "Quantity per Object");
        "Total Sales Surch. Amt. (Sun.)" := ROUND("Sales Surch. Amount (Sundry)" * Quantity * "Quantity per Object");
      END ELSE BEGIN
        "Cost Amount" := 0;
        "Sales Amount" := 0;
        "Service Amount" := 0;
        "Total Hours" := 0;

        "Total Cost" := 0;
        "Total Cost (Material)" := 0;
        "Total Cost (Labor)" := 0;
        "Total Cost (Subcontr.)" := 0;
        "Total Cost (Plant)" := 0;
        "Total Cost (Sundry)" := 0;

        "Total Surcharge Amount" := 0;
        "Total Surch. Amount (Material)" := 0;
        "Total Surch. Amount (Labor)" := 0;
        "Total Surch. Amount (Subc.)" := 0;
        "Total Surch. Amount (Plant)" := 0;
        "Total Surch. Amount (Sundry)" := 0;

        "Total Sales Surch. Amount" := 0;
        "Total Sales Surch. Amt. (Mat.)" := 0;
        "Total Sales Surch. Amt. (Lab.)" := 0;
        "Total Sales Surch. Amt. (Sub.)" := 0;
        "Total Sales Surch. Amt. (Plt.)" := 0;
        "Total Sales Surch. Amt. (Sun.)" := 0;
      END;
    END;

    PROCEDURE SetRemovedFromStructureLine@1100528605(IRemovedFromStructureLine@1100528600 : Boolean);
    BEGIN
      RemovedFromStructureLine := IRemovedFromStructureLine;
    END;

    PROCEDURE UpdateTransferToContract@1100528606(VAR IServSurvLocationObject@1100528600 : Record 11071813;ITransferToContract@1100528602 : Boolean);
    VAR
      ServSurvLocationObject@1100528601 : Record 11071813;
    BEGIN
      ServSurvLocationObject.COPY(IServSurvLocationObject);
      ServSurvLocationObject.MARKEDONLY(TRUE);
      IF ServSurvLocationObject.FINDSET(TRUE) THEN BEGIN
        REPEAT
          ServSurvLocationObject.VALIDATE("Include in Contract", ITransferToContract);
          ServSurvLocationObject.MODIFY(TRUE);
        UNTIL ServSurvLocationObject.NEXT = 0;
      END ELSE
        ERROR(Text000);
    END;

    PROCEDURE TestObjectsNotCreated@1100528607();
    BEGIN
      TESTFIELD("Objects Created", FALSE);
    END;

    PROCEDURE AttachSelObjectsToContract@1100528608(VAR IServSurvLocationObject@1100528600 : Record 11071813);
    VAR
      ServSurvLocationObject@1100528601 : Record 11071813;
      ServiceSurvey@1100409000 : Record 11071803;
      ServiceSurveyManagement@1100528602 : Codeunit 11012852;
      AttachToServiceContractFRM@1100528604 : Page 11125306;
      LinkType@1100528609 : 'New Contract,Existing Contract';
      ExistingServiceContractNo@1100528610 : Code[20];
      ServicePackageCode@1100528611 : Code[10];
      ServiceContractTemplate@1210190000 : Code[20];
      ServiceContractStatus@1210190001 : Option;
      ServiceContractStartingDate@1210190002 : Date;
    BEGIN
      ServSurvLocationObject.COPY(IServSurvLocationObject);
      IF NOT ServSurvLocationObject.FINDSET THEN
        ERROR(Text002);

      ServSurvLocationObject.SETFILTER(Quantity, '>%1', 0);
      ServSurvLocationObject.SETRANGE("Include in Contract", TRUE);
      ServSurvLocationObject.SETRANGE("Service Contract No.", '');
      IF NOT ServSurvLocationObject.FINDSET THEN
        ERROR(Text003);

      IF NOT ServiceSurvey.GET(ServSurvLocationObject."Survey No.") THEN
        ServiceSurvey.INIT;

      AttachToServiceContractFRM.LOOKUPMODE(TRUE);
      AttachToServiceContractFRM.PutSettings(
        1, ServiceSurvey."Contract Template Code", 0, ServiceSurvey."Service Package", ServiceSurvey."Starting Date");
      IF AttachToServiceContractFRM.RUNMODAL <> ACTION::LookupOK THEN
        EXIT;
      AttachToServiceContractFRM.GetSettings(
        LinkType, ExistingServiceContractNo, ServiceContractTemplate, ServiceContractStatus, ServicePackageCode,
        ServiceContractStartingDate);

      IF LinkType = LinkType::"New Contract" THEN BEGIN
        ServiceSurveyManagement.CreateContractFromObjects(ServSurvLocationObject, '',
          ServiceContractTemplate, ServiceContractStatus, ServicePackageCode, ServiceContractStartingDate);
      END ELSE
        ServiceSurveyManagement.CreateContractFromObjects(ServSurvLocationObject, ExistingServiceContractNo,
          ServiceContractTemplate, ServiceContractStatus, ServicePackageCode, ServiceContractStartingDate);

      IServSurvLocationObject.CLEARMARKS;
    END;

    PROCEDURE GetMarginPerc@1100528609() MarginPerc : Decimal;
    BEGIN
      IF "Cost Amount" <> 0 THEN
        MarginPerc := ("Sales Amount" - "Cost Amount") / "Cost Amount" * 100
      ELSE
        MarginPerc := 0;
    END;

    PROCEDURE GetSalesAmountOfRecordSet@1100528610(VAR IServSurvLocationObject@1100528600 : Record 11071813) : Decimal;
    VAR
      ServSurvLocationObject@1100528601 : Record 11071813;
      SalesAmount@1100528602 : Decimal;
    BEGIN
      ServSurvLocationObject.COPY(IServSurvLocationObject);
      IF NOT ServSurvLocationObject.FINDSET THEN
        EXIT;
      REPEAT
        SalesAmount += ServSurvLocationObject."Sales Amount";
      UNTIL ServSurvLocationObject.NEXT = 0;
      EXIT(SalesAmount);
    END;

    PROCEDURE ShowDetails@1100528616();
    VAR
      ServSurvLocObjDetail@1100528600 : Record 11071807;
    BEGIN
      ServSurvLocObjDetail.SETRANGE("Survey No.", "Survey No.");
      ServSurvLocObjDetail.SETRANGE("Location Code", "Location Code");
      ServSurvLocObjDetail.SETRANGE("Seq. No.", "Seq. No.");
      PAGE.RUNMODAL(PAGE::"Service Survey Line Details", ServSurvLocObjDetail);
    END;

    PROCEDURE SelectStdObjects@1100528615() lvRefresh : Boolean;
    VAR
      ServiceSurvey@1100528601 : Record 11071803;
      StandardObject@1100528603 : Record 11020334;
      StandardObjectList@1100528602 : Page 11072547;
      ServiceObjectManagement@1100528604 : Codeunit 11012808;
    BEGIN
      ServiceObjectManagement.ApplyStandardObjectFilter(StandardObject);
      IF "Standard Object No." <> '' THEN
        IF StandardObject.GET("Standard Object No.") THEN;

      StandardObjectList.LOOKUPMODE(TRUE);
      IF NOT ServiceSurvey.GET("Survey No.") THEN
        ServiceSurvey.INIT;
      IF ServiceSurvey."Input Method" = ServiceSurvey."Input Method"::Object THEN
        StandardObjectList.SetSelection(DATABASE::"Serv. Surv. Location Object", "Survey No.", "Location Code", '', 0);
      StandardObjectList.SETTABLEVIEW(StandardObject);
      StandardObjectList.SETRECORD(StandardObject);
      IF StandardObjectList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        ServiceSurvey.TESTFIELD("Input Method", ServiceSurvey."Input Method"::Object);
        StandardObjectList.GETRECORD(StandardObject);
        VALIDATE("Standard Object No.", StandardObject."No.");
      END ELSE BEGIN
        lvRefresh := StandardObjectList.CheckMultiCopy;  //db, 18-12-15
      END;

      EXIT(lvRefresh);
    END;

    PROCEDURE UpdateSurveyLocObjects@1100528614(VAR IServSurvLocationObject@1100525000 : Record 11071813);
    VAR
      ServSurvLocationObject@1100528600 : Record 11071813;
      UpdateSurvLocationObjectsREP@1100528602 : Report 11012738;
    BEGIN
      ServSurvLocationObject.COPY(IServSurvLocationObject);
      IF ServSurvLocationObject.ISEMPTY THEN
        ERROR(Text002);

      UpdateSurvLocationObjectsREP.SETTABLEVIEW(ServSurvLocationObject);
      UpdateSurvLocationObjectsREP.RUNMODAL;

      CLEARMARKS;
    END;

    PROCEDURE RoundSalesAmount@1100528611(VAR IServSurvLocationObject@1100525000 : Record 11071813);
    VAR
      ServSurvLocationObject@1100528601 : Record 11071813;
      SurveyRoundSalesAmountREP@1100528600 : Report 11012739;
    BEGIN
      ServSurvLocationObject.COPY(IServSurvLocationObject);

      IF ServSurvLocationObject.ISEMPTY THEN
        ERROR(Text002);

      ServSurvLocationObject.SETRANGE("Objects Created", FALSE);

      SurveyRoundSalesAmountREP.SetDefaults(ServSurvLocationObject.GetSalesAmountOfRecordSet(ServSurvLocationObject));
      SurveyRoundSalesAmountREP.SETTABLEVIEW(ServSurvLocationObject);
      SurveyRoundSalesAmountREP.RUNMODAL;
    END;

    PROCEDURE AdjustHoursByCostObject@1100528612(VAR IServSurvLocationObject@1100525000 : Record 11071813);
    VAR
      ServSurvLocationObject@1100528600 : Record 11071813;
      AdjSurveyHoursbyCostObj@1100528601 : Report 11012742;
    BEGIN
      ServSurvLocationObject.COPY(IServSurvLocationObject);
      IF ServSurvLocationObject.ISEMPTY THEN
        ERROR(Text002);

      ServSurvLocationObject.SETRANGE("Objects Created", FALSE);

      AdjSurveyHoursbyCostObj.SetDefaults(ServSurvLocationObject);
      AdjSurveyHoursbyCostObj.SETTABLEVIEW(ServSurvLocationObject);
      AdjSurveyHoursbyCostObj.RUNMODAL;
    END;

    PROCEDURE "---"@1100528618();
    BEGIN
    END;

    PROCEDURE CopyObjectLevelSpecs@1100528613();
    VAR
      ObjectSpecificationLine@1100528601 : Record 11071781;
    BEGIN
      IF "Standard Object No." = '' THEN
        EXIT;

      ObjectSpecificationLine.SETRANGE("Specification Type", ObjectSpecificationLine."Specification Type"::"Standard Object");
      ObjectSpecificationLine.SETRANGE(Code, "Standard Object No.");
      ObjectSpecificationLine.SETRANGE("Object Level", TRUE);
      ObjectSpecificationLine.SETRANGE(Type, ObjectSpecificationLine.Type::Line);
      IF ObjectSpecificationLine.FINDSET THEN
        REPEAT
          IF ObjectSpecificationLine.Type = ObjectSpecificationLine.Type::Line THEN BEGIN
            FindOrCreateObjectSpecGroup("Survey No.", "Location Code", "Seq. No.",
              ObjectSpecificationLine.GetObjSpecificationGroupCode);
          END;
          FindOrCreateObjectSpec(
            "Survey No.", "Location Code", "Seq. No.", ObjectSpecificationLine."Specification Code");
        UNTIL ObjectSpecificationLine.NEXT = 0;
    END;

    LOCAL PROCEDURE FindOrCreateObjectSpec@1100528620(ISurveyNo@1100528601 : Code[20];ILocationCode@1100528603 : Code[10];ISeqNo@1100528606 : Integer;IObjectSpecCode@1100528600 : Code[10]) : Boolean;
    VAR
      BaseObjectSpecificationLine@1100528604 : Record 11071779;
      ServiceSurveyObjectSpec@1100528605 : Record 11071972;
      LineNo@1100528602 : Integer;
    BEGIN
      BaseObjectSpecificationLine.SETRANGE(Code, IObjectSpecCode);
      BaseObjectSpecificationLine.SETRANGE(Level, BaseObjectSpecificationLine.Level::Object);
      IF NOT BaseObjectSpecificationLine.FINDFIRST THEN
        EXIT;

      ServiceSurveyObjectSpec.SETRANGE("Survey No.", ISurveyNo);
      ServiceSurveyObjectSpec.SETRANGE("Location Code", ILocationCode);
      ServiceSurveyObjectSpec.SETRANGE("Seq. No.", ISeqNo);
      IF ServiceSurveyObjectSpec.FINDLAST THEN
        LineNo := ServiceSurveyObjectSpec."Line No.";
      ServiceSurveyObjectSpec.SETRANGE("Specification Code", BaseObjectSpecificationLine.Code);
      IF NOT ServiceSurveyObjectSpec.FINDFIRST THEN BEGIN
        ServiceSurveyObjectSpec.SETRANGE("Specification Code");
        LineNo += 10000;
        ServiceSurveyObjectSpec.VALIDATE("Survey No.", ISurveyNo);
        ServiceSurveyObjectSpec.VALIDATE("Location Code", ILocationCode);
        ServiceSurveyObjectSpec.VALIDATE("Seq. No.", ISeqNo);
        ServiceSurveyObjectSpec.VALIDATE(Type, ServiceSurveyObjectSpec.Type::Line);
        ServiceSurveyObjectSpec.VALIDATE("Specification Code", BaseObjectSpecificationLine.Code);
        ServiceSurveyObjectSpec."Line No." := LineNo;
        ServiceSurveyObjectSpec.INSERT(TRUE);
      END;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE FindOrCreateObjectSpecGroup@1100528619(IServiceSurveyNo@1100528603 : Code[20];ILocationCode@1100528605 : Code[10];ISeqNo@1100528606 : Integer;IObjectSpecGroupCode@1100528601 : Code[10]);
    VAR
      ObjectSpecificationGroup@1100528604 : Record 11071778;
      ServiceSurveyObjectSpec@1100528600 : Record 11071972;
      LineNo@1100528602 : Integer;
    BEGIN
      IF NOT ObjectSpecificationGroup.GET(IObjectSpecGroupCode) THEN
        EXIT;

      ServiceSurveyObjectSpec.SETRANGE("Survey No.", IServiceSurveyNo);
      ServiceSurveyObjectSpec.SETRANGE("Location Code", ILocationCode);
      ServiceSurveyObjectSpec.SETRANGE("Seq. No.", ISeqNo);
      IF ServiceSurveyObjectSpec.FINDLAST THEN
        LineNo := ServiceSurveyObjectSpec."Line No.";
      ServiceSurveyObjectSpec.SETRANGE(Type, ServiceSurveyObjectSpec.Type::Group);
      ServiceSurveyObjectSpec.SETRANGE("Specification Code", ObjectSpecificationGroup.Code);
      ServiceSurveyObjectSpec.SetDontCheckBORGUser(TRUE);
      IF NOT ServiceSurveyObjectSpec.FINDFIRST THEN BEGIN
        ServiceSurveyObjectSpec.SETRANGE("Specification Code");
        LineNo += 10000;
        ServiceSurveyObjectSpec.VALIDATE("Survey No.", IServiceSurveyNo);
        ServiceSurveyObjectSpec.VALIDATE("Location Code", ILocationCode);
        ServiceSurveyObjectSpec.VALIDATE("Seq. No.", ISeqNo);
        ServiceSurveyObjectSpec.VALIDATE(Type, ServiceSurveyObjectSpec.Type::Group);
        ServiceSurveyObjectSpec.VALIDATE("Specification Code", ObjectSpecificationGroup.Code);
        ServiceSurveyObjectSpec."Line No." := LineNo;
        ServiceSurveyObjectSpec.INSERT(TRUE);
      END;
    END;

    LOCAL PROCEDURE "----"@1100528617();
    BEGIN
    END;

    PROCEDURE GetTotalAmountByCostObject@1100528621(ICostObjectFilter@1100528610 : Code[250];IRateCodeFilter@1100528630 : Code[250];VAR OTotalLabor@1100528611 : Decimal;VAR OTotalHours@1100528612 : Decimal;VAR OTotalMaterial@1100528613 : Decimal;VAR OTotalSubcontracting@1100528614 : Decimal;VAR OTotalPlant@1100528615 : Decimal;VAR OTotalSundry@1100528616 : Decimal;VAR OTotalCost@1100528617 : Decimal;VAR OTotalSurcharge@1100528618 : Decimal);
    VAR
      ServSurvLocObjDetail@1100528601 : Record 11071807;
      ServiceSurveyManagement@1100528600 : Codeunit 11012852;
      LaborPerService@1100528602 : Decimal;
      HoursPerService@1100528603 : Decimal;
      MaterialPerService@1100528604 : Decimal;
      SubcontractingPerService@1100528609 : Decimal;
      PlantPerService@1100528605 : Decimal;
      SundryPerService@1100528606 : Decimal;
      TotalCostPerService@1100528607 : Decimal;
      SurchargePerService@1100528608 : Decimal;
      SurchargePerServiceLabor@1100528619 : Decimal;
      SurchargePerServiceMaterial@1100528620 : Decimal;
      SurchargePerServiceSubcontracting@1100528621 : Decimal;
      SurchargePerServicePlant@1100528622 : Decimal;
      SurchargePerServiceSundry@1100528623 : Decimal;
      SalesSurchargePerService@1100528629 : Decimal;
      SalesSurchargePerServiceLabor@1100528628 : Decimal;
      SalesSurchargePerServiceMaterial@1100528627 : Decimal;
      SalesSurchargePerServiceSubcontracting@1100528626 : Decimal;
      SalesSurchargePerServicePlant@1100528625 : Decimal;
      SalesSurchargePerServiceSundry@1100528624 : Decimal;
    BEGIN
      OTotalLabor := 0;
      OTotalHours := 0;
      OTotalMaterial := 0;
      OTotalSubcontracting := 0;
      OTotalPlant := 0;
      OTotalSundry := 0;
      OTotalCost := 0;
      OTotalSurcharge := 0;

      ServSurvLocObjDetail.SETRANGE("Survey No.", "Survey No.");
      ServSurvLocObjDetail.SETRANGE("Location Code", "Location Code");
      ServSurvLocObjDetail.SETRANGE("Seq. No.", "Seq. No.");
      IF ServSurvLocObjDetail.FINDSET THEN
        REPEAT
          LaborPerService := 0;
          HoursPerService := 0;
          MaterialPerService := 0;
          SubcontractingPerService := 0;
          PlantPerService := 0;
          SundryPerService := 0;
          TotalCostPerService := 0;

          ServiceSurveyManagement.GetCostObjectDetByCostObject(ServSurvLocObjDetail,
            ICostObjectFilter, IRateCodeFilter, TRUE, LaborPerService, HoursPerService, MaterialPerService,
            SubcontractingPerService, PlantPerService, SundryPerService, TotalCostPerService);

          SurchargePerService :=
            ServSurvLocObjDetail.GetSurveySurchargeAmounts(0,
              SurchargePerServiceLabor, SurchargePerServiceMaterial, SurchargePerServiceSubcontracting,
              SurchargePerServicePlant, SurchargePerServiceSundry);

          SalesSurchargePerService :=
            ServSurvLocObjDetail.GetSurveySurchargeAmounts(1,
              SalesSurchargePerServiceLabor, SalesSurchargePerServiceMaterial, SalesSurchargePerServiceSubcontracting,
              SalesSurchargePerServicePlant, SalesSurchargePerServiceSundry);

          OTotalLabor +=
            (LaborPerService + SurchargePerServiceLabor + SalesSurchargePerServiceLabor) *
            ServSurvLocObjDetail."Frequency per Year" * Quantity * "Quantity per Object" * "Correction Factor";
          OTotalHours +=
            HoursPerService * ServSurvLocObjDetail."Frequency per Year" * Quantity * "Quantity per Object" * "Correction Factor";
          OTotalMaterial +=
            (MaterialPerService + SurchargePerServiceMaterial + SalesSurchargePerServiceMaterial) *
            ServSurvLocObjDetail."Frequency per Year" * Quantity * "Quantity per Object" * "Correction Factor";
          OTotalSubcontracting +=
            (SubcontractingPerService + SurchargePerServiceSubcontracting + SalesSurchargePerServiceSubcontracting) *
            ServSurvLocObjDetail."Frequency per Year" * Quantity * "Quantity per Object" * "Correction Factor";
          OTotalPlant +=
            (PlantPerService + SurchargePerServicePlant + SalesSurchargePerServicePlant) *
            ServSurvLocObjDetail."Frequency per Year" * Quantity * "Quantity per Object" * "Correction Factor";
          OTotalSundry +=
            (SundryPerService + SurchargePerServiceSundry + SalesSurchargePerServiceSundry) *
            ServSurvLocObjDetail."Frequency per Year" * Quantity * "Quantity per Object" * "Correction Factor";
          OTotalCost +=
            (TotalCostPerService + SurchargePerService + SalesSurchargePerService) *
            ServSurvLocObjDetail."Frequency per Year" * Quantity * "Quantity per Object" * "Correction Factor";
          OTotalSurcharge +=
            (SurchargePerService + SalesSurchargePerService) *
            ServSurvLocObjDetail."Frequency per Year" * Quantity * "Quantity per Object" * "Correction Factor";
        UNTIL ServSurvLocObjDetail.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

