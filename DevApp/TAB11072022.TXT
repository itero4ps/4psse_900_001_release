OBJECT Table 11072022 Consolidated Try-out Quote
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS9.00;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF Code = '' THEN BEGIN
                 ContMgtSetup.GET;
                 ContMgtSetup.TESTFIELD(ContMgtSetup."Try-out Quote Nos.");
                 NoSeriesMgt.InitSeries(ContMgtSetup."Try-out Quote Nos.",xRec."No. Series",0D,Code,"No. Series");
               END;
               "Creation Date" := TODAY;
               "Inserted By" := USERID;

               //**4PS Generated Code. Do Not Change.sn05
               DPA_OnInsert;
               //**4PS Generated Code.en05
             END;

    OnModify=BEGIN
               FillModificationData;
             END;

    OnDelete=VAR
               CommLineRec@1210190001 : Record 97;
               TryFeatRec@1210190003 : Record 11012753;
               TrySuccRec@1210190000 : Record 11012761;
               ActRec@1210190002 : Record 5080;
               VersRec@1210190004 : Record 11012763;
               CompRec@1210190005 : Record 11012762;
               lvDocRelRec@1210190006 : Record 11012407;
             BEGIN
               TryFeatRec.SETRANGE("Relation Type",TryFeatRec."Relation Type"::"Try-out Quote");
               TryFeatRec.SETRANGE(Code,Code);
               TryFeatRec.DELETEALL;

               TrySuccRec.SETRANGE("Try-out Quote",Code);
               TrySuccRec.DELETEALL(TRUE);

               CompRec.SETRANGE("Try-out Quote", Code);
               CompRec.DELETEALL(TRUE);

               VersRec.SETRANGE("Try-out Quote", Code);
               VersRec.DELETEALL(TRUE);

               ActRec.SETRANGE("Try-out Quote No.",Code);
               ActRec.DELETEALL(TRUE);

               CommLineRec.SETRANGE("Table Name",CommLineRec."Table Name"::"Try-out Quote");
               CommLineRec.SETRANGE("No.",Code);
               CommLineRec.DELETEALL;

               lvDocRelRec.SETRANGE("Document Type",lvDocRelRec."Document Type"::"Try-out Quote");
               lvDocRelRec.SETRANGE("No.",Code);
               lvDocRelRec.DELETEALL;
             END;

    CaptionML=ENU=Consolidated Try-out Quote;
    LookupPageID=Page11071837;
    DrillDownPageID=Page11071837;
  }
  FIELDS
  {
    { 5   ;   ;Company             ;Text50        ;CaptionML=ENU=Company }
    { 10  ;   ;Code                ;Code20        ;OnValidate=BEGIN
                                                                IF Code <> xRec.Code THEN BEGIN
                                                                  ContMgtSetup.GET;
                                                                  NoSeriesMgt.TestManual(ContMgtSetup."Try-out Quote Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Code }
    { 20  ;   ;Description         ;Text50        ;CaptionML=ENU=Description }
    { 25  ;   ;Description 2       ;Text50        ;CaptionML=ENU=Description 2 }
    { 30  ;   ;Address             ;Text50        ;OnValidate=VAR
                                                                lDummy@1210190000 : Text[30];
                                                              BEGIN
                                                              END;

                                                   CaptionML=ENU=Address;
                                                   Editable=Yes }
    { 40  ;   ;Address 2           ;Text50        ;CaptionML=ENU=Address 2;
                                                   Editable=Yes }
    { 50  ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                Postcode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=City;
                                                   Editable=Yes }
    { 60  ;   ;County              ;Text30        ;CaptionML=ENU=County;
                                                   Editable=Yes }
    { 65  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=ENU=Country/Region Code }
    { 70  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=VAR
                                                                PostCode@11012000 : Record 225;
                                                              BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Post Code;
                                                   Editable=Yes }
    { 75  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=ENU=Territory Code }
    { 80  ;   ;Salesperson Code    ;Code20        ;TableRelation=IF (No. Related Sales Persons=FILTER(1..)) "Salesperson by Contact"."Salesperson Code" WHERE (Contact No.=FIELD(Contact No.))
                                                                 ELSE IF (No. Related Sales Persons=FILTER(0)) Salesperson/Purchaser;
                                                   CaptionML=ENU=Salesperson Code }
    { 90  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Comment Line" WHERE (Table Name=CONST(Try-out Quote),
                                                                                           No.=FIELD(Code)));
                                                   CaptionML=ENU=Comment;
                                                   Editable=No }
    { 100 ;   ;Creation Date       ;Date          ;CaptionML=ENU=Creation Date }
    { 110 ;   ;Expected Starting Date;Date        ;CaptionML=ENU=Expected Starting Date }
    { 120 ;   ;Expected End Date   ;Date          ;CaptionML=ENU=Expected End Date }
    { 130 ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=ENU=Global Dimension 1 Code;
                                                   CaptionClass='1,1,1' }
    { 140 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=ENU=No. Series;
                                                   Editable=No }
    { 150 ;   ;Send Date           ;Date          ;CaptionML=ENU=Send Date }
    { 160 ;   ;Status              ;Code20        ;TableRelation="Try-out Status".Code WHERE (Type=CONST(Try-out Quote));
                                                   OnValidate=BEGIN
                                                                IF (Status <> '') AND (Status <> xRec.Status) THEN
                                                                  "Status changed on" := TODAY;
                                                              END;

                                                   CaptionML=ENU=Status }
    { 170 ;   ;Offered Amount      ;Decimal       ;CaptionML=ENU=Offered Amount }
    { 180 ;   ;Quote Text          ;Text250       ;CaptionML=ENU=Quote Text }
    { 190 ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   OnValidate=BEGIN
                                                                IF "Copy Address from" IN ["Copy Address from"::Company, "Copy Address from"::CompanyVisit,
                                                                                           "Copy Address from"::CompanyAlternative] THEN
                                                                  VALIDATE("Copy Address from");

                                                                IF "Contact No." <> xRec."Contact No." THEN BEGIN
                                                                  "Contact Person No." := '';
                                                                  "Salesperson Code" := '';
                                                                END;

                                                                IF "Contact No." <> '' THEN BEGIN
                                                                  ProspectRec.GET("Contact No.");
                                                                  ProspectRec.TESTFIELD(Blocked, FALSE);
                                                                  IF "Salesperson Code" = '' THEN
                                                                    IF ProspectRec."Salesperson Code" <> '' THEN BEGIN
                                                                      CheckContactSalesRelation(ProspectRec."Company No.", ProspectRec."Salesperson Code");
                                                                      VALIDATE("Salesperson Code", ProspectRec."Salesperson Code");
                                                                    END ELSE
                                                                      IF TryRec.GET("Try-out No.") THEN
                                                                        VALIDATE("Salesperson Code", TryRec."Salesperson Code");
                                                                END;

                                                                CALCFIELDS("Contact Name", "Contact Name 2");
                                                              END;

                                                   CaptionML=ENU=Contact No. }
    { 200 ;   ;Contact Person No.  ;Code20        ;TableRelation=Contact.No. WHERE (Company No.=FIELD(Contact No.),
                                                                                    Type=CONST(Person));
                                                   OnValidate=BEGIN
                                                                IF "Contact Person No." <> '' THEN BEGIN
                                                                  IF "Copy Address from" IN ["Copy Address from"::Person, "Copy Address from"::PersonVisit,
                                                                                             "Copy Address from"::PersonAlternative  ] THEN
                                                                    VALIDATE("Copy Address from");

                                                                  TESTFIELD("Contact No.");
                                                                  ContactRec.GET("Contact Person No.");
                                                                  ContactRec.TESTFIELD(Blocked, FALSE);
                                                                  ProspectRec.GET("Contact No.");
                                                                  IF ContactRec."Salesperson Code" <> '' THEN BEGIN
                                                                    CheckContactSalesRelation(ContactRec."Company No.", ContactRec."Salesperson Code");
                                                                    VALIDATE("Salesperson Code",ContactRec."Salesperson Code");
                                                                  END ELSE
                                                                    IF ProspectRec."Salesperson Code" <> '' THEN
                                                                      VALIDATE("Salesperson Code",ProspectRec."Salesperson Code")
                                                                    ELSE
                                                                      IF TryRec.GET("Try-out No.") THEN
                                                                        VALIDATE("Salesperson Code",TryRec."Salesperson Code");
                                                                END ELSE
                                                                  VALIDATE("Contact No.");
                                                              END;

                                                   CaptionML=ENU=Contact Person No. }
    { 210 ;   ;Try-out No.         ;Code20        ;TableRelation=Try-out.Code;
                                                   OnValidate=BEGIN
                                                                IF "Copy Address from" = "Copy Address from"::"Try Out" THEN
                                                                  VALIDATE("Copy Address from");

                                                                SuccRec.SETFILTER("Try-out No.", '<>%1', "Try-out No.");
                                                                SuccRec.SETRANGE("Try-out Quote", Code);
                                                                IF SuccRec.FIND('-') THEN BEGIN
                                                                  REPEAT
                                                                    SuccRec2.COPY(SuccRec);
                                                                    SuccRec2.SETRANGE("Try-out No.", "Try-out No.");
                                                                    IF NOT SuccRec2.FIND('+') THEN SuccRec2.INIT;
                                                                    LastLino := SuccRec2."Line No.";

                                                                    SuccRec2.COPY(SuccRec);
                                                                    SuccRec2."Try-out No." := "Try-out No.";
                                                                    SuccRec2."Line No." := LastLino + 10000;
                                                                    SuccRec2.INSERT;
                                                                    SuccRec.DELETE;
                                                                  UNTIL SuccRec.NEXT = 0;
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Try-out No. }
    { 220 ;   ;Contact Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact No.)));
                                                   CaptionML=ENU=Contact Name;
                                                   Editable=No }
    { 221 ;   ;Contact Name 2      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact."Name 2" WHERE (No.=FIELD(Contact No.)));
                                                   CaptionML=ENU=Contact Name 2;
                                                   Editable=No }
    { 230 ;   ;Contact Person Name ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Person No.)));
                                                   CaptionML=ENU=Contact Person Name;
                                                   Editable=No }
    { 240 ;   ;Try-out Description ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Try-out.Description WHERE (Code=FIELD(Try-out No.)));
                                                   CaptionML=ENU=Try-out Description;
                                                   Editable=No }
    { 250 ;   ;Sales person Name   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Salesperson Code)));
                                                   CaptionML=ENU=Salesperson Name;
                                                   Editable=No }
    { 260 ;   ;Apply Date          ;Date          ;CaptionML=ENU=Apply Date }
    { 270 ;   ;Assign Date         ;Date          ;CaptionML=ENU=Assign Date }
    { 275 ;   ;Assign Time         ;Time          ;CaptionML=ENU=Assign Time }
    { 280 ;   ;Register Date       ;Date          ;CaptionML=ENU=Register Date }
    { 290 ;   ;Tender Date         ;Date          ;CaptionML=ENU=Tender Date }
    { 295 ;   ;Tender Time         ;Time          ;CaptionML=ENU=Tender Time }
    { 700 ;   ;Discipline          ;Code10        ;TableRelation=Discipline;
                                                   CaptionML=ENU=Discipline }
    { 705 ;   ;Discipline Description;Text30      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Discipline.Description WHERE (Code=FIELD(Discipline)));
                                                   CaptionML=ENU=Discipline Description;
                                                   Editable=No }
    { 710 ;   ;Try Out City        ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Try-out.City WHERE (Code=FIELD(Try-out No.)));
                                                   CaptionML=ENU=Try Out City;
                                                   Editable=No }
    { 720 ;   ;Copy Address from   ;Option        ;InitValue=Company;
                                                   OnValidate=BEGIN
                                                                CASE "Copy Address from" OF
                                                                  "Copy Address from"::"Try Out":
                                                                    BEGIN
                                                                      "Alternative Address" := '';
                                                                      IF TryRec.GET("Try-out No.") THEN BEGIN
                                                                        Address := TryRec.Address;
                                                                        "Address 2" := TryRec."Address 2";
                                                                        City := TryRec.City;
                                                                        County := TryRec.County;
                                                                        "Country/Region Code":= TryRec."Country/Region Code";
                                                                        "Post Code" := TryRec."Post Code";
                                                                        "Territory Code":= TryRec."Territory Code";
                                                                      END;
                                                                    END;
                                                                  "Copy Address from"::Company:
                                                                    BEGIN
                                                                      "Alternative Address" := '';
                                                                      IF ContactRec.GET("Contact No.") THEN BEGIN
                                                                        Address := ContactRec.Address;
                                                                        "Address 2" := ContactRec."Address 2";
                                                                        City := ContactRec.City;
                                                                        County := ContactRec.County;
                                                                        "Country/Region Code":= ContactRec."Country/Region Code";
                                                                        "Post Code" := ContactRec."Post Code";
                                                                        "Territory Code":= ContactRec."Territory Code";
                                                                      END;
                                                                   END;

                                                                  //20061009/4PS.e
                                                                  "Copy Address from"::CompanyVisit:
                                                                    BEGIN
                                                                      "Alternative Address" := '';
                                                                      IF ContactRec.GET("Contact No.") THEN BEGIN
                                                                        Address := ContactRec."Visit Address";
                                                                        "Address 2" := ContactRec."Visit Address 2";
                                                                        City := ContactRec."Visit Address City";
                                                                        County := ContactRec."Visit Address County";
                                                                        "Country/Region Code" := ContactRec."Visit Address Country/Region";
                                                                        "Post Code" := ContactRec."Visit Address Post Code";
                                                                //        "Territory Code":= ContactRec."Territory Code";
                                                                      END;
                                                                   END;

                                                                  "Copy Address from"::CompanyAlternative:
                                                                    BEGIN
                                                                      "Alternative Address" := '';
                                                                      Address := '';
                                                                      "Address 2" := '';
                                                                      City := '';
                                                                      County := '';
                                                                      "Country/Region Code" := '';
                                                                      "Post Code" := '';
                                                                      "Territory Code":= '';
                                                                   END;

                                                                  "Copy Address from"::Person:
                                                                    BEGIN
                                                                     "Alternative Address" := '';
                                                                      IF ContactRec.GET("Contact Person No.") THEN BEGIN
                                                                        Address := ContactRec.Address;
                                                                        "Address 2" := ContactRec."Address 2";
                                                                        City := ContactRec.City;
                                                                        County := ContactRec.County;
                                                                        "Country/Region Code":= ContactRec."Country/Region Code";
                                                                        "Post Code" := ContactRec."Post Code";
                                                                        "Territory Code":= ContactRec."Territory Code";
                                                                      END;
                                                                    END;
                                                                  "Copy Address from"::PersonVisit:
                                                                    BEGIN
                                                                      "Alternative Address" := '';
                                                                      IF ContactRec.GET("Contact Person No.") THEN BEGIN
                                                                        Address := ContactRec."Visit Address";
                                                                        "Address 2" := ContactRec."Visit Address 2";
                                                                        City := ContactRec."Visit Address City";
                                                                        County := ContactRec."Visit Address County";
                                                                        "Country/Region Code" := ContactRec."Visit Address Country/Region";
                                                                        "Post Code" := ContactRec."Visit Address Post Code";
                                                                //        "Territory Code":= ContactRec."Territory Code";
                                                                      END;
                                                                   END;

                                                                  "Copy Address from"::PersonAlternative:
                                                                    BEGIN
                                                                      "Alternative Address" := '';
                                                                      Address := '';
                                                                      "Address 2" := '';
                                                                      City := '';
                                                                      County := '';
                                                                      "Country/Region Code" := '';
                                                                      "Post Code" := '';
                                                                      "Territory Code":= '';
                                                                   END;

                                                                  //20061009/4PS.e
                                                                END;
                                                              END;

                                                   CaptionML=ENU=Copy Address from;
                                                   OptionCaptionML=ENU=Try Out,Company,Company Visit Address,Company Alternative Address,Contact,Contact Visit Address,Contact Alternative Address;
                                                   OptionString=Try Out,Company,CompanyVisit,CompanyAlternative,Person,PersonVisit,PersonAlternative }
    { 721 ;   ;Alternative Address ;Code20        ;TableRelation=IF (Copy Address from=CONST(CompanyAlternative)) "Contact Alt. Address".Code WHERE (Contact No.=FIELD(Contact No.))
                                                                 ELSE IF (Copy Address from=CONST(PersonAlternative)) "Contact Alt. Address".Code WHERE (Contact No.=FIELD(Contact Person No.));
                                                   OnValidate=BEGIN
                                                                CASE "Copy Address from" OF
                                                                  "Copy Address from"::CompanyAlternative:
                                                                  BEGIN
                                                                    IF ContactalternativeRec.GET("Contact No.", "Alternative Address") THEN BEGIN
                                                                      Address := ContactalternativeRec.Address;
                                                                      "Address 2" := ContactalternativeRec."Address 2";
                                                                      City := ContactalternativeRec.City;
                                                                      County := ContactalternativeRec.County;
                                                                      "Country/Region Code" := ContactalternativeRec."Country/Region Code";
                                                                      "Post Code" := ContactalternativeRec."Post Code";
                                                                      //"Territory Code":= ;
                                                                     END;
                                                                   END;

                                                                  "Copy Address from"::PersonAlternative:
                                                                  BEGIN
                                                                    IF ContactalternativeRec.GET("Contact Person No.", "Alternative Address") THEN BEGIN
                                                                      Address := ContactalternativeRec.Address;
                                                                      "Address 2" := ContactalternativeRec."Address 2";
                                                                      City := ContactalternativeRec.City;
                                                                      County := ContactalternativeRec.County;
                                                                      "Country/Region Code" := ContactalternativeRec."Country/Region Code";
                                                                      "Post Code" := ContactalternativeRec."Post Code";
                                                                      //"Territory Code":= ;
                                                                     END;
                                                                    END;

                                                                END;
                                                              END;

                                                   CaptionML=ENU=Alternative Address }
    { 725 ;   ;Contact Filter      ;Code20        ;FieldClass=Normal;
                                                   CaptionML=ENU=Contact Filter;
                                                   Editable=No }
    { 730 ;   ;Contact Phone       ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact."Phone No." WHERE (No.=FIELD(Contact Filter)));
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=ENU=Contact Phone;
                                                   Editable=No }
    { 731 ;   ;Contact Phone 2     ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact."Phone No. 2" WHERE (No.=FIELD(Contact Filter)));
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=ENU=Contact Phone 2;
                                                   Editable=No }
    { 732 ;   ;Contact Mobile Phone;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact."Mobile Phone No." WHERE (No.=FIELD(Contact Filter)));
                                                   ExtendedDatatype=Phone No.;
                                                   CaptionML=ENU=Contact Mobile Phone;
                                                   Editable=No }
    { 733 ;   ;Contact Fax         ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact."Fax No." WHERE (No.=FIELD(Contact Filter)));
                                                   CaptionML=ENU=Contact Fax;
                                                   Editable=No }
    { 734 ;   ;Contact E-Mail      ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.E-Mail WHERE (No.=FIELD(Contact Filter)));
                                                   CaptionML=ENU=Contact E-Mail;
                                                   Editable=No }
    { 740 ;   ;Estimate No.        ;Code20        ;TableRelation=Estimate.No.;
                                                   CaptionML=ENU=Estimate No. }
    { 741 ;   ;Estimator           ;Code20        ;TableRelation=Employee.No.;
                                                   CaptionML=ENU=Estimator }
    { 742 ;   ;Name Estimator      ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee."Full Name" WHERE (No.=FIELD(Estimator)));
                                                   CaptionML=ENU=Name Estimator;
                                                   Editable=No }
    { 745 ;   ;Estimate Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Estimate.Description WHERE (No.=FIELD(Estimate No.)));
                                                   CaptionML=ENU=Estimate Description;
                                                   Editable=No }
    { 747 ;   ;Estimate Total      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Estimate Line OLD"."Cumulative Total" WHERE (Estimate No.=FIELD(Estimate No.)));
                                                   CaptionML=ENU=Estimate Total;
                                                   Editable=No }
    { 748 ;   ;Status changed on   ;Date          ;CaptionML=ENU=Status changed on;
                                                   Editable=No }
    { 750 ;   ;Tender No.          ;Code20        ;CaptionML=ENU=Tender No. }
    { 760 ;   ;No. Related Sales Persons;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Salesperson by Contact" WHERE (Contact No.=FIELD(Contact No.)));
                                                   CaptionML=ENU=No. Related Sales Persons;
                                                   Editable=No }
    { 770 ;   ;Your reference      ;Text30        ;CaptionML=ENU=Your reference }
    { 780 ;   ;Change Date         ;Date          ;CaptionML=ENU=Changed on;
                                                   Editable=No }
    { 790 ;   ;Changed By          ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Changed By;
                                                   Editable=No }
    { 800 ;   ;Inserted By         ;Code50        ;TableRelation=User."User Name";
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Inserted By;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Company,Code                            ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      ContMgtSetup@11012000 : Record 5079;
      ProspectRec@1210190001 : Record 5050;
      ContactRec@1210190000 : Record 5050;
      ContactalternativeRec@1100485000 : Record 5051;
      TryRec@1210190003 : Record 11012750;
      SuccRec@1210190009 : Record 11012761;
      SuccRec2@1210190008 : Record 11012761;
      Postcode@1210190006 : Record 225;
      NoSeriesMgt@1210190011 : Codeunit 396;
      LastLino@1210190007 : Integer;
      DPA_Management@1100000999 : Codeunit 11012783;

    PROCEDURE CheckContactSalesRelation@1210190000(lvContact@1210190001 : Code[20];lvSalesPerson@1210190002 : Code[20]);
    VAR
      ContSalesRec@1210190000 : Record 11012760;
    BEGIN
      IF NOT ContSalesRec.GET(lvContact, lvSalesPerson) THEN BEGIN
        ContSalesRec.INIT;
        ContSalesRec."Contact No." := lvContact;
        ContSalesRec."Salesperson Code" := lvSalesPerson;
        ContSalesRec.INSERT(TRUE);
      END;
    END;

    PROCEDURE FillModificationData@1100485000();
    BEGIN
      "Change Date" := TODAY;
      "Changed By" := USERID;
    END;

    PROCEDURE DPA_SetDefaultDpmtFromNoSeries@1100000995(xRecRef@1100525002 : RecordRef);
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      xRecRef.SETTABLE(xRec);
      DPA_Management.SetDepartmentCodeNoSeries(
        TABLENAME,
        "Global Dimension 1 Code",
        "No. Series",
        xRec."No. Series" );
    END;

    LOCAL PROCEDURE DPA_OnInsert@1100000991();
    VAR
      Dimension1Code@1100528400 : Code[20];
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      Dimension1Code :=
        DPA_Management.GetNoSeriesDepartmentCode(
          "No. Series",
          xRec."No. Series",
          DATABASE::"Consolidated Try-out Quote");
      IF Dimension1Code <> '' THEN
        "Global Dimension 1 Code" := Dimension1Code;

      IF "Global Dimension 1 Code" <> '' THEN
        VALIDATE("Global Dimension 1 Code");
    END;

    PROCEDURE DPA_GetFieldNoDepartmentFilter@1100000993() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(0);
    END;

    PROCEDURE DPA_GetFiltersFltrGrp@1100000997(FilterGroupNo@1100525000 : Integer) FilterText : Text[250];
    BEGIN
      //**4PS Generated Code - Do Not Change
      FILTERGROUP(FilterGroupNo);
      FilterText := COPYSTR(GETFILTERS, 1, MAXSTRLEN(FilterText));
      FILTERGROUP(0);
    END;

    PROCEDURE DPA_SetFilters@1100000998(Context@1100525000 : Text[30]) : Boolean;
    VAR
      RecRef@1100525003 : RecordRef;
      i@1100525004 : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      RecRef.GETTABLE(Rec);
      DPA_Management.SetDPAFilterFromContext(
        RecRef,
        Context,
        DPA_GetFieldNoDepartmentCode,
        DPA_GetFieldNoDepartmentFilter );

      FOR i := 10 DOWNTO 0 DO BEGIN
        RecRef.FILTERGROUP(i);
        FILTERGROUP(i);
        SETVIEW(RecRef.GETVIEW(FALSE));
      END;

      EXIT(DPA_Management.IsHardFilter);
    END;

    LOCAL PROCEDURE DPA_IsActive@1100000999() : Boolean;
    VAR
      DepartmentAuthorizObject@1100526000 : Record 11012466;
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DepartmentAuthorizObject.READPERMISSION THEN
        EXIT(FALSE);

      IF NOT DPA_Management.AuthorizationActive THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE DPA_FindRecWithDPAFilterAppld@1100000989();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN BEGIN
        FIND;
        EXIT;
      END;

      IF NOT DPA_Management.HasTableHardFilter(11072022) THEN BEGIN
        FIND;
        EXIT;
      END;

      DPA_SetFilters('Table 11072022');
      IF NOT FIND THEN
        DPA_Management.RaiseDPAErrorForTable(TABLECAPTION);
    END;

    PROCEDURE DPA_ChkDepartmentCodeAllowed@1100000990(IsHardFilter@1100526000 : Boolean);
    VAR
      DimensionManagement@1100526001 : Codeunit 408;
    BEGIN
      //**4PS Generated Code - Do Not Change
      DimensionManagement.CheckDepartmAuthWithFilterType(
        DATABASE::"Consolidated Try-out Quote", "Global Dimension 1 Code", IsHardFilter);
    END;

    PROCEDURE DPA_GetFieldNoDepartmentCode@1100000994() : Integer;
    BEGIN
      //**4PS Generated Code - Do Not Change
      EXIT(FIELDNO("Global Dimension 1 Code"));
    END;

    PROCEDURE DPA_SetDefaultDepartment@1100000996();
    BEGIN
      //**4PS Generated Code - Do Not Change
      IF NOT DPA_IsActive THEN
        EXIT;

      DPA_Management.SetDepartmentCodeUser(TABLENAME, "Global Dimension 1 Code");
    END;

    BEGIN
    {
      //20061009/4PS : Modified field ["Copy Address from"] added option [CompanyVisit,Person,PersonVisit]
    }
    END.
  }
}

