OBJECT Table 11125778 Glazing Service Call Line
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PS9.00;
  }
  PROPERTIES
  {
    DataCaptionFields=Glazing Service Call No.,Line No.,Item Description;
    OnInsert=BEGIN
               VALIDATE("VAT Prod. Posting Group Item", UpdateVatProdPostingGrp);  //RFC 547
             END;

    OnDelete=VAR
               GlazingServiceCallAssembly@1100525000 : Record 11125779;
               GlazingServiceCallActivity@1100525001 : Record 11125781;
             BEGIN
               GlazingServiceCallAssembly.SETRANGE("Glazing Service Call No.", "Glazing Service Call No.");
               GlazingServiceCallAssembly.SETRANGE("Glazing Service Call Line No.", "Line No.");
               GlazingServiceCallAssembly.DELETEALL;

               GlazingServiceCallActivity.SETRANGE("Glazing Service Call No.", "Glazing Service Call No.");
               GlazingServiceCallActivity.SETRANGE("Glazing Service Call Line No.", "Line No.");
               GlazingServiceCallActivity.DELETEALL;
             END;

    CaptionML=ENU=Glazing Service Call Line;
  }
  FIELDS
  {
    { 1   ;   ;Glazing Service Call No.;Code20    ;TableRelation="Glazing Service Call";
                                                   OnValidate=VAR
                                                                GlazingServiceCall@1100525000 : Record 11125777;
                                                              BEGIN
                                                                IF NOT GlazingServiceCall.GET("Glazing Service Call No.") THEN
                                                                  GlazingServiceCall.INIT;

                                                                VALIDATE(Region, GlazingServiceCall.Region);
                                                                VALIDATE("Building Status", GlazingServiceCall."Building Status");
                                                              END;

                                                   CaptionML=ENU=Glazing Service Call No.;
                                                   NotBlank=Yes }
    { 2   ;   ;Line No.            ;Integer       ;CaptionML=ENU=Line No. }
    { 10  ;   ;Item Description    ;Text50        ;CaptionML=ENU=Item Description }
    { 11  ;   ;Item Description 2  ;Text50        ;CaptionML=ENU=Item Description 2 }
    { 20  ;   ;Description         ;Text50        ;CaptionML=ENU=Description }
    { 21  ;   ;Description 2       ;Text50        ;CaptionML=ENU=Description 2 }
    { 50  ;   ;Tilted Mounting     ;Boolean       ;CaptionML=ENU=Tilted Mounting }
    { 51  ;   ;Tilted Mounting Disallowed;Boolean ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Glazing Service Call Assembly" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                            Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                            Tilted Mounting Disallowed=CONST(Yes)));
                                                   CaptionML=ENU=Tilted Mounting Disallowed;
                                                   Editable=No }
    { 100 ;   ;Quantity            ;Decimal       ;InitValue=1;
                                                   OnValidate=BEGIN
                                                                UpdateUnitPrice(FIELDNO(Quantity));
                                                                UpdateAssemblyLines(FIELDNO(Quantity));
                                                                UpdateActivityLines(FIELDNO(Quantity));
                                                                UpdateLinearMeters;
                                                                UpdateItemSalesAmount;
                                                                UpdateItemStandardCostAmount;
                                                                "Tot. Sfc. Area Driemaat (m2)" := "Surface Area Driemaat (m2)" * Quantity;  //db, 21-12-12: 29244
                                                              END;

                                                   CaptionML=ENU=Quantity;
                                                   DecimalPlaces=0:0 }
    { 110 ;   ;Width (mm)          ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurfaceArea;
                                                                UpdateSurfaceAreaDriemaat;
                                                                UpdateLinearMeters;
                                                              END;

                                                   CaptionML=ENU=Width (mm);
                                                   DecimalPlaces=0:0;
                                                   MinValue=0 }
    { 120 ;   ;Height (mm)         ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurfaceArea;
                                                                UpdateSurfaceAreaDriemaat;
                                                                UpdateLinearMeters;
                                                              END;

                                                   CaptionML=ENU=Height (mm);
                                                   DecimalPlaces=0:0;
                                                   MinValue=0 }
    { 130 ;   ;Altitude (m)        ;Decimal       ;OnValidate=BEGIN
                                                                GetMaxAllowedSurfaceArea;
                                                              END;

                                                   CaptionML=ENU=Altitude (m);
                                                   DecimalPlaces=0:0 }
    { 145 ;   ;Region              ;Option        ;OnValidate=BEGIN
                                                                GetMaxAllowedSurfaceArea;
                                                              END;

                                                   CaptionML=ENU=Region;
                                                   OptionCaptionML=ENU=" ,,,,,I,,,,,II,,,,,III";
                                                   OptionString=[ ,,,,,I,,,,,II,,,,,III];
                                                   NotBlank=Yes;
                                                   Editable=No }
    { 146 ;   ;Building Status     ;Option        ;OnValidate=BEGIN
                                                                GetMaxAllowedSurfaceArea;
                                                              END;

                                                   CaptionML=ENU=Building Status;
                                                   OptionCaptionML=ENU=" ,,,,,Built-On,,,,,Vacant";
                                                   OptionString=[ ,,,,,Built-On,,,,,Vacant];
                                                   NotBlank=Yes;
                                                   Editable=No }
    { 190 ;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   OnValidate=VAR
                                                                Item@1100525000 : Record 27;
                                                                GlazingApplication@1100525001 : Record 11125763;
                                                                SalesPriceCalcMgt@1100525002 : Codeunit 7000;
                                                              BEGIN
                                                                IF NOT Item.GET("Item No.") THEN
                                                                  Item.INIT
                                                                //mg.sn, 13-12-11: M31429
                                                                ELSE BEGIN
                                                                  Item.TESTFIELD(Blocked, FALSE);
                                                                END;
                                                                //mg.en, 13-12-11: M31429

                                                                "Item Description" := Item.Description;
                                                                "Item Description 2" := Item."Description 2";

                                                                IF NOT GlazingApplication.GET(Item."Glazing Application Code") THEN
                                                                  CLEAR(GlazingApplication);
                                                                IF GlazingApplication.Type <> GlazingApplication.Type::Vent THEN
                                                                  CLEAR(GlazingApplication);

                                                                VALIDATE("Vent Glazing Application Code", GlazingApplication.Code);

                                                                // jhoek.280710.begin
                                                                UpdateUnitPrice(FIELDNO("Item No."));
                                                                //VALIDATE("Item Sales Price", Item."Unit Price");
                                                                // jhoek.280710.end

                                                                VALIDATE("Item Standard Cost", Item."Standard Cost");

                                                                VALIDATE("VAT Prod. Posting Group Item", UpdateVatProdPostingGrp);  //RFC 547
                                                                CalcVATAmount; // RFC 547

                                                                //db, 28-08-15: function LookupItemNoWithSalesPrice from OnLookup moved to OnAssistEdit on page
                                                              END;

                                                   CaptionML=ENU=Item No. }
    { 200 ;   ;Glazing Assembly    ;Boolean       ;CaptionML=ENU=Glazing Assembly }
    { 215 ;   ;Glazing Assembly Weight;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Assembly"."Total Weight" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                         Glazing Service Call Line No.=FIELD(Line No.)));
                                                   CaptionML=ENU=Glazing Assembly Weight;
                                                   Editable=No }
    { 220 ;   ;Breastwork Height   ;Decimal       ;CaptionML=ENU=Breastwork Height;
                                                   MinValue=0 }
    { 221 ;   ;Min. Breastwork Height;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Max("Glazing Service Call Assembly"."Min. Breastwork Height" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                   Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                   Min. Breastwork Height=FILTER(<>0)));
                                                   CaptionML=ENU=Min. Breastwork Height;
                                                   Editable=No }
    { 225 ;   ;Height Surcharge    ;Decimal       ;OnValidate=BEGIN
                                                                UpdateActivityLines(FIELDNO("Height Surcharge")); // jhoek.220910
                                                              END;

                                                   CaptionML=ENU=Height Surcharge }
    { 230 ;   ;No. of Glaziers     ;Decimal       ;OnValidate=BEGIN
                                                                UpdateActivityLines(FIELDNO("No. of Glaziers"));
                                                              END;

                                                   CaptionML=ENU=No. of Glaziers;
                                                   DecimalPlaces=0:0;
                                                   MinValue=0 }
    { 240 ;   ;Vent Glazing Application Code;Code20;
                                                   TableRelation="Glazing Application".Code WHERE (Type=CONST(Vent));
                                                   OnValidate=VAR
                                                                GlazingApplication@1100525000 : Record 11125763;
                                                              BEGIN
                                                                IF NOT GlazingApplication.GET("Vent Glazing Application Code") THEN
                                                                  GlazingApplication.INIT;

                                                                VALIDATE("Vent Clearance (mm)", GlazingApplication."Vent Clearance (mm)");
                                                              END;

                                                   CaptionML=ENU=Vent Glazing Application Code;
                                                   Editable=No }
    { 250 ;   ;Vent Clearance (mm) ;Decimal       ;OnValidate=BEGIN
                                                                UpdateSurfaceArea;
                                                                UpdateSurfaceAreaDriemaat;
                                                              END;

                                                   CaptionML=ENU=Vent Clearance (mm);
                                                   Editable=No }
    { 300 ;   ;Surface Area (m2)   ;Decimal       ;OnValidate=BEGIN
                                                                UpdateActivityLines(FIELDNO("Surface Area (m2)"));
                                                                UpdateAssemblyLines(FIELDNO("Surface Area (m2)"));
                                                              END;

                                                   CaptionML=ENU=Surface Area (m2);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 310 ;   ;Surface Area Driemaat (m2);Decimal ;OnValidate=BEGIN
                                                                UpdateAssemblyLines(FIELDNO("Surface Area Driemaat (m2)"));
                                                                UpdateNoOfGlaziers;
                                                                "Tot. Sfc. Area Driemaat (m2)" := "Surface Area Driemaat (m2)" * Quantity;  //db, 21-12-12: 29244
                                                              END;

                                                   CaptionML=ENU=Surface Area Driemaat (m2);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 311 ;   ;Min. Sfc. Area Driemaat (m2);Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Max("Glazing Service Call Assembly"."Min. Sfc. Area Driemaat (m2)" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                         Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                         Min. Sfc. Area Driemaat (m2)=FILTER(<>0)));
                                                   CaptionML=ENU=Min. Sfc. Area Driemaat (m2);
                                                   MinValue=0;
                                                   Editable=No }
    { 312 ;   ;Tot. Sfc. Area Driemaat (m2);Decimal;
                                                   OnValidate=BEGIN
                                                                UpdateAssemblyLines(FIELDNO("Surface Area Driemaat (m2)"));
                                                                UpdateNoOfGlaziers;
                                                              END;

                                                   CaptionML=ENU=Tot. Sfc. Area Driemaat (m2);
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 320 ;   ;Linear Meters       ;Decimal       ;OnValidate=BEGIN
                                                                UpdateAssemblyLines(FIELDNO("Linear Meters"));
                                                                UpdateActivityLines(FIELDNO("Linear Meters"));
                                                              END;

                                                   CaptionML=ENU=Linear Meters;
                                                   Editable=No }
    { 400 ;   ;Glazing Activity Removal;Code10    ;TableRelation="Glazing Activity";
                                                   OnValidate=BEGIN
                                                                // Moved to the form. Sigh.
                                                                //CreateActivityLines(FIELDNO("Glazing Activity Removal"), "Glazing Activity Removal");
                                                              END;

                                                   CaptionML=ENU=Glazing Activity Removal }
    { 401 ;   ;Description Glaz.Act.Removal;Text50;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Glazing Activity".Description WHERE (Code=FIELD(Glazing Activity Removal)));
                                                   CaptionML=ENU=Description Glazing Activity Removal;
                                                   Editable=No }
    { 410 ;   ;Glazing Activity Mounting;Code10   ;TableRelation="Glazing Activity";
                                                   OnValidate=BEGIN
                                                                // Moved to the form. Sigh.
                                                                //CreateActivityLines(FIELDNO("Glazing Activity Mounting"), "Glazing Activity Mounting");
                                                              END;

                                                   CaptionML=ENU=Glazing Activity Mounting }
    { 411 ;   ;Description Glaz.Act.Mounting;Text50;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Lookup("Glazing Activity".Description WHERE (Code=FIELD(Glazing Activity Mounting)));
                                                   CaptionML=ENU=Description Glazing Activity Mountingl;
                                                   Editable=No }
    { 500 ;   ;Unit Cost Removal   ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Cost Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                        Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                        Type=CONST(Removal)));
                                                   CaptionML=ENU=Unit Cost Removal;
                                                   Editable=No }
    { 501 ;   ;Cost Amount Removal ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Total Cost Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                              Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                              Type=CONST(Removal)));
                                                   CaptionML=ENU=Cost Amount Removal;
                                                   Editable=No }
    { 510 ;   ;Unit Cost Mounting  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Cost Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                        Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                        Type=CONST(Mounting)));
                                                   CaptionML=ENU=Unit Cost Mounting;
                                                   Editable=No }
    { 511 ;   ;Cost Amount Mounting;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Total Cost Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                              Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                              Type=CONST(Mounting)));
                                                   CaptionML=ENU=Cost Amount Mounting;
                                                   Editable=No }
    { 600 ;   ;Sales Price Removal ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                         Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                         Type=CONST(Removal)));
                                                   CaptionML=ENU=Sales Price Removal;
                                                   Editable=No }
    { 601 ;   ;Sales Amount Removal;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Total Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                               Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                               Type=CONST(Removal)));
                                                   CaptionML=ENU=Sales Amount Removal;
                                                   Editable=No }
    { 610 ;   ;Sales Price Mounting;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                         Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                         Type=CONST(Mounting)));
                                                   CaptionML=ENU=Sales Price Mounting;
                                                   Editable=No }
    { 611 ;   ;Sales Amount Mounting;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Total Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                               Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                               Type=CONST(Mounting)));
                                                   CaptionML=ENU=Sales Amount Mounting;
                                                   Editable=No }
    { 700 ;   ;Item Sales Price    ;Decimal       ;OnValidate=BEGIN
                                                                UpdateItemSalesAmount;
                                                              END;

                                                   CaptionML=ENU=Item Sales Price }
    { 710 ;   ;Item Standard Cost  ;Decimal       ;OnValidate=BEGIN
                                                                UpdateItemStandardCostAmount;
                                                              END;

                                                   CaptionML=ENU=Item Standard Cost }
    { 720 ;   ;Item Sales Amount   ;Decimal       ;CaptionML=ENU=Item Sales Amount;
                                                   Editable=No }
    { 730 ;   ;Item Standard Cost Amount;Decimal  ;CaptionML=ENU=Item Standard Cost Amount;
                                                   Editable=No }
    { 790 ;   ;Shape Surcharge %   ;Decimal       ;OnValidate=BEGIN
                                                                UpdateAssemblyLines(FIELDNO("Shape Surcharge %"));
                                                              END;

                                                   CaptionML=ENU=Shape Surcharge %;
                                                   DecimalPlaces=0:2;
                                                   BlankZero=Yes }
    { 800 ;   ;Sales Price Assembly;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Assembly"."Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                         Glazing Service Call Line No.=FIELD(Line No.)));
                                                   CaptionML=ENU=Sales Price Assembly;
                                                   Editable=No }
    { 801 ;   ;Sales Amount Assembly;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Assembly"."Total Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                               Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                               VAT Prod. Posting Group=FIELD(VAT Prod. Posting Group Filter)));
                                                   CaptionML=ENU=Sales Amount Assembly;
                                                   Editable=No }
    { 810 ;   ;Standard Cost Assembly;Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Assembly"."Standard Cost Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                 Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                 VAT Prod. Posting Group=FIELD(VAT Prod. Posting Group Filter)));
                                                   CaptionML=ENU=Standard Cost Assembly;
                                                   Editable=No }
    { 811 ;   ;Standard Cost Amount Assembly;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Assembly"."Total Cost Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                              Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                              VAT Prod. Posting Group=FIELD(VAT Prod. Posting Group Filter)));
                                                   CaptionML=ENU=Standard Cost Amount Assembly;
                                                   Editable=No }
    { 920 ;   ;Removal Hours       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Total Hours" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                        Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                        Type=CONST(Removal)));
                                                   CaptionML=ENU=Removal Hours;
                                                   Editable=No }
    { 930 ;   ;Mounting Hours      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Total Hours" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                        Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                        Type=CONST(Mounting)));
                                                   CaptionML=ENU=Mounting Hours;
                                                   Editable=No }
    { 940 ;   ;Total Hours         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Total Hours" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                        Glazing Service Call Line No.=FIELD(Line No.)));
                                                   CaptionML=ENU=Total Hours;
                                                   Editable=No }
    { 1000;   ;Service Order No.   ;Code20        ;TableRelation="Service Order";
                                                   CaptionML=ENU=Service Order No.;
                                                   Editable=No }
    { 1050;   ;VAT Prod. Posting Group Item;Code10;TableRelation="VAT Product Posting Group".Code;
                                                   CaptionML=ENU=VAT Prod. Posting Group Item;
                                                   Editable=No }
    { 1055;   ;Active VAT Prod. Posting Group;Code10;
                                                   TableRelation="VAT Product Posting Group".Code;
                                                   CaptionML=ENU=Active VAT Prod. Posting Group Item;
                                                   Editable=No }
    { 1060;   ;VAT % Item          ;Decimal       ;CaptionML=ENU=VAT % Item;
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 1070;   ;Item Sales VAT Amount;Decimal      ;CaptionML=ENU=Item Sales VAT Amount;
                                                   Editable=No }
    { 1080;   ;Item Sales Amount incl. VAT;Decimal;CaptionML=ENU=Item Sales Amount incl. VAT;
                                                   Editable=No }
    { 1100;   ;Sales VAT Amount Removal;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Total Sales VAT Amt" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                Type=CONST(Removal)));
                                                   CaptionML=ENU=Sales VAT Amount Removal;
                                                   Editable=No }
    { 1110;   ;Sales VAT  Amount Mounting;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Total Sales VAT Amt" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                Type=CONST(Mounting)));
                                                   CaptionML=ENU=Sales VAT Amount Mounting;
                                                   Editable=No }
    { 1120;   ;Sales VAT Amount Assembly;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Assembly"."Total Sales VAT Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                   Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                   VAT Prod. Posting Group=FIELD(VAT Prod. Posting Group Filter)));
                                                   CaptionML=ENU=Sales VAT Amount Assembly;
                                                   Editable=No }
    { 1150;   ;Sales Amt Removal incl. VAT;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Tot Sls Amt incl. VAT" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                  Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                  Type=CONST(Removal)));
                                                   CaptionML=ENU=Sales Amount Removal incl. VAT;
                                                   Editable=No }
    { 1160;   ;Sales Amt Mounting incl. VAT;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Tot Sls Amt incl. VAT" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                  Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                  Type=CONST(Mounting)));
                                                   CaptionML=ENU=Sales Amount Mounting incl. VAT;
                                                   Editable=No }
    { 1170;   ;Sales Amt Assembly incl. VAT;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Assembly"."Total Sales Amount incl. VAT" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                         Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                         VAT Prod. Posting Group=FIELD(VAT Prod. Posting Group Filter)));
                                                   CaptionML=ENU=Sales Amount Assembly incl. VAT;
                                                   Editable=No }
    { 1180;   ;VAT Prod. Posting Group Filter;Code10;
                                                   FieldClass=FlowFilter;
                                                   TableRelation="VAT Product Posting Group".Code;
                                                   CaptionML=ENU=VAT Prod. Posting Group Filter }
    { 1200;   ;Sales VAT Activity Labor;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Labor Sales VAT Amt" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                Labor VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter)));
                                                   CaptionML=ENU="Sales VAT Amount Activity Labor ";
                                                   Editable=No }
    { 1210;   ;Sales VAT Activity Material;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Material Sales VAT Amt" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                   Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                   Material VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter)));
                                                   CaptionML=ENU=Sales VAT Amount Activity Material;
                                                   Editable=No }
    { 1220;   ;Sales VAT Activity Subcontr.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Subcontr. Sales VAT Amt" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                    Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                    Subcontr. VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter)));
                                                   CaptionML=ENU=Sales VAT Amount Activity Subcontracting;
                                                   Editable=No }
    { 1230;   ;Sales VAT Activity Plant;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Plant Sales VAT Amt" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                Plant VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter)));
                                                   CaptionML=ENU=Sales VAT Amount Activity Plant;
                                                   Editable=No }
    { 1250;   ;Sales Amt Act Labor incl. VAT;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Labor Sls Amt incl. VAT" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                    Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                    Labor VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                                    Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Sales Amount Activity Labor  incl. VAT;
                                                   Editable=No }
    { 1260;   ;Sales Amt Act Mat incl. VAT;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Material Sls Amt incl. VAT" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                       Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                       Material VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                                       Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Sales Amount Activity Material  incl. VAT;
                                                   Editable=No }
    { 1270;   ;Sales Amt Act Subc incl. VAT;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Subc. Sls Amt incl. VAT" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                    Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                    Subcontr. VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                                    Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Sales Amount Activity Subcontracting  incl. VAT;
                                                   Editable=No }
    { 1280;   ;Sales Amt Act Plant incl. VAT;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Plant Sls Amt incl. VAT" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                    Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                    Plant VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                                    Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Sales Amount Activity Plant  incl. VAT;
                                                   Editable=No }
    { 1300;   ;Sales Amt Activity Labor;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Labor Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                               Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                               Labor VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                               Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU="Sales Amount Activity Labor ";
                                                   Editable=No }
    { 1305;   ;Cost Amt Activity Labor;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Labor Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                         Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                         Labor VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                         Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU="Cost Amount Activity Labor ";
                                                   Editable=No }
    { 1310;   ;Sales Amt Activity Material;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Material Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                  Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                  Material VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                                  Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Sales Amount Activity Material;
                                                   Editable=No }
    { 1315;   ;Cost Amt Activity Material;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Material Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                            Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                            Material VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                            Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Cost Amount Activity Material;
                                                   Editable=No }
    { 1320;   ;Sales Amt Activity Subcontr.;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Subcontr. Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                   Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                   Subcontr. VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                                   Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Sales Amount Activity Subcontracting;
                                                   Editable=No }
    { 1325;   ;Cost Amt Activity Subcontr.;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Subcontracting Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                                  Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                                  Subcontr. VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                                  Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Cost Amount Activity Subcontracting;
                                                   Editable=No }
    { 1330;   ;Sales Amt Activity Plant;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Plant Sales Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                               Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                               Plant VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                               Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Sales Amount Activity Plant;
                                                   Editable=No }
    { 1335;   ;Cost Amt Activity Plant;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Glazing Service Call Activity"."Plant Amount" WHERE (Glazing Service Call No.=FIELD(Glazing Service Call No.),
                                                                                                                         Glazing Service Call Line No.=FIELD(Line No.),
                                                                                                                         Plant VAT Prod. Post. Grp=FIELD(VAT Prod. Posting Group Filter),
                                                                                                                         Type=FIELD(Activity Type Filter)));
                                                   CaptionML=ENU=Cost Amount Activity Plant;
                                                   Editable=No }
    { 1350;   ;Original Line No.   ;Integer       ;CaptionML=ENU=Original Line No.;
                                                   Editable=No }
    { 1360;   ;Appointment No.     ;Option        ;CaptionML=ENU=Appointment No.;
                                                   OptionCaptionML=ENU=" ,1,2,3,4,5,6";
                                                   OptionString=[ ,1,2,3,4,5,6] }
    { 1370;   ;Activity Type Filter;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=ENU=Activity Type Filter;
                                                   OptionCaptionML=ENU=" ,Removal,Mounting";
                                                   OptionString=[ ,Removal,Mounting] }
    { 1380;   ;Item Basic Price    ;Decimal       ;OnValidate=BEGIN
                                                                UpdateItemSalesPrice;
                                                              END;

                                                   CaptionML=ENU=Item Basic Price;
                                                   Editable=No }
    { 1390;   ;Item Sales Discount %;Decimal      ;OnValidate=BEGIN
                                                                UpdateItemSalesPrice;
                                                              END;

                                                   CaptionML=ENU=Item Sales Discount %;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Glazing Service Call No.,Line No.       ;SumIndexFields=Item Standard Cost Amount,Item Sales Amount,Item Sales VAT Amount,Item Sales Amount incl. VAT;
                                                   MaintainSIFTIndex=No;
                                                   Clustered=Yes }
    {    ;Glazing Service Call No.,Service Order No. }
    {    ;Vent Glazing Application Code            }
    {    ;Active VAT Prod. Posting Group           }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1100525000 : TextConst 'ENU=Invalid field no.';
      Text001@1100525001 : TextConst 'ENU=%1 x %2 mm.';
      Text002@1100525002 : TextConst 'ENU=At least one cost object code must be filled in line %1 of %2 %3.';

    PROCEDURE GlazingActivityAssistEdit@1100525006(FieldNo@1100525000 : Integer);
    VAR
      GlazingServiceCall@1100525002 : Record 11125777;
      GlazingServiceCallActivity@1100525001 : Record 11125781;
      GlazingSvcCallActivities@1100525003 : Page 11125796;
    BEGIN
      GlazingServiceCall.GET("Glazing Service Call No.");

      GlazingServiceCallActivity.SETCURRENTKEY("Glazing Service Call No.", "Glazing Service Call Line No.", Type);
      GlazingServiceCallActivity.SETRANGE("Glazing Service Call No.", "Glazing Service Call No.");
      GlazingServiceCallActivity.SETRANGE("Glazing Service Call Line No.", "Line No.");

      CASE FieldNo OF
        Rec.FIELDNO("Glazing Activity Removal"): GlazingServiceCallActivity.SETRANGE(Type, GlazingServiceCallActivity.Type::Removal);
        Rec.FIELDNO("Glazing Activity Mounting"): GlazingServiceCallActivity.SETRANGE(Type, GlazingServiceCallActivity.Type::Mounting);
      END;

      GlazingSvcCallActivities.EDITABLE :=
        (GlazingServiceCall.Status = GlazingServiceCall.Status::Open) AND ("Service Order No." = '');
      GlazingSvcCallActivities.SETTABLEVIEW(GlazingServiceCallActivity);
      GlazingSvcCallActivities.RUNMODAL;
    END;

    PROCEDURE GlazingAssemblyAssistEdit@1100525007();
    VAR
      GlazingServiceCall@1100525002 : Record 11125777;
      GlazingServiceCallAssembly@1100525000 : Record 11125779;
      GlazingSvcCallAssembly@1100525001 : Page 11125789;
    BEGIN
      TESTFIELD(Quantity);
      TESTFIELD("Line No.");

      GlazingServiceCall.GET("Glazing Service Call No.");

      GlazingServiceCallAssembly.FILTERGROUP(10);
      GlazingServiceCallAssembly.SETRANGE("Glazing Service Call No.", "Glazing Service Call No.");
      GlazingServiceCallAssembly.SETRANGE("Glazing Service Call Line No.", "Line No.");
      GlazingServiceCallAssembly.FILTERGROUP(0);

      GlazingSvcCallAssembly.EDITABLE :=
        (GlazingServiceCall.Status = GlazingServiceCall.Status::Open) AND ("Service Order No." = '');
      GlazingSvcCallAssembly.SETTABLEVIEW(GlazingServiceCallAssembly);
      GlazingSvcCallAssembly.RUNMODAL;
    END;

    PROCEDURE CreateActivityLines@1100525014(FieldNo@1100525002 : Integer;NewValue@1100525003 : Code[10]);
    VAR
      GlazingServiceCall@1100525005 : Record 11125777;
      GlazingActivity@1100525006 : Record 11125768;
      GlazingActivityLine@1100525001 : Record 11125769;
      GlazingServiceCallActivity@1100525000 : Record 11125781;
      Type@1100525004 : ' ,Removal,Mounting';
    BEGIN
      CASE FieldNo OF
        Rec.FIELDNO("Glazing Activity Removal"): Type := Type::Removal;
        Rec.FIELDNO("Glazing Activity Mounting"): Type := Type::Mounting;
      ELSE
        ERROR(Text000);
      END;

      // Remove old lines, if any
      GlazingServiceCallActivity.SETCURRENTKEY("Glazing Service Call No.", "Glazing Service Call Line No.", Type);
      GlazingServiceCallActivity.SETRANGE("Glazing Service Call No.", "Glazing Service Call No.");
      GlazingServiceCallActivity.SETRANGE("Glazing Service Call Line No.", "Line No.");
      GlazingServiceCallActivity.SETRANGE(Type, Type);
      GlazingServiceCallActivity.DELETEALL;

      GlazingServiceCall.GET("Glazing Service Call No.");

      GlazingServiceCallActivity.SETRANGE(Type);
      IF NOT GlazingServiceCallActivity.FINDLAST THEN
        GlazingServiceCallActivity."Line No." := 0;

      GlazingActivityLine.SETRANGE("Glazing Activity Code", NewValue);

      IF GlazingActivityLine.FINDSET THEN
        REPEAT
          IF (GlazingActivityLine."Cost Object Code Labor" = '' ) AND
             (GlazingActivityLine."Cost Object Code Material" = '') AND
             (GlazingActivityLine."Cost Object Code Subcontr." = '') AND
             (GlazingActivityLine."Cost Object Code Plant" = '')
          THEN
            ERROR(Text002, GlazingActivityLine."Line No.", GlazingActivity.TABLECAPTION, GlazingActivityLine."Glazing Activity Code");

          GlazingServiceCallActivity."Glazing Service Call No." := "Glazing Service Call No.";
          GlazingServiceCallActivity."Glazing Service Call Line No." := "Line No.";
          GlazingServiceCallActivity."Line No." := GlazingServiceCallActivity."Line No." + 10000;
          GlazingServiceCallActivity.Type := Type;
          GlazingServiceCallActivity."Cost Driver" := GlazingActivityLine."Cost Driver";
          GlazingServiceCallActivity."Item No." := GlazingActivityLine."Item No.";
          GlazingServiceCallActivity."Cost Object Code Labor" := GlazingActivityLine."Cost Object Code Labor";
          GlazingServiceCallActivity."Cost Object Code Material" := GlazingActivityLine."Cost Object Code Material";
          GlazingServiceCallActivity."Cost Object Code Subcontr." := GlazingActivityLine."Cost Object Code Subcontr.";
          GlazingServiceCallActivity."Cost Object Code Plant" := GlazingActivityLine."Cost Object Code Plant";
          GlazingServiceCallActivity.Description := GlazingActivityLine.Description;
          GlazingServiceCallActivity."Surface Area" := "Surface Area (m2)";
          GlazingServiceCallActivity."Linear Meters" := "Linear Meters";
          GlazingServiceCallActivity."Call Line Quantity" := Quantity;
          GlazingServiceCallActivity."Height Surcharge" := "Height Surcharge";
          GlazingServiceCallActivity."No. of Glaziers" := "No. of Glaziers";
          GlazingServiceCallActivity."Qty. per Unit of Measure" := GlazingActivityLine."Qty. per Unit of Measure";
          GlazingServiceCallActivity."Unit of Measure Code" := GlazingActivityLine."Unit of Measure Code";
          GlazingServiceCallActivity.Norm := GlazingActivityLine.Norm;
          // GlazingServiceCallActivity."Price Reference Date" := GlazingActivityLine."Price Reference Date";
          GlazingServiceCallActivity."Price Reference Date" := GlazingServiceCall.Date; // jhoek.270710
          // jhoek.060910.begin
          // GlazingServiceCallActivity.VALIDATE("Rate Code", GlazingServiceCall."Default Rate Code");
          GlazingServiceCallActivity.VALIDATE("Rate Code", GlazingActivityLine."Rate Code");
          // jhoek.060910.end
          GlazingServiceCallActivity.Hours := GlazingActivityLine.Hours;
          GlazingServiceCallActivity."Material Price" := GlazingActivityLine."Material Price";
          GlazingServiceCallActivity."Subcontracting Price" := GlazingActivityLine."Subcontracting Price";
          GlazingServiceCallActivity."Plant Price" := GlazingActivityLine."Plant Price";
          GlazingServiceCallActivity."Surcharge %" := GlazingActivityLine."Surcharge %";
          GlazingServiceCallActivity."Profit/Risk %" := GlazingActivityLine."Profit/Risk %";
          GlazingServiceCallActivity.Quantity := GlazingActivityLine.Quantity; // jhoek.290710
          GlazingServiceCallActivity.UpdateVatProdPostingGrp(); // RFC 547
          GlazingServiceCallActivity.UpdateQuantity;
          GlazingServiceCallActivity.UpdateTotals;
          GlazingServiceCallActivity.INSERT;
        UNTIL GlazingActivityLine.NEXT = 0;
    END;

    PROCEDURE UpdateAssemblyLines@1100525000(FieldNo@1100525000 : Integer);
    VAR
      GlazingServiceCallAssembly@1100525001 : Record 11125779;
    BEGIN
      GlazingServiceCallAssembly.SETRANGE("Glazing Service Call No.", "Glazing Service Call No.");
      GlazingServiceCallAssembly.SETRANGE("Glazing Service Call Line No.", "Line No.");

      IF GlazingServiceCallAssembly.FINDSET(TRUE, FALSE) THEN
        REPEAT
          CASE FieldNo OF
            Rec.FIELDNO("Surface Area Driemaat (m2)"):
              GlazingServiceCallAssembly.VALIDATE("Surface Area Driemaat (m2)", "Surface Area Driemaat (m2)");
            Rec.FIELDNO("Surface Area (m2)"):
              GlazingServiceCallAssembly.VALIDATE("Surface Area (m2)", "Surface Area (m2)");
            Rec.FIELDNO("Linear Meters"):
              GlazingServiceCallAssembly.VALIDATE("Linear Meters", "Linear Meters");
            Rec.FIELDNO(Quantity):
              GlazingServiceCallAssembly.VALIDATE("Quantity (Glazing Call Line)", Quantity);
            Rec.FIELDNO("Shape Surcharge %"):
              GlazingServiceCallAssembly.VALIDATE("Shape Surcharge %", "Shape Surcharge %");
          END;
          GlazingServiceCallAssembly.MODIFY;
        UNTIL GlazingServiceCallAssembly.NEXT = 0;
    END;

    PROCEDURE UpdateActivityLines@1100525009(FieldNo@1100525000 : Integer);
    VAR
      GlazingServiceCallActivity@1100525001 : Record 11125781;
    BEGIN
      GlazingServiceCallActivity.SETRANGE("Glazing Service Call No.", "Glazing Service Call No.");
      GlazingServiceCallActivity.SETRANGE("Glazing Service Call Line No.", "Line No.");

      IF GlazingServiceCallActivity.FINDSET(TRUE, FALSE) THEN
        REPEAT
          CASE FieldNo OF
            Rec.FIELDNO("Surface Area (m2)"): GlazingServiceCallActivity.VALIDATE("Surface Area", "Surface Area (m2)");
            Rec.FIELDNO("Linear Meters"): GlazingServiceCallActivity.VALIDATE("Linear Meters", "Linear Meters");
            Rec.FIELDNO(Quantity): GlazingServiceCallActivity.VALIDATE("Call Line Quantity", Quantity);
            Rec.FIELDNO("Height Surcharge"): GlazingServiceCallActivity.VALIDATE("Height Surcharge", "Height Surcharge");
            Rec.FIELDNO("No. of Glaziers"): GlazingServiceCallActivity.VALIDATE("No. of Glaziers", "No. of Glaziers");
          END;
          GlazingServiceCallActivity.MODIFY;
        UNTIL GlazingServiceCallActivity.NEXT = 0;
    END;

    PROCEDURE GlazingAssemblyCode@1100525001(Purpose@1100525001 : 'Ordering,,,Max. Surface Area Check') Result : Code[50];
    VAR
      GlazingServiceCallAssembly@1100525000 : Record 11125779;
    BEGIN
      // According to the functional specs, will never exceed 50 chars
      // For the purpose of ordering: include all item nos.
      // For the purpose of max. surface check: include only items associated with a glazing application
      GlazingServiceCallAssembly.SETRANGE("Glazing Service Call No.", "Glazing Service Call No.");
      GlazingServiceCallAssembly.SETRANGE("Glazing Service Call Line No.", "Line No.");

      IF GlazingServiceCallAssembly.FINDSET THEN
        REPEAT
          IF (Purpose = Purpose::Ordering) OR
             ((Purpose = Purpose::"Max. Surface Area Check") AND (GlazingServiceCallAssembly."Glazing Application Code" <> ''))
          THEN
            CASE Purpose OF
              Purpose::Ordering:
                Result := Result + GlazingServiceCallAssembly."Ordering Code" + '-';
              Purpose::"Max. Surface Area Check":
                Result := Result + GlazingServiceCallAssembly."Glazing Application Code" + '-';
            END;
        UNTIL GlazingServiceCallAssembly.NEXT = 0;

      Result := DELCHR(Result, '>', '-');
    END;

    PROCEDURE UpdateSurfaceArea@1100525002();
    BEGIN
      VALIDATE("Surface Area (m2)", (("Height (mm)" - "Vent Clearance (mm)") * "Width (mm)") / 1000000);
    END;

    PROCEDURE UpdateSurfaceAreaDriemaat@1100525005();
    VAR
      Width@1100525000 : Decimal;
      Height@1100525001 : Decimal;
    BEGIN
      Width := Rec."Width (mm)" / 10;
      Height := (Rec."Height (mm)" - "Vent Clearance (mm)") / 10;

      Width := 3 * ROUND(Width / 3, 1, '>');
      Height := 3 * ROUND(Height / 3, 1, '>');

      CALCFIELDS("Min. Sfc. Area Driemaat (m2)");
      VALIDATE("Surface Area Driemaat (m2)", Max((Width * Height) / 10000, "Min. Sfc. Area Driemaat (m2)"));
    END;

    PROCEDURE UpdateNoOfGlaziers@1100525015();
    BEGIN
      CALCFIELDS("Glazing Assembly Weight");
      VALIDATE("No. of Glaziers", ROUND("Glazing Assembly Weight" / 25, 1, '>'));
    END;

    PROCEDURE GetMaxAllowedSurfaceArea@1100525008() : Decimal;
    VAR
      GlazingAssemblyCode2@1100525001 : Code[250];
      MaxWindowPaneSurfaceArea@1100525000 : Record 11125765;
    BEGIN
      GlazingAssemblyCode2 := GlazingAssemblyCode(3);

      IF MaxWindowPaneSurfaceArea.GET(GlazingAssemblyCode2, Region, "Building Status", "Altitude (m)") THEN
        EXIT(MaxWindowPaneSurfaceArea."Max. Allowed Surface Area");
    END;

    PROCEDURE UpdateLinearMeters@1100525004();
    BEGIN
      VALIDATE("Linear Meters", (("Width (mm)" * 2 + "Height (mm)" * 2)) / 1000);
    END;

    PROCEDURE UpdateItemSalesAmount@1100525003();
    BEGIN
      "Item Sales Amount" := Quantity * "Item Sales Price";
      CalcVATAmount;  // RFC 547
    END;

    PROCEDURE UpdateItemStandardCostAmount@1100525010();
    BEGIN
      "Item Standard Cost Amount" := Quantity * "Item Standard Cost";
    END;

    PROCEDURE Max@1100525011(Value1@1100525000 : Decimal;Value2@1100525001 : Decimal) : Decimal;
    BEGIN
      IF Value1 > Value2 THEN
        EXIT(Value1);
      EXIT(Value2);
    END;

    PROCEDURE TotalCost@1100525012() : Decimal;
    BEGIN
      CALCFIELDS("Cost Amount Mounting", "Cost Amount Removal", "Standard Cost Amount Assembly");
      EXIT("Cost Amount Mounting" + "Cost Amount Removal" + "Item Standard Cost Amount" + "Standard Cost Amount Assembly");
    END;

    PROCEDURE TotalSalesAmount@1100525013() Value : Decimal;
    VAR
      GlazingServiceCall@1100525000 : Record 11125777;
      Currency@1210190000 : Record 4;
    BEGIN
      IF NOT GlazingServiceCall.GET("Glazing Service Call No.") THEN
        GlazingServiceCall.INIT;

      CASE GlazingServiceCall."Fixed Price Contract" OF
        TRUE:
          BEGIN
            CALCFIELDS("Sales Amount Assembly");
            // jhoek.170910.begin
            // EXIT("Sales Amount Assembly");
            Value := "Sales Amount Assembly" + "Item Sales Amount";
            // jhoek.170910.end
          END;
        FALSE:
          BEGIN
            CALCFIELDS("Sales Amount Mounting", "Sales Amount Removal", "Sales Amount Assembly");
            Value := "Sales Amount Mounting" + "Sales Amount Removal" + "Item Sales Amount" + "Sales Amount Assembly";
          END;
      END;
      Currency.InitRoundingPrecision;
      Value := ROUND(Value, Currency."Amount Rounding Precision");
    END;

    PROCEDURE TotalSalesAmountVAT@1100525020() Value : Decimal;
    VAR
      GlazingServiceCall@1100525000 : Record 11125777;
      Currency@1210190000 : Record 4;
    BEGIN
      // RFC 547
      IF NOT GlazingServiceCall.GET("Glazing Service Call No.") THEN
        GlazingServiceCall.INIT;

      CASE GlazingServiceCall."Fixed Price Contract" OF
        TRUE:
          BEGIN
            CALCFIELDS("Sales VAT Amount Assembly");
            Value := "Sales VAT Amount Assembly" + "Item Sales VAT Amount";
          END;
        FALSE:
          BEGIN
            CALCFIELDS("Sales VAT  Amount Mounting", "Sales VAT Amount Removal", "Sales VAT Amount Assembly");
            Value :=
              "Sales VAT  Amount Mounting" + "Sales VAT Amount Removal" +
              "Item Sales VAT Amount" + "Sales VAT Amount Assembly";
          END;
      END;
      Currency.InitRoundingPrecision;
      Value := ROUND(Value, Currency."Amount Rounding Precision");
    END;

    PROCEDURE TotalSalesAmountInclVAT@1100525021() : Decimal;
    VAR
      GlazingServiceCall@1100525000 : Record 11125777;
    BEGIN
      // RFC 547
      EXIT(TotalSalesAmount + TotalSalesAmountVAT);

      IF NOT GlazingServiceCall.GET("Glazing Service Call No.") THEN
        GlazingServiceCall.INIT;

      CASE GlazingServiceCall."Fixed Price Contract" OF
        TRUE:
          BEGIN
            CALCFIELDS("Sales Amt Assembly incl. VAT");
            EXIT("Sales Amt Assembly incl. VAT" + "Item Sales Amount incl. VAT");
          END;
        FALSE:
          BEGIN
            CALCFIELDS("Sales Amt Mounting incl. VAT", "Sales Amt Removal incl. VAT", "Sales Amt Assembly incl. VAT");
            EXIT("Sales Amt Mounting incl. VAT" + "Sales Amt Removal incl. VAT" +
                  "Item Sales Amount incl. VAT" + "Sales Amt Assembly incl. VAT");
          END;
      END;
    END;

    PROCEDURE GetVentDescription2@1100525016() : Text[50];
    BEGIN
      //mg.so, 04-01-12: M31426
      //IF "Vent Glazing Application Code" <> '' THEN
      //  IF "Vent Clearance (mm)" <> 0 THEN
      //mg.eo, 04-01-12: M31426
      EXIT(STRSUBSTNO(Text001, "Width (mm)", "Height (mm)" - "Vent Clearance (mm)")); //mg.c, 09-12-11: M31424
    END;

    PROCEDURE UpdateUnitPrice@1100525017(CalledByFieldNo@1100525000 : Integer);
    VAR
      SalesPriceCalcMgt@1100525001 : Codeunit 7000;
    BEGIN
      IF "Item No." = '' THEN  BEGIN
        VALIDATE("Item Basic Price", 0);
        VALIDATE("Item Sales Discount %", 0);
        EXIT;
      END;

      SalesPriceCalcMgt.FindGlazSvcCallLinePrice(Rec,CalledByFieldNo);
    END;

    PROCEDURE UpdateVatProdPostingGrp@1100525018() VatProdPostingGrp : Code[20];
    VAR
      ServiceSetup@1100525001 : Record 11012800;
      ItemRec@1100525002 : Record 27;
      ServLocRec@1100525003 : Record 11012801;
      GlazingServiceCall@1100525004 : Record 11125777;
      Customer@1100525005 : Record 18;
    BEGIN
      // RFC 547
      VatProdPostingGrp := '';
      GlazingServiceCall.GET("Glazing Service Call No.");
      ServiceSetup.GET;
      IF NOT ItemRec.GET("Item No.") THEN
        ItemRec.INIT;

      IF (ServiceSetup."Source VAT Prod. Posting Group" = ServiceSetup."Source VAT Prod. Posting Group"::"Item/CostObject") AND
         (ItemRec."VAT Prod. Posting Group" <> '') THEN
      BEGIN
        VatProdPostingGrp := ItemRec."VAT Prod. Posting Group";
      END;

      IF VatProdPostingGrp = '' THEN BEGIN
        IF ServLocRec.GET(GlazingServiceCall."Service Location No.") THEN BEGIN
          IF ServLocRec."VAT Prod. Posting Group" <> '' THEN
            VatProdPostingGrp := ServLocRec."VAT Prod. Posting Group";
        END;
      END;

      IF VatProdPostingGrp = '' THEN BEGIN
        IF Customer.GET(GlazingServiceCall."Customer No.") THEN
          VatProdPostingGrp := Customer."VAT Prod. Posting Group";
      END;

      IF VatProdPostingGrp = '' THEN BEGIN
        VatProdPostingGrp := ServiceSetup."VAT Prod. Posting Group"
      END;
    END;

    PROCEDURE CalcVATAmount@1100525019();
    VAR
      GlazingServiceCall@1100525001 : Record 11125777;
    BEGIN
      // RFC 547
      GlazingServiceCall.GET("Glazing Service Call No.");
      CalcVATAmount2(GlazingServiceCall);
    END;

    PROCEDURE CalcVATAmount2@1100525026(GlazingServiceCall@1100525003 : Record 11125777);
    VAR
      VATPostingSetup@1100525000 : Record 325;
      Currency@1100525002 : Record 4;
    BEGIN
      // RFC 547
      IF NOT VATPostingSetup.GET(GlazingServiceCall."VAT Bus. Posting Group",
                                 "VAT Prod. Posting Group Item")
      THEN
        VATPostingSetup.INIT;

      "VAT % Item" := 0;
      "Item Sales VAT Amount" := 0;
      "Item Sales Amount incl. VAT" := "Item Sales Amount";
      IF VATPostingSetup."VAT Calculation Type" = VATPostingSetup."VAT Calculation Type"::"Normal VAT" THEN BEGIN
        "VAT % Item" := VATPostingSetup."VAT %";
        Currency.InitRoundingPrecision;
        "Item Sales Amount incl. VAT" := ROUND(
           "Item Sales Amount" * (100 + "VAT % Item") /100,
           Currency."Unit-Amount Rounding Precision");
        "Item Sales VAT Amount" := "Item Sales Amount incl. VAT" - "Item Sales Amount";
      END;
    END;

    PROCEDURE TotalSalesAmtByVATPrdGrp@1100525024(VatProdPostGrp@1100525001 : Code[10];TypeFilter@1210190000 : ' ,Removal,Mounting,Item,Assembly') Value : Decimal;
    VAR
      GlazingServiceCall@1100525000 : Record 11125777;
      Currency@1210190001 : Record 4;
    BEGIN
      // RFC 547
      IF NOT GlazingServiceCall.GET("Glazing Service Call No.") THEN
        GlazingServiceCall.INIT;

      SETFILTER("VAT Prod. Posting Group Filter", '=%1', VatProdPostGrp);
      IF TypeFilter <> TypeFilter::" " THEN
        SETFILTER("Activity Type Filter", '=%1', TypeFilter);

      CASE GlazingServiceCall."Fixed Price Contract" OF
        TRUE:
          BEGIN
            CALCFIELDS("Sales Amount Assembly");
            CASE TypeFilter OF
              TypeFilter::" ":
                BEGIN
                  IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                    Value := "Sales Amount Assembly" + "Item Sales Amount"
                  ELSE
                    Value := "Sales Amount Assembly";
                END;
              TypeFilter::Item:
                IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                  Value := "Item Sales Amount";
              TypeFilter::Assembly:
                Value := "Sales Amount Assembly";
            END;
          END;
        FALSE:
          BEGIN
            CALCFIELDS("Sales Amt Activity Labor", "Sales Amt Activity Material",
                       "Sales Amt Activity Subcontr.", "Sales Amt Activity Plant",
                       "Sales Amount Assembly");
            CASE TypeFilter OF
              TypeFilter::" ":
                BEGIN
                  IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                    Value :=
                      "Sales Amt Activity Labor" + "Sales Amt Activity Material" +
                      "Sales Amt Activity Subcontr." + "Sales Amt Activity Plant" +
                      "Item Sales Amount" + "Sales Amount Assembly"
                  ELSE
                    Value :=
                      "Sales Amt Activity Labor" + "Sales Amt Activity Material" +
                      "Sales Amt Activity Subcontr." + "Sales Amt Activity Plant" +
                      "Sales Amount Assembly";
                END;
              TypeFilter::Removal,
              TypeFilter::Mounting:
                Value :=
                  "Sales Amt Activity Labor" + "Sales Amt Activity Material" +
                  "Sales Amt Activity Subcontr." + "Sales Amt Activity Plant";
              TypeFilter::Item:
                IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                  Value := "Item Sales Amount";
              TypeFilter::Assembly:
                Value := "Sales Amount Assembly";
            END;
          END;
      END;

      Currency.InitRoundingPrecision;
      Value := ROUND(Value, Currency."Amount Rounding Precision");

      SETRANGE("VAT Prod. Posting Group Filter");
      SETRANGE("Activity Type Filter");
    END;

    PROCEDURE TotalSalesAmVATByVATPrdGrp@1100525023(VatProdPostGrp@1100525001 : Code[10];TypeFilter@1210190000 : ' ,Removal,Mounting,Item,Assembly') Value : Decimal;
    VAR
      GlazingServiceCall@1100525000 : Record 11125777;
      Currency@1210190001 : Record 4;
    BEGIN
      // RFC 547
      IF NOT GlazingServiceCall.GET("Glazing Service Call No.") THEN
        GlazingServiceCall.INIT;

      SETFILTER("VAT Prod. Posting Group Filter",  '=%1',VatProdPostGrp);
      IF TypeFilter <> TypeFilter::" " THEN
        SETFILTER("Activity Type Filter", '=%1', TypeFilter);

      CASE GlazingServiceCall."Fixed Price Contract" OF
        TRUE:
          BEGIN
            CALCFIELDS("Sales VAT Amount Assembly");
            CASE TypeFilter OF
              TypeFilter::" ":
                BEGIN
                  IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                    Value := "Sales VAT Amount Assembly" + "Item Sales VAT Amount"
                  ELSE
                    Value := "Sales VAT Amount Assembly";
                END;
              TypeFilter::Item:
                IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                  Value := "Item Sales VAT Amount";
              TypeFilter::Assembly:
                Value := "Sales VAT Amount Assembly";
            END;
          END;
        FALSE:
          BEGIN
            CALCFIELDS("Sales VAT Activity Labor", "Sales VAT Activity Material",
                       "Sales VAT Activity Subcontr.", "Sales VAT Activity Plant",
                       "Sales VAT Amount Assembly");
            CASE TypeFilter OF
              TypeFilter::" ":
                BEGIN
                  IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                    Value :=
                      "Sales VAT Activity Labor" + "Sales VAT Activity Material" +
                      "Sales VAT Activity Subcontr." + "Sales VAT Activity Plant" +
                      "Item Sales VAT Amount" + "Sales VAT Amount Assembly"
                  ELSE
                    Value :=
                      "Sales VAT Activity Labor" + "Sales VAT Activity Material" +
                      "Sales VAT Activity Subcontr." + "Sales VAT Activity Plant" +
                      "Sales VAT Amount Assembly";
                END;
              TypeFilter::Removal,
              TypeFilter::Mounting:
                Value :=
                  "Sales VAT Activity Labor" + "Sales VAT Activity Material" +
                  "Sales VAT Activity Subcontr." + "Sales VAT Activity Plant";
              TypeFilter::Item:
                IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                  Value := "Item Sales VAT Amount";
              TypeFilter::Assembly:
                Value := "Sales VAT Amount Assembly";
            END;
          END;
      END;
      Currency.InitRoundingPrecision;
      Value := ROUND(Value, Currency."Amount Rounding Precision");

      SETRANGE("VAT Prod. Posting Group Filter");
      SETRANGE("Activity Type Filter");
    END;

    PROCEDURE TotalSalesAmInclVATByVATPrdGrp@1100525022(VatProdPostGrp@1100525001 : Code[10];TypeFilter@1210190000 : ' ,Removal,Mounting,Item,Assembly') : Decimal;
    VAR
      GlazingServiceCall@1100525000 : Record 11125777;
    BEGIN
      // RFC 547
      EXIT(TotalSalesAmtByVATPrdGrp(VatProdPostGrp, TypeFilter) + TotalSalesAmVATByVATPrdGrp(VatProdPostGrp, TypeFilter));
    END;

    PROCEDURE TotalCostByVATPrdGrp@1100525025(VatProdPostGrp@1100525000 : Code[10];TypeFilter@1210190000 : ' ,Removal,Mounting,Item,Assembly') Value : Decimal;
    VAR
      GlazingServiceCall@1100525001 : Record 11125777;
    BEGIN
      // RFC 547
      IF NOT GlazingServiceCall.GET("Glazing Service Call No.") THEN
        GlazingServiceCall.INIT;

      SETFILTER("VAT Prod. Posting Group Filter", '=%1', VatProdPostGrp);
      IF TypeFilter <> TypeFilter::" " THEN
        SETFILTER("Activity Type Filter", '=%1', TypeFilter);

      CASE GlazingServiceCall."Fixed Price Contract" OF
        TRUE:
          BEGIN
            CALCFIELDS("Standard Cost Amount Assembly");
            CASE TypeFilter OF
              TypeFilter::" ":
                BEGIN
                  IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                    Value := "Item Standard Cost Amount" + "Standard Cost Amount Assembly"
                  ELSE
                    Value := "Standard Cost Amount Assembly";
                END;
              TypeFilter::Item:
                IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                  Value := "Item Standard Cost Amount";
              TypeFilter::Assembly:
                Value := "Standard Cost Amount Assembly";
            END;
          END;
        FALSE:
          BEGIN
            CALCFIELDS("Cost Amt Activity Labor","Cost Amt Activity Material",
                       "Cost Amt Activity Subcontr.","Cost Amt Activity Plant",
                       "Standard Cost Amount Assembly");

            CASE TypeFilter OF
              TypeFilter::" ":
                BEGIN
                  IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                    Value := "Cost Amt Activity Labor" + "Cost Amt Activity Material" +
                             "Cost Amt Activity Subcontr." + "Cost Amt Activity Plant" +
                             "Item Standard Cost Amount" + "Standard Cost Amount Assembly"
                  ELSE
                    Value := "Cost Amt Activity Labor" + "Cost Amt Activity Material" +
                             "Standard Cost Amount Assembly";
                END;
              TypeFilter::Removal,
              TypeFilter::Mounting:
                Value := "Cost Amt Activity Labor" + "Cost Amt Activity Material" +
                         "Cost Amt Activity Subcontr." + "Cost Amt Activity Plant";
              TypeFilter::Item:
                IF VatProdPostGrp = "VAT Prod. Posting Group Item" THEN
                  Value := "Item Standard Cost Amount";
              TypeFilter::Assembly:
                Value := "Standard Cost Amount Assembly";
            END;
          END;
      END;

      SETRANGE("VAT Prod. Posting Group Filter");
      SETRANGE("Activity Type Filter");
    END;

    PROCEDURE LookupItemNoWithSalesPrice@1100528400();
    VAR
      GlazingServiceCall@1100528401 : Record 11125777;
      Item@1100528400 : Record 27;
    BEGIN
      //kkleermaker, 110721, M23540
      //db, 28-08-15: function was local (for lookup table field ItemNo, but now used on page)
      GlazingServiceCall.GET("Glazing Service Call No.");
      Item.LookupItemNoWithSalesPrice(
        "Item No.",
        Quantity,
        1,
        GlazingServiceCall."Customer No.",
        GlazingServiceCall.Date);
      VALIDATE("Item No.");
    END;

    PROCEDURE UpdateItemSalesPrice@1100528602();
    BEGIN
      VALIDATE("Item Sales Price", "Item Basic Price" * (100 - "Item Sales Discount %") / 100);
    END;

    BEGIN
    END.
  }
}

