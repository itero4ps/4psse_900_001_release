OBJECT Table 12013606 EX User Group
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EXF350000;
  }
  PROPERTIES
  {
    DataPerCompany=No;
    OnInsert=BEGIN
               "Company Name" := COMPANYNAME;
             END;

    OnDelete=VAR
               UserGroupLine@1100285002 : Record 12013607;
             BEGIN
               IF ExFlowUserMgt.TemplateLineExist(Rec) THEN
                 ERROR(EXF04);

               UserGroupLine.RESET;
               UserGroupLine.SETRANGE("Company Name","Company Name");
               UserGroupLine.SETRANGE(Code,Code);
               IF UserGroupLine.FIND('-') THEN
                 UserGroupLine.DELETEALL;
             END;

    OnRename=BEGIN
               ERROR(EXF03);
             END;

    CaptionML=ENU=User Group;
    LookupPageID=Page12013618;
    DrillDownPageID=Page12013618;
  }
  FIELDS
  {
    { 1   ;   ;Company Name        ;Text30        ;TableRelation=Company;
                                                   CaptionML=ENU=Company Name }
    { 2   ;   ;Code                ;Code50        ;TableRelation="EX User Group".Code;
                                                   AltSearchField=Search Name;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Code;
                                                   NotBlank=Yes }
    { 10  ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                IF ("Search Name" = UPPERCASE(xRec.Name)) OR ("Search Name" = '') THEN
                                                                  "Search Name" := Name;
                                                              END;

                                                   CaptionML=ENU=Name }
    { 11  ;   ;Coding Rule         ;Integer       ;TableRelation="EX Coding Rule".ID;
                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=ENU=Coding Rule }
    { 12  ;   ;Auto Approve        ;Boolean       ;OnValidate=BEGIN
                                                                IF ("Auto Approve" <> xRec."Auto Approve") AND NOT "Auto Approve" THEN
                                                                  "Auto Approve Comment" := '';
                                                              END;

                                                   CaptionML=ENU=Auto Approve }
    { 13  ;   ;Auto Approve Comment;Text180       ;OnValidate=BEGIN
                                                                IF ("Auto Approve Comment" <> xRec."Auto Approve Comment") AND ("Auto Approve Comment" <> '') THEN
                                                                  "Auto Approve" := TRUE;
                                                              END;

                                                   CaptionML=ENU=Auto Approve Comment }
    { 14  ;   ;Manager             ;Code50        ;TableRelation="EX User Group".Code WHERE (Company Name=FIELD(Company Name));
                                                   CaptionML=ENU=Manager;
                                                   Description=532 }
    { 15  ;   ;Days before escalation;Integer     ;CaptionML=ENU=Days before escalation;
                                                   Description=532 }
    { 18  ;   ;Blocked             ;Boolean       ;OnValidate=BEGIN
                                                                IF Blocked THEN
                                                                  IF ExFlowUserMgt.TemplateLineExist(Rec) THEN
                                                                    ERROR(EXF06);
                                                              END;

                                                   CaptionML=ENU=Blocked;
                                                   Description=718 }
    { 20  ;   ;Search Name         ;Code50        ;CaptionML=ENU=Search Name }
    { 50  ;   ;Dimension Value     ;Code20        ;OnValidate=BEGIN
                                                                ValidateShortcutDimCode(FindDimension,"Dimension Value");
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupShortcutDimCode(FindDimension,"Dimension Value");
                                                            END;

                                                   CaptionML=ENU=Dimension Value }
    { 60  ;   ;Exclude from web list;Boolean      ;CaptionML=ENU=Exclude from the web's user list;
                                                   Description=610 }
  }
  KEYS
  {
    {    ;Company Name,Code                       ;Clustered=Yes }
    {    ;Code                                     }
    {    ;Name                                     }
    {    ;Search Name                              }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Code,Name                                }
  }
  CODE
  {
    VAR
      EXF03@1100285005 : TextConst 'ENU=Approval Groups can not be renamed!';
      EXF04@1100285008 : TextConst 'ENU=You can not delete the Approval Group before it is removed from all template rules.';
      ExFlowUserMgt@1100285000 : Codeunit 12013596;
      EXF06@1100285001 : TextConst 'ENU=You can not block the Approval Group before it is removed from all template rules.';

    PROCEDURE FindDimension@1100285004() : Integer;
    VAR
      GLSetup@1100285000 : Record 98;
      ExFlowSetup@1100285001 : Record 12013601;
    BEGIN
      GLSetup.GET;
      ExFlowSetup.GET(COMPANYNAME);
      ExFlowSetup.TESTFIELD("User Dimension Code");

      CASE ExFlowSetup."User Dimension Code" OF
        GLSetup."Shortcut Dimension 1 Code": EXIT(1);
        GLSetup."Shortcut Dimension 2 Code": EXIT(2);
        GLSetup."Shortcut Dimension 3 Code": EXIT(3);
        GLSetup."Shortcut Dimension 4 Code": EXIT(4);
        GLSetup."Shortcut Dimension 5 Code": EXIT(5);
        GLSetup."Shortcut Dimension 6 Code": EXIT(6);
        GLSetup."Shortcut Dimension 7 Code": EXIT(7);
        GLSetup."Shortcut Dimension 8 Code": EXIT(8);
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      DimMgt@1100285000 : Codeunit 408;
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE LookupShortcutDimCode@28(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      DimMgt@1100285000 : Codeunit 408;
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
    END;

    BEGIN
    END.
  }
}

