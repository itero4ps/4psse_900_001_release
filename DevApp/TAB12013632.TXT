OBJECT Table 12013632 EX Reference
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=EXF350000;
  }
  PROPERTIES
  {
    CaptionML=ENU=Reference;
    LookupPageID=Page12013632;
  }
  FIELDS
  {
    { 1   ;   ;Reference           ;Code50        ;CaptionML=ENU=Reference;
                                                   NotBlank=Yes }
    { 2   ;   ;Vendor No.          ;Code20        ;TableRelation=Vendor;
                                                   CaptionML=ENU=Vendor No. }
    { 5   ;   ;Description         ;Text50        ;CaptionML=ENU=Description }
    { 10  ;   ;Dimension           ;Code20        ;OnValidate=BEGIN
                                                                IF("Predefined Purch. Code" <> '') AND (Dimension <> '') AND (Dimension <> xRec.Dimension) THEN
                                                                  ERROR(EXF053);
                                                                ValidateShortcutDimCode(FindDimension,Dimension);
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupShortcutDimCode(FindDimension,Dimension);
                                                            END;

                                                   CaptionML=ENU=Dimension Value }
    { 11  ;   ;First Approver      ;Code50        ;OnValidate=VAR
                                                                UserGroup@1100285000 : Record 12013606;
                                                              BEGIN
                                                                IF "First Approver" <> '' THEN BEGIN
                                                                  IF NOT UserGroup.GET(COMPANYNAME,"First Approver") THEN
                                                                    BEGIN
                                                                      UserGroup.RESET;
                                                                      UserGroup.SETRANGE("Company Name",COMPANYNAME);
                                                                      UserGroup.SETFILTER(Code,"First Approver" + '*');
                                                                      IF UserGroup.FIND('-') THEN
                                                                        "First Approver" := UserGroup.Code
                                                                      ELSE
                                                                        ERROR(EXF13,"First Approver");
                                                                    END;
                                                                  "Template Rule" := '';
                                                                END;
                                                              END;

                                                   CaptionML=ENU=First Approver }
    { 12  ;   ;Template Rule       ;Code20        ;OnValidate=BEGIN
                                                                IF "Template Rule" <> '' THEN
                                                                  IF NOT TemplateRule.GET(COMPANYNAME,"Template Rule") THEN
                                                                    ERROR(EXF052,"Template Rule")
                                                                  ELSE
                                                                    "First Approver" := '';
                                                              END;

                                                   OnLookup=BEGIN
                                                              CLEAR(TemplateRuleForm);

                                                              TemplateRuleForm.EDITABLE(FALSE);
                                                              TemplateRuleForm.LOOKUPMODE(TRUE);
                                                              TemplateRule.RESET;
                                                              TemplateRule.SETRANGE("Company Name",COMPANYNAME);
                                                              TemplateRuleForm.SETTABLEVIEW(TemplateRule);
                                                              IF TemplateRuleForm.RUNMODAL = ACTION::LookupOK THEN
                                                                BEGIN
                                                                  TemplateRuleForm.GETRECORD(TemplateRule);
                                                                  VALIDATE("Template Rule",TemplateRule.Code);
                                                                END;
                                                            END;

                                                   CaptionML=ENU=Template Rule }
    { 50  ;   ;Predefined Purch. Code;Code10      ;TableRelation="EX Standard Purchase Code".Code;
                                                   OnValidate=BEGIN
                                                                IF("Predefined Purch. Code" <> '') AND (Dimension <> '') AND ("Predefined Purch. Code" <> xRec."Predefined Purch. Code") THEN
                                                                  ERROR(EXF053);
                                                              END;

                                                   CaptionML=ENU=Predefined ExFlow Purch. Code }
    { 55  ;   ;Purchaser Code      ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=ENU=Purchaser Code }
  }
  KEYS
  {
    {    ;Reference,Vendor No.                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Reference,Description                    }
  }
  CODE
  {
    VAR
      EXF13@1100285001 : TextConst 'ENU=Approval Group %1 is missing.';
      EXF052@1100285002 : TextConst 'ENU=Template %1 does not exist.';
      EXF053@1100285000 : TextConst 'ENU=Dimension can not be selected in comibination with a Standard Purch Code.';
      TemplateRuleForm@1100285004 : Page 12013648;
      TemplateRule@1100285003 : Record 12013645;

    PROCEDURE FindDimension@1100285004() : Integer;
    VAR
      GLSetup@1100285000 : Record 98;
      ExFlowSetup@1100285001 : Record 12013601;
    BEGIN
      GLSetup.GET;

      ExFlowSetup.GET(COMPANYNAME);
      ExFlowSetup.TESTFIELD("User Dimension Code");

      CASE ExFlowSetup."User Dimension Code" OF
        GLSetup."Shortcut Dimension 1 Code": EXIT(1);
        GLSetup."Shortcut Dimension 2 Code": EXIT(2);
        GLSetup."Shortcut Dimension 3 Code": EXIT(3);
        GLSetup."Shortcut Dimension 4 Code": EXIT(4);
        GLSetup."Shortcut Dimension 5 Code": EXIT(5);
        GLSetup."Shortcut Dimension 6 Code": EXIT(6);
        GLSetup."Shortcut Dimension 7 Code": EXIT(7);
        GLSetup."Shortcut Dimension 8 Code": EXIT(8);
      END;
    END;

    PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      DimMgt@1100285000 : Codeunit 408;
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
    END;

    PROCEDURE LookupShortcutDimCode@28(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      DimMgt@1100285000 : Codeunit 408;
    BEGIN
      DimMgt.LookupDimValueCode(FieldNumber,ShortcutDimCode);
    END;

    BEGIN
    END.
  }
}

