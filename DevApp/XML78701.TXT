OBJECT XMLport 78701 Finvoice Template From Rep-2
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSFI-CUSTSPEC-FV;
  }
  PROPERTIES
  {
    Direction=Export;
    Encoding=ISO-8859-2;
    Format/Evaluate=XML Format/Evaluate;
    OnInitXMLport=BEGIN
                    gtxBaseDateFormat := 'CCYYMMDD';
                    FinvoiceSetup.GET;
                  END;

    UseRequestPage=No;
  }
  ELEMENTS
  {
    { [{5D73AD0C-A2EC-45C3-9BC1-376A55DDAD9A}];  ;Finvoice            ;Element ;Table   ;
                                                  ReqFilterFields=Field3;
                                                  SourceTable=Table112;
                                                  SourceTableView=SORTING(Field3)
                                                                  ORDER(Ascending);
                                                  Export::OnAfterGetRecord=BEGIN

                                                                             CompanyInfo.GET;
                                                                             //Tehd„„n heti aluksi :
                                                                               //viittaukset eri asiakastyyppeihin
                                                                               //lasketaan kokonaissummat ja ALV:t
                                                                               //etc. listaukset t„h„n.


                                                                             BillCustomer.GET("Sales Invoice Header"."Bill-to Customer No.");
                                                                             SellCustomer.GET("Sales Invoice Header"."Sell-to Customer No.");
                                                                             IF "Sales Invoice Header"."Ship-to Code" <> '' THEN
                                                                               ShipToAddress.GET("Sales Invoice Header"."Sell-to Customer No.", "Sales Invoice Header"."Ship-to Code");
                                                                             GLsetup.GET;
                                                                             IF "Sales Invoice Header"."Currency Code" = '' THEN
                                                                               InvCurrencyCode := GLsetup."LCY Code"
                                                                             ELSE
                                                                               InvCurrencyCode := "Sales Invoice Header"."Currency Code";
                                                                             InvCurrencyCode := COPYSTR(InvCurrencyCode,1,3);

                                                                             IF "Sales Invoice Header"."Language Code" <> '' THEN
                                                                               gtxInvoiceLanguageCode := COPYSTR("Sales Invoice Header"."Language Code",1,2)
                                                                             ELSE
                                                                               gtxInvoiceLanguageCode := 'FI';


                                                                             CLEAR(gInvTotalExcVAT);
                                                                             CLEAR(gInvTotalIncVAT);
                                                                             CLEAR(gInvTotalVAT);
                                                                             CLEAR(VATAmountLine);
                                                                             VATAmountLine.DELETEALL;
                                                                             gSalesInvLines.SETRANGE(gSalesInvLines."Document No.","Sales Invoice Header"."No.");
                                                                             IF gSalesInvLines.FINDSET THEN REPEAT
                                                                               gInvTotalExcVAT += gSalesInvLines.Amount;
                                                                               gInvTotalIncVAT += gSalesInvLines."Amount Including VAT";
                                                                               gInvTotalVAT += gSalesInvLines."Amount Including VAT" - gSalesInvLines.Amount;

                                                                               IF (gSalesInvLines.Type = gSalesInvLines.Type::"G/L Account") THEN
                                                                                 gSalesInvLines."No." := '';

                                                                               VATAmountLine.INIT;
                                                                               VATAmountLine."VAT Identifier" := gSalesInvLines."VAT Identifier";
                                                                               VATAmountLine."VAT Calculation Type" := gSalesInvLines."VAT Calculation Type";
                                                                               VATAmountLine."Tax Group Code" := gSalesInvLines."Tax Group Code";
                                                                               VATAmountLine."VAT %" := gSalesInvLines."VAT %";
                                                                               VATAmountLine."VAT Base" := gSalesInvLines.Amount;
                                                                               VATAmountLine."Amount Including VAT" := gSalesInvLines."Amount Including VAT";
                                                                               VATAmountLine."Line Amount" := gSalesInvLines."Line Amount";
                                                                               IF gSalesInvLines."Allow Invoice Disc." THEN
                                                                                 VATAmountLine."Inv. Disc. Base Amount" := gSalesInvLines."Line Amount";
                                                                               VATAmountLine."Invoice Discount Amount" := gSalesInvLines."Inv. Discount Amount";
                                                                               VATAmountLine."VAT Clause Code" := gSalesInvLines."VAT Clause Code";
                                                                               VATAmountLine.InsertLine;

                                                                               TotalSubTotal += gSalesInvLines."Line Amount";
                                                                               TotalInvDiscAmount -= gSalesInvLines."Inv. Discount Amount";
                                                                               TotalAmount += gSalesInvLines.Amount;
                                                                               TotalAmountVAT += gSalesInvLines."Amount Including VAT" - gSalesInvLines.Amount;
                                                                               TotalAmountInclVAT += gSalesInvLines."Amount Including VAT";
                                                                               TotalPaymentDiscOnVAT += -(gSalesInvLines."Line Amount" - gSalesInvLines."Inv. Discount Amount" - gSalesInvLines."Amount Including VAT");

                                                                             UNTIL gSalesInvLines.NEXT = 0;
                                                                           END;
                                                                            }

    { [{C0F25689-15BA-48C1-B984-9E0CF1C0D75F}];1 ;Version             ;Attribute;Text    }

    { [{5B933635-E839-471D-8397-08E23ACC6330}];1 ;noNamespaceSchemaLocation;Attribute;Text }

    { [{2681CA5D-72AB-4FC8-87EA-F0D0F521353A}];1 ;SellerPartyDetails  ;Element ;Text     }

    { [{58635D06-80B5-4DF0-80E0-EF62E7FFCA11}];2 ;SellerPartyIdentifier;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerPartyIdentifier := COPYSTR(CompanyInfo."Business Identity Code",1,35);
                                                                               END;
                                                                                }

    { [{284478AC-6F27-4D44-A8E4-99CEF8786411}];2 ;SellerPartyIdentifierUrlText;Element;Text }

    { [{CDF5F006-2B69-4A6A-A8BF-78406035C1EA}];2 ;SellerOrganisationName;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerOrganisationName := COPYSTR(CompanyInfo.Name,1,70);
                                                                               END;
                                                                                }

    { [{CBE41819-60E3-4338-9EF8-CF8619868C9F}];2 ;SellerOrganisationDepartment;Element;Text }

    { [{DD355654-B674-4DB5-B132-4314CAA3F0A6}];2 ;SellerOrganisationTaxCode;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerOrganisationTaxCode := COPYSTR(CompanyInfo."VAT Registration No.",1,35);
                                                                               END;
                                                                                }

    { [{EAA2EA30-3291-454F-968A-66EABD3835FD}];2 ;SellerOrganisationTaxCodeUrlText;Element;Text }

    { [{CE2ABDEA-E0FA-42DF-BA04-D2327964D613}];2 ;SellerCode          ;Element ;Text     }

    { [{4442B0D3-8996-47F3-A77E-186200F3629F}];2 ;SellerPostalAddressDetails;Element;Text;
                                                  MinOccurs=Zero }

    { [{587BADCB-E81A-42E0-98B2-29CF94AFCB45}];3 ;SellerStreetName    ;Element ;Text    ;
                                                  VariableName=<SellerStreetName>;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 "<SellerStreetName>" := COPYSTR(CompanyInfo.Address,1,35);
                                                                               END;
                                                                                }

    { [{4F505841-746B-407E-99C1-DF8D25BF40C2}];3 ;SellerTownName      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerTownName := COPYSTR(CompanyInfo.City,1,35);
                                                                               END;
                                                                                }

    { [{4FEC6DF9-307D-4E29-A248-C27724C80B6A}];3 ;SellerPostCodeIdentifier;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerPostCodeIdentifier := COPYSTR(CompanyInfo."Post Code",1,35);
                                                                               END;
                                                                                }

    { [{66EC7064-E757-4A01-BEFB-C826341C1E26}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCode1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CountryCode1 := COPYSTR(CompanyInfo."Country/Region Code",1,2);
                                                                               END;
                                                                                }

    { [{9159CD58-0D5C-4042-BE9D-6C50787ADA7F}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryName1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Country.GET(CompanyInfo."Country/Region Code");
                                                                                 CountryName1 := COPYSTR(Country.Name,1,35);
                                                                               END;
                                                                                }

    { [{8C4962E8-B885-42BF-95A5-19D7F8D5246D}];1 ;SellerOrganisationUnitNumber;Element;Text }

    { [{4E5E7DD7-49A4-405A-B44E-DEF93FF3F61B}];1 ;SellerSiteCode      ;Element ;Text     }

    { [{E277BF7A-F647-4D34-BFEC-EC9AB0009B21}];1 ;SellerContactPersonName;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF SalesPurchPerson.GET("Sales Invoice Header"."Salesperson Code") THEN
                                                                                   BEGIN
                                                                                     SellerContactPersonName := COPYSTR(SalesPurchPerson.Name,1,35);
                                                                                     SellerPhoneNumberIdentifier := COPYSTR(SalesPurchPerson."Phone No.",1,35);
                                                                                     SellerEmailaddressIdentifier := COPYSTR(SalesPurchPerson."E-Mail",1,70);
                                                                                   END;
                                                                               END;
                                                                                }

    { [{A0F57AAA-2BDB-4BA1-9160-1341C68F92F4}];1 ;SellerContactPersonFunction;Element;Text }

    { [{FD1CDD55-F3A6-41C0-935B-89E3FC97CFE4}];1 ;SellerContactPersonDepartment;Element;Text }

    { [{6434D54E-778B-4A80-9310-D53EB313EF5A}];1 ;SellerCommunicationDetails;Element;Text }

    { [{BC4A424F-F122-460D-A72B-9DA4D39701AB}];2 ;SellerPhoneNumberIdentifier;Element;Text }

    { [{7B5978F4-A041-4D39-894E-B239B9B1AE2E}];2 ;SellerEmailaddressIdentifier;Element;Text }

    { [{0FC66DC2-51C4-4381-A12B-5E38F7F0B633}];1 ;SellerInformationDetails;Element;Text  }

    { [{8A89B2A2-B897-4DBB-A305-D4ED6BD49B87}];2 ;SellerHomeTownName  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerHomeTownName := COPYSTR(CompanyInfo."Registered Home City",1,35);
                                                                               END;
                                                                                }

    { [{E4E11546-8F8E-418F-9DAF-28576D4A36AA}];2 ;SellerPhoneNumber   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerPhoneNumber := COPYSTR(CompanyInfo."Phone No.",1,35);
                                                                               END;
                                                                                }

    { [{A8A35B6C-A3E3-453F-B6DE-5B7264267C42}];2 ;SellerFaxNumber     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerFaxNumber := COPYSTR(CompanyInfo."Fax No.",1,35);
                                                                               END;
                                                                                }

    { [{71651981-7422-47F0-8B6A-7BB805C0B4E0}];2 ;SellerCommonEmailaddressIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerCommonEmailaddressIdentifier := COPYSTR(CompanyInfo."E-Mail",1,70);
                                                                               END;
                                                                                }

    { [{08BBCC99-0E61-4C8A-A7B5-F950F75ACB76}];2 ;SellerWebaddressIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerWebaddressIdentifier := COPYSTR(CompanyInfo."Home Page",1,35);
                                                                               END;
                                                                                }

    { [{15B1FE7F-5281-4F14-97F1-05E2C7B1BE68}];2 ;SellerAccountDetails;Element ;Text     }

    { [{E685DC78-1249-49BA-A21C-8B683AB68CC5}];3 ;SellerAccountID     ;Element ;Text    ;
                                                  TextType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF FinvoiceSetup."IBAN Account No." <> '' THEN BEGIN
                                                                                   IdentificationSchemeNameID := 'IBAN';
                                                                                   SellerAccountID := COPYSTR(FinvoiceSetup."IBAN Account No.",1,35);
                                                                                 END ELSE BEGIN
                                                                                   SellerAccountID := COPYSTR(CompanyInfo.IBAN,1,35);
                                                                                   IdentificationSchemeNameID := 'IBAN';
                                                                                 END;
                                                                               END;
                                                                                }

    { [{E5E024D6-5B1B-4783-8F2F-F7EC0AA04BA7}];4 ;IdentificationSchemeName;Attribute;Text;
                                                  VariableName=IdentificationSchemeNameID;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IdentificationSchemeNameID := FORMAT(SellCustomer."Account Type");
                                                                               END;
                                                                                }

    { [{6EA748B6-4631-4049-9508-022DC3A397B8}];3 ;SellerBic           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerBic := COPYSTR(CompanyInfo."SWIFT Code",1,11);
                                                                               END;
                                                                                }

    { [{56F1A50A-93B7-4A0B-A891-DB8D99953ECA}];4 ;IdentificationSchemeName;Attribute;Text;
                                                  VariableName=IdentificationSchemeNameBIC;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentificationSchemeNameBIC := 'BIC';
                                                                               END;
                                                                                }

    { [{FDDD3CAE-D02B-490C-B6FB-813503316015}];1 ;InvoiceSenderPartyDetails;Element;Text }

    { [{B682676F-3D82-48C5-A8FA-7064B905C8FE}];2 ;InvoiceSenderPartyIdentifier;Element;Text }

    { [{031CB3B1-D217-49D6-986A-37695208B70D}];2 ;InvoiceSenderOrganisationName;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceSenderOrganisationName := COPYSTR(CompanyInfo.Name,1,35);
                                                                               END;
                                                                                }

    { [{F48BAD6E-7571-4A03-A020-0137FB166F60}];2 ;InvoiceSenderOrganisationTaxCode;Element;Text }

    { [{214D190F-276C-4324-AFE0-9CBD135D56F6}];1 ;InvoiceRecipientPartyDetails;Element;Text }

    { [{0D4665F0-2662-49B0-B074-362D5FDBC4C3}];2 ;InvoiceRecipientPartyIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientPartyIdentifier := COPYSTR(BillCustomer."Business Identity Code",1,35);
                                                                               END;
                                                                                }

    { [{FAB86B7D-CCC4-4F2F-BA9D-DAA42397B49A}];2 ;InvoiceRecipientOrganisationName;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientOrganisationName := COPYSTR("Sales Invoice Header"."Bill-to Name",1,35);
                                                                               END;
                                                                                }

    { [{116B9DED-704E-4659-9B6C-CDFCCA659BB9}];2 ;InvoiceRecipientOrganisationTaxCode;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientOrganisationTaxCode := COPYSTR(BillCustomer."VAT Registration No.",1,35);
                                                                               END;
                                                                                }

    { [{68BC8536-3D32-4E46-BEBF-D2969C939A2F}];2 ;InvoiceRecipientPostalAddressDetails;Element;Text }

    { [{492282F1-78B7-4143-B93B-145CDCE32FB5}];3 ;InvoiceRecipientStreetName;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientStreetName := COPYSTR("Sales Invoice Header"."Bill-to Address",1,35);
                                                                               END;
                                                                                }

    { [{8910FC96-5828-4804-AD91-1BB212C7714F}];3 ;InvoiceRecipientTownName;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientTownName := COPYSTR("Sales Invoice Header"."Bill-to City",1,35);
                                                                               END;
                                                                                }

    { [{E2EEC30E-8616-4B08-823A-50F8A8E3C57A}];3 ;InvoiceRecipientPostCodeIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientPostCodeIdentifier := COPYSTR("Sales Invoice Header"."Bill-to Post Code",1,35);
                                                                               END;
                                                                                }

    { [{1254FF03-D55C-4F81-AFED-E865116E17AA}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCode2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Bill-to Country/Region Code" <> '' THEN
                                                                                   CountryCode2 := COPYSTR("Sales Invoice Header"."Bill-to Country/Region Code",1,2)
                                                                                 ELSE
                                                                                   CountryCode2 := 'FI';
                                                                               END;
                                                                                }

    { [{5121B9C7-F4D4-460E-BC47-B4F8CE11E611}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryName2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Country.GET(CountryCode2);
                                                                                 CountryName2 := COPYSTR(Country.Name,1,35);
                                                                               END;
                                                                                }

    { [{7FEC1A76-F782-40D9-8A8E-9C1550B672ED}];1 ;InvoiceRecipientSiteCode;Element;Text  }

    { [{AB4BF62E-4081-4B10-B27A-6E4E190B8933}];1 ;InvoiceRecipientContactPersonName;Element;Text }

    { [{E2B6A5D1-7FA8-4AFC-96CB-253C7178DFF9}];1 ;InvoiceRecipientContactPersonFunction;Element;Text }

    { [{08BED657-3EEC-4229-B32A-EC96548BFFBB}];1 ;InvoiceRecipientContactPersonDepartment;Element;Text }

    { [{877A5646-B265-4F37-9C8B-FCD7CBE61999}];1 ;InvoiceRecipientLanguageCode;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientLanguageCode := gtxInvoiceLanguageCode;
                                                                               END;
                                                                                }

    { [{6CFB8C01-4152-4DBE-8163-DBEA184827AF}];1 ;InvoiceRecipientCommunicationDetails;Element;Text }

    { [{6D047DA5-3D4F-4E9B-BA87-07FAD2B75D6F}];1 ;BuyerPartyDetails   ;Element ;Text     }

    { [{9655C144-548D-4060-B225-59A3706C4C5D}];2 ;BuyerPartyIdentifier;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerPartyIdentifier := COPYSTR(SellCustomer."Business Identity Code",1,35);
                                                                               END;
                                                                                }

    { [{70F821FA-0DFD-44B2-BA8A-3D228C142D84}];2 ;BuyerOrganisationName;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerOrganisationName := COPYSTR("Sales Invoice Header"."Sell-to Customer Name",1,70);
                                                                               END;
                                                                                }

    { [{798B9C0A-45E7-4837-B397-3E2DD0AFB8FA}];2 ;BuyerOrganisationDepartment;Element;Text }

    { [{038D7E49-FBA1-403F-9B3F-1C7C69F4715C}];2 ;BuyerOrganisationTaxCode;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerOrganisationTaxCode := COPYSTR(SellCustomer."VAT Registration No.",1,35);
                                                                               END;
                                                                                }

    { [{13DC7474-55E3-4ADE-BDAD-607B7BA5A39F}];2 ;BuyerCode           ;Element ;Text     }

    { [{A388150D-A58C-4D4E-A513-CADD797EB78A}];2 ;BuyerPostalAddressDetails;Element;Text }

    { [{9AE81620-E923-49A0-947B-23AB1A08F90C}];3 ;BuyerStreetName     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerStreetName := COPYSTR("Sales Invoice Header"."Sell-to Address",1,35);
                                                                               END;
                                                                                }

    { [{44945325-1923-4956-91D9-88A5998336A4}];3 ;BuyerTownName       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerTownName := COPYSTR("Sales Invoice Header"."Sell-to City",1,35);
                                                                               END;
                                                                                }

    { [{00C68842-E1FE-4CC0-994D-4FBD4C8E24DC}];3 ;BuyerPostCodeIdentifier;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerPostCodeIdentifier := COPYSTR("Sales Invoice Header"."Sell-to Post Code",1,35);
                                                                               END;
                                                                                }

    { [{D87A2583-AC2B-4AD2-9660-438A5625F28A}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCode3;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Sell-to Country/Region Code" <> '' THEN
                                                                                   CountryCode3 := COPYSTR("Sales Invoice Header"."Sell-to Country/Region Code",1,2)
                                                                                 ELSE
                                                                                   CountryCode3 := 'FI';
                                                                               END;
                                                                                }

    { [{4293E56C-5F11-4CE2-A743-A396DD3C7DFC}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryName3;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF ("Sales Invoice Header"."Sell-to Country/Region Code" <> '') AND
                                                                                    (Country.GET("Sales Invoice Header"."Sell-to Country/Region Code")) THEN
                                                                                   CountryName3 := COPYSTR(Country.Name,1,35)
                                                                                 ELSE
                                                                                   CountryName3 := 'Suomi';
                                                                               END;
                                                                                }

    { [{E5A527AA-9AD8-441B-8FDF-CF42DFDCC4C4}];1 ;BuyerOrganisationUnitNumber;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerOrganisationUnitNumber := COPYSTR(SellCustomer."EDI Code",1,35);
                                                                               END;
                                                                                }

    { [{E22C7C8C-1F2B-4E02-AFD0-C5837B0BD81A}];1 ;BuyerSiteCode       ;Element ;Text     }

    { [{50417C47-6E9D-4B95-B541-A638F03BD23A}];1 ;BuyerContactPersonName;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerContactPersonName := COPYSTR("Sales Invoice Header"."Sell-to Contact",1,35);
                                                                               END;
                                                                                }

    { [{E37B78D0-9F4B-4919-898B-9FAC8F8C6332}];1 ;BuyerContactPersonFunction;Element;Text }

    { [{0664580E-0F0F-4F36-9ED4-CBD88EE52014}];1 ;BuyerContactPersonDepartment;Element;Text }

    { [{08C750DC-54A9-4363-AECE-028CA2B66090}];1 ;BuyerCommunicationDetails;Element;Text }

    { [{57791FFC-7906-4AF2-835C-28A2BFD4B062}];1 ;DeliveryPartyDetails;Element ;Text     }

    { [{11FAB08D-43FE-4E55-9483-8E789F042786}];2 ;DeliveryPartyIdentifier;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Ship-to Code" <> '' THEN BEGIN
                                                                                   ShipToAddress.GET("Sales Invoice Header"."Sell-to Customer No.", "Sales Invoice Header"."Ship-to Code");
                                                                                   DeliveryPartyIdentifier := COPYSTR(ShipToAddress."EDI Code",1,35);
                                                                                 END ELSE BEGIN
                                                                                   DeliveryPartyIdentifier := COPYSTR(SellCustomer."EDI Code",1,35);
                                                                                 END;
                                                                               END;
                                                                                }

    { [{D14A0ED6-2C29-44C2-981F-D3F192FD7887}];2 ;DeliveryOrganisationName;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryOrganisationName := COPYSTR("Sales Invoice Header"."Ship-to Name",1,35);
                                                                               END;
                                                                                }

    { [{7756E7FF-0FD1-4F46-BD84-C8FE6D6E2793}];2 ;DeliveryOrganisationTaxCode;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Ship-to Code" <> '' THEN BEGIN
                                                                                   ShipToAddress.GET("Sales Invoice Header"."Sell-to Customer No.", "Sales Invoice Header"."Ship-to Code");
                                                                                   DeliveryOrganisationTaxCode := COPYSTR(ShipToAddress."VAT Registration No.",1,35);
                                                                                 END ELSE BEGIN
                                                                                   DeliveryOrganisationTaxCode := COPYSTR(SellCustomer."VAT Registration No.",1,35);
                                                                                 END;
                                                                               END;
                                                                                }

    { [{6C4D272A-7AAC-48CF-983E-7CA3C911F12D}];2 ;DeliveryCode        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryCode := COPYSTR(ShipToAddress."EDI Code",1,35);
                                                                               END;
                                                                                }

    { [{D300171F-27E4-4DBA-8EE6-0C6F5996D4B1}];3 ;IdentifierType      ;Attribute;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentifierType := 'EDI';
                                                                               END;
                                                                                }

    { [{08F1B660-9B97-44CF-9488-3D439C392A92}];2 ;DeliveryPostalAddressDetails;Element;Text }

    { [{0F6CA425-1143-4FCE-9555-21262D0BA80E}];3 ;DeliveryStreetName  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryStreetName := COPYSTR("Sales Invoice Header"."Ship-to Address",1,35);
                                                                               END;
                                                                                }

    { [{171487EE-B4FB-49D9-A42D-000266D314A0}];3 ;DeliveryTownName    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryTownName := COPYSTR("Sales Invoice Header"."Ship-to City",1,35);
                                                                               END;
                                                                                }

    { [{BAB497E5-42E7-4C27-85A8-55D8D6DFFC29}];3 ;DeliveryPostCodeIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryPostCodeIdentifier := COPYSTR("Sales Invoice Header"."Ship-to Post Code",1,35);
                                                                               END;
                                                                                }

    { [{6717D29D-E78E-4666-9703-90A16FE4F0FE}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCode4;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Ship-to Country/Region Code" <> '' THEN
                                                                                   CountryCode4 := COPYSTR("Sales Invoice Header"."Ship-to Country/Region Code",1,2)
                                                                                 ELSE
                                                                                   CountryCode4 := 'FI';
                                                                               END;
                                                                                }

    { [{F130B913-FADE-4F95-B2E3-9AE36B96063F}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryName4;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF Country.GET("Sales Invoice Header"."Ship-to Country/Region Code") THEN
                                                                                   CountryName4 := COPYSTR(Country.Name,1,35)
                                                                                 ELSE
                                                                                   Country.Name := 'Suomi';
                                                                               END;
                                                                                }

    { [{FF558CA0-8E98-4014-9516-E6AA932DBA5A}];1 ;DeliveryOrganisationUnitNumber;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Ship-to Code" <> '' THEN BEGIN
                                                                                   DeliveryOrganisationUnitNumber := COPYSTR(ShipToAddress."EDI Code",1,35);
                                                                                   DeliveryContactPersonName := COPYSTR("Sales Invoice Header"."Ship-to Contact",1,35);
                                                                                   DeliveryPhoneNumberIdentifier := COPYSTR(ShipToAddress."Phone No.",1,35);
                                                                                   DeliveryEmailaddressIdentifier := COPYSTR(ShipToAddress."E-Mail",1,70);
                                                                                 END ELSE BEGIN
                                                                                   DeliveryOrganisationUnitNumber := COPYSTR(SellCustomer."EDI Code",1,35);
                                                                                   DeliveryContactPersonName := COPYSTR("Sales Invoice Header"."Ship-to Contact",1,35);
                                                                                   DeliveryPhoneNumberIdentifier := COPYSTR(SellCustomer."Phone No.",1,35);
                                                                                   DeliveryEmailaddressIdentifier := COPYSTR(SellCustomer."E-Mail",1,70);
                                                                                 END;
                                                                               END;
                                                                                }

    { [{4AC86C82-62C9-436E-A076-F15317B64113}];1 ;DeliverySiteCode    ;Element ;Text     }

    { [{3888BC30-3964-4DC9-9D08-D9B16135AF14}];1 ;DeliveryContactPersonName;Element;Text }

    { [{30F4DD45-7D1C-45B1-BCA8-84E70D0431CE}];1 ;DeliveryContactPersonFunction;Element;Text }

    { [{A24AAC50-B292-49FE-97E2-3C31EBA5805B}];1 ;DeliveryContactPersonDepartment;Element;Text }

    { [{742A569E-F098-47B0-80C8-9402710BB148}];1 ;DeliveryCommunicationDetails;Element;Text }

    { [{2E024A68-BA42-478F-95F2-F25FE82AF327}];2 ;DeliveryPhoneNumberIdentifier;Element;Text }

    { [{4272DB1A-0FEA-4929-A329-81779E23399F}];2 ;DeliveryEmailaddressIdentifier;Element;Text }

    { [{5512C7B5-820A-4273-87D1-43BE883B1E3E}];1 ;DeliveryDetails     ;Element ;Text     }

    { [{67631DBE-AD50-4746-ACD7-FEF440FBFAFE}];2 ;DeliveryDate        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryDate := FormatDate("Sales Invoice Header"."Shipment Date");
                                                                               END;
                                                                                }

    { [{8151E9CD-5BD1-4B3A-AD2A-F6D60EA54C40}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format3;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format3 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{10A1E9D6-41B1-4C37-8F39-A58AE51B7041}];2 ;DeliveryMethodText  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF recShippingAgent.GET("Sales Invoice Header"."Shipping Agent Code") THEN
                                                                                   DeliveryMethodText := COPYSTR(recShippingAgent.Name,1,512);
                                                                               END;
                                                                                }

    { [{9C504982-B447-488E-A34B-17C0FFA1C5DD}];2 ;DeliveryTermsText   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF recShipmentMethod.GET("Sales Invoice Header"."Shipment Method Code") THEN
                                                                                   DeliveryTermsText := COPYSTR(recShipmentMethod.Description,1,512);
                                                                               END;
                                                                                }

    { [{C11FA7BA-C483-448D-9151-CAFD121F6261}];1 ;AnyPartyDetails     ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{182DED4F-51CD-456E-80DE-E35277AE079E}];2 ;AnyPartyText        ;Element ;Text     }

    { [{896A3A5C-F97C-427A-BE5D-A48BF002E7A7}];3 ;AnyPartyCode        ;Attribute;Text   ;
                                                  VariableName=AnyPartyCodeAttr }

    { [{45403F79-CD44-4186-AD4C-26277D4B53AE}];2 ;AnyPartyIdentifier  ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{EEC816EC-1B9C-48B3-A11D-CA6147439D4F}];2 ;AnyPartyOrganisationName;Element;Text  }

    { [{326C4316-AE39-4444-BA30-88B925DE6CA7}];2 ;AnyPartyOrganisationDepartment;Element;Text;
                                                  MinOccurs=Zero }

    { [{233152E9-1539-4AFE-99C0-38FEA1D259D1}];2 ;AnyPartyOrganisationTaxCode;Element;Text;
                                                  MinOccurs=Zero }

    { [{2FDCC21F-CEEE-4AA4-89B4-BF3750A2FF24}];2 ;AnyPartyCode        ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{CF4C72A6-8EE5-4725-A32B-96CF3B09ED84}];3 ;IdentifierType      ;Attribute;Text   ;
                                                  VariableName=IdentifierTypeAnyPartyCode;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // <xs:attribute name="IdentifierType">
                                                                                 // <xs:simpleType>
                                                                                 // <xs:restriction base="xs:token">
                                                                                 // <xs:enumeration value="DUNS"/>
                                                                                 // <xs:enumeration value="GLN"/>
                                                                                 // <xs:enumeration value="HETU"/>
                                                                                 // <xs:enumeration value="EDI"/>
                                                                                 // </xs:restriction>
                                                                                 // </xs:simpleType>
                                                                                 // </xs:attribute>

                                                                                 IdentifierTypeAnyPartyCode := 'EDI';
                                                                               END;
                                                                                }

    { [{01186F70-ECFD-4C89-94E6-68C43F08806F}];2 ;AnyPartyContactPersonName;Element;Text;
                                                  MinOccurs=Zero }

    { [{DD7DA907-6BA3-4794-A7FA-E5DCA7F75EF5}];2 ;AnyPartyContactPersonFunction;Element;Text;
                                                  MinOccurs=Zero }

    { [{011A9F44-4B64-4CCE-BA0E-413AFDA1919F}];2 ;AnyPartyContactPersonDepartment;Element;Text;
                                                  MinOccurs=Zero }

    { [{A7AEB3FE-F5AD-4C55-AA74-846D557E3C5C}];2 ;AnyPartyCommunicationDetails;Element;Text;
                                                  MinOccurs=Zero }

    { [{40C4185C-086C-4F84-ADA4-FB1B9EF54C19}];2 ;AnyPartyPostalAddressDetails;Element;Text;
                                                  MinOccurs=Zero }

    { [{2203B03E-D9F5-46FD-A5DC-A629505B3723}];3 ;AnyPartyStreetName  ;Element ;Text     }

    { [{F2ABA183-74B4-4DB6-9286-DF71956B7A61}];3 ;AnyPartyTownName    ;Element ;Text     }

    { [{AB2F6523-B2BA-4DF9-8342-78343BB4E216}];3 ;AnyPartyPostCodeIdentifier;Element;Text }

    { [{EB25CEC3-52BB-4C84-8945-37C772258532}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCodeAnyParty;
                                                  MinOccurs=Zero }

    { [{57F0797C-2048-4A3E-8897-01CA0EBAEDB3}];3 ;CountryName         ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{8AFD614E-4455-4852-A71A-F830EABA1F7C}];3 ;AnyPartyPostOfficeBoxIdentifier;Element;Text;
                                                  MinOccurs=Zero }

    { [{13975EE8-5A3F-4B16-8EE0-AA051CDAC510}];1 ;InvoiceDetails      ;Element ;Text     }

    { [{D12265D8-24B6-4878-AF66-82AACC5BF637}];2 ;InvoiceTypeCode     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceTypeCode := 'INV01';
                                                                                 //InvoiceTypeCode := 'TES01';
                                                                               END;
                                                                                }

    { [{6BE66163-63BC-4DEB-99F5-C4F1381BA640}];3 ;CodeListAgencyIdentifier;Attribute;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CodeListAgencyIdentifier := 'SPY';
                                                                               END;
                                                                                }

    { [{247E4562-F571-4100-97D7-5E296CF21EC8}];2 ;InvoiceTypeText     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                  InvoiceTypeText := 'LASKU';
                                                                                 // InvoiceTypeText := 'TESTILASKU';
                                                                               END;
                                                                                }

    { [{E9A18CC5-1947-48EE-9738-24FD0AB927B2}];2 ;OriginCode          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OriginCode := 'Original';
                                                                               END;
                                                                                }

    { [{E5308BF5-2D74-4D1F-B979-717841F0011E}];2 ;OriginText          ;Element ;Text     }

    { [{9EC5FF0F-D3DF-4462-8FA2-B7358096AA07}];2 ;InvoiceNumber       ;Element ;Text    ;
                                                  VariableName=<InvoiceNumber>;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                  "<InvoiceNumber>" := COPYSTR("Sales Invoice Header"."No.",1,20);
                                                                               END;
                                                                                }

    { [{BD9B230E-F7D4-435B-808E-7593E4C3EA1E}];2 ;InvoiceDate         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceDate := FormatDate("Sales Invoice Header"."Document Date");
                                                                               END;
                                                                                }

    { [{C36A5C01-DEE9-4FB9-95A7-73BDA6318FFF}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format1 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{ECAFC50A-CF32-4230-A03B-AD5169640E56}];2 ;OriginalInvoiceNumber;Element;Text    ;
                                                  VariableName=OriginalInvoiceNumber1;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF OriginalInvoiceNumber1 = '' THEN
                                                                                    currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2161C847-829B-44E5-8DBF-8F82FACA335B}];2 ;InvoicingPeriodStartDate;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{35EC3C73-A401-4AC8-8544-9FF9758D10AE}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format4;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format4 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{44F23F2A-CD78-477F-A8ED-D1A4384C3DFC}];2 ;InvoicingPeriodEndDate;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{9FEB003D-51DB-4F2B-89F0-7C338912CA64}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format5;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format5 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{67866832-F303-47A1-AD87-63A983D97BE0}];2 ;SellerReferenceIdentifier;Element;Text }

    { [{160ADB78-F622-42EC-9489-1A4ECDE800FE}];2 ;SellerReferenceIdentifierUrlText;Element;Text }

    { [{EDFBA2F7-E572-4578-8671-08785868FB38}];2 ;BuyersSellerIdentifier;Element;Text    }

    { [{7D313685-ECB2-479C-AAC5-6D265807A05A}];2 ;SellersBuyerIdentifier;Element;Text    }

    { [{E8062BD5-A0FB-41A5-BCEF-BA8EE0E395CC}];2 ;OrderIdentifier     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OrderIdentifier := COPYSTR("Sales Invoice Header"."External Document No.",1,35);
                                                                               END;
                                                                                }

    { [{9F5384AF-CEB4-4E1B-8A47-377BE077BD9A}];2 ;OrderIdentifierUrlText;Element;Text    }

    { [{8D9B77CA-5AB6-40D7-85A0-BF96EC2F28A7}];2 ;OrderDate           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{A44E9C31-1207-45DB-B1C5-7F67E280D47B}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format6;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format6 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{8F161760-8DCB-4039-BED2-0CCE39869D0F}];2 ;OrdererName         ;Element ;Text     }

    { [{2F2BDFFE-104E-4B44-BA8A-D3B667FD18AA}];2 ;SalesPersonName     ;Element ;Text     }

    { [{B2AA2062-1FDA-4E70-AA34-137FB1FF6EF0}];2 ;OrderConfirmationIdentifier;Element;Text }

    { [{F4484FB5-44E9-4C36-877E-84477F771367}];2 ;OrderConfirmationDate;Element;Text    ;
                                                  VariableName=<OrderConfirmationDate>;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AF3ECE40-B319-4A50-ACEA-1C46415FE517}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format7;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format7 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{06DEA10F-31B0-4480-A18C-BB41EAD7EFD8}];2 ;AgreementIdentifier ;Element ;Text     }

    { [{2AFB2B58-E92A-4E09-B603-B6EC5C334FC4}];2 ;AgreementIdentifierUrlText;Element;Text }

    { [{8529697E-8403-4B54-B418-2C8A567C1B75}];2 ;AgreementTypeText   ;Element ;Text     }

    { [{5ED4EC0F-7ED7-4480-9E33-4588F94F0A34}];2 ;AgreementTypeCode   ;Element ;Text     }

    { [{8E3B3953-F5A8-4B8F-AEF1-6F8FD3D11CBA}];2 ;AgreementDate       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{633B0432-285B-40B1-AA08-C1E80069FEE4}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format8;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format8 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{1D7C737F-00CD-4542-B50B-30B79D4F4BAF}];2 ;NotificationIdentifier;Element;Text    }

    { [{FFC4A7C1-2225-4249-AB84-216DD7553642}];2 ;NotificationDate    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{33D55658-9E4F-4114-B014-6CC3568893DD}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format9;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format9 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{C13699E9-0188-4D49-81F9-D7E7CEEE7D39}];2 ;RegistrationNumberIdentifier;Element;Text }

    { [{6C658DB0-847B-4150-ADAF-A152ABD29F0E}];2 ;ControllerIdentifier;Element ;Text     }

    { [{63A4C020-1595-4021-A571-2313195D4F83}];2 ;ControllerName      ;Element ;Text     }

    { [{92302601-AD7C-4680-BD4D-EBC58BAD4E07}];2 ;ControlDate         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{A4B640E9-A583-4E7B-9962-F0E064BE8C34}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format10;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format10 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{4B4AAA9C-0CE4-4C32-BD0F-BE7790474C8B}];2 ;BuyerReferenceIdentifier;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerReferenceIdentifier := COPYSTR("Sales Invoice Header"."Your Reference",1,35);
                                                                               END;
                                                                                }

    { [{6B25F86A-C1AA-4EB6-9C95-126BCED88D45}];2 ;ProjectReferenceIdentifier;Element;Text }

    { [{9B96D3CB-55AF-46A9-B082-D3CBFAD3A1AB}];2 ;DefinitionDetails   ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{C512B937-3CFC-44F5-979C-A2A96ED2B1AE}];3 ;DefinitionHeaderText;Element ;Text     }

    { [{FBE17F6B-179E-4C0A-8F4F-575327AEF27D}];4 ;DefinitionCode      ;Attribute;Text   ;
                                                  Occurrence=Optional }

    { [{75AA27D5-5FBC-4DC0-AEFE-8EA9AE7F4160}];3 ;DefinitionValue     ;Element ;Text     }

    { [{D73E93E2-3ED0-4C21-B075-5636BD297A23}];2 ;InvoiceTotalVatExcludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceTotalVatExcludedAmount := FormatDecimal(gInvTotalExcVAT);
                                                                               END;
                                                                                }

    { [{F8E015F6-29E7-4E8A-B3D0-BA66D8BE72A4}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier8;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier8 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{5A79FB2C-2EBD-465F-99D8-4A8E375B4740}];2 ;InvoiceTotalVatAmount;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceTotalVatAmount := FormatDecimal(gInvTotalVAT);
                                                                               END;
                                                                                }

    { [{F94242D8-886A-49CA-A4E1-E637E9F86081}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier11;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier11 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{55885038-E8CA-4173-9CCE-669E65EB404A}];2 ;InvoiceTotalVatIncludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceTotalVatIncludedAmount := FormatDecimal(gInvTotalIncVAT);
                                                                               END;
                                                                                }

    { [{EAB9331E-0012-445D-9DDC-A1CF70E5FF32}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier1 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{685B4179-5DD4-486E-9E70-81B68E05A4E1}];2 ;InvoiceTotalRoundoffAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3D24557F-395C-45FF-9A4F-FF6F2F06F741}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier12;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier12 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{69F22E43-B70F-4CAD-A2B0-00DFFD14C08B}];2 ;ExchangeRate        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{781E1A3E-A131-4759-B740-5536F1500A0A}];2 ;OtherCurrencyAmountVatExcludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2686F528-B67D-469C-8D8D-6AC45C3D2540}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier13;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier13 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{9888638A-B853-4519-98AB-7C9D28C7095A}];2 ;OtherCurrencyAmountVatIncludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{4B9B4C51-8956-4255-95F3-6124DE1E7440}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier14;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier14 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{909251A9-4BB1-43EA-97B9-BD396A9BB925}];2 ;CreditLimitAmount   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F2B3CBE8-DBE5-4595-AC27-AD7CFE598DBE}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier15;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier15 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{36837D93-90B6-4451-BA5D-F675523425D8}];2 ;CreditInterestPercent;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AEBE91DA-47BA-493B-8DC6-D1AF8244AD39}];2 ;OperationLimitAmount;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{0F736072-EE63-4359-9B1C-035FE0EB70A6}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier16;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier16 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{19393F0B-4F07-4BCA-8AB8-BA4B4FD35D90}];2 ;MonthlyAmount       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3FC70511-271F-4C7B-BFD1-39B937D0D774}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier17;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier17 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{6ADC4F30-CE4B-434A-AC86-856BDE90E48C}];2 ;ShortProposedAccountIdentifier;Element;Text }

    { [{2F700F83-3A17-48C5-BBA2-493B76119E0D}];2 ;NormalProposedAccountIdentifier;Element;Text }

    { [{B4D88D9D-6C05-4C68-994C-9BD7B52CF36F}];2 ;ProposedAccountText ;Element ;Text     }

    { [{1015EC20-61E6-4280-8B05-FCB2290540F3}];2 ;AccountDimensionText;Element ;Text     }

    { [{EC9C6446-0074-4D07-B344-A37878DC2CE8}];2 ;SellerAccountText   ;Element ;Text     }

    { [{C4FE2AB0-E6C8-4F73-BDF7-E7229DAD9CC8}];2 ;VatSpecificationDetails;Element;Table ;
                                                  VariableName=VATAmountLine;
                                                  SourceTable=Table290;
                                                  Temporary=Yes }

    { [{DE7CCAB9-9E0A-4B03-BA3F-ADDD98A4C044}];3 ;VatBaseAmount       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VatBaseAmount := FormatDecimal(VATAmountLine."VAT Base");
                                                                               END;
                                                                                }

    { [{EB03BE4F-F3D4-4DDE-8E04-43FAF8237E53}];4 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier9;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier9 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{3B509E1C-D480-4AD7-A463-5C50BB00F22C}];3 ;VatRatePercent      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VatRatePercent := FormatQty(VATAmountLine."VAT %");
                                                                               END;
                                                                                }

    { [{2365DAC3-728A-4CD8-8850-00390BD952AC}];3 ;VatRateAmount       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VatRateAmount := FormatDecimal(VATAmountLine."VAT Amount");
                                                                               END;
                                                                                }

    { [{61AADF30-DB95-4230-ABB7-25D91EDD2C12}];4 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier10;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier10 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{40CBF05F-5446-46D3-BD04-D587B55A9B8E}];2 ;InvoiceFreeText     ;Element ;Text     }

    { [{3D603A62-4FA8-49AE-9D83-220F76669ACF}];2 ;InvoiceVatFreeText  ;Element ;Text     }

    { [{299F419C-D59B-47E8-9AB1-58A808A4D258}];2 ;PaymentTermsDetails ;Element ;Text     }

    { [{72374FC1-745E-4F16-9B37-07322C9216F4}];2 ;DiscountDetails     ;Element ;Text     }

    { [{7C704E0E-D1E3-4B4F-8D1C-8CC4B269D1EB}];1 ;PaymentStatusDetails;Element ;Text     }

    { [{9F2988BD-3FD2-4BE6-9229-8D13F568C1E9}];1 ;PartialPaymentDetails;Element;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{11EC71CA-10CE-4DA4-80BD-67427A4172A1}];2 ;PaidAmount          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{D6908819-D7D5-42FA-89A4-8ADAC499BE87}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentPaidAmount;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentPaidAmount := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{BEC64E92-7922-4688-A85F-E12C9B13A87E}];2 ;PaidVatExcludedAmount;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{5C6EED30-663A-462C-BC9D-69461D106871}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentPaidVatExcAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentPaidVatExcAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{B446E601-6219-430B-B979-55F5931FB298}];2 ;UnPaidAmount        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{A83B6996-B989-4ADF-93A8-A183B3755777}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentUnPaidAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentUnPaidAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{5BACAEAB-3F2C-4E90-9E2A-D117F837FA4A}];2 ;UnPaidVatExcludedAmount;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{94380511-E23B-4BE4-B650-05190C212665}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentUnPaidVatExcAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentUnPaidVatExcAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{41647A6D-6F61-4BDD-971F-0D8FEC20EA96}];2 ;InterestPercent     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3E6DF8DC-6111-40C4-BCBE-9839196223FD}];2 ;ProsessingCostsAmount;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{27DFA043-9674-48A1-ADAA-CD276885A4FB}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentProssCostAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentProssCostAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{B814AD71-ADBD-4E44-9D3F-D17ACB7C9E1E}];2 ;PartialPaymentVatIncludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{6199B4A7-ED19-4717-A052-938BB559C2A2}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentPartPaymVatIncAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentPartPaymVatIncAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{C3CB8177-870A-47E9-BBE3-29E1EB068B53}];2 ;PartialPaymentVatExcludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{6BC3EA36-BCB3-43F0-8D77-F8B56776F5A7}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentPartPaymVatExcAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentPartPaymVatExcAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{7D754B33-6D03-460C-B33E-29162A16271C}];2 ;PartialPaymentDueDate;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{D492FE57-0BCA-4EDB-9668-F839C1E6197A}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=FormatPartPaymentDueDate;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 FormatPartPaymentDueDate := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{8F81CEDC-3251-4407-8751-D6599405381E}];2 ;PartialPaymentReferenceIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{B9FEB4CF-3A03-45FF-B79A-C58D5A8126CF}];1 ;FactoringAgreementDetails;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F930D770-8E63-463D-9CE2-5A69E9668379}];2 ;FactoringAgreementIdentifier;Element;Text }

    { [{C8F51365-3BD0-4D3D-B063-1073D3510F9A}];2 ;TransmissionListIdentifier;Element;Text }

    { [{8F0E0D9B-FC26-45F0-B768-95866002250C}];2 ;EndorsementClauseCode;Element;Text     }

    { [{6C1AA58D-B28D-4733-98DE-1B225ABED5A4}];2 ;FactoringTypeCode   ;Element ;Text     }

    { [{B98F4943-C4D2-433B-A8FD-410F1DB55A01}];2 ;FactoringFreeText   ;Element ;Text     }

    { [{0709BAA2-5D5F-4B77-A987-614E5C031A5A}];2 ;FactoringPartyIdentifier;Element;Text  }

    { [{D344A0DF-C09C-4849-99EE-2A3332640B85}];2 ;FactoringPartyName  ;Element ;Text     }

    { [{A10D94F1-8A8A-4380-B776-5A006E49AD69}];2 ;FactoringPartyPostalAddressDetails;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{84803911-855C-4454-B26F-CC30458114D6}];3 ;FactoringPartyStreetName;Element;Text  }

    { [{AC23C8DC-DEED-4EA7-A571-50369E24ABCF}];3 ;FactoringPartyTownName;Element;Text    }

    { [{4182CF81-A0BB-4910-80CE-8828002B7F8F}];3 ;FactoringPartyPostCodeIdentifier;Element;Text }

    { [{20A4F29E-D82F-4FA6-9677-E6FB342182FE}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCodeFactPartyPostAddr }

    { [{52EAB92C-17FA-4112-AB6F-F2A50C6E4480}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryNameFactPartyPostAddr }

    { [{78DA3886-CC1C-4F21-8247-434B9B0D14F5}];3 ;FactoringPartyPostOfficeBoxIdentifier;Element;Text }

    { [{44BA054D-CC4E-471A-BEBA-076B6CED53E7}];1 ;VirtualBankBarcode  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IF "Sales Cr.Memo Header"."Reference No." <> '' THEN
                                                                                 //  VirtualBankBarcode := COPYSTR('4' + DELCHR(CompanyInfo.IBAN,'=','FI ') +
                                                                                 //  ConvTotal(gInvTotalIncVAT) + '000' + FillLeadingZero("Sales Cr.Memo Header"."Reference No.", 20) +
                                                                                 //  FORMAT("Sales Cr.Memo Header"."Due Date",0,'<Year,2><Month,2><Day,2>'),1,512);
                                                                               END;
                                                                                }

    { [{E195123B-0741-48A8-9BE5-676EC0F01598}];1 ;InvoiceRow          ;Element ;Table   ;
                                                  SourceTable=Table113;
                                                  SourceTableView=SORTING(Field3,Field4)
                                                                  ORDER(Ascending);
                                                  LinkFields=Field3=FIELD(Field3);
                                                  LinkTable=Sales Invoice Header }

    { [{C53F089A-A972-489C-BDD3-A192C292CEA1}];2 ;RowSubIdentifier    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{45760A02-964D-41F3-A95C-4FDB72B492BA}];2 ;ArticleIdentifier   ;Element ;Text    ;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ArticleIdentifier := COPYSTR("Sales Invoice Line"."No.",1,35);
                                                                               END;
                                                                                }

    { [{54F01277-186A-4C9D-8932-83BA8E434F2F}];2 ;ArticleGroupIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{534AA4E2-4526-42B5-B028-35A5FE2F34D8}];2 ;ArticleName         ;Element ;Text    ;
                                                  DataType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ArticleName := COPYSTR("Sales Invoice Line".Description,1,100);
                                                                               END;
                                                                                }

    { [{AB3CE0E1-E7B2-4E06-B046-99BDB027DE9A}];2 ;ArticleInfoUrlText  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AFD0A3E5-CDB3-4128-812C-A361928D6023}];2 ;BuyerArticleIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3E262B03-63E9-4B81-AC70-41FB28B75722}];2 ;EanCode             ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{491C3ADB-E27B-41EA-BFE7-FBF45365C9B4}];2 ;RowRegistrationNumberIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{51BB29D2-8F29-48C9-8670-4E7C85C754BC}];2 ;SerialNumberIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{84A40A00-8F34-46BA-851B-AD6E561275AB}];2 ;RowActionCode       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2241D363-9870-4082-83A1-EC8FFC3CD034}];2 ;RowDefinitionDetails;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{6B5BE5BC-6EAA-429F-9E0C-5EE6A2210774}];3 ;RowDefinitionHeaderText;Element;Text   }

    { [{6687E05C-C3AD-49C4-AAAE-9172AE23E77B}];4 ;DefinitionCode      ;Attribute;Text   ;
                                                  VariableName=DefinitionCode2;
                                                  Occurrence=Optional }

    { [{AAFA8D33-70EC-4FDC-AA48-571896120CC1}];3 ;RowDefinitionValue  ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{4D025F3C-ABBE-4F40-AEE1-86280776BBC9}];2 ;OfferedQuantity     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{0F87192B-3E91-4CA3-9056-B8D495563454}];2 ;DeliveredQuantity   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveredQuantity := FormatQty("Sales Invoice Line".Quantity);
                                                                               END;
                                                                                }

    { [{B3F6F70E-C94A-4763-830E-A0D61720D810}];3 ;QuantityUnitCode    ;Attribute;Text   ;
                                                  VariableName=QuantityUnitCode1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 QuantityUnitCode1 := COPYSTR("Sales Invoice Line"."Unit of Measure",1,14);
                                                                               END;
                                                                                }

    { [{F60D3FB2-B144-46D2-826F-09FF5E1CB63A}];2 ;OrderedQuantity     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OrderedQuantity := FormatQty("Sales Invoice Line".Quantity);
                                                                               END;
                                                                                }

    { [{5FBDA75D-0E02-43CD-BB85-ECA9A92F6516}];3 ;QuantityUnitCode    ;Attribute;Text   ;
                                                  VariableName=QuantityUnitCode2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 QuantityUnitCode2 := COPYSTR("Sales Invoice Line"."Unit of Measure",1,14);
                                                                               END;
                                                                                }

    { [{36D56111-5584-444B-9CAE-12A891FDE573}];2 ;ConfirmedQuantity   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{4CEB07BA-E714-432A-985C-60D02EE71FB7}];2 ;PostDeliveredQuantity;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{FEE90149-83C3-4005-B392-CBBA1C34C073}];2 ;InvoicedQuantity    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{8F47B51F-2C28-4055-85BB-20B0F3A4624E}];2 ;CreditRequestedQuantity;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{06A8DE46-2C50-420D-A35B-03F9BEFCB49D}];2 ;ReturnedQuantity    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F8C327C9-7084-410D-8D78-8D8894B69627}];2 ;StartDate           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{77671245-3F39-4833-A92B-28F653D38777}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format11;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format11 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{BFF535C0-9FDD-4B46-8285-B8882EED518B}];2 ;EndDate             ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{9BC06D1B-2EB8-48F2-8AE1-B6A9A345519E}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format12;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format12 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{D25F39C4-0311-4F3F-8292-5CEF35E4E529}];2 ;UnitPriceAmount     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Invoice Header"."Prices Including VAT" THEN
                                                                                    UnitPriceAmount := FormatDecimal(ROUND(100 * "Sales Invoice Line"."Unit Price"/(100 + "Sales Invoice Line"."VAT %"), 0.01))
                                                                                   ELSE
                                                                                     IF "Sales Invoice Line"."Unit Price" = ROUND("Sales Invoice Line"."Unit Price", 0.01) THEN
                                                                                       UnitPriceAmount := FormatDecimal(ROUND("Sales Invoice Line"."Unit Price", 0.01))
                                                                                     ELSE
                                                                                       UnitPriceAmount := FormatDecimal(ROUND("Sales Invoice Line"."Unit Price", 0.00001));
                                                                               END;
                                                                                }

    { [{7F807ADA-65A0-4FB3-8962-576D4A2407CB}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier6;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier6 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{BB3ECFD9-57E5-4DDB-BA8A-7288804387EF}];3 ;UnitPriceUnitCode   ;Attribute;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 UnitPriceUnitCode := COPYSTR(InvCurrencyCode + '/' + "Sales Invoice Line"."Unit of Measure Code",1,14);
                                                                               END;
                                                                                }

    { [{ED4F0FEB-415F-4D52-80DC-DA472ED6A719}];2 ;UnitPriceVatIncludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{A2B629B8-BFBA-46EA-9F2F-790866557771}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier18;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier18 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{FF07515F-AED9-47EE-ACBF-DBB9BA416C54}];2 ;UnitPriceBaseQuantity;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{53932CD4-977F-4E26-856E-44921EE3E2EC}];2 ;RowIdentifier       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3B8DC59C-76CC-4C48-B523-188F00055E4E}];2 ;RowIdentifierUrlText;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{C416F6BF-91F0-4D46-A71C-8041CB4B2B84}];2 ;RowOrderPositionIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3D02CA49-AD55-496D-AC3F-442DD95D7270}];2 ;RowIdentifierDate   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{07702B6D-E471-4E7A-8D6D-028E970B6DF7}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format13;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format13 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{5CE07A1F-E4FD-4897-8E77-5BB9DCCC302B}];2 ;RowPositionIdentifier;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{011058DB-BF07-439D-A0BB-55687039CD8B}];2 ;OriginalInvoiceNumber;Element;Text    ;
                                                  VariableName=OriginalInvoiceNumber2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{13B3CADD-95CA-4F1A-B485-67607F34585D}];2 ;RowOrdererName      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{05094268-02FC-4531-ADA2-1D673585FD95}];2 ;RowSalesPersonName  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{50163123-6053-47F4-887E-32C1516552F4}];2 ;RowOrderConfirmationIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{04CB006F-7088-46C3-8889-F2B3DC5971B9}];2 ;RowOrderConfirmationDate;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AF23EB1B-5972-4BB1-AAA7-466B9498C07E}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format14;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format14  := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{0E66C5E8-B459-4183-8456-FD912A8759D9}];2 ;RowDeliveryIdentifier;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{CF05FB9B-3B50-422D-A324-3C97F1117440}];2 ;RowDeliveryIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{563E2DE6-7AE4-4A32-81C3-03760714F2EE}];2 ;RowDeliveryDate     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{A979C9BC-3B1D-48E9-9F0B-781A6CA3B882}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format15;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format15  := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{0A7548D9-8F3F-4FFF-AE06-DF1DC0DD5355}];2 ;RowQuotationIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{86D4018C-60D4-4B47-8AAF-E5322EF9EE9B}];2 ;RowQuotationIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{BCCA2FC9-63E5-4293-AB4B-257C13D2575F}];2 ;RowAgreementIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{8C8E4A9C-5C17-494A-8BBE-AB06CCF2F045}];2 ;RowAgreementIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{7EB38D4E-02BC-436D-8AF5-91FC73A36813}];2 ;RowRequestOfQuotationIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{EDE2AA6D-64B2-46B2-93EB-5A9A2E2D5528}];2 ;RowRequestOfQuotationIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F05BFF08-D0E6-4B4D-B25C-172631602E37}];2 ;RowPriceListIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{967BD9CD-ADD2-4C17-AEDB-DBBB242A90AA}];2 ;RowPriceListIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{50B6BD01-C027-4F96-8CE9-EF6FBED1EEC7}];2 ;RowProjectReferenceIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{84728BB7-BB38-4D3D-B50B-34A2A99D166B}];2 ;RowOverDuePaymentDetails;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{5FFB9EE7-D94C-4616-8B35-3664A8ABD4D3}];2 ;RowAnyPartyDetails  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AF01769C-CA5D-432D-A7AA-12BB21B8FCB8}];3 ;RowAnyPartyText     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{88A1B81C-21C4-43C0-9FE8-D00A4783D6DE}];4 ;AnyPartyCode        ;Attribute;Text   ;
                                                  VariableName=AnyPartyCodeRowAnyPartyText;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{D5B78630-37CE-48D4-854D-AE07DFCE7D7E}];3 ;RowAnyPartyIdentifier;Element;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2E09B57E-50F2-4656-94EA-D5B3929C9FB2}];3 ;RowAnyPartyOrganisationName;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{280FD162-231D-43D3-83EB-95C61B429BDE}];3 ;RowAnyPartyOrganisationDepartment;Element;Text;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{456349BA-B1F1-48EA-8F85-97791897B643}];3 ;RowAnyPartyOrganisationTaxCode;Element;Text;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{42CA33C9-FAA4-458D-B4B7-270235BA334C}];3 ;RowAnyPartyPostalAddressDetails;Element;Text;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{EE2C64D2-B3E7-4B93-9777-A182E0840A2C}];4 ;RowAnyPartyStreetName;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{41B593E6-98D5-4552-B5A8-0D62330A03EC}];4 ;RowAnyPartyTownName ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{EF17A04A-B75D-4BC6-ADFB-E793A8B4C4A4}];4 ;RowAnyPartyPostCodeIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{BF7616B2-4455-4467-AF8B-14C97A325C49}];4 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=RowAnyPartyCountryCode;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{92841336-13B4-47A5-861C-EBE29C54B359}];4 ;CountryName         ;Element ;Text    ;
                                                  VariableName=RowCountryName;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{93FDE54F-F0FB-443B-8103-DAF40C50C8FE}];4 ;RowAnyPartyPostOfficeBoxIdentifier;Element;Text;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{5E3248A3-D2B5-40EF-BA62-EDA5E8608394}];3 ;RowAnyPartyOrganisationUnitNumber;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{4C45877B-2B3C-4E2D-8991-93124149B2AE}];3 ;RowAnyPartySiteCode ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{ED07F7A2-5CEC-419E-A538-92ED2F1F8332}];2 ;RowDeliveryDetails  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{ABF3083D-C215-4760-8F8D-D158A6062202}];2 ;RowShortProposedAccountIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{C9BA21ED-C43F-47C2-98B8-8F521B47E521}];2 ;RowNormalProposedAccountIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{6A329EAF-DEE5-4D17-B631-B5401BF9E99F}];2 ;RowProposedAccountText;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{30CDFC4A-AB8B-498A-8768-FCBDD7644A85}];2 ;RowAccountDimensionText;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{934741C9-4065-4074-8AB5-E8933010104B}];2 ;RowSellerAccountText;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{BF53BCAE-73D3-4CA5-BD49-A5072B87E564}];2 ;RowFreeText         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{1AB371B3-9016-40A6-AF14-E740721BBA4F}];2 ;RowUsedQuantity     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{D6152D2B-5D96-46C0-862C-B61AE5599CCD}];2 ;RowPreviousMeterReadingDate;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{9475311D-956F-4297-8CBC-E2847272B1BB}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format16;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format16 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{2D546620-2FA4-452A-93F8-5EE7AD08907C}];2 ;RowLatestMeterReadingDate;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{4A0754A2-BDC7-4D30-9AED-16401952EAF1}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format17;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format17 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{87A07E65-6BE6-447B-A435-B0E767CD6E66}];2 ;RowCalculatedQuantity;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2964C94D-77F3-4800-86FE-6D6DCFAF05BA}];2 ;RowAveragePriceAmount;Element;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{1E4CF492-F3ED-4C52-80F2-E63A48BC6961}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier19;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier19 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{C42E4195-F432-4202-8761-199C940C6A43}];2 ;RowDiscountPercent  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowDiscountPercent := FormatQty("Sales Invoice Line"."Line Discount %");
                                                                               END;
                                                                                }

    { [{341BB8EA-4BE3-4890-B969-D8DBC12A59FD}];2 ;RowDiscountAmount   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowDiscountAmount := FormatDecimal("Sales Invoice Line"."Line Discount Amount");
                                                                               END;
                                                                                }

    { [{562140F9-161C-4682-B63B-4406C0FDF295}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier5;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier5 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{D8BA49E2-C877-4F2C-B30B-84DB775E8DFF}];2 ;RowDiscountTypeCode ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{CB405B2F-C905-402F-9A4A-89797B3CE848}];2 ;RowDiscountTypeText ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{CA8EBB00-15A3-4237-B7EE-8B6636FB19FF}];2 ;RowProgressiveDiscountDetails;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{DF1A48AE-68BB-47EA-A94B-9E0FD40EB679}];2 ;RowVatRatePercent   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{07C41A17-7480-42D4-8C99-60839A133C49}];2 ;RowVatCode          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{88F28265-A5F9-4620-9BBE-F6FB0868218C}];2 ;RowVatAmount        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowVatAmount := FormatDecimal(
                                                                                   ("Sales Invoice Line"."Amount Including VAT" - "Sales Invoice Line".Amount));
                                                                               END;
                                                                                }

    { [{530C6419-78BD-4FD2-9D55-9F72D9C5182D}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier7;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier7 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{C2AE23C8-F1C8-4BA8-B38C-D226C7D14F90}];2 ;RowVatExcludedAmount;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowVatExcludedAmount := FormatDecimal("Sales Invoice Line".Amount);
                                                                               END;
                                                                                }

    { [{BF1105C1-5279-4A73-9132-88F044401238}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier3;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier3 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{3090635F-7070-4A6A-B40A-5D36BCC30EEE}];2 ;RowAmount           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowAmount := FormatDecimal("Sales Invoice Line"."Amount Including VAT");
                                                                               END;
                                                                                }

    { [{08C24725-B957-418A-A60E-4A2BE2054B0F}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier4;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier4 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{54693BD7-7657-408F-B18F-745C3718EBF7}];2 ;RowTransactionDetails;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{8ACCBC06-CB61-433E-83B8-5423BBA7FB80}];2 ;SubInvoiceRow       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{544CDCFF-8873-47BD-84DE-D06E5822F52C}];1 ;SpecificationDetails;Element ;Text     }

    { [{FC91E03C-84BE-4066-B15B-EDE8D0E05897}];1 ;EpiDetails          ;Element ;Text     }

    { [{362A340F-CE08-4963-8593-9A1EA4FD6909}];2 ;EpiIdentificationDetails;Element;Text  }

    { [{13F2C7A7-6AB5-4199-A190-EBF7A4E884C3}];3 ;EpiDate             ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiDate := FormatDate("Sales Invoice Header"."Document Date");
                                                                               END;
                                                                                }

    { [{6ACF7948-7783-4F71-8B6A-B0739DEBB084}];4 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format2 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{DF682637-9CE7-4062-A4D4-8633A908F2B0}];3 ;EpiReference        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiReference := "Sales Invoice Header"."Reference No.";
                                                                               END;
                                                                                }

    { [{9855362B-E9C1-484D-B140-91D9B44DA745}];3 ;EpiUrl              ;Element ;Text     }

    { [{C3B134AD-9450-4F2C-959F-8FBB4A8E59C9}];3 ;EpiEmail            ;Element ;Text     }

    { [{CF2CD9A4-A669-4FBA-9EE7-93EA5D208428}];3 ;EpiOrderInfo        ;Element ;Text     }

    { [{19FB4FB6-F94B-46E2-B59A-183EEF1E4072}];2 ;EpiPartyDetails     ;Element ;Text     }

    { [{D9F455C6-4C04-4906-91E7-2E0948AA4E59}];3 ;EpiBfiPartyDetails  ;Element ;Text     }

    { [{8B7EFE1D-C3C5-4B81-BA3C-1AD3C1AB5E7E}];4 ;EpiBfiIdentifier    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF FinvoiceSetup."Intermediator Code" <> '' THEN
                                                                                   EpiBfiIdentifier := FinvoiceSetup."Intermediator Code"
                                                                                 ELSE
                                                                                   EpiBfiIdentifier := CompanyInfo."SWIFT Code";
                                                                               END;
                                                                                }

    { [{A2C2DEC0-F98C-47D1-BB82-A56AA7AF7360}];5 ;IdentificationSchemeName;Attribute;Text;
                                                  VariableName=IdentificationSchemeName2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentificationSchemeName2 := 'BIC';
                                                                               END;
                                                                                }

    { [{764CA436-C945-4783-90EE-B8F08FD06B76}];4 ;EpiBfiName          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiBfiName := CompanyInfo.Name;
                                                                               END;
                                                                                }

    { [{649EDA05-028A-44A0-A688-BE7DC2E5B721}];3 ;EpiBeneficiaryPartyDetails;Element;Text }

    { [{5C066D8A-BF79-4F3C-8309-266C9722D303}];4 ;EpiNameAddressDetails;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{917B474B-A582-458E-A909-0AAD64E94D3B}];4 ;EpiBei              ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{93F51830-FFC6-4A69-81E6-5F7F6AF79AB9}];4 ;EpiAccountID        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF FinvoiceSetup."IBAN Account No." <> '' THEN
                                                                                   EpiAccountID := FinvoiceSetup."IBAN Account No."
                                                                                 ELSE
                                                                                   EpiAccountID := CompanyInfo.IBAN;
                                                                               END;
                                                                                }

    { [{A8B2B76B-A9A4-4991-8EC1-DD6C5ABEDA84}];5 ;IdentificationSchemeName;Attribute;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentificationSchemeName := 'IBAN';
                                                                               END;
                                                                                }

    { [{32F9AAA4-35E2-41C3-9643-9AF1AD8C63C1}];2 ;EpiPaymentInstructionDetails;Element;Text }

    { [{B885291B-522A-45C0-9557-0B6B06D67CFC}];3 ;EpiPaymentInstructionId;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiPaymentInstructionId := 'E-lasku';
                                                                               END;
                                                                                }

    { [{CE9545ED-C59B-4F58-89B6-DAC884C7968A}];3 ;EpiTransactionTypeCode;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AD676C19-6C9D-4395-B96A-9FFFBA42D18B}];3 ;EpiInstructionCode  ;Element ;Text     }

    { [{8B301F99-AEB8-47B7-BC54-D75DDEAB80E5}];3 ;EpiRemittanceInfoIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiRemittanceInfoIdentifier := "Sales Invoice Header"."Reference No.";
                                                                               END;
                                                                                }

    { [{7AAC2E87-E5C7-4363-BEED-504769775EC1}];4 ;IdentificationSchemeName;Attribute;Text;
                                                  VariableName=IdentificationSchemeName3;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentificationSchemeName3 := 'SPY';
                                                                               END;
                                                                                }

    { [{1A4E7CAE-DF46-4052-BFA6-926F4094F400}];3 ;EpiInstructedAmount ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiInstructedAmount := FormatDecimal(TotalAmountInclVAT);
                                                                               END;
                                                                                }

    { [{6F303242-1AD0-423E-B741-BFBB0516DD73}];4 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier2 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{0D853299-85E1-4840-9E90-2910D33A577F}];3 ;EpiCharge           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiCharge := 'SHA'
                                                                               END;
                                                                                }

    { [{8A95B325-B7AF-4F84-B64A-912F6FE2E2CE}];4 ;ChargeOption        ;Attribute;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ChargeOption := 'SHA'
                                                                               END;
                                                                                }

    { [{A8A71FFD-3EBB-4F95-B8AA-C07E884D317B}];3 ;EpiDateOptionDate   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiDateOptionDate := FormatDate("Sales Invoice Header"."Due Date");
                                                                               END;
                                                                                }

    { [{C17501AA-83A1-48E4-A943-555920782BDC}];4 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format18;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format18 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{4DB9DFC8-1863-490E-B17E-259ECF60604D}];1 ;InvoiceUrlNameText  ;Element ;Text     }

    { [{FE2B66E4-73BC-4FDE-B6C9-73C041D4158B}];1 ;InvoiceUrlText      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceUrlText := 'attachment://'+ "Sales Invoice Header"."No."+'.pdf';
                                                                               END;
                                                                                }

    { [{B7AFE632-F208-443A-AF02-8306345A6621}];1 ;StorageUrlText      ;Element ;Text     }

    { [{58E11B09-F055-46DB-B169-F151F4779B10}];1 ;LayOutIdentifier    ;Element ;Text     }

    { [{DC06320C-0D54-43BA-8665-9C976294B37F}];1 ;InvoiceSegmentIdentifier;Element;Text  }

    { [{15218C37-20C1-4358-92BF-55DDDDE25B45}];1 ;ControlStampText    ;Element ;Text     }

    { [{2CAEB421-0114-4C2B-A4D3-7FA61FA1E8EC}];1 ;AcceptanceStampText ;Element ;Text     }

    { [{7794927C-2E34-467A-8406-EB53547F4A93}];1 ;OriginalInvoiceFormat;Element;Text    ;
                                                  VariableName=OriginalInvoiceFormat3 }

    { [{D63EF924-FEEC-4AE3-8A7F-2DE08FA1FC6D}];1 ;AttachmentMessageDetails;Element;Text ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{BC477C24-73F0-4F77-BF32-3445179CDB26}];2 ;AttachmentMessageIdentifier;Element;Text }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SalesSetup@1000000000 : Record 311;
      ShipmentMethod@1000000001 : Record 10;
      ShippingAgent@1000000002 : Record 291;
      PaymentTerms@1000000003 : Record 3;
      FinanceChargeTerms@1000000004 : Record 5;
      SalesPurchPerson@1000000005 : Record 13;
      CompanyInfo@1000000006 : Record 79;
      Country@1000000007 : Record 9;
      ShipToAddress@1000000009 : Record 222;
      SellCustomer@1000000010 : Record 18;
      BillCustomer@1000000011 : Record 18;
      ShipCustomer@1000000012 : Record 18;
      gSalesInvLines@1000000008 : Record 113;
      recShippingAgent@1000000016 : Record 291;
      recShipmentMethod@1000000017 : Record 10;
      GLsetup@1000000018 : Record 98;
      gInvTotalIncVAT@1000000013 : Decimal;
      gInvTotalExcVAT@1000000014 : Decimal;
      gInvTotalVAT@1000000015 : Decimal;
      InvCurrencyCode@1000000019 : Code[10];
      TotalSubTotal@1000000026 : Decimal;
      TotalAmount@1000000025 : Decimal;
      TotalAmountInclVAT@1000000024 : Decimal;
      TotalAmountVAT@1000000023 : Decimal;
      TotalInvDiscAmount@1000000022 : Decimal;
      TotalPaymentDiscOnVAT@1000000021 : Decimal;
      gtxBaseDateFormat@1000000020 : Text;
      gtxInvoiceLanguageCode@1000000027 : Text[2];
      FinvoiceSetup@1000 : Record 11250735;

    LOCAL PROCEDURE FormatDate@1000000010(DateToFormat@1000000000 : Date) FormattedDate : Text[20];
    BEGIN
      FormattedDate := FORMAT(DateToFormat,0,'<YEAR4,4><MONTH,2><DAY,2>');
    END;

    LOCAL PROCEDURE FormatDecimal@1000000032(DecimalToFormat@1000000000 : Decimal) FormattedDecimal : Text[20];
    BEGIN
      FormattedDecimal := FORMAT(DecimalToFormat,0,'<Sign><integer><Decimals,3>');
    END;

    LOCAL PROCEDURE FormatQty@1000000004(QtyToFormat@1000000000 : Decimal) FormattedQty : Text[20];
    BEGIN
      FormattedQty := FORMAT(QtyToFormat,0,1);
    END;

    PROCEDURE ConvTotal@1000000002(Total@1000000000 : Decimal) TotalStr : Text[8];
    VAR
      IntegerTxt@1000000001 : Text[6];
      DecimalText@1000000002 : Text[2];
      Amount@1000000003 : Decimal;
    BEGIN
      //Muutetaan senteiksi
      Amount := 100 * Total;
      //Otetaan vain kokonaiset
      TotalStr := FORMAT(Amount,8,'<Integer>');
      //Poistetaan mahdolliset v„lily”nnit alusta
      TotalStr := DELCHR(TotalStr, '<>', ' ');
      //Etunollat„ytt”
      IF STRLEN(TotalStr) < 8 THEN
        REPEAT
          TotalStr := '0' + TotalStr;
        UNTIL STRLEN(TotalStr) = 8;
    END;

    PROCEDURE FillLeadingZero@1000000003(ReferenceString@1000000000 : Code[20];Length@1000000001 : Integer) ZeroFilledRefStr : Code[20];
    BEGIN
      //Etunollat„ytt”
      IF STRLEN(ReferenceString) < Length THEN BEGIN
        ZeroFilledRefStr := ReferenceString;
        REPEAT
          ZeroFilledRefStr := '0' + ZeroFilledRefStr;
        UNTIL STRLEN(ZeroFilledRefStr) = Length;
      END;
    END;

    BEGIN
    {
      01. 17.03.2016 EVRY/THA : Finvoice 2.0 Luotu.
      02. 24.10.2016 EVRY/JPI :
        - Finvoice 2.01 elemettej„ ja attribuutteja lis„tty
        - Epi tiedot t„ytetty vastaamaan edellist„ ratkaisua
        - Testattu usean eli ALV-% esitt„minen
      03. 23.11.2016 EVRY/JPI :
        - Elementtej„ jotka ovat tyhji„ ja  j„„v„t skeeman
          validointiin virheeseen kuten date ja amount tyyppiset elementit
          poistettu currxmlport.skip funktiolla
        - Joitain elementtej„ joilla alielementtej„ jotka ovat tyhji„
          poistettu currxmlport.skip funktiolla sill„ j„„v„t skeeman
          validoinnissa virheeseen


      ///Huomioita\\\
      Pyrit„„n pit„m„„n rakenne yhtenev„isen„, jolloin:
      - Tehd„„n tarvittavat haut jo heti otsikkotietueen alussa
      - Usein k„ytett„v„t formatoinnit ja mukautukset tehd„„n funktioina
      - XMLport Designerissa yll„pidet„„n rakennetta
      - Koodissa kohdistetaan data rakenteeseen
      - Sis„ll”n kehitt„misess„ kannatta hy”dynt„„ vanhassa versiossa esiteltyj„ ratkaisuja
      - Finvoice Tagien tekstipituudet huomioitu
    }
    END.
  }
}

