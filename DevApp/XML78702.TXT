OBJECT XMLport 78702 Finvoice Cr.Memo Temp From R-2
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=4PSFI-CUSTSPEC-FV;
  }
  PROPERTIES
  {
    Direction=Export;
    Encoding=ISO-8859-2;
    Format/Evaluate=XML Format/Evaluate;
    OnInitXMLport=BEGIN
                    gtxBaseDateFormat := 'CCYYMMDD';
                  END;

    UseRequestPage=No;
  }
  ELEMENTS
  {
    { [{5D73AD0C-A2EC-45C3-9BC1-376A55DDAD9A}];  ;Finvoice            ;Element ;Table   ;
                                                  ReqFilterFields=Field3;
                                                  SourceTable=Table114;
                                                  SourceTableView=SORTING(Field3)
                                                                  ORDER(Ascending);
                                                  Export::OnAfterGetRecord=BEGIN

                                                                             CompanyInfo.GET;
                                                                             //Tehd„„n heti aluksi :
                                                                               //viittaukset eri asiakastyyppeihin
                                                                               //lasketaan kokonaissummat ja ALV:t
                                                                               //etc. listaukset t„h„n.


                                                                             BillCustomer.GET("Sales Cr.Memo Header"."Bill-to Customer No.");
                                                                             SellCustomer.GET("Sales Cr.Memo Header"."Sell-to Customer No.");
                                                                             IF "Sales Cr.Memo Header"."Ship-to Code" <> '' THEN
                                                                               ShipToAddress.GET("Sales Cr.Memo Header"."Sell-to Customer No.", "Sales Cr.Memo Header"."Ship-to Code");
                                                                             GLsetup.GET;
                                                                             IF "Sales Cr.Memo Header"."Currency Code" = '' THEN
                                                                               InvCurrencyCode := GLsetup."LCY Code"
                                                                             ELSE
                                                                               InvCurrencyCode := "Sales Cr.Memo Header"."Currency Code";
                                                                             InvCurrencyCode := COPYSTR(InvCurrencyCode,1,3);

                                                                             IF "Sales Cr.Memo Header"."Language Code" <> '' THEN
                                                                               gtxInvoiceLanguageCode := COPYSTR("Sales Cr.Memo Header"."Language Code",1,2)
                                                                             ELSE
                                                                               gtxInvoiceLanguageCode := 'FI';

                                                                             CLEAR(gInvTotalExcVAT);
                                                                             CLEAR(gInvTotalIncVAT);
                                                                             CLEAR(gInvTotalVAT);
                                                                             CLEAR(VATAmountLine);
                                                                             VATAmountLine.DELETEALL;
                                                                             gSalesCrMemoLines.SETRANGE(gSalesCrMemoLines."Document No.","Sales Cr.Memo Header"."No.");
                                                                             IF gSalesCrMemoLines.FINDSET THEN REPEAT
                                                                               gInvTotalExcVAT += (gSalesCrMemoLines.Amount*-1);
                                                                               gInvTotalIncVAT += (gSalesCrMemoLines."Amount Including VAT"*-1);
                                                                               gInvTotalVAT += (gSalesCrMemoLines."Amount Including VAT"*-1) - (gSalesCrMemoLines.Amount*-1);

                                                                               IF (gSalesCrMemoLines.Type = gSalesCrMemoLines.Type::"G/L Account") THEN
                                                                                 gSalesCrMemoLines."No." := '';

                                                                               VATAmountLine.INIT;
                                                                               VATAmountLine."VAT Identifier" := gSalesCrMemoLines."VAT Identifier";
                                                                               VATAmountLine."VAT Calculation Type" := gSalesCrMemoLines."VAT Calculation Type";
                                                                               VATAmountLine."Tax Group Code" := gSalesCrMemoLines."Tax Group Code";
                                                                               VATAmountLine."VAT %" := gSalesCrMemoLines."VAT %";
                                                                               VATAmountLine."VAT Base" := (gSalesCrMemoLines.Amount*-1);
                                                                               VATAmountLine."Amount Including VAT" := (gSalesCrMemoLines."Amount Including VAT"*-1);
                                                                               VATAmountLine."Line Amount" := (gSalesCrMemoLines."Line Amount"*-1);
                                                                               IF gSalesCrMemoLines."Allow Invoice Disc." THEN
                                                                                 VATAmountLine."Inv. Disc. Base Amount" := (gSalesCrMemoLines."Line Amount"*-1);
                                                                               VATAmountLine."Invoice Discount Amount" := (gSalesCrMemoLines."Inv. Discount Amount"*-1);
                                                                               VATAmountLine."VAT Clause Code" := gSalesCrMemoLines."VAT Clause Code";
                                                                               VATAmountLine.InsertLine;

                                                                               TotalSubTotal += (gSalesCrMemoLines."Line Amount"*-1);
                                                                               TotalInvDiscAmount -= (gSalesCrMemoLines."Inv. Discount Amount"*-1);
                                                                               TotalAmount += (gSalesCrMemoLines.Amount*-1);
                                                                               TotalAmountVAT += (gSalesCrMemoLines."Amount Including VAT"*-1) - (gSalesCrMemoLines.Amount*-1);
                                                                               TotalAmountInclVAT += (gSalesCrMemoLines."Amount Including VAT"*-1);
                                                                               TotalPaymentDiscOnVAT += -((gSalesCrMemoLines."Line Amount"*-1) - (gSalesCrMemoLines."Inv. Discount Amount"*-1) - (gSalesCrMemoLines."Amount Including VAT"*-1));

                                                                             UNTIL gSalesCrMemoLines.NEXT = 0;
                                                                           END;
                                                                            }

    { [{C0F25689-15BA-48C1-B984-9E0CF1C0D75F}];1 ;Version             ;Attribute;Text    }

    { [{5B933635-E839-471D-8397-08E23ACC6330}];1 ;noNamespaceSchemaLocation;Attribute;Text }

    { [{2681CA5D-72AB-4FC8-87EA-F0D0F521353A}];1 ;SellerPartyDetails  ;Element ;Text     }

    { [{58635D06-80B5-4DF0-80E0-EF62E7FFCA11}];2 ;SellerPartyIdentifier;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerPartyIdentifier := COPYSTR(CompanyInfo."Business Identity Code",1,35);
                                                                               END;
                                                                                }

    { [{284478AC-6F27-4D44-A8E4-99CEF8786411}];2 ;SellerPartyIdentifierUrlText;Element;Text }

    { [{CDF5F006-2B69-4A6A-A8BF-78406035C1EA}];2 ;SellerOrganisationName;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerOrganisationName := COPYSTR(CompanyInfo.Name,1,70);
                                                                               END;
                                                                                }

    { [{CBE41819-60E3-4338-9EF8-CF8619868C9F}];2 ;SellerOrganisationDepartment;Element;Text }

    { [{DD355654-B674-4DB5-B132-4314CAA3F0A6}];2 ;SellerOrganisationTaxCode;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerOrganisationTaxCode := COPYSTR(CompanyInfo."VAT Registration No.",1,35);
                                                                               END;
                                                                                }

    { [{EAA2EA30-3291-454F-968A-66EABD3835FD}];2 ;SellerOrganisationTaxCodeUrlText;Element;Text }

    { [{CE2ABDEA-E0FA-42DF-BA04-D2327964D613}];2 ;SellerCode          ;Element ;Text     }

    { [{4442B0D3-8996-47F3-A77E-186200F3629F}];2 ;SellerPostalAddressDetails;Element;Text }

    { [{587BADCB-E81A-42E0-98B2-29CF94AFCB45}];3 ;SellerStreetName    ;Element ;Text    ;
                                                  VariableName=<SellerStreetName>;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 "<SellerStreetName>" := COPYSTR(CompanyInfo.Address,1,35);
                                                                               END;
                                                                                }

    { [{4F505841-746B-407E-99C1-DF8D25BF40C2}];3 ;SellerTownName      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerTownName := COPYSTR(CompanyInfo.City,1,35);
                                                                               END;
                                                                                }

    { [{4FEC6DF9-307D-4E29-A248-C27724C80B6A}];3 ;SellerPostCodeIdentifier;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerPostCodeIdentifier := COPYSTR(CompanyInfo."Post Code",1,35);
                                                                               END;
                                                                                }

    { [{66EC7064-E757-4A01-BEFB-C826341C1E26}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCode1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CountryCode1 := COPYSTR(CompanyInfo."Country/Region Code",1,2);
                                                                               END;
                                                                                }

    { [{9159CD58-0D5C-4042-BE9D-6C50787ADA7F}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryName1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Country.GET(CompanyInfo."Country/Region Code");
                                                                                 CountryName1 := COPYSTR(Country.Name,1,35);
                                                                               END;
                                                                                }

    { [{8C4962E8-B885-42BF-95A5-19D7F8D5246D}];1 ;SellerOrganisationUnitNumber;Element;Text }

    { [{4E5E7DD7-49A4-405A-B44E-DEF93FF3F61B}];1 ;SellerSiteCode      ;Element ;Text     }

    { [{E277BF7A-F647-4D34-BFEC-EC9AB0009B21}];1 ;SellerContactPersonName;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF SalesPurchPerson.GET("Sales Cr.Memo Header"."Salesperson Code") THEN
                                                                                   BEGIN
                                                                                     SellerContactPersonName := COPYSTR(SalesPurchPerson.Name,1,35);
                                                                                     SellerPhoneNumberIdentifier := COPYSTR(SalesPurchPerson."Phone No.",1,35);
                                                                                     SellerEmailaddressIdentifier := COPYSTR(SalesPurchPerson."E-Mail",1,70);
                                                                                   END;
                                                                               END;
                                                                                }

    { [{A0F57AAA-2BDB-4BA1-9160-1341C68F92F4}];1 ;SellerContactPersonFunction;Element;Text }

    { [{FD1CDD55-F3A6-41C0-935B-89E3FC97CFE4}];1 ;SellerContactPersonDepartment;Element;Text }

    { [{6434D54E-778B-4A80-9310-D53EB313EF5A}];1 ;SellerCommunicationDetails;Element;Text }

    { [{BC4A424F-F122-460D-A72B-9DA4D39701AB}];2 ;SellerPhoneNumberIdentifier;Element;Text }

    { [{7B5978F4-A041-4D39-894E-B239B9B1AE2E}];2 ;SellerEmailaddressIdentifier;Element;Text }

    { [{0FC66DC2-51C4-4381-A12B-5E38F7F0B633}];1 ;SellerInformationDetails;Element;Text  }

    { [{8A89B2A2-B897-4DBB-A305-D4ED6BD49B87}];2 ;SellerHomeTownName  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerHomeTownName := COPYSTR(CompanyInfo."Registered Home City",1,35);
                                                                               END;
                                                                                }

    { [{E4E11546-8F8E-418F-9DAF-28576D4A36AA}];2 ;SellerPhoneNumber   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerPhoneNumber := COPYSTR(CompanyInfo."Phone No.",1,35);
                                                                               END;
                                                                                }

    { [{A8A35B6C-A3E3-453F-B6DE-5B7264267C42}];2 ;SellerFaxNumber     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerFaxNumber := COPYSTR(CompanyInfo."Fax No.",1,35);
                                                                               END;
                                                                                }

    { [{71651981-7422-47F0-8B6A-7BB805C0B4E0}];2 ;SellerCommonEmailaddressIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerCommonEmailaddressIdentifier := COPYSTR(CompanyInfo."E-Mail",1,70);
                                                                               END;
                                                                                }

    { [{08BBCC99-0E61-4C8A-A7B5-F950F75ACB76}];2 ;SellerWebaddressIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerWebaddressIdentifier := COPYSTR(CompanyInfo."Home Page",1,35);
                                                                               END;
                                                                                }

    { [{15B1FE7F-5281-4F14-97F1-05E2C7B1BE68}];2 ;SellerAccountDetails;Element ;Text     }

    { [{E685DC78-1249-49BA-A21C-8B683AB68CC5}];3 ;SellerAccountID     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IF FinvoiceSetup."IBAN Account No." <> '' THEN
                                                                                 //  SellerAccountID := COPYSTR(FinvoiceSetup."IBAN Account No.",1,35)
                                                                                 //ELSE
                                                                                 //  SellerAccountID := COPYSTR(CompanyInfo.IBAN,1,35);
                                                                                 IF FinvoiceSetup."IBAN Account No." <> '' THEN BEGIN
                                                                                   IdentificationSchemeNameID := 'IBAN';
                                                                                   SellerAccountID := COPYSTR(FinvoiceSetup."IBAN Account No.",1,35);
                                                                                 END ELSE BEGIN
                                                                                   SellerAccountID := COPYSTR(CompanyInfo.IBAN,1,35);
                                                                                   IdentificationSchemeNameID := 'IBAN';
                                                                                 END;
                                                                               END;
                                                                                }

    { [{E5E024D6-5B1B-4783-8F2F-F7EC0AA04BA7}];4 ;IdentificationSchemeName;Attribute;Text;
                                                  VariableName=IdentificationSchemeNameID;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IdentificationSchemeNameID := FORMAT(SellCustomer."Account Type");
                                                                               END;
                                                                                }

    { [{6EA748B6-4631-4049-9508-022DC3A397B8}];3 ;SellerBic           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 SellerBic := COPYSTR(CompanyInfo."SWIFT Code",1,11);
                                                                               END;
                                                                                }

    { [{56F1A50A-93B7-4A0B-A891-DB8D99953ECA}];4 ;IdentificationSchemeName;Attribute;Text;
                                                  VariableName=IdentificationSchemeNameBIC;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentificationSchemeNameBIC := 'BIC';
                                                                               END;
                                                                                }

    { [{FDDD3CAE-D02B-490C-B6FB-813503316015}];1 ;InvoiceSenderPartyDetails;Element;Text }

    { [{B682676F-3D82-48C5-A8FA-7064B905C8FE}];2 ;InvoiceSenderPartyIdentifier;Element;Text }

    { [{031CB3B1-D217-49D6-986A-37695208B70D}];2 ;InvoiceSenderOrganisationName;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceSenderOrganisationName := COPYSTR(CompanyInfo.Name,1,35);
                                                                               END;
                                                                                }

    { [{F48BAD6E-7571-4A03-A020-0137FB166F60}];2 ;InvoiceSenderOrganisationTaxCode;Element;Text }

    { [{214D190F-276C-4324-AFE0-9CBD135D56F6}];1 ;InvoiceRecipientPartyDetails;Element;Text }

    { [{0D4665F0-2662-49B0-B074-362D5FDBC4C3}];2 ;InvoiceRecipientPartyIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientPartyIdentifier := COPYSTR(BillCustomer."Business Identity Code",1,35);
                                                                               END;
                                                                                }

    { [{FAB86B7D-CCC4-4F2F-BA9D-DAA42397B49A}];2 ;InvoiceRecipientOrganisationName;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientOrganisationName := COPYSTR("Sales Cr.Memo Header"."Bill-to Name",1,35);
                                                                               END;
                                                                                }

    { [{116B9DED-704E-4659-9B6C-CDFCCA659BB9}];2 ;InvoiceRecipientOrganisationTaxCode;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientOrganisationTaxCode := COPYSTR(BillCustomer."VAT Registration No.",1,35);
                                                                               END;
                                                                                }

    { [{68BC8536-3D32-4E46-BEBF-D2969C939A2F}];2 ;InvoiceRecipientPostalAddressDetails;Element;Text }

    { [{492282F1-78B7-4143-B93B-145CDCE32FB5}];3 ;InvoiceRecipientStreetName;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientStreetName := COPYSTR("Sales Cr.Memo Header"."Bill-to Address",1,35);
                                                                               END;
                                                                                }

    { [{8910FC96-5828-4804-AD91-1BB212C7714F}];3 ;InvoiceRecipientTownName;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientTownName := COPYSTR("Sales Cr.Memo Header"."Bill-to City",1,35);
                                                                               END;
                                                                                }

    { [{E2EEC30E-8616-4B08-823A-50F8A8E3C57A}];3 ;InvoiceRecipientPostCodeIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientPostCodeIdentifier := COPYSTR("Sales Cr.Memo Header"."Bill-to Post Code",1,35);
                                                                               END;
                                                                                }

    { [{1254FF03-D55C-4F81-AFED-E865116E17AA}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCode2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Cr.Memo Header"."Bill-to Country/Region Code" <> '' THEN
                                                                                   CountryCode2 := COPYSTR("Sales Cr.Memo Header"."Bill-to Country/Region Code",1,2)
                                                                                 ELSE
                                                                                   CountryCode2 := 'FI';
                                                                               END;
                                                                                }

    { [{5121B9C7-F4D4-460E-BC47-B4F8CE11E611}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryName2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Country.GET(CountryCode2);
                                                                                 CountryName2 := COPYSTR(Country.Name,1,35);
                                                                               END;
                                                                                }

    { [{7FEC1A76-F782-40D9-8A8E-9C1550B672ED}];1 ;InvoiceRecipientSiteCode;Element;Text  }

    { [{AB4BF62E-4081-4B10-B27A-6E4E190B8933}];1 ;InvoiceRecipientContactPersonName;Element;Text }

    { [{E2B6A5D1-7FA8-4AFC-96CB-253C7178DFF9}];1 ;InvoiceRecipientContactPersonFunction;Element;Text }

    { [{08BED657-3EEC-4229-B32A-EC96548BFFBB}];1 ;InvoiceRecipientContactPersonDepartment;Element;Text }

    { [{877A5646-B265-4F37-9C8B-FCD7CBE61999}];1 ;InvoiceRecipientLanguageCode;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceRecipientLanguageCode := gtxInvoiceLanguageCode;
                                                                               END;
                                                                                }

    { [{6CFB8C01-4152-4DBE-8163-DBEA184827AF}];1 ;InvoiceRecipientCommunicationDetails;Element;Text }

    { [{6D047DA5-3D4F-4E9B-BA87-07FAD2B75D6F}];1 ;BuyerPartyDetails   ;Element ;Text     }

    { [{9655C144-548D-4060-B225-59A3706C4C5D}];2 ;BuyerPartyIdentifier;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerPartyIdentifier := COPYSTR(SellCustomer."Business Identity Code",1,35);
                                                                               END;
                                                                                }

    { [{70F821FA-0DFD-44B2-BA8A-3D228C142D84}];2 ;BuyerOrganisationName;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerOrganisationName := COPYSTR("Sales Cr.Memo Header"."Sell-to Customer Name",1,70);
                                                                               END;
                                                                                }

    { [{798B9C0A-45E7-4837-B397-3E2DD0AFB8FA}];2 ;BuyerOrganisationDepartment;Element;Text }

    { [{038D7E49-FBA1-403F-9B3F-1C7C69F4715C}];2 ;BuyerOrganisationTaxCode;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerOrganisationTaxCode := COPYSTR(SellCustomer."VAT Registration No.",1,35);
                                                                               END;
                                                                                }

    { [{13DC7474-55E3-4ADE-BDAD-607B7BA5A39F}];2 ;BuyerCode           ;Element ;Text     }

    { [{A388150D-A58C-4D4E-A513-CADD797EB78A}];2 ;BuyerPostalAddressDetails;Element;Text }

    { [{9AE81620-E923-49A0-947B-23AB1A08F90C}];3 ;BuyerStreetName     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerStreetName := COPYSTR("Sales Cr.Memo Header"."Sell-to Address",1,35);
                                                                               END;
                                                                                }

    { [{44945325-1923-4956-91D9-88A5998336A4}];3 ;BuyerTownName       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerTownName := COPYSTR("Sales Cr.Memo Header"."Sell-to City",1,35);
                                                                               END;
                                                                                }

    { [{00C68842-E1FE-4CC0-994D-4FBD4C8E24DC}];3 ;BuyerPostCodeIdentifier;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerPostCodeIdentifier := COPYSTR("Sales Cr.Memo Header"."Sell-to Post Code",1,35);
                                                                               END;
                                                                                }

    { [{D87A2583-AC2B-4AD2-9660-438A5625F28A}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCode3;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Cr.Memo Header"."Sell-to Country/Region Code" <> '' THEN
                                                                                   CountryCode3 := COPYSTR("Sales Cr.Memo Header"."Sell-to Country/Region Code",1,2)
                                                                                 ELSE
                                                                                   CountryCode3 := 'FI';
                                                                               END;
                                                                                }

    { [{4293E56C-5F11-4CE2-A743-A396DD3C7DFC}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryName3;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF ("Sales Cr.Memo Header"."Sell-to Country/Region Code" <> '') AND
                                                                                    (Country.GET("Sales Cr.Memo Header"."Sell-to Country/Region Code")) THEN
                                                                                   CountryName3 := COPYSTR(Country.Name,1,35)
                                                                                 ELSE
                                                                                   CountryName3 := 'Suomi';
                                                                               END;
                                                                                }

    { [{E5A527AA-9AD8-441B-8FDF-CF42DFDCC4C4}];1 ;BuyerOrganisationUnitNumber;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerOrganisationUnitNumber := COPYSTR(SellCustomer."EDI Code",1,35);
                                                                               END;
                                                                                }

    { [{E22C7C8C-1F2B-4E02-AFD0-C5837B0BD81A}];1 ;BuyerSiteCode       ;Element ;Text     }

    { [{50417C47-6E9D-4B95-B541-A638F03BD23A}];1 ;BuyerContactPersonName;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerContactPersonName := COPYSTR("Sales Cr.Memo Header"."Sell-to Contact",1,35);
                                                                               END;
                                                                                }

    { [{E37B78D0-9F4B-4919-898B-9FAC8F8C6332}];1 ;BuyerContactPersonFunction;Element;Text }

    { [{0664580E-0F0F-4F36-9ED4-CBD88EE52014}];1 ;BuyerContactPersonDepartment;Element;Text }

    { [{08C750DC-54A9-4363-AECE-028CA2B66090}];1 ;BuyerCommunicationDetails;Element;Text }

    { [{57791FFC-7906-4AF2-835C-28A2BFD4B062}];1 ;DeliveryPartyDetails;Element ;Text     }

    { [{11FAB08D-43FE-4E55-9483-8E789F042786}];2 ;DeliveryPartyIdentifier;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Cr.Memo Header"."Ship-to Code" <> '' THEN BEGIN
                                                                                   ShipToAddress.GET("Sales Cr.Memo Header"."Sell-to Customer No.", "Sales Cr.Memo Header"."Ship-to Code");
                                                                                   DeliveryPartyIdentifier := COPYSTR(ShipToAddress."EDI Code",1,35);
                                                                                 END ELSE BEGIN
                                                                                   DeliveryPartyIdentifier := COPYSTR(SellCustomer."EDI Code",1,35);
                                                                                 END;
                                                                               END;
                                                                                }

    { [{D14A0ED6-2C29-44C2-981F-D3F192FD7887}];2 ;DeliveryOrganisationName;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryOrganisationName := COPYSTR("Sales Cr.Memo Header"."Ship-to Name",1,35);
                                                                               END;
                                                                                }

    { [{7756E7FF-0FD1-4F46-BD84-C8FE6D6E2793}];2 ;DeliveryOrganisationTaxCode;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Cr.Memo Header"."Ship-to Code" <> '' THEN BEGIN
                                                                                   ShipToAddress.GET("Sales Cr.Memo Header"."Sell-to Customer No.", "Sales Cr.Memo Header"."Ship-to Code");
                                                                                   DeliveryOrganisationTaxCode := COPYSTR(ShipToAddress."VAT Registration No.",1,35);
                                                                                 END ELSE BEGIN
                                                                                   DeliveryOrganisationTaxCode := COPYSTR(SellCustomer."VAT Registration No.",1,35);
                                                                                 END;
                                                                               END;
                                                                                }

    { [{6C4D272A-7AAC-48CF-983E-7CA3C911F12D}];2 ;DeliveryCode        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryCode := COPYSTR(ShipToAddress."EDI Code",1,35);
                                                                               END;
                                                                                }

    { [{D300171F-27E4-4DBA-8EE6-0C6F5996D4B1}];3 ;IdentifierType      ;Attribute;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentifierType := 'EDI';
                                                                               END;
                                                                                }

    { [{08F1B660-9B97-44CF-9488-3D439C392A92}];2 ;DeliveryPostalAddressDetails;Element;Text }

    { [{0F6CA425-1143-4FCE-9555-21262D0BA80E}];3 ;DeliveryStreetName  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryStreetName := COPYSTR("Sales Cr.Memo Header"."Ship-to Address",1,35);
                                                                               END;
                                                                                }

    { [{171487EE-B4FB-49D9-A42D-000266D314A0}];3 ;DeliveryTownName    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryTownName := COPYSTR("Sales Cr.Memo Header"."Ship-to City",1,35);
                                                                               END;
                                                                                }

    { [{BAB497E5-42E7-4C27-85A8-55D8D6DFFC29}];3 ;DeliveryPostCodeIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryPostCodeIdentifier := COPYSTR("Sales Cr.Memo Header"."Ship-to Post Code",1,35);
                                                                               END;
                                                                                }

    { [{6717D29D-E78E-4666-9703-90A16FE4F0FE}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCode4;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Cr.Memo Header"."Ship-to Country/Region Code" <> '' THEN
                                                                                   CountryCode4 := COPYSTR("Sales Cr.Memo Header"."Ship-to Country/Region Code",1,2)
                                                                                 ELSE
                                                                                   CountryCode4 := 'FI';
                                                                               END;
                                                                                }

    { [{F130B913-FADE-4F95-B2E3-9AE36B96063F}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryName4;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF Country.GET("Sales Cr.Memo Header"."Ship-to Country/Region Code") THEN
                                                                                   CountryName4 := COPYSTR(Country.Name,1,35)
                                                                                 ELSE
                                                                                   Country.Name := 'Suomi';
                                                                               END;
                                                                                }

    { [{FF558CA0-8E98-4014-9516-E6AA932DBA5A}];1 ;DeliveryOrganisationUnitNumber;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Cr.Memo Header"."Ship-to Code" <> '' THEN BEGIN
                                                                                   DeliveryOrganisationUnitNumber := COPYSTR(ShipToAddress."EDI Code",1,35);
                                                                                   DeliveryContactPersonName := COPYSTR("Sales Cr.Memo Header"."Ship-to Contact",1,35);
                                                                                   DeliveryPhoneNumberIdentifier := COPYSTR(ShipToAddress."Phone No.",1,35);
                                                                                   DeliveryEmailaddressIdentifier := COPYSTR(ShipToAddress."E-Mail",1,70);
                                                                                 END ELSE BEGIN
                                                                                   DeliveryOrganisationUnitNumber := COPYSTR(SellCustomer."EDI Code",1,35);
                                                                                   DeliveryContactPersonName := COPYSTR("Sales Cr.Memo Header"."Ship-to Contact",1,35);
                                                                                   DeliveryPhoneNumberIdentifier := COPYSTR(SellCustomer."Phone No.",1,35);
                                                                                   DeliveryEmailaddressIdentifier := COPYSTR(SellCustomer."E-Mail",1,70);
                                                                                 END;
                                                                               END;
                                                                                }

    { [{4AC86C82-62C9-436E-A076-F15317B64113}];1 ;DeliverySiteCode    ;Element ;Text     }

    { [{3888BC30-3964-4DC9-9D08-D9B16135AF14}];1 ;DeliveryContactPersonName;Element;Text }

    { [{30F4DD45-7D1C-45B1-BCA8-84E70D0431CE}];1 ;DeliveryContactPersonFunction;Element;Text }

    { [{A24AAC50-B292-49FE-97E2-3C31EBA5805B}];1 ;DeliveryContactPersonDepartment;Element;Text }

    { [{742A569E-F098-47B0-80C8-9402710BB148}];1 ;DeliveryCommunicationDetails;Element;Text }

    { [{2E024A68-BA42-478F-95F2-F25FE82AF327}];2 ;DeliveryPhoneNumberIdentifier;Element;Text }

    { [{4272DB1A-0FEA-4929-A329-81779E23399F}];2 ;DeliveryEmailaddressIdentifier;Element;Text }

    { [{5512C7B5-820A-4273-87D1-43BE883B1E3E}];1 ;DeliveryDetails     ;Element ;Text     }

    { [{67631DBE-AD50-4746-ACD7-FEF440FBFAFE}];2 ;DeliveryDate        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveryDate := FormatDate("Sales Cr.Memo Header"."Shipment Date");
                                                                               END;
                                                                                }

    { [{8151E9CD-5BD1-4B3A-AD2A-F6D60EA54C40}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format3;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format3 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{10A1E9D6-41B1-4C37-8F39-A58AE51B7041}];2 ;DeliveryMethodText  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IF recShippingAgent.GET("Sales Cr.Memo Header"."Shipping Agent Code") THEN
                                                                                 //  DeliveryMethodText := COPYSTR(recShippingAgent.Name,1,512);
                                                                               END;
                                                                                }

    { [{9C504982-B447-488E-A34B-17C0FFA1C5DD}];2 ;DeliveryTermsText   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF recShipmentMethod.GET("Sales Cr.Memo Header"."Shipment Method Code") THEN
                                                                                   DeliveryTermsText := COPYSTR(recShipmentMethod.Description,1,512);
                                                                               END;
                                                                                }

    { [{C11FA7BA-C483-448D-9151-CAFD121F6261}];1 ;AnyPartyDetails     ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{459AC6B8-D424-45F0-A1C6-CDAB8A58A5FB}];2 ;AnyPartyText        ;Element ;Text     }

    { [{C69BD391-F465-45E5-ABFF-EA8C28C99686}];3 ;AnyPartyCode        ;Attribute;Text   ;
                                                  VariableName=AnyPartyCodeAttr }

    { [{800AA7E2-BD9F-4F33-8B1C-BF4ECF1445F2}];2 ;AnyPartyIdentifier  ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{47090863-1D00-42C9-9CE2-67416B45F953}];2 ;AnyPartyOrganisationName;Element;Text  }

    { [{5B83CACC-9692-482C-A7BB-CAEC50F697E4}];2 ;AnyPartyOrganisationDepartment;Element;Text;
                                                  MinOccurs=Zero }

    { [{C77798F0-AB28-47F4-84A2-6C6AE5F9C5B3}];2 ;AnyPartyOrganisationTaxCode;Element;Text;
                                                  MinOccurs=Zero }

    { [{E4A4D428-2965-442D-A1EF-7CF17278CE53}];2 ;AnyPartyCode        ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{F1A9C821-947C-499D-9198-EC33AA16B874}];3 ;IdentifierType      ;Attribute;Text   ;
                                                  VariableName=IdentifierTypeAnyPartyCode;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 // <xs:attribute name="IdentifierType">
                                                                                 // <xs:simpleType>
                                                                                 // <xs:restriction base="xs:token">
                                                                                 // <xs:enumeration value="DUNS"/>
                                                                                 // <xs:enumeration value="GLN"/>
                                                                                 // <xs:enumeration value="HETU"/>
                                                                                 // <xs:enumeration value="EDI"/>
                                                                                 // </xs:restriction>
                                                                                 // </xs:simpleType>
                                                                                 // </xs:attribute>
                                                                                 IdentifierTypeAnyPartyCode := 'EDI';
                                                                               END;
                                                                                }

    { [{AD6F7D77-15AE-4EB6-8A7D-C13507C1A653}];2 ;AnyPartyContactPersonName;Element;Text;
                                                  MinOccurs=Zero }

    { [{EB91F4AD-DA02-44C9-AB10-E2947F4CDC26}];2 ;AnyPartyContactPersonFunction;Element;Text;
                                                  MinOccurs=Zero }

    { [{233CC1EA-FD26-407C-84D4-08881A7EC718}];2 ;AnyPartyContactPersonDepartment;Element;Text;
                                                  MinOccurs=Zero }

    { [{1E8BB305-6C3B-4510-937D-33D55B099F77}];2 ;AnyPartyCommunicationDetails;Element;Text;
                                                  MinOccurs=Zero }

    { [{B589D963-29FD-415C-AC30-423EF9C3D30F}];2 ;AnyPartyPostalAddressDetails;Element;Text;
                                                  MinOccurs=Zero }

    { [{1C34943E-D5D3-437B-9C67-F2AA7440CD11}];3 ;AnyPartyStreetName  ;Element ;Text     }

    { [{C6040718-D1FC-4E86-83B2-EACBA4E1F833}];3 ;AnyPartyTownName    ;Element ;Text     }

    { [{047BA670-E00B-421B-AAD1-410ACE72C021}];3 ;AnyPartyPostCodeIdentifier;Element;Text }

    { [{5BD0DEBC-A9C7-4580-8800-8D71C8942421}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=AnyPartyCountryCode;
                                                  MinOccurs=Zero }

    { [{49975892-A09D-43E7-9F7B-5E6020123B88}];3 ;CountryName         ;Element ;Text    ;
                                                  MinOccurs=Zero }

    { [{A7D46B75-A975-4078-92C5-89AE26B35CF2}];3 ;AnyPartyPostOfficeBoxIdentifier;Element;Text;
                                                  MinOccurs=Zero }

    { [{13975EE8-5A3F-4B16-8EE0-AA051CDAC510}];1 ;InvoiceDetails      ;Element ;Text     }

    { [{D12265D8-24B6-4878-AF66-82AACC5BF637}];2 ;InvoiceTypeCode     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                  InvoiceTypeCode := 'INV02';
                                                                                 // InvoiceTypeCode := 'TES01';
                                                                               END;
                                                                                }

    { [{6BE66163-63BC-4DEB-99F5-C4F1381BA640}];3 ;CodeListAgencyIdentifier;Attribute;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 CodeListAgencyIdentifier := 'SPY';
                                                                               END;
                                                                                }

    { [{247E4562-F571-4100-97D7-5E296CF21EC8}];2 ;InvoiceTypeText     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                  InvoiceTypeText := 'HYVITYSLASKU';
                                                                                 // InvoiceTypeText := 'TESTILASKU';
                                                                               END;
                                                                                }

    { [{E9A18CC5-1947-48EE-9738-24FD0AB927B2}];2 ;OriginCode          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OriginCode := 'Original';
                                                                               END;
                                                                                }

    { [{E5308BF5-2D74-4D1F-B979-717841F0011E}];2 ;OriginText          ;Element ;Text     }

    { [{9EC5FF0F-D3DF-4462-8FA2-B7358096AA07}];2 ;InvoiceNumber       ;Element ;Text    ;
                                                  VariableName=<InvoiceNumber>;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                  "<InvoiceNumber>" := COPYSTR("Sales Cr.Memo Header"."No.",1,20);
                                                                               END;
                                                                                }

    { [{BD9B230E-F7D4-435B-808E-7593E4C3EA1E}];2 ;InvoiceDate         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceDate := FormatDate("Sales Cr.Memo Header"."Document Date");
                                                                               END;
                                                                                }

    { [{C36A5C01-DEE9-4FB9-95A7-73BDA6318FFF}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format1 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{ECAFC50A-CF32-4230-A03B-AD5169640E56}];2 ;OriginalInvoiceNumber;Element;Text    ;
                                                  VariableName=OriginalInvoiceNumber1 }

    { [{2161C847-829B-44E5-8DBF-8F82FACA335B}];2 ;InvoicingPeriodStartDate;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{E9B0C2C9-F537-4CB8-9E7C-B24917804DD1}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format4;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format4 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{44F23F2A-CD78-477F-A8ED-D1A4384C3DFC}];2 ;InvoicingPeriodEndDate;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{0183BA0B-BCE5-4C10-B423-ABAC82B0995A}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format5;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format5 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{67866832-F303-47A1-AD87-63A983D97BE0}];2 ;SellerReferenceIdentifier;Element;Text }

    { [{160ADB78-F622-42EC-9489-1A4ECDE800FE}];2 ;SellerReferenceIdentifierUrlText;Element;Text }

    { [{EDFBA2F7-E572-4578-8671-08785868FB38}];2 ;BuyersSellerIdentifier;Element;Text    }

    { [{7D313685-ECB2-479C-AAC5-6D265807A05A}];2 ;SellersBuyerIdentifier;Element;Text    }

    { [{E8062BD5-A0FB-41A5-BCEF-BA8EE0E395CC}];2 ;OrderIdentifier     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OrderIdentifier := COPYSTR("Sales Cr.Memo Header"."External Document No.",1,35);
                                                                               END;
                                                                                }

    { [{9F5384AF-CEB4-4E1B-8A47-377BE077BD9A}];2 ;OrderIdentifierUrlText;Element;Text    }

    { [{8D9B77CA-5AB6-40D7-85A0-BF96EC2F28A7}];2 ;OrderDate           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{409CB4A3-909E-4071-9884-44320A4EB642}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format6;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format6 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{8F161760-8DCB-4039-BED2-0CCE39869D0F}];2 ;OrdererName         ;Element ;Text     }

    { [{2F2BDFFE-104E-4B44-BA8A-D3B667FD18AA}];2 ;SalesPersonName     ;Element ;Text     }

    { [{B2AA2062-1FDA-4E70-AA34-137FB1FF6EF0}];2 ;OrderConfirmationIdentifier;Element;Text }

    { [{F4484FB5-44E9-4C36-877E-84477F771367}];2 ;OrderConfirmationDate;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{E84A77E2-A31B-4464-A54B-C8DC392EE606}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format7;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format7 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{06DEA10F-31B0-4480-A18C-BB41EAD7EFD8}];2 ;AgreementIdentifier ;Element ;Text     }

    { [{2AFB2B58-E92A-4E09-B603-B6EC5C334FC4}];2 ;AgreementIdentifierUrlText;Element;Text }

    { [{8529697E-8403-4B54-B418-2C8A567C1B75}];2 ;AgreementTypeText   ;Element ;Text     }

    { [{5ED4EC0F-7ED7-4480-9E33-4588F94F0A34}];2 ;AgreementTypeCode   ;Element ;Text     }

    { [{8E3B3953-F5A8-4B8F-AEF1-6F8FD3D11CBA}];2 ;AgreementDate       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{C2FA4AD8-97A9-4D88-B3DF-3B44141BBA63}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format8;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format8 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{1D7C737F-00CD-4542-B50B-30B79D4F4BAF}];2 ;NotificationIdentifier;Element;Text    }

    { [{FFC4A7C1-2225-4249-AB84-216DD7553642}];2 ;NotificationDate    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{966D5A27-5707-4755-A8C2-B922614F2F84}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format9;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format9 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{C13699E9-0188-4D49-81F9-D7E7CEEE7D39}];2 ;RegistrationNumberIdentifier;Element;Text }

    { [{6C658DB0-847B-4150-ADAF-A152ABD29F0E}];2 ;ControllerIdentifier;Element ;Text     }

    { [{63A4C020-1595-4021-A571-2313195D4F83}];2 ;ControllerName      ;Element ;Text     }

    { [{92302601-AD7C-4680-BD4D-EBC58BAD4E07}];2 ;ControlDate         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{D41D906C-74FC-4B80-A077-7C9F74761758}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format10;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format10 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{4B4AAA9C-0CE4-4C32-BD0F-BE7790474C8B}];2 ;BuyerReferenceIdentifier;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 BuyerReferenceIdentifier := COPYSTR("Sales Cr.Memo Header"."Your Reference",1,35);
                                                                               END;
                                                                                }

    { [{6B25F86A-C1AA-4EB6-9C95-126BCED88D45}];2 ;ProjectReferenceIdentifier;Element;Text }

    { [{9B96D3CB-55AF-46A9-B082-D3CBFAD3A1AB}];2 ;DefinitionDetails   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{0A104459-519C-430C-AB0E-F56F36C34354}];3 ;DefinitionHeaderText;Element ;Text     }

    { [{1C8DDC1D-0594-4088-9EAC-45E672EE1456}];4 ;DefinitionCode      ;Attribute;Text   ;
                                                  Occurrence=Optional }

    { [{24206EB7-F8CB-4166-998F-E816C250E6DC}];3 ;DefinitionValue     ;Element ;Text     }

    { [{D73E93E2-3ED0-4C21-B075-5636BD297A23}];2 ;InvoiceTotalVatExcludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceTotalVatExcludedAmount := FormatDecimal(gInvTotalExcVAT);
                                                                               END;
                                                                                }

    { [{F8E015F6-29E7-4E8A-B3D0-BA66D8BE72A4}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier8;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier8 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{5A79FB2C-2EBD-465F-99D8-4A8E375B4740}];2 ;InvoiceTotalVatAmount;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceTotalVatAmount := FormatDecimal(gInvTotalVAT);
                                                                               END;
                                                                                }

    { [{556D2DE3-E173-4746-9562-2249A88812CF}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier11;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier11 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{55885038-E8CA-4173-9CCE-669E65EB404A}];2 ;InvoiceTotalVatIncludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceTotalVatIncludedAmount := FormatDecimal(gInvTotalIncVAT);
                                                                               END;
                                                                                }

    { [{EAB9331E-0012-445D-9DDC-A1CF70E5FF32}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier1 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{685B4179-5DD4-486E-9E70-81B68E05A4E1}];2 ;InvoiceTotalRoundoffAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{197A4A26-7665-4443-8DF1-DE0008694EAD}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier12;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier12 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{69F22E43-B70F-4CAD-A2B0-00DFFD14C08B}];2 ;ExchangeRate        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{781E1A3E-A131-4759-B740-5536F1500A0A}];2 ;OtherCurrencyAmountVatExcludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2B540D8A-1DE0-4B4A-929C-BE8F6C8FD60A}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier13;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier13 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{9888638A-B853-4519-98AB-7C9D28C7095A}];2 ;OtherCurrencyAmountVatIncludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F6089C70-7989-4220-A248-A99B35ABE041}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier14;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier14 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{909251A9-4BB1-43EA-97B9-BD396A9BB925}];2 ;CreditLimitAmount   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2CAD29A1-50FA-4C15-9D27-6F9B4EE17634}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier15;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier15 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{36837D93-90B6-4451-BA5D-F675523425D8}];2 ;CreditInterestPercent;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AEBE91DA-47BA-493B-8DC6-D1AF8244AD39}];2 ;OperationLimitAmount;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{19393F0B-4F07-4BCA-8AB8-BA4B4FD35D90}];2 ;MonthlyAmount       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{6ADC4F30-CE4B-434A-AC86-856BDE90E48C}];2 ;ShortProposedAccountIdentifier;Element;Text }

    { [{2F700F83-3A17-48C5-BBA2-493B76119E0D}];2 ;NormalProposedAccountIdentifier;Element;Text }

    { [{B4D88D9D-6C05-4C68-994C-9BD7B52CF36F}];2 ;ProposedAccountText ;Element ;Text     }

    { [{1015EC20-61E6-4280-8B05-FCB2290540F3}];2 ;AccountDimensionText;Element ;Text     }

    { [{EC9C6446-0074-4D07-B344-A37878DC2CE8}];2 ;SellerAccountText   ;Element ;Text     }

    { [{C4FE2AB0-E6C8-4F73-BDF7-E7229DAD9CC8}];2 ;VatSpecificationDetails;Element;Table ;
                                                  VariableName=VATAmountLine;
                                                  SourceTable=Table290;
                                                  Temporary=Yes }

    { [{DE7CCAB9-9E0A-4B03-BA3F-ADDD98A4C044}];3 ;VatBaseAmount       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VatBaseAmount := FormatDecimal(VATAmountLine."VAT Base");
                                                                               END;
                                                                                }

    { [{EB03BE4F-F3D4-4DDE-8E04-43FAF8237E53}];4 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier9;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier9 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{3B509E1C-D480-4AD7-A463-5C50BB00F22C}];3 ;VatRatePercent      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VatRatePercent := FormatQty(VATAmountLine."VAT %");
                                                                               END;
                                                                                }

    { [{2365DAC3-728A-4CD8-8850-00390BD952AC}];3 ;VatRateAmount       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 VatRateAmount := FormatDecimal(VATAmountLine."VAT Amount");
                                                                               END;
                                                                                }

    { [{61AADF30-DB95-4230-ABB7-25D91EDD2C12}];4 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier10;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier10 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{40CBF05F-5446-46D3-BD04-D587B55A9B8E}];2 ;InvoiceFreeText     ;Element ;Text     }

    { [{3D603A62-4FA8-49AE-9D83-220F76669ACF}];2 ;InvoiceVatFreeText  ;Element ;Text     }

    { [{299F419C-D59B-47E8-9AB1-58A808A4D258}];2 ;PaymentTermsDetails ;Element ;Text     }

    { [{72374FC1-745E-4F16-9B37-07322C9216F4}];2 ;DiscountDetails     ;Element ;Text     }

    { [{7C704E0E-D1E3-4B4F-8D1C-8CC4B269D1EB}];1 ;PaymentStatusDetails;Element ;Text     }

    { [{9F2988BD-3FD2-4BE6-9229-8D13F568C1E9}];1 ;PartialPaymentDetails;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{9488A32B-4D0C-4B63-A120-A68EBEC90F21}];2 ;PaidAmount          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{5DA7B178-C7FD-4DBB-888B-301F3D1916BF}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentPaidAmount;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentPaidAmount := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{D7294DD7-924D-40CD-BECC-CF92A176E91D}];2 ;PaidVatExcludedAmount;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{460556DA-C19D-46DC-AEA0-214200207C61}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentPaidVatExcAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentPaidVatExcAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{A17CDA40-0FD4-43BD-890E-3D1376848657}];2 ;UnPaidAmount        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{CF2A0EAB-2FC4-4FCE-8C5A-E01A50C8E921}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentUnPaidAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentUnPaidAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{D3333A77-123F-4795-A783-BE3D65CF9200}];2 ;UnPaidVatExcludedAmount;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{626FFDA0-6B3B-4C24-A6D8-08F0057EF48C}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentUnPaidVatExcAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentUnPaidVatExcAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{D59661B5-3F13-48B4-A788-ED6DEA0819D5}];2 ;InterestPercent     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{96234F3C-00BF-43E4-B254-84DEBB4A1128}];2 ;ProsessingCostsAmount;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{C5262370-81E6-4D40-9304-EC4151DA3095}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentProssCostAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentProssCostAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{4F18E00D-195E-4F2E-8501-EF8A45977EE5}];2 ;PartialPaymentVatIncludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{CC84DFB0-159E-49AC-9B1F-6DAE0D11E459}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentPartPaymVatIncAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentPartPaymVatIncAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{67CF9911-39A6-4075-9DA0-07ED733BF6CB}];2 ;PartialPaymentVatExcludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{8CD2CCE9-F308-454A-95AA-93794EDFCFBA}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmtCurrIdentPartPaymVatExcAmt;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmtCurrIdentPartPaymVatExcAmt := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{2E9CDD3B-F3FA-403C-80FC-066FD93778AA}];2 ;PartialPaymentDueDate;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{EB04984B-5172-47B3-8BFA-006F1AEAF57C}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=FormatPartPaymentDueDate;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 FormatPartPaymentDueDate := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{3B160068-E8E2-481A-BAEB-2AD3E27B8404}];2 ;PartialPaymentReferenceIdentifier;Element;Text }

    { [{C3CB8177-870A-47E9-BBE3-29E1EB068B53}];1 ;FactoringAgreementDetails;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{08D827B0-414F-4B7B-9BE1-F9605E40CFC5}];2 ;FactoringAgreementIdentifier;Element;Text }

    { [{AE540234-6796-4B2B-A6D5-B6A462763975}];2 ;TransmissionListIdentifier;Element;Text }

    { [{497ED586-E95F-405D-A425-ADEDFB9F790C}];2 ;EndorsementClauseCode;Element;Text     }

    { [{CFA2BB0B-18DB-42F0-8FA8-22A96A3EC277}];2 ;FactoringTypeCode   ;Element ;Text     }

    { [{4820F340-5266-4729-A1B9-968831C71909}];2 ;FactoringFreeText   ;Element ;Text     }

    { [{C8F08DEA-9700-43F7-9F7D-2550BC311255}];2 ;FactoringPartyIdentifier;Element;Text  }

    { [{05083C0C-FD22-4BD5-A95B-FD7D6853B25F}];2 ;FactoringPartyName  ;Element ;Text     }

    { [{7B81F8BA-4D5A-421B-A7A0-9519A134FC9B}];2 ;FactoringPartyPostalAddressDetails;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{E5C074FB-C72B-43B7-9B15-E1FFF3095910}];3 ;FactoringPartyStreetName;Element;Text  }

    { [{F3D0B357-3402-412E-A2B0-A18211D1A9ED}];3 ;FactoringPartyTownName;Element;Text    }

    { [{5C837652-FD65-43FC-A054-E01B8A2EA30C}];3 ;FactoringPartyPostCodeIdentifier;Element;Text }

    { [{59C4C8CF-06FE-4F9F-B51C-0389FFC06237}];3 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=CountryCodeFactPartyPostAddr }

    { [{3CAE63B5-0985-46D2-852C-7D7C82D0C4BF}];3 ;CountryName         ;Element ;Text    ;
                                                  VariableName=CountryNameFactPartyPostAddr }

    { [{9B7A5452-6965-442C-95C5-A43385B37967}];3 ;FactoringPartyPostOfficeBoxIdentifier;Element;Text }

    { [{7D754B33-6D03-460C-B33E-29162A16271C}];1 ;VirtualBankBarcode  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 //IF "Sales Cr.Memo Header"."Reference No." <> '' THEN
                                                                                 //  VirtualBankBarcode := COPYSTR('4' + DELCHR(CompanyInfo.IBAN,'=','FI ') +
                                                                                 //  ConvTotal(gInvTotalIncVAT) + '000' + FillLeadingZero("Sales Cr.Memo Header"."Reference No.", 20) +
                                                                                 //  FORMAT("Sales Cr.Memo Header"."Due Date",0,'<Year,2><Month,2><Day,2>'),1,512);
                                                                               END;
                                                                                }

    { [{E195123B-0741-48A8-9BE5-676EC0F01598}];1 ;InvoiceRow          ;Element ;Table   ;
                                                  SourceTable=Table115;
                                                  SourceTableView=SORTING(Field3,Field4)
                                                                  ORDER(Ascending);
                                                  LinkFields=Field2=FIELD(Field2),
                                                             Field3=FIELD(Field3);
                                                  LinkTable=Sales Cr.Memo Header }

    { [{C53F089A-A972-489C-BDD3-A192C292CEA1}];2 ;RowSubIdentifier    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{45760A02-964D-41F3-A95C-4FDB72B492BA}];2 ;ArticleIdentifier   ;Element ;Text    ;
                                                  DataType=Code;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ArticleIdentifier := COPYSTR("Sales Cr.Memo Line"."No.",1,35);
                                                                               END;
                                                                                }

    { [{54F01277-186A-4C9D-8932-83BA8E434F2F}];2 ;ArticleGroupIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{534AA4E2-4526-42B5-B028-35A5FE2F34D8}];2 ;ArticleName         ;Element ;Text    ;
                                                  DataType=Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ArticleName := COPYSTR("Sales Cr.Memo Line".Description,1,100);
                                                                               END;
                                                                                }

    { [{AB3CE0E1-E7B2-4E06-B046-99BDB027DE9A}];2 ;ArticleInfoUrlText  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AFD0A3E5-CDB3-4128-812C-A361928D6023}];2 ;BuyerArticleIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3E262B03-63E9-4B81-AC70-41FB28B75722}];2 ;EanCode             ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{491C3ADB-E27B-41EA-BFE7-FBF45365C9B4}];2 ;RowRegistrationNumberIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{51BB29D2-8F29-48C9-8670-4E7C85C754BC}];2 ;SerialNumberIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{84A40A00-8F34-46BA-851B-AD6E561275AB}];2 ;RowActionCode       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2241D363-9870-4082-83A1-EC8FFC3CD034}];2 ;RowDefinitionDetails;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{99628F68-267D-43B1-9868-23DC7B7C6020}];3 ;RowDefinitionHeaderText;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{19FBAB2C-5A06-480E-9832-23A1E974D509}];4 ;DefinitionCode      ;Attribute;Text   ;
                                                  VariableName=DefinitionCode2;
                                                  Occurrence=Optional;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{0944BBC0-628B-40A6-A950-F7251860C6FD}];3 ;RowDefinitionValue  ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{6687E05C-C3AD-49C4-AAAE-9172AE23E77B}];2 ;OfferedQuantity     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{0F87192B-3E91-4CA3-9056-B8D495563454}];2 ;DeliveredQuantity   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 DeliveredQuantity := FormatQty("Sales Cr.Memo Line".Quantity);
                                                                               END;
                                                                                }

    { [{B3F6F70E-C94A-4763-830E-A0D61720D810}];3 ;QuantityUnitCode    ;Attribute;Text   ;
                                                  VariableName=QuantityUnitCode1;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 QuantityUnitCode1 := COPYSTR("Sales Cr.Memo Line"."Unit of Measure",1,14);
                                                                               END;
                                                                                }

    { [{F60D3FB2-B144-46D2-826F-09FF5E1CB63A}];2 ;OrderedQuantity     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 OrderedQuantity := FormatQty("Sales Cr.Memo Line".Quantity);
                                                                               END;
                                                                                }

    { [{5FBDA75D-0E02-43CD-BB85-ECA9A92F6516}];3 ;QuantityUnitCode    ;Attribute;Text   ;
                                                  VariableName=QuantityUnitCode2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 QuantityUnitCode2 := COPYSTR("Sales Cr.Memo Line"."Unit of Measure",1,14);
                                                                               END;
                                                                                }

    { [{36D56111-5584-444B-9CAE-12A891FDE573}];2 ;ConfirmedQuantity   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{4CEB07BA-E714-432A-985C-60D02EE71FB7}];2 ;PostDeliveredQuantity;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{FEE90149-83C3-4005-B392-CBBA1C34C073}];2 ;InvoicedQuantity    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{8F47B51F-2C28-4055-85BB-20B0F3A4624E}];2 ;CreditRequestedQuantity;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{06A8DE46-2C50-420D-A35B-03F9BEFCB49D}];2 ;ReturnedQuantity    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F8C327C9-7084-410D-8D78-8D8894B69627}];2 ;StartDate           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3DA47E9E-2E5F-4859-8E00-FF16F21F148D}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format11;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format11 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{BFF535C0-9FDD-4B46-8285-B8882EED518B}];2 ;EndDate             ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F3557850-543E-48FD-AAB5-0FE7C346A44A}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format12;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format12 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{D25F39C4-0311-4F3F-8292-5CEF35E4E529}];2 ;UnitPriceAmount     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF "Sales Cr.Memo Header"."Prices Including VAT" THEN
                                                                                    UnitPriceAmount := FormatDecimal(ROUND(100 * "Sales Cr.Memo Line"."Unit Price"*-1/(100 + "Sales Cr.Memo Line"."VAT %"), 0.01))
                                                                                   ELSE
                                                                                     IF "Sales Cr.Memo Line"."Unit Price" = ROUND("Sales Cr.Memo Line"."Unit Price"*-1, 0.01) THEN
                                                                                       UnitPriceAmount := FormatDecimal(ROUND("Sales Cr.Memo Line"."Unit Price"*-1, 0.01))
                                                                                     ELSE
                                                                                       UnitPriceAmount := FormatDecimal(ROUND("Sales Cr.Memo Line"."Unit Price"*-1, 0.00001));
                                                                               END;
                                                                                }

    { [{7F807ADA-65A0-4FB3-8962-576D4A2407CB}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier6;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier6 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{BB3ECFD9-57E5-4DDB-BA8A-7288804387EF}];3 ;UnitPriceUnitCode   ;Attribute;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 UnitPriceUnitCode := COPYSTR(InvCurrencyCode + '/' + "Sales Cr.Memo Line"."Unit of Measure Code",1,14);
                                                                               END;
                                                                                }

    { [{ED4F0FEB-415F-4D52-80DC-DA472ED6A719}];2 ;UnitPriceVatIncludedAmount;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{75A6C971-AD6F-4E5F-B36A-F701EC9904A3}];3 ;UnitPriceVatIncludedAmount;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier18;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier18 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{FF07515F-AED9-47EE-ACBF-DBB9BA416C54}];2 ;UnitPriceBaseQuantity;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{53932CD4-977F-4E26-856E-44921EE3E2EC}];2 ;RowIdentifier       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3B8DC59C-76CC-4C48-B523-188F00055E4E}];2 ;RowIdentifierUrlText;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{C416F6BF-91F0-4D46-A71C-8041CB4B2B84}];2 ;RowOrderPositionIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{3D02CA49-AD55-496D-AC3F-442DD95D7270}];2 ;RowIdentifierDate   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{49B50C25-3B0C-4216-89DF-BFD1D233A8FF}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format13;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format13 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{5CE07A1F-E4FD-4897-8E77-5BB9DCCC302B}];2 ;RowPositionIdentifier;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{011058DB-BF07-439D-A0BB-55687039CD8B}];2 ;OriginalInvoiceNumber;Element;Text    ;
                                                  VariableName=OriginalInvoiceNumber2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{13B3CADD-95CA-4F1A-B485-67607F34585D}];2 ;RowOrdererName      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{05094268-02FC-4531-ADA2-1D673585FD95}];2 ;RowSalesPersonName  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{50163123-6053-47F4-887E-32C1516552F4}];2 ;RowOrderConfirmationIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{04CB006F-7088-46C3-8889-F2B3DC5971B9}];2 ;RowOrderConfirmationDate;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{04F41E3B-308A-4613-B3DE-EE3981A63C18}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format14;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format14  := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{0E66C5E8-B459-4183-8456-FD912A8759D9}];2 ;RowDeliveryIdentifier;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{CF05FB9B-3B50-422D-A324-3C97F1117440}];2 ;RowDeliveryIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{563E2DE6-7AE4-4A32-81C3-03760714F2EE}];2 ;RowDeliveryDate     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{32F8907A-1724-4AAA-8970-6BB0FBDFDB08}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format15;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format15  := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{0A7548D9-8F3F-4FFF-AE06-DF1DC0DD5355}];2 ;RowQuotationIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{86D4018C-60D4-4B47-8AAF-E5322EF9EE9B}];2 ;RowQuotationIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{BCCA2FC9-63E5-4293-AB4B-257C13D2575F}];2 ;RowAgreementIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{8C8E4A9C-5C17-494A-8BBE-AB06CCF2F045}];2 ;RowAgreementIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{7EB38D4E-02BC-436D-8AF5-91FC73A36813}];2 ;RowRequestOfQuotationIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{EDE2AA6D-64B2-46B2-93EB-5A9A2E2D5528}];2 ;RowRequestOfQuotationIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F05BFF08-D0E6-4B4D-B25C-172631602E37}];2 ;RowPriceListIdentifier;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{967BD9CD-ADD2-4C17-AEDB-DBBB242A90AA}];2 ;RowPriceListIdentifierUrlText;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{50B6BD01-C027-4F96-8CE9-EF6FBED1EEC7}];2 ;RowProjectReferenceIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{84728BB7-BB38-4D3D-B50B-34A2A99D166B}];2 ;RowOverDuePaymentDetails;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{5FFB9EE7-D94C-4616-8B35-3664A8ABD4D3}];2 ;RowAnyPartyDetails  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{76888161-0638-48E5-8B19-2B6ABB4565FC}];3 ;RowAnyPartyText     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F819AA6E-AABA-49C5-9D9F-A0EBA36B1369}];4 ;AnyPartyCode        ;Attribute;Text   ;
                                                  VariableName=AnyPartyCodeRowAnyPartyText;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{13BCC19A-F961-4F62-9CF8-9DD8627692C8}];3 ;RowAnyPartyIdentifier;Element;Text    ;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{D3AEF968-79DF-4481-BC36-4F512CF005FC}];3 ;RowAnyPartyOrganisationName;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{C566657A-9156-4DFF-902B-2F61DB12F2EA}];3 ;RowAnyPartyOrganisationDepartment;Element;Text;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{6FE78D3D-A061-4507-8CC5-A79AC6FF1ECB}];3 ;RowAnyPartyOrganisationTaxCode;Element;Text;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{108CE6F9-DFB2-4944-9E07-670291978846}];3 ;RowAnyPartyPostalAddressDetails;Element;Text;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{A78D3E29-D5CA-4063-A74D-088D079272C3}];4 ;RowAnyPartyStreetName;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{530CE0D5-826E-483E-840A-46FD6739DD2D}];4 ;RowAnyPartyTownName ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{F4CC77DD-5D53-4E7F-9633-830B681F9D8A}];4 ;RowAnyPartyPostCodeIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{0201A2A0-779E-40BE-A0BA-15B49E23A94B}];4 ;CountryCode         ;Element ;Text    ;
                                                  VariableName=RowAnyPartyCountryCode;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{BC87CBF5-B4DA-403F-939E-66E295BCB6D9}];4 ;CountryName         ;Element ;Text    ;
                                                  VariableName=RowCountryName;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2337BD17-386F-4114-BC85-197A5773CF89}];4 ;RowAnyPartyPostOfficeBoxIdentifier;Element;Text;
                                                  MinOccurs=Zero;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{730629BD-158F-42CE-B5D3-85B372475A4D}];3 ;RowAnyPartyOrganisationUnitNumber;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{796E25D5-C248-44A6-8692-B7A2D9A8A63F}];3 ;RowAnyPartySiteCode ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{ED07F7A2-5CEC-419E-A538-92ED2F1F8332}];2 ;RowDeliveryDetails  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{ABF3083D-C215-4760-8F8D-D158A6062202}];2 ;RowShortProposedAccountIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{C9BA21ED-C43F-47C2-98B8-8F521B47E521}];2 ;RowNormalProposedAccountIdentifier;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{6A329EAF-DEE5-4D17-B631-B5401BF9E99F}];2 ;RowProposedAccountText;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{30CDFC4A-AB8B-498A-8768-FCBDD7644A85}];2 ;RowAccountDimensionText;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{934741C9-4065-4074-8AB5-E8933010104B}];2 ;RowSellerAccountText;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{BF53BCAE-73D3-4CA5-BD49-A5072B87E564}];2 ;RowFreeText         ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{1AB371B3-9016-40A6-AF14-E740721BBA4F}];2 ;RowUsedQuantity     ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{D6152D2B-5D96-46C0-862C-B61AE5599CCD}];2 ;RowPreviousMeterReadingDate;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{42D10B13-157C-4BEF-9503-DF7E8457A678}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format16;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format16 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{2D546620-2FA4-452A-93F8-5EE7AD08907C}];2 ;RowLatestMeterReadingDate;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{DF0887C5-CE47-4C4D-8B79-88DBD192B2D7}];3 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format17;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format17 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{87A07E65-6BE6-447B-A435-B0E767CD6E66}];2 ;RowCalculatedQuantity;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{2964C94D-77F3-4800-86FE-6D6DCFAF05BA}];2 ;RowAveragePriceAmount;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{99D79E98-23D8-42EF-9E23-1A7DA37C9C1F}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier19;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier19 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{C42E4195-F432-4202-8761-199C940C6A43}];2 ;RowDiscountPercent  ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowDiscountPercent := FormatQty("Sales Cr.Memo Line"."Line Discount %");
                                                                               END;
                                                                                }

    { [{341BB8EA-4BE3-4890-B969-D8DBC12A59FD}];2 ;RowDiscountAmount   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowDiscountAmount := FormatDecimal("Sales Cr.Memo Line"."Line Discount Amount");
                                                                               END;
                                                                                }

    { [{5F314A33-0DBF-4590-A684-56219119DDFE}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier5;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier5 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{D8BA49E2-C877-4F2C-B30B-84DB775E8DFF}];2 ;RowDiscountTypeCode ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{CB405B2F-C905-402F-9A4A-89797B3CE848}];2 ;RowDiscountTypeText ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{CA8EBB00-15A3-4237-B7EE-8B6636FB19FF}];2 ;RowProgressiveDiscountDetails;Element;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{DF1A48AE-68BB-47EA-A94B-9E0FD40EB679}];2 ;RowVatRatePercent   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{07C41A17-7480-42D4-8C99-60839A133C49}];2 ;RowVatCode          ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{88F28265-A5F9-4620-9BBE-F6FB0868218C}];2 ;RowVatAmount        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowVatAmount := FormatDecimal(
                                                                                   (("Sales Cr.Memo Line"."Amount Including VAT"*-1) - ("Sales Cr.Memo Line".Amount*-1)));
                                                                               END;
                                                                                }

    { [{530C6419-78BD-4FD2-9D55-9F72D9C5182D}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier7;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier7 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{C2AE23C8-F1C8-4BA8-B38C-D226C7D14F90}];2 ;RowVatExcludedAmount;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowVatExcludedAmount := FormatDecimal(("Sales Cr.Memo Line".Amount*-1));
                                                                               END;
                                                                                }

    { [{8E274531-B891-48F9-8996-9043330F7211}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier3;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier3 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{3090635F-7070-4A6A-B40A-5D36BCC30EEE}];2 ;RowAmount           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 RowAmount := FormatDecimal(("Sales Cr.Memo Line"."Amount Including VAT"*-1));
                                                                               END;
                                                                                }

    { [{08C24725-B957-418A-A60E-4A2BE2054B0F}];3 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier4;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier4 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{54693BD7-7657-408F-B18F-745C3718EBF7}];2 ;RowTransactionDetails;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{8ACCBC06-CB61-433E-83B8-5423BBA7FB80}];2 ;SubInvoiceRow       ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{544CDCFF-8873-47BD-84DE-D06E5822F52C}];1 ;SpecificationDetails;Element ;Text     }

    { [{FC91E03C-84BE-4066-B15B-EDE8D0E05897}];1 ;EpiDetails          ;Element ;Text     }

    { [{362A340F-CE08-4963-8593-9A1EA4FD6909}];2 ;EpiIdentificationDetails;Element;Text  }

    { [{13F2C7A7-6AB5-4199-A190-EBF7A4E884C3}];3 ;EpiDate             ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiDate := FormatDate("Sales Cr.Memo Header"."Document Date");
                                                                               END;
                                                                                }

    { [{3D8CDA19-9FE3-459F-A71D-385B58C373A2}];4 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format2 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{DF682637-9CE7-4062-A4D4-8633A908F2B0}];3 ;EpiReference        ;Element ;Text     }

    { [{9855362B-E9C1-484D-B140-91D9B44DA745}];3 ;EpiUrl              ;Element ;Text     }

    { [{C3B134AD-9450-4F2C-959F-8FBB4A8E59C9}];3 ;EpiEmail            ;Element ;Text     }

    { [{CF2CD9A4-A669-4FBA-9EE7-93EA5D208428}];3 ;EpiOrderInfo        ;Element ;Text     }

    { [{19FB4FB6-F94B-46E2-B59A-183EEF1E4072}];2 ;EpiPartyDetails     ;Element ;Text     }

    { [{D9F455C6-4C04-4906-91E7-2E0948AA4E59}];3 ;EpiBfiPartyDetails  ;Element ;Text     }

    { [{8B7EFE1D-C3C5-4B81-BA3C-1AD3C1AB5E7E}];4 ;EpiBfiIdentifier    ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF FinvoiceSetup."Intermediator Code" <> '' THEN
                                                                                   EpiBfiIdentifier := FinvoiceSetup."Intermediator Code"
                                                                                 ELSE
                                                                                   EpiBfiIdentifier := CompanyInfo."SWIFT Code";
                                                                               END;
                                                                                }

    { [{374A2513-D7A0-4D75-A845-93A6B995A2AC}];5 ;IdentificationSchemeName;Attribute;Text;
                                                  VariableName=IdentificationSchemeName2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentificationSchemeName2 := 'BIC';
                                                                               END;
                                                                                }

    { [{764CA436-C945-4783-90EE-B8F08FD06B76}];4 ;EpiBfiName          ;Element ;Text     }

    { [{649EDA05-028A-44A0-A688-BE7DC2E5B721}];3 ;EpiBeneficiaryPartyDetails;Element;Text }

    { [{5C066D8A-BF79-4F3C-8309-266C9722D303}];4 ;EpiNameAddressDetails;Element;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiNameAddressDetails := CompanyInfo.Name;
                                                                               END;
                                                                                }

    { [{917B474B-A582-458E-A909-0AAD64E94D3B}];4 ;EpiBei              ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{93F51830-FFC6-4A69-81E6-5F7F6AF79AB9}];4 ;EpiAccountID        ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IF FinvoiceSetup."IBAN Account No." <> '' THEN
                                                                                   EpiAccountID := FinvoiceSetup."IBAN Account No."
                                                                                 ELSE
                                                                                   EpiAccountID := CompanyInfo.IBAN;
                                                                               END;
                                                                                }

    { [{A8B2B76B-A9A4-4991-8EC1-DD6C5ABEDA84}];5 ;IdentificationSchemeName;Attribute;Text;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 IdentificationSchemeName := 'IBAN';
                                                                               END;
                                                                                }

    { [{32F9AAA4-35E2-41C3-9643-9AF1AD8C63C1}];2 ;EpiPaymentInstructionDetails;Element;Text }

    { [{B885291B-522A-45C0-9557-0B6B06D67CFC}];3 ;EpiPaymentInstructionId;Element;Text  ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiPaymentInstructionId := 'E-lasku';
                                                                               END;
                                                                                }

    { [{CE9545ED-C59B-4F58-89B6-DAC884C7968A}];3 ;EpiTransactionTypeCode;Element;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{AD676C19-6C9D-4395-B96A-9FFFBA42D18B}];3 ;EpiInstructionCode  ;Element ;Text     }

    { [{8B301F99-AEB8-47B7-BC54-D75DDEAB80E5}];3 ;EpiRemittanceInfoIdentifier;Element;Text }

    { [{1A4E7CAE-DF46-4052-BFA6-926F4094F400}];3 ;EpiInstructedAmount ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiInstructedAmount := FormatDecimal(TotalAmountInclVAT);
                                                                               END;
                                                                                }

    { [{6F303242-1AD0-423E-B741-BFBB0516DD73}];4 ;AmountCurrencyIdentifier;Attribute;Text;
                                                  VariableName=AmountCurrencyIdentifier2;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 AmountCurrencyIdentifier2 := InvCurrencyCode;
                                                                               END;
                                                                                }

    { [{0D853299-85E1-4840-9E90-2910D33A577F}];3 ;EpiCharge           ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiCharge := 'SHA'
                                                                               END;
                                                                                }

    { [{8A95B325-B7AF-4F84-B64A-912F6FE2E2CE}];4 ;ChargeOption        ;Attribute;Text   ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 ChargeOption := 'SHA'
                                                                               END;
                                                                                }

    { [{A8A71FFD-3EBB-4F95-B8AA-C07E884D317B}];3 ;EpiDateOptionDate   ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 EpiDateOptionDate := FormatDate("Sales Cr.Memo Header"."Due Date");
                                                                               END;
                                                                                }

    { [{706CEC28-B86D-4F38-95D9-D861FEC4E007}];4 ;Format              ;Attribute;Text   ;
                                                  VariableName=Format18;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 Format18 := gtxBaseDateFormat;
                                                                               END;
                                                                                }

    { [{4DB9DFC8-1863-490E-B17E-259ECF60604D}];1 ;InvoiceUrlNameText  ;Element ;Text     }

    { [{FE2B66E4-73BC-4FDE-B6C9-73C041D4158B}];1 ;InvoiceUrlText      ;Element ;Text    ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 InvoiceUrlText := 'attachment://'+ "Sales Cr.Memo Header"."No."+'.pdf';
                                                                               END;
                                                                                }

    { [{B7AFE632-F208-443A-AF02-8306345A6621}];1 ;StorageUrlText      ;Element ;Text     }

    { [{58E11B09-F055-46DB-B169-F151F4779B10}];1 ;LayOutIdentifier    ;Element ;Text     }

    { [{DC06320C-0D54-43BA-8665-9C976294B37F}];1 ;InvoiceSegmentIdentifier;Element;Text  }

    { [{15218C37-20C1-4358-92BF-55DDDDE25B45}];1 ;ControlStampText    ;Element ;Text     }

    { [{2CAEB421-0114-4C2B-A4D3-7FA61FA1E8EC}];1 ;AcceptanceStampText ;Element ;Text     }

    { [{7794927C-2E34-467A-8406-EB53547F4A93}];1 ;OriginalInvoiceFormat;Element;Text    ;
                                                  VariableName=OriginalInvoiceFormat3 }

    { [{D63EF924-FEEC-4AE3-8A7F-2DE08FA1FC6D}];1 ;AttachmentMessageDetails;Element;Text ;
                                                  Export::OnBeforePassVariable=BEGIN
                                                                                 currXMLport.SKIP;
                                                                               END;
                                                                                }

    { [{41E5A62D-E068-4B3E-A3DD-EAF76DA43038}];2 ;AttachmentMessageIdentifier;Element;Text }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      SalesSetup@1000000000 : Record 311;
      ShipmentMethod@1000000001 : Record 10;
      ShippingAgent@1000000002 : Record 291;
      PaymentTerms@1000000003 : Record 3;
      FinanceChargeTerms@1000000004 : Record 5;
      SalesPurchPerson@1000000005 : Record 13;
      CompanyInfo@1000000006 : Record 79;
      Country@1000000007 : Record 9;
      ShipToAddress@1000000009 : Record 222;
      SellCustomer@1000000010 : Record 18;
      BillCustomer@1000000011 : Record 18;
      ShipCustomer@1000000012 : Record 18;
      gSalesCrMemoLines@1000000008 : Record 115;
      recShippingAgent@1000000016 : Record 291;
      recShipmentMethod@1000000017 : Record 10;
      GLsetup@1000000018 : Record 98;
      gInvTotalIncVAT@1000000013 : Decimal;
      gInvTotalExcVAT@1000000014 : Decimal;
      gInvTotalVAT@1000000015 : Decimal;
      InvCurrencyCode@1000000019 : Code[10];
      TotalSubTotal@1000000026 : Decimal;
      TotalAmount@1000000025 : Decimal;
      TotalAmountInclVAT@1000000024 : Decimal;
      TotalAmountVAT@1000000023 : Decimal;
      TotalInvDiscAmount@1000000022 : Decimal;
      TotalPaymentDiscOnVAT@1000000021 : Decimal;
      gtxBaseDateFormat@1000000020 : Text;
      gtxInvoiceLanguageCode@1000000027 : Text[2];
      FinvoiceSetup@1000 : Record 11250735;

    LOCAL PROCEDURE FormatDate@1000000010(DateToFormat@1000000000 : Date) FormattedDate : Text[20];
    BEGIN
      FormattedDate := FORMAT(DateToFormat,0,'<YEAR4,4><MONTH,2><DAY,2>');
    END;

    LOCAL PROCEDURE FormatDecimal@1000000032(DecimalToFormat@1000000000 : Decimal) FormattedDecimal : Text[20];
    BEGIN
      FormattedDecimal := FORMAT(DecimalToFormat,0,'<Sign><integer><Decimals,3>');
    END;

    LOCAL PROCEDURE FormatQty@1000000004(QtyToFormat@1000000000 : Decimal) FormattedQty : Text[20];
    BEGIN
      FormattedQty := FORMAT(QtyToFormat,0,1);
    END;

    PROCEDURE ConvTotal@1000000002(Total@1000000000 : Decimal) TotalStr : Text[8];
    VAR
      IntegerTxt@1000000001 : Text[6];
      DecimalText@1000000002 : Text[2];
      Amount@1000000003 : Decimal;
    BEGIN
      //Muutetaan senteiksi
      Amount := 100 * Total;
      //Otetaan vain kokonaiset
      TotalStr := FORMAT(Amount,8,'<Integer>');
      //Poistetaan mahdolliset v„lily”nnit alusta
      TotalStr := DELCHR(TotalStr, '<>', ' ');
      //Etunollat„ytt”
      IF STRLEN(TotalStr) < 8 THEN
        REPEAT
          TotalStr := '0' + TotalStr;
        UNTIL STRLEN(TotalStr) = 8;
    END;

    PROCEDURE FillLeadingZero@1000000003(ReferenceString@1000000000 : Code[20];Length@1000000001 : Integer) ZeroFilledRefStr : Code[20];
    BEGIN
      //Etunollat„ytt”
      IF STRLEN(ReferenceString) < Length THEN BEGIN
        ZeroFilledRefStr := ReferenceString;
        REPEAT
          ZeroFilledRefStr := '0' + ZeroFilledRefStr;
        UNTIL STRLEN(ZeroFilledRefStr) = Length;
      END;
    END;

    BEGIN
    {
      01. 17.03.2016 EVRY/THA : Finvoice 2.0 Luotu.
      02. 24.10.2016 EVRY/JPI :
        - Finvoice 2.01 elemettej„ ja attribuutteja lis„tty
      03. 23.11.2016 EVRY/JPI :
        - Elementtej„ jotka ovat tyhji„ ja  j„„v„t skeeman
          validointiin virheeseen kuten date ja amount tyyppiset elementit
          poistettu currxmlport.skip funktiolla
        - Joitain elementtej„ joilla alielementtej„ jotka ovat tyhji„
          poistettu currxmlport.skip funktiolla sill„ j„„v„t skeeman
          validoinnissa virheeseen

      ///Huomioita\\\
      Pyrit„„n pit„m„„n rakenne yhtenev„isen„, jolloin:
      - Tehd„„n tarvittavat haut jo heti otsikkotietueen alussa
      - Usein k„ytett„v„t formatoinnit ja mukautukset tehd„„n funktioina
      - XMLport Designerissa yll„pidet„„n rakennetta
      - Koodissa kohdistetaan data rakenteeseen
      - Sis„ll”n kehitt„misess„ kannatta hy”dynt„„ vanhassa versiossa esiteltyj„ ratkaisuja
      - Finvoice Tagien tekstipituudet huomioitu

      ///KESKEN\\\
      L„pik„yt„vi„ osa-alueita:
      - Epi tietojen t„ytt„minen
      - Runko on tehty <VatSpecificationDetails>, mutta testattava usean eri ALV-%:n esitt„minen
    }
    END.
  }
}

