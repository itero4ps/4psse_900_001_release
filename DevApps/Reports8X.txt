OBJECT Report 82 Export Budget to Excel
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Export Budget to Excel;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  DimSelectionBuf.CompareDimText(
                    3,REPORT::"Export Budget to Excel",'',ColumnDim,Text000);
                END;

  }
  DATASET
  {
    { 3459;    ;DataItem;                    ;
               DataItemTable=Table96;
               DataItemTableView=SORTING(Budget Name,G/L Account No.,Business Unit Code,Global Dimension 1 Code,Global Dimension 2 Code,Budget Dimension 1 Code,Budget Dimension 2 Code,Budget Dimension 3 Code,Budget Dimension 4 Code,Date);
               OnPreDataItem=VAR
                               BusUnit@1000 : Record 220;
                             BEGIN
                               IF GETRANGEMIN("Budget Name") <> GETRANGEMAX("Budget Name") THEN
                                 ERROR(Text001);

                               IF (StartDate = 0D) OR
                                  (NoOfPeriods = 0) OR
                                  (FORMAT(PeriodLength) = '')
                               THEN
                                 ERROR(Text002);

                               SelectedDim.RESET;
                               SelectedDim.SETRANGE("User ID",USERID);
                               SelectedDim.SETRANGE("Object Type",3);
                               SelectedDim.SETRANGE("Object ID",REPORT::"Export Budget to Excel");
                               i := 0;
                               IF BusUnit.FINDFIRST THEN BEGIN
                                 i := i + 1;
                                 BusUnitDimIndex := i;
                                 BusUnitDimCode := COPYSTR(UPPERCASE(BusUnit.TABLECAPTION),1,MAXSTRLEN(ColumnDimCode[1]));
                                 ColumnDimCode[BusUnitDimIndex] := BusUnitDimCode;
                               END;
                               IF SelectedDim.FIND('-') THEN
                                 REPEAT
                                   i := i + 1;
                                   IF i > ARRAYLEN(ColumnDimCode) THEN
                                     ERROR(Text003,ARRAYLEN(ColumnDimCode));
                                   ColumnDimCode[i] := SelectedDim."Dimension Code";
                                 UNTIL (SelectedDim.NEXT = 0) OR (i = 8);
                               NoOfDimensions := i;

                               FOR i := 1 TO NoOfPeriods DO BEGIN
                                 IF i = 1 THEN
                                   TempPeriod."Period Start" := StartDate
                                 ELSE
                                   TempPeriod."Period Start" := CALCDATE(PeriodLength,TempPeriod."Period Start");
                                 TempPeriod."Period End" := CALCDATE(PeriodLength,TempPeriod."Period Start");
                                 TempPeriod."Period End" := CALCDATE('<-1D>',TempPeriod."Period End");
                                 TempPeriod."Period No." := i;
                                 TempPeriod.INSERT;
                               END;

                               SETRANGE(Date,StartDate,TempPeriod."Period End");
                               TempBudgetBuf2.DELETEALL;
                               ExcelBuf.DELETEALL;
                             END;

               OnAfterGetRecord=BEGIN
                                  CLEAR(TempBudgetBuf1);
                                  TempBudgetBuf1."G/L Account No." := "G/L Account No.";
                                  TempBudgetBuf1."Dimension Value Code 1" := GetDimValueCode(ColumnDimCode[1]);
                                  TempBudgetBuf1."Dimension Value Code 2" := GetDimValueCode(ColumnDimCode[2]);
                                  TempBudgetBuf1."Dimension Value Code 3" := GetDimValueCode(ColumnDimCode[3]);
                                  TempBudgetBuf1."Dimension Value Code 4" := GetDimValueCode(ColumnDimCode[4]);
                                  TempBudgetBuf1."Dimension Value Code 5" := GetDimValueCode(ColumnDimCode[5]);
                                  TempBudgetBuf1."Dimension Value Code 6" := GetDimValueCode(ColumnDimCode[6]);
                                  TempBudgetBuf1."Dimension Value Code 7" := GetDimValueCode(ColumnDimCode[7]);
                                  TempBudgetBuf1."Dimension Value Code 8" := GetDimValueCode(ColumnDimCode[8]);
                                  TempBudgetBuf1.Date := CalcPeriodStart(Date);
                                  TempBudgetBuf1.Amount := Amount;

                                  TempBudgetBuf2 := TempBudgetBuf1;
                                  IF TempBudgetBuf2.FIND THEN BEGIN
                                    TempBudgetBuf2.Amount :=
                                      TempBudgetBuf2.Amount + TempBudgetBuf1.Amount;
                                    TempBudgetBuf2.MODIFY;
                                  END ELSE
                                    TempBudgetBuf2.INSERT;
                                END;

               OnPostDataItem=VAR
                                DimValue@1004 : Record 349;
                                BusUnit@1007 : Record 220;
                                Window@1000 : Dialog;
                                RecNo@1001 : Integer;
                                TotalRecNo@1002 : Integer;
                                Continue@1003 : Boolean;
                                LastBudgetRowNo@1005 : Integer;
                                DimensionRange@1006 : ARRAY [2,8] OF Integer;
                              BEGIN
                                Window.OPEN(
                                  Text005 +
                                  '@1@@@@@@@@@@@@@@@@@@@@@@@@@\');
                                Window.UPDATE(1,0);
                                TotalRecNo := GLAcc.COUNT;
                                RecNo := 0;

                                RowNo := 1;
                                EnterCell(RowNo,1,Text006,FALSE,TRUE,'',ExcelBuf."Cell Type"::Text);
                                EnterCell(RowNo,2,'',FALSE,TRUE,'',ExcelBuf."Cell Type"::Text);
                                EnterFilterInCell(GETFILTER("Budget Name"),FIELDCAPTION("Budget Name"));

                                GLSetup.GET;
                                EnterFilterInCell(GETFILTER("Business Unit Code"),FIELDCAPTION("Business Unit Code"));
                                IF GLSetup."Global Dimension 1 Code" <> '' THEN BEGIN
                                  Dim.GET(GLSetup."Global Dimension 1 Code");
                                  EnterFilterInCell(GETFILTER("Global Dimension 1 Code"),Dim."Code Caption");
                                END;
                                IF GLSetup."Global Dimension 2 Code" <> '' THEN BEGIN
                                  Dim.GET(GLSetup."Global Dimension 2 Code");
                                  EnterFilterInCell(GETFILTER("Global Dimension 2 Code"),Dim."Code Caption");
                                END;
                                GLBudgetName.GET(GETFILTER("Budget Name"));
                                IF GLBudgetName."Budget Dimension 1 Code" <> '' THEN BEGIN
                                  Dim.GET(GLBudgetName."Budget Dimension 1 Code");
                                  EnterFilterInCell(GETFILTER("Budget Dimension 1 Code"),Dim."Code Caption");
                                END;
                                IF GLBudgetName."Budget Dimension 2 Code" <> '' THEN BEGIN
                                  Dim.GET(GLBudgetName."Budget Dimension 2 Code");
                                  EnterFilterInCell(GETFILTER("Budget Dimension 2 Code"),Dim."Code Caption");
                                END;
                                IF GLBudgetName."Budget Dimension 3 Code" <> '' THEN BEGIN
                                  Dim.GET(GLBudgetName."Budget Dimension 3 Code");
                                  EnterFilterInCell(GETFILTER("Budget Dimension 3 Code"),Dim."Code Caption");
                                END;
                                IF GLBudgetName."Budget Dimension 4 Code" <> '' THEN BEGIN
                                  Dim.GET(GLBudgetName."Budget Dimension 4 Code");
                                  EnterFilterInCell(GETFILTER("Budget Dimension 4 Code"),Dim."Code Caption");
                                END;

                                RowNo := RowNo + 2;
                                HeaderRowNo := RowNo;
                                EnterCell(HeaderRowNo,1,FIELDCAPTION("G/L Account No."),FALSE,TRUE,'',ExcelBuf."Cell Type"::Text);
                                EnterCell(HeaderRowNo,2,GLAcc.FIELDCAPTION(Name),FALSE,TRUE,'',ExcelBuf."Cell Type"::Text);
                                i := 0;
                                ColNo := 2;
                                Continue := TRUE;
                                WHILE Continue DO BEGIN
                                  i := i + 1;
                                  IF i > 8 THEN
                                    Continue := FALSE
                                  ELSE
                                    IF ColumnDimCode[i] = '' THEN
                                      Continue := FALSE;
                                  IF Continue THEN BEGIN
                                    ColNo := ColNo + 1;
                                    IF i = BusUnitDimIndex THEN
                                      EnterCell(HeaderRowNo,ColNo,BusUnit.TABLECAPTION,FALSE,TRUE,'',ExcelBuf."Cell Type"::Text)
                                    ELSE BEGIN
                                      Dim.GET(ColumnDimCode[i]);
                                      EnterCell(HeaderRowNo,ColNo,Dim."Code Caption",FALSE,TRUE,'',ExcelBuf."Cell Type"::Text);
                                    END;
                                  END;
                                END;
                                IF TempPeriod.FIND('-') THEN
                                  REPEAT
                                    ColNo := ColNo + 1;
                                    EnterCell(HeaderRowNo,ColNo,FORMAT(TempPeriod."Period Start"),FALSE,TRUE,'',ExcelBuf."Cell Type"::Date);
                                  UNTIL TempPeriod.NEXT = 0;

                                COPYFILTER("G/L Account No.",GLAcc."No.");
                                IF GLAcc.FIND('-') THEN
                                  REPEAT
                                    RecNo := RecNo + 1;
                                    Window.UPDATE(1,ROUND(RecNo / TotalRecNo * 10000,1));
                                    RowNo := RowNo + 1;
                                    EnterCell(
                                      RowNo,2,COPYSTR(COPYSTR(PADSTR(' ',100),1,2 * GLAcc.Indentation + 1) + GLAcc.Name,2),
                                      GLAcc."Account Type" <> GLAcc."Account Type"::Posting,FALSE,'',ExcelBuf."Cell Type"::Text);
                                    EnterCell(
                                      RowNo,1,GLAcc."No.",GLAcc."Account Type" <> GLAcc."Account Type"::Posting,FALSE,'',ExcelBuf."Cell Type"::Text);
                                    IF (GLAcc.Totaling = '') OR (NOT IncludeTotalingFormulas) THEN BEGIN
                                      TempBudgetBuf2.SETRANGE("G/L Account No.",GLAcc."No.");
                                      IF TempBudgetBuf2.FIND('-') THEN BEGIN
                                        TempBudgetBuf1 := TempBudgetBuf2;
                                        EnterDimValues;
                                        IF TempPeriod.FIND('-') THEN;
                                        REPEAT
                                          IF (TempBudgetBuf1."Dimension Value Code 1" <>
                                              TempBudgetBuf2."Dimension Value Code 1") OR
                                             (TempBudgetBuf1."Dimension Value Code 2" <>
                                              TempBudgetBuf2."Dimension Value Code 2") OR
                                             (TempBudgetBuf1."Dimension Value Code 3" <>
                                              TempBudgetBuf2."Dimension Value Code 3") OR
                                             (TempBudgetBuf1."Dimension Value Code 4" <>
                                              TempBudgetBuf2."Dimension Value Code 4") OR
                                             (TempBudgetBuf1."Dimension Value Code 5" <>
                                              TempBudgetBuf2."Dimension Value Code 5") OR
                                             (TempBudgetBuf1."Dimension Value Code 6" <>
                                              TempBudgetBuf2."Dimension Value Code 6") OR
                                             (TempBudgetBuf1."Dimension Value Code 7" <>
                                              TempBudgetBuf2."Dimension Value Code 7") OR
                                             (TempBudgetBuf1."Dimension Value Code 8" <>
                                              TempBudgetBuf2."Dimension Value Code 8")
                                          THEN BEGIN
                                            RowNo := RowNo + 1;
                                            EnterCell(
                                              RowNo,1,GLAcc."No.",GLAcc."Account Type" <> GLAcc."Account Type"::Posting,FALSE,'',ExcelBuf."Cell Type"::Text);
                                            EnterDimValues;
                                            TempBudgetBuf1 := TempBudgetBuf2;
                                          END;
                                          TempPeriod.GET(0,TempBudgetBuf2.Date);
                                          EnterCell(
                                            RowNo,NoOfDimensions + 2 + TempPeriod."Period No.",
                                            MatrixMgt.FormatValue(TempBudgetBuf2.Amount,RoundingFactor,FALSE),
                                            GLAcc."Account Type" <> GLAcc."Account Type"::Posting,
                                            FALSE,'',ExcelBuf."Cell Type"::Number);
                                          TempPeriod.NEXT;
                                        UNTIL TempBudgetBuf2.NEXT = 0;
                                      END ELSE BEGIN
                                        CLEAR(TempBudgetBuf2);
                                        EnterDimValues;
                                      END;
                                    END ELSE
                                      IF TempPeriod.FIND('-') THEN BEGIN
                                        REPEAT
                                          EnterFormula(
                                            RowNo,
                                            NoOfDimensions + 2 + TempPeriod."Period No.",
                                            GLAcc.Totaling,
                                            GLAcc."Account Type" <> GLAcc."Account Type"::Posting,
                                            FALSE,
                                            '#,##0.00');
                                        UNTIL TempPeriod.NEXT = 0;
                                      END;
                                  UNTIL GLAcc.NEXT = 0;
                                IF IncludeTotalingFormulas THEN
                                  HasFormulaError := ExcelBuf.ExportBudgetFilterToFormula(ExcelBuf);
                                Window.CLOSE;
                                LastBudgetRowNo := RowNo;

                                RowNo := RowNo + 200; // Move way below the budget
                                FOR i := 1 TO NoOfDimensions DO
                                  IF i = BusUnitDimIndex THEN BEGIN
                                    IF BusUnit.FINDSET THEN BEGIN
                                      DimensionRange[1,i] := RowNo;
                                      REPEAT
                                        EnterCell(RowNo,1,BusUnit.Code,FALSE,FALSE,'',ExcelBuf."Cell Type"::Text);
                                        RowNo := RowNo + 1;
                                      UNTIL BusUnit.NEXT = 0;
                                      DimensionRange[2,i] := RowNo - 1;
                                    END;
                                  END ELSE BEGIN
                                    DimValue.SETRANGE("Dimension Code",ColumnDimCode[i]);
                                    DimValue.SETFILTER("Dimension Value Type",'%1|%2',
                                      DimValue."Dimension Value Type"::Standard,DimValue."Dimension Value Type"::"Begin-Total");
                                    IF DimValue.FINDSET(FALSE,FALSE) THEN BEGIN
                                      DimensionRange[1,i] := RowNo;
                                      REPEAT
                                        EnterCell(RowNo,1,DimValue.Code,FALSE,FALSE,'',ExcelBuf."Cell Type"::Text);
                                        RowNo := RowNo + 1;
                                      UNTIL DimValue.NEXT = 0;
                                      DimensionRange[2,i] := RowNo - 1;
                                    END;
                                  END;

                                IF HasFormulaError THEN
                                  IF NOT CONFIRM(STRSUBSTNO(Text007,ExcelBuf.GetExcelReference(7))) THEN
                                    CurrReport.BREAK;

                                ExcelBuf.CreateBook(ServerFileName,ExcelBuf.GetExcelReference(10));
                                ExcelBuf.SetCurrent(HeaderRowNo + 1,1);
                                ExcelBuf.StartRange;
                                ExcelBuf.SetCurrent(LastBudgetRowNo,1);
                                ExcelBuf.EndRange;
                                ExcelBuf.CreateRange(ExcelBuf.GetExcelReference(8));
                                IF TempPeriod.FIND('-') THEN BEGIN
                                  REPEAT
                                    ExcelBuf.SetCurrent(HeaderRowNo + 1,NoOfDimensions + 2 + TempPeriod."Period No.");
                                    ExcelBuf.StartRange;
                                    ExcelBuf.SetCurrent(LastBudgetRowNo,NoOfDimensions + 2 + TempPeriod."Period No.");
                                    ExcelBuf.EndRange;
                                    ExcelBuf.CreateRange(ExcelBuf.GetExcelReference(9) + '_' + FORMAT(TempPeriod."Period No."));
                                  UNTIL TempPeriod.NEXT = 0;
                                END;

                                FOR i := 1 TO NoOfDimensions DO BEGIN
                                  ExcelBuf.SetCurrent(HeaderRowNo + 1,i + 2);
                                  ExcelBuf.StartRange;
                                  ExcelBuf.SetCurrent(LastBudgetRowNo,i + 2);
                                  ExcelBuf.EndRange;
                                  ExcelBuf.CreateRange('NAV_DIM' + FORMAT(i));
                                  ExcelBuf.SetCurrent(DimensionRange[1,i],1);
                                  ExcelBuf.StartRange;
                                  ExcelBuf.SetCurrent(DimensionRange[2,i],1);
                                  ExcelBuf.EndRange;
                                  ExcelBuf.CreateValidationRule('NAV_DIM' + FORMAT(i));
                                END;

                                ExcelBuf.WriteSheet(
                                  PADSTR(STRSUBSTNO('%1 %2',GLBudgetName.Name,GLBudgetName.Description),30),
                                  COMPANYNAME,
                                  USERID);

                                ExcelBuf.CloseBook;
                                IF NOT TestMode THEN BEGIN
                                  ExcelBuf.SetFriendlyFilename(STRSUBSTNO('%1-%2',GLBudgetName.Name,GLBudgetName.Description));
                                  ExcelBuf.OpenExcel;
                                  ExcelBuf.GiveUserControl;
                                END;
                              END;

               ReqFilterFields=Budget Name,Business Unit Code,G/L Account No.,Global Dimension 1 Code,Global Dimension 2 Code,Budget Dimension 1 Code,Budget Dimension 2 Code,Budget Dimension 3 Code,Budget Dimension 4 Code }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   ColumnDim := DimSelectionBuf.GetDimSelectionText(3,REPORT::"Export Budget to Excel",'');
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Start Date;
                  SourceExpr=StartDate }

      { 5   ;2   ;Field     ;
                  CaptionML=ENU=No. of Periods;
                  SourceExpr=NoOfPeriods }

      { 3   ;2   ;Field     ;
                  CaptionML=ENU=Period Length;
                  SourceExpr=PeriodLength }

      { 7   ;2   ;Field     ;
                  CaptionML=ENU=Column Dimensions;
                  SourceExpr=ColumnDim;
                  Editable=FALSE;
                  OnAssistEdit=BEGIN
                                 DimSelectionBuf.SetDimSelectionMultiple(3,REPORT::"Export Budget to Excel",ColumnDim);
                               END;
                                }

      { 10  ;2   ;Field     ;
                  CaptionML=ENU=Include Totaling Formulas;
                  SourceExpr=IncludeTotalingFormulas }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Column Dimensions';
      Text001@1001 : TextConst 'ENU=You can only export one budget at a time.';
      Text002@1002 : TextConst 'ENU=You must specify a Start Date, No. of Periods, and a Period Length.';
      Text003@1003 : TextConst 'ENU=You can only select a maximum of %1 column dimensions.';
      Text005@1004 : TextConst 'ENU=Analyzing Data...\\';
      Text006@1005 : TextConst 'ENU=Export Filters';
      Text007@1006 : TextConst 'ENU=Some filters cannot be converted into Excel formulas. You will have to check %1 errors in the Excel worksheet. Do you want to create the Excel worksheet?';
      TempPeriod@1007 : TEMPORARY Record 2000000007;
      SelectedDim@1009 : Record 369;
      TempBudgetBuf1@1010 : TEMPORARY Record 371;
      TempBudgetBuf2@1011 : TEMPORARY Record 371;
      DimSetEntry@1012 : Record 480;
      GLSetup@1013 : Record 98;
      Dim@1014 : Record 348;
      GLBudgetName@1015 : Record 95;
      ExcelBuf@1016 : TEMPORARY Record 370;
      GLAcc@1017 : Record 15;
      DimSelectionBuf@1018 : Record 368;
      MatrixMgt@1033 : Codeunit 9200;
      StartDate@1019 : Date;
      PeriodLength@1020 : DateFormula;
      NoOfPeriods@1021 : Integer;
      NoOfDimensions@1022 : Integer;
      i@1023 : Integer;
      RowNo@1024 : Integer;
      ColNo@1025 : Integer;
      ServerFileName@1034 : Text;
      ColumnDim@1026 : Text[250];
      ColumnDimCode@1027 : ARRAY [8] OF Code[20];
      HasFormulaError@1028 : Boolean;
      IncludeTotalingFormulas@1029 : Boolean;
      RoundingFactor@1032 : 'None,1,1000,1000000';
      HeaderRowNo@1030 : Integer;
      BusUnitDimIndex@1008 : Integer;
      BusUnitDimCode@1031 : Code[20];
      TestMode@1035 : Boolean;

    LOCAL PROCEDURE CalcPeriodStart@1(EntryDate@1000 : Date) : Date;
    BEGIN
      TempPeriod."Period Start" := EntryDate;
      TempPeriod.FIND('=<');
      EXIT(TempPeriod."Period Start");
    END;

    LOCAL PROCEDURE GetDimValueCode@2(DimCode@1000 : Code[20]) : Code[20];
    BEGIN
      IF DimCode = '' THEN
        EXIT('');
      IF DimCode = BusUnitDimCode THEN
        EXIT("G/L Budget Entry"."Business Unit Code");
      DimSetEntry.SETRANGE("Dimension Set ID","G/L Budget Entry"."Dimension Set ID");
      DimSetEntry.SETRANGE("Dimension Code",DimCode);
      IF DimSetEntry.FINDFIRST THEN
        EXIT(DimSetEntry."Dimension Value Code");
      EXIT('');
    END;

    LOCAL PROCEDURE EnterCell@3(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Bold@1003 : Boolean;UnderLine@1004 : Boolean;NumberFormat@1005 : Text[30];CellType@1006 : Option);
    BEGIN
      ExcelBuf.INIT;
      ExcelBuf.VALIDATE("Row No.",RowNo);
      ExcelBuf.VALIDATE("Column No.",ColumnNo);
      ExcelBuf."Cell Value as Text" := CellValue;
      ExcelBuf.Formula := '';
      ExcelBuf.Bold := Bold;
      ExcelBuf.Underline := UnderLine;
      ExcelBuf.NumberFormat := NumberFormat;
      ExcelBuf."Cell Type" := CellType;
      ExcelBuf.INSERT;
    END;

    LOCAL PROCEDURE EnterFilterInCell@5(Filter@1000 : Text[250];FieldName@1001 : Text[100]);
    BEGIN
      IF Filter <> '' THEN BEGIN
        RowNo := RowNo + 1;
        EnterCell(RowNo,1,FieldName,FALSE,FALSE,'',ExcelBuf."Cell Type"::Text);
        EnterCell(RowNo,2,Filter,FALSE,FALSE,'',ExcelBuf."Cell Type"::Text);
      END;
    END;

    LOCAL PROCEDURE EnterDimValue@7(ColDimIndex@1000 : Integer;DimValueCode@1001 : Code[20]);
    BEGIN
      IF ColumnDimCode[ColDimIndex] <> '' THEN BEGIN
        ColNo := ColNo + 1;
        EnterCell(RowNo,ColNo,DimValueCode,FALSE,FALSE,'',ExcelBuf."Cell Type"::Text);
      END;
    END;

    LOCAL PROCEDURE EnterDimValues@6();
    BEGIN
      ColNo := 2;
      EnterDimValue(1,TempBudgetBuf2."Dimension Value Code 1");
      EnterDimValue(2,TempBudgetBuf2."Dimension Value Code 2");
      EnterDimValue(3,TempBudgetBuf2."Dimension Value Code 3");
      EnterDimValue(4,TempBudgetBuf2."Dimension Value Code 4");
      EnterDimValue(5,TempBudgetBuf2."Dimension Value Code 5");
      EnterDimValue(6,TempBudgetBuf2."Dimension Value Code 6");
      EnterDimValue(7,TempBudgetBuf2."Dimension Value Code 7");
      EnterDimValue(8,TempBudgetBuf2."Dimension Value Code 8");
    END;

    LOCAL PROCEDURE EnterFormula@8(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Bold@1005 : Boolean;UnderLine@1006 : Boolean;NumberFormat@1003 : Text[30]);
    BEGIN
      ExcelBuf.INIT;
      ExcelBuf.VALIDATE("Row No.",RowNo);
      ExcelBuf.VALIDATE("Column No.",ColumnNo);
      ExcelBuf."Cell Value as Text" := '';
      ExcelBuf.Formula := CellValue; // is converted to formula later.
      ExcelBuf.Bold := Bold;
      ExcelBuf.Underline := UnderLine;
      ExcelBuf.NumberFormat := NumberFormat;
      ExcelBuf.INSERT;
    END;

    PROCEDURE SetParameters@4(NewStartDate@1001 : Date;NewNoOfPeriods@1002 : Integer;NewPeriodLength@1003 : DateFormula;NewRoundingFactor@1000 : 'None,1,1000,1000000');
    BEGIN
      StartDate := NewStartDate;
      NoOfPeriods := NewNoOfPeriods;
      PeriodLength := NewPeriodLength;
      RoundingFactor := NewRoundingFactor;
    END;

    PROCEDURE SetFileNameSilent@9(NewFileName@1000 : Text);
    BEGIN
      ServerFileName := NewFileName;
    END;

    PROCEDURE SetTestMode@10(NewTestMode@1000 : Boolean);
    BEGIN
      TestMode := NewTestMode;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 83 Change Global Dimensions
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00,4PS9.00;
  }
  PROPERTIES
  {
    Permissions=TableData 17=imd,
                TableData 21=imd,
                TableData 25=imd,
                TableData 32=imd,
                TableData 110=imd,
                TableData 111=imd,
                TableData 112=imd,
                TableData 113=imd,
                TableData 114=imd,
                TableData 115=imd,
                TableData 120=imd,
                TableData 121=imd,
                TableData 122=imd,
                TableData 123=imd,
                TableData 124=imd,
                TableData 125=imd,
                TableData 11072005=imd,
                TableData 171=imd,
                TableData 174=imd,
                TableData 203=imd,
                TableData 271=imd,
                TableData 281=imd,
                TableData 297=imd,
                TableData 304=imd,
                TableData 379=imd,
                TableData 380=imd,
                TableData 11072600=imd,
                TableData 11020402=imd,
                TableData 11020403=imd,
                TableData 11072055=imd,
                TableData 11072056=imd,
                TableData 11072057=imd,
                TableData 11072058=imd,
                TableData 5601=imd,
                TableData 11072085=imd,
                TableData 11072088=imd,
                TableData 5802=imd,
                TableData 5832=imd,
                TableData 5907=imd,
                TableData 5908=imd,
                TableData 5965=imd,
                TableData 5970=imd,
                TableData 5971=imd,
                TableData 6650=imd,
                TableData 6651=imd,
                TableData 6660=imd,
                TableData 6661=imd,
                TableData 8383=imd;
    CaptionML=ENU=Change Global Dimensions;
    ProcessingOnly=Yes;
    OnPreReport=VAR
                  Dim@1000 : Record 348;
                BEGIN
                  IF NewGlobalDim1Code <> GLSetup."Global Dimension 1 Code" THEN BEGIN
                    ConfirmationMessage :=
                      GLSetup.FIELDCAPTION("Global Dimension 1 Code") + ' (' +
                      GLSetup.FIELDCAPTION("Shortcut Dimension 1 Code") + ')';
                    IF NewGlobalDim2Code <> GLSetup."Global Dimension 2 Code" THEN
                      ConfirmationMessage := ConfirmationMessage + Text000 +
                        GLSetup.FIELDCAPTION("Global Dimension 2 Code") + ' (' +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 2 Code") + ')';
                  END ELSE
                    IF NewGlobalDim2Code <> GLSetup."Global Dimension 2 Code" THEN
                      ConfirmationMessage :=
                        GLSetup.FIELDCAPTION("Global Dimension 2 Code") + ' (' +
                        GLSetup.FIELDCAPTION("Shortcut Dimension 2 Code") + ')';

                  IF ConfirmationMessage <> '' THEN BEGIN
                    IF (NewGlobalDim1Code = GLSetup."Global Dimension 2 Code") AND
                       (NewGlobalDim2Code = GLSetup."Global Dimension 1 Code")
                    THEN BEGIN
                      MESSAGE(Text001);
                      CurrReport.QUIT;
                    END;
                    IF Dim.CheckIfDimUsed(NewGlobalDim1Code,1,'','',0) THEN
                      ERROR(
                        Text002,
                        Dim.GetCheckDimErr,GLSetup.FIELDCAPTION("Global Dimension 1 Code"));
                    IF Dim.CheckIfDimUsed(NewGlobalDim2Code,2,'','',0) THEN
                      ERROR(
                        Text002,
                        Dim.GetCheckDimErr,GLSetup.FIELDCAPTION("Global Dimension 2 Code"));
                    IF NOT CONFIRM(Text003,FALSE,ConfirmationMessage) THEN
                      CurrReport.QUIT;
                  END ELSE
                    CurrReport.QUIT;

                  //**4PS.sn  C-015604
                  //* Standard bug, only process the dimension(s) that are modified (and filled)!
                  ModifyDim1 := FALSE;
                  ModifyDim2 := FALSE;
                  IF (NewGlobalDim1Code <> GLSetup."Global Dimension 1 Code") AND (NewGlobalDim1Code <> '') THEN
                    ModifyDim1 := TRUE;
                  IF (NewGlobalDim2Code <> GLSetup."Global Dimension 2 Code") AND (NewGlobalDim2Code <> '') THEN
                    ModifyDim2 := TRUE;
                  IF (NOT ModifyDim1) AND (NOT ModifyDim2) THEN
                    CurrReport.QUIT;
                  //**4PS.en
                END;

    OnPostReport=BEGIN
                   IF ChangeGlobalDim THEN BEGIN
                     GLSetup.VALIDATE("Global Dimension 1 Code",NewGlobalDim1Code);
                     GLSetup.VALIDATE("Global Dimension 2 Code",NewGlobalDim2Code);
                     GLSetup.MODIFY(TRUE);
                     MESSAGE(
                       Text004,
                       ConfirmationMessage);
                   END;
                 END;

  }
  DATASET
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   GLSetup.GET;
                   NewGlobalDim1Code := GLSetup."Global Dimension 1 Code";
                   NewGlobalDim2Code := GLSetup."Global Dimension 2 Code";
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Global Dimension 1 Code;
                  SourceExpr=NewGlobalDim1Code;
                  TableRelation=Dimension;
                  OnValidate=BEGIN
                               IF NewGlobalDim1Code = NewGlobalDim2Code THEN
                                 NewGlobalDim2Code := '';
                             END;
                              }

      { 3   ;2   ;Field     ;
                  CaptionML=ENU=Global Dimension 2 Code;
                  SourceExpr=NewGlobalDim2Code;
                  TableRelation=Dimension;
                  OnValidate=BEGIN
                               IF NewGlobalDim1Code = NewGlobalDim2Code THEN
                                 NewGlobalDim1Code := '';
                             END;
                              }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=" and "';
      Text001@1001 : TextConst 'ENU=You must run this batch job twice to reverse the global dimensions.';
      Text002@1002 : TextConst 'ENU=%1\You cannot use it as %2.';
      Text003@1003 : TextConst 'ENU=Are you sure that you want to change:\%1?';
      Text004@1004 : TextConst 'ENU=The following dimensions have been successfully changed:\%1.';
      Text005@1005 : TextConst 'ENU=Database information\';
      Text006@1006 : TextConst 'ENU=" No. of Records        #1######\"';
      Text007@1007 : TextConst 'ENU=" Progress              @2@@@@@@@@@@@@@\"';
      Text008@1008 : TextConst 'ENU=" Estimated Ending Time #3#######################\"';
      Text009@1009 : TextConst 'ENU=Table information\';
      Text010@1010 : TextConst 'ENU=" Company               #4#######################\"';
      Text011@1011 : TextConst 'ENU=" Table                 #5#######################\"';
      Text012@1012 : TextConst 'ENU=" No. of Records        #6######\"';
      Text013@1013 : TextConst 'ENU=" Progress              @7@@@@@@@@@@@@@"';
      Text014@1014 : TextConst 'ENU=Please wait while the operation is being completed.';
      Text015@1015 : TextConst 'ENU=<Hours24>:<Minutes,2>';
      DimVal@1105 : Record 349;
      ItemBudgetEntry@1141 : Record 7134;
      GLSetup@1016 : Record 98;
      GLAcc@1017 : Record 15;
      GLEntry@1018 : Record 17;
      Cust@1019 : Record 18;
      CustLedgEntry@1020 : Record 21;
      DtldCustLedgEntry@1021 : Record 379;
      Vend@1022 : Record 23;
      VendorLedgEntry@1023 : Record 25;
      DtldVendLedgEntry@1024 : Record 380;
      Item@1113 : Record 27;
      ItemLedgEntry@1025 : Record 32;
      SalesHeader@1026 : Record 36;
      SalesLine@1027 : Record 37;
      PurchHeader@1028 : Record 38;
      PurchLine@1029 : Record 39;
      GenJnlLine@1030 : Record 81;
      ItemJnlLine@1031 : Record 83;
      GLBudgetEntry@1033 : Record 96;
      SalesShptHeader@1034 : Record 110;
      SaleShptLine@1035 : Record 111;
      SalesInvHeader@1036 : Record 112;
      SalesInvLine@1037 : Record 113;
      ReturnRcptHeader@1038 : Record 6660;
      ReturnRcptLine@1039 : Record 6661;
      SalesCrMemoHeader@1040 : Record 114;
      SalesCrMemoLine@1041 : Record 115;
      PurchRcptHeader@1042 : Record 120;
      PurchRcptLine@1043 : Record 121;
      PurchInvHeader@1044 : Record 122;
      PurchInvLine@1045 : Record 123;
      PurchCrMemoHeader@1046 : Record 124;
      PurchCrMemoLine@1047 : Record 125;
      ServHeader@1048 : Record 5900;
      ServLine@1049 : Record 5902;
      ServShptHeader@1129 : Record 5990;
      ServShptLine@1128 : Record 5991;
      ServInvHeader@1127 : Record 5992;
      ServInvLine@1124 : Record 5993;
      ServCrMemoHeader@1131 : Record 5994;
      ServCrMemoLine@1130 : Record 5995;
      ReturnShptHeader@1053 : Record 6650;
      ReturnShptLine@1054 : Record 6651;
      ResGr@1055 : Record 152;
      Res@1056 : Record 156;
      Job@1057 : Record 11072003;
      JobLedgEntry@1058 : Record 11072005;
      ResLedgEntry@1059 : Record 203;
      StdSalesLine@1114 : Record 171;
      StdPurchLine@1115 : Record 174;
      ValueEntry@1060 : Record 5802;
      CapLedgEntry@1106 : Record 5832;
      ResJnlLine@1061 : Record 207;
      JobJnlLine@1062 : Record 11072008;
      GenJnlAlloc@1063 : Record 221;
      ReqLine@1064 : Record 246;
      BankAcc@1065 : Record 270;
      BankAccLedgEntry@1066 : Record 271;
      PhysInvtLedgEntry@1067 : Record 281;
      ReminderHeader@1068 : Record 295;
      IssuedReminderHeader@1069 : Record 297;
      FinChrgMemoHeader@1070 : Record 302;
      IssuedFinChrgMemoHeader@1071 : Record 304;
      Employee@1072 : Record 5200;
      ProdOrder@1107 : Record 5405;
      ProdOrderLine@1073 : Record 5406;
      ProdOrderComp@1074 : Record 5407;
      FA@1075 : Record 5600;
      FALedgEntry@1076 : Record 5601;
      FAAlloc@1077 : Record 11072080;
      FAJnlLine@1078 : Record 5621;
      MaintenanceLedgEntry@1079 : Record 11072085;
      Insurance@1080 : Record 11072087;
      InsCovLedgEntry@1081 : Record 11072088;
      InsuranceJnlLine@1082 : Record 11072092;
      RespCenter@1083 : Record 5714;
      SalespersonPurchaser@1084 : Record 13;
      Campaign@1085 : Record 11072034;
      CustomerTemplate@1108 : Record 5105;
      SalesHeaderArchive@1109 : Record 11072055;
      SalesLineArchive@1110 : Record 11072056;
      PurchHeaderArchive@1111 : Record 11072057;
      PurchLineArchive@1112 : Record 11072058;
      DimSetEntry@1050 : Record 480;
      DefaultDim@1086 : Record 352;
      DimBuf@1092 : Record 360;
      WarrantyLedgerEntry@1134 : Record 5908;
      ServiceLedgerEntry@1118 : Record 5907;
      ItemCharge@1117 : Record 5800;
      TransferHeader@1116 : Record 5740;
      TransferLine@1119 : Record 5741;
      TransferShipmentHeader@1120 : Record 5744;
      TransferShipmentLine@1121 : Record 5745;
      TransferReceiptHeader@1122 : Record 5746;
      TransferReceiptLine@1123 : Record 5747;
      WorkCenter@1125 : Record 99000754;
      PlanningComponent@1126 : Record 99000829;
      ServItemLine@1156 : Record 5901;
      JobTask@1155 : Record 11072600;
      JobTaskDim@1154 : Record 11020400;
      JobWIPEntry@1153 : Record 11020402;
      JobWIPGLEntry@1152 : Record 11020403;
      StdGenJnlLine@1151 : Record 751;
      StdItemJnlLine@1150 : Record 753;
      ServCtrHeader@1149 : Record 5965;
      FiledServCtrHeader@1148 : Record 5970;
      StdServLine@1147 : Record 5997;
      TempDefaultDimDimensionsFieldMap@1146 : TEMPORARY Record 8383;
      TempDimSetDimensionsFieldMap@1145 : TEMPORARY Record 8383;
      IndicatorWindow@1051 : Dialog;
      NewGlobalDim1Code@1095 : Code[20];
      NewGlobalDim2Code@1096 : Code[20];
      DatabaseRecords@1097 : Integer;
      CheckedDatabaseRecords@1098 : Integer;
      TableRecords@1099 : Integer;
      CheckedTableRecords@1100 : Integer;
      StartTime@1102 : Time;
      StartDate@1103 : Date;
      ConfirmationMessage@1104 : Text[250];
      ModifyDim1@1100525000 : Boolean;
      ModifyDim2@1100525001 : Boolean;

    LOCAL PROCEDURE ChangeGlobalDim@1() : Boolean;
    VAR
      DimFilter@1000 : Text[250];
      TempTableOption@1005 : 'DefaultDimTables,DimSetTables';
    BEGIN
      InitializeTablesForModification;
      OpenIndicator;
      CountRowsAndLockTable(TempDefaultDimDimensionsFieldMap);
      CountRowsAndLockTable(TempDimSetDimensionsFieldMap);
      CountRowsAndLockExceptionalCases;

      DimVal.SETCURRENTKEY(Code,"Global Dimension No.");
      //DimVal.SETRANGE("Global Dimension No.",1,2);  //**4PS.o  C-015604
      //**4PS.sn  C-015604
      IF ModifyDim1 AND ModifyDim2 THEN
        DimVal.SETRANGE("Global Dimension No.",1,2)
      ELSE BEGIN
        IF ModifyDim1 THEN
          DimVal.SETRANGE("Global Dimension No.",1)
        ELSE
          DimVal.SETRANGE("Global Dimension No.",2);
      END;
      //**4PS.en
      DimVal.MODIFYALL("Global Dimension No.",0);
      DimVal.RESET;
      //IF NewGlobalDim1Code <> '' THEN BEGIN  //**4PS.o  C-015604
      IF (NewGlobalDim1Code <> '') AND ModifyDim1 THEN BEGIN  //**4PS.n  C-015604
        DimVal.SETRANGE("Dimension Code",NewGlobalDim1Code);
        DimVal.MODIFYALL("Global Dimension No.",1);
      END;
      //IF NewGlobalDim2Code <> '' THEN BEGIN  //**4PS.o  C-015604
      IF (NewGlobalDim2Code <> '') AND ModifyDim2 THEN BEGIN  //**4PS.n  C-015604
        DimVal.SETRANGE("Dimension Code",NewGlobalDim2Code);
        DimVal.MODIFYALL("Global Dimension No.",2);
      END;

      { //**4PS.so  C-015604
      IF NewGlobalDim1Code <> '' THEN
        IF NewGlobalDim2Code <> '' THEN
          DimFilter := NewGlobalDim1Code + '|' + NewGlobalDim2Code
        ELSE
          DimFilter := NewGlobalDim1Code
      ELSE
        IF NewGlobalDim2Code <> '' THEN
          DimFilter := NewGlobalDim2Code
        ELSE
          DimFilter := '';
      } //**4PS.eo
      //**4PS.sn  C-015604
      IF ModifyDim1 AND ModifyDim2 THEN
        DimFilter := NewGlobalDim1Code + '|' + NewGlobalDim2Code
      ELSE BEGIN
        IF ModifyDim1 THEN
          DimFilter := NewGlobalDim1Code
        ELSE
          DimFilter := NewGlobalDim2Code;
      END;
      //**4PS.en

      DefaultDim.SETFILTER("Dimension Code",DimFilter);
      DimBuf.SETFILTER("Dimension Code",DimFilter);
      JobTaskDim.SETFILTER("Dimension Code",DimFilter);  // PS55126

      StartTime := TIME;
      StartDate := TODAY;

      ChangeGlobalsInTables(TempTableOption::DefaultDimTables);
      ChangeGlobalsInTables(TempTableOption::DimSetTables);
      UpdateExceptionalCases;

      IndicatorWindow.CLOSE;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetDefaultJobTaskDim@11(JobNo@1000 : Code[20];JobTaskNo@1001 : Code[20];VAR GlobalDim1Value@1002 : Code[20];VAR GlobalDim2Value@1003 : Code[20]);
    BEGIN
      GlobalDim1Value := '';
      GlobalDim2Value := '';

      JobTaskDim.SETRANGE("Job No.",JobNo);
      JobTaskDim.SETRANGE("Job Task No.",JobTaskNo);
      IF JobTaskDim.FINDSET THEN
        REPEAT
          IF JobTaskDim."Dimension Code" = NewGlobalDim1Code THEN
            GlobalDim1Value := JobTaskDim."Dimension Value Code";
          IF JobTaskDim."Dimension Code" = NewGlobalDim2Code THEN
            GlobalDim2Value := JobTaskDim."Dimension Value Code";
        UNTIL JobTaskDim.NEXT = 0;
    END;

    LOCAL PROCEDURE OpenIndicator@9();
    BEGIN
      IndicatorWindow.OPEN(
        Text005 +
        Text006 +
        Text007 +
        Text008 +
        Text009 +
        Text010 +
        Text011 +
        Text012 +
        Text013);
    END;

    LOCAL PROCEDURE UpdateGeneralInfo@6(CompanyName@1000 : Text[100];TableName@1001 : Text[50];CurrentTableRecords@1002 : Integer);
    BEGIN
      TableRecords := CurrentTableRecords;
      CheckedTableRecords := 0;
      IndicatorWindow.UPDATE(1,DatabaseRecords);
      IF DatabaseRecords <> 0 THEN
        IndicatorWindow.UPDATE(2,ROUND(CheckedDatabaseRecords / DatabaseRecords * 10000,1))
      ELSE
        IndicatorWindow.UPDATE(2,0);
      IF CheckedDatabaseRecords <> 0 THEN
        IndicatorWindow.UPDATE(3,CalcEndingTime(TODAY,TIME))
      ELSE
        IndicatorWindow.UPDATE(3,Text014);
      IndicatorWindow.UPDATE(4,CompanyName);
      IndicatorWindow.UPDATE(5,TableName);
      IndicatorWindow.UPDATE(6,CurrentTableRecords);
      CheckedDatabaseRecords := CheckedDatabaseRecords + CurrentTableRecords;
    END;

    LOCAL PROCEDURE UpdateProgressInfo@7();
    BEGIN
      IF TableRecords <> 0 THEN
        IndicatorWindow.UPDATE(7,ROUND(CheckedTableRecords / TableRecords * 10000,1))
      ELSE
        IndicatorWindow.UPDATE(7,0);
    END;

    LOCAL PROCEDURE CalcEndingTime@2(PresentDate@1000 : Date;PresentTime@1001 : Time) : Text[250];
    VAR
      RemainingTime@1002 : Integer;
      EndingDate@1003 : Date;
      EndingTime@1004 : Time;
    BEGIN
      IF PresentDate > StartDate THEN
        RemainingTime := ((PresentDate - StartDate) * 8640000) + (235959T - StartTime) + (PresentTime - 000000T)
      ELSE
        RemainingTime := (PresentTime - StartTime);
      RemainingTime := ROUND((RemainingTime / CheckedDatabaseRecords) * (DatabaseRecords - CheckedDatabaseRecords),1);
      EndingDate := StartDate + ABS(ROUND(RemainingTime / 360000,1));
      EndingTime := StartTime + ABS(ROUND(RemainingTime MOD 360000,1));
      IF EndingTime < StartTime THEN
        EndingDate := EndingDate + 1;
      EXIT(FORMAT(EndingDate) + ' ' + FORMAT(EndingTime,0,Text015));
    END;

    PROCEDURE InitializeRequest@3(NewGlobalDim1CodeFrom@1000 : Code[20];NewGlobalDim2CodeFrom@1001 : Code[20]);
    BEGIN
      NewGlobalDim1Code := NewGlobalDim1CodeFrom;
      NewGlobalDim2Code := NewGlobalDim2CodeFrom;
    END;

    LOCAL PROCEDURE GetDefaultDim@16(No@1000 : Code[20];Global1FieldRef@1001 : FieldRef;Global2FieldRef@1002 : FieldRef);
    BEGIN
      IF ModifyDim1 THEN //**4PS.n  C-015604
        Global1FieldRef.VALUE := '';
      IF ModifyDim2 THEN //**4PS.n  C-015604
        Global2FieldRef.VALUE := '';

      DefaultDim.SETRANGE("Table ID",Global1FieldRef.RECORD.NUMBER);
      DefaultDim.SETRANGE("No.",No);
      IF DefaultDim.FINDSET THEN
        REPEAT
          IF DefaultDim."Dimension Code" = NewGlobalDim1Code THEN
            IF ModifyDim1 THEN //**4PS.n  C-015604
              Global1FieldRef.VALUE := DefaultDim."Dimension Value Code";
          IF DefaultDim."Dimension Code" = NewGlobalDim2Code THEN
            IF ModifyDim2 THEN //**4PS.n  C-015604
              Global2FieldRef.VALUE := DefaultDim."Dimension Value Code";
        UNTIL DefaultDim.NEXT = 0;
    END;

    LOCAL PROCEDURE AddToDefaultDimTempTable@148(TableNo@1003 : Integer;Global1FieldNo@1002 : Integer;Global2FieldNo@1001 : Integer;IDFieldNo@1000 : Integer);
    BEGIN
      AddToTempTable(TempDefaultDimDimensionsFieldMap,TableNo,Global1FieldNo,Global2FieldNo,IDFieldNo);
    END;

    LOCAL PROCEDURE AddToDimSetTempTable@151(TableNo@1003 : Integer;Global1FieldNo@1002 : Integer;Global2FieldNo@1001 : Integer;IDFieldNo@1000 : Integer);
    BEGIN
      AddToTempTable(TempDimSetDimensionsFieldMap,TableNo,Global1FieldNo,Global2FieldNo,IDFieldNo);
    END;

    LOCAL PROCEDURE ChangeGlobalsInTables@42(TempTableOption@1003 : 'DefaultDimTables,DimSetTables');
    VAR
      FieldRecordRef@1004 : RecordRef;
      TempRecRef@1000 : RecordRef;
      TableNoFieldRef@1005 : FieldRef;
      TableNumber@1002 : Integer;
      TableNoFieldNumber@1006 : Integer;
    BEGIN
      CASE TempTableOption OF
        TempTableOption::DefaultDimTables:
          FieldRecordRef.GETTABLE(TempDefaultDimDimensionsFieldMap);
        TempTableOption::DimSetTables:
          FieldRecordRef.GETTABLE(TempDimSetDimensionsFieldMap);
      END;

      // Get the field no when the "Table No." is stored.
      TableNoFieldNumber := TempDimSetDimensionsFieldMap.FIELDNO("Table No.");
      WITH FieldRecordRef DO BEGIN
        TableNoFieldRef := FIELD(TableNoFieldNumber);
        IF FINDSET THEN BEGIN
          REPEAT
            TableNumber := TableNoFieldRef.VALUE;
            TempRecRef.OPEN(TableNumber);
            CASE TempTableOption OF
              TempTableOption::DefaultDimTables:
                ChangeGlobalsWithDefaultDim(TempRecRef);
              TempTableOption::DimSetTables:
                ChangeGlobalsWithDimensionSet(TempRecRef);
            END;
            TempRecRef.CLOSE;
          UNTIL NEXT = 0;
        END
      END;
    END;

    LOCAL PROCEDURE ChangeGlobalsWithDefaultDim@194(RecordRefForProcessing@1000 : RecordRef);
    VAR
      Global1FieldNo@1001 : Integer;
      Global2FieldNo@1002 : Integer;
      NoFieldNo@1003 : Integer;
      No@1004 : Code[20];
    BEGIN
      GetFieldNumbersFromTempTable(
        TempDefaultDimDimensionsFieldMap,RecordRefForProcessing.NUMBER,Global1FieldNo,Global2FieldNo,NoFieldNo);
      UpdateGeneralInfo(COMPANYNAME,RecordRefForProcessing.CAPTION,RecordRefForProcessing.COUNT);
      WITH RecordRefForProcessing DO
        IF FINDFIRST THEN BEGIN
          REPEAT
            No := FIELD(NoFieldNo).VALUE;
            GetDefaultDim(No,FIELD(Global1FieldNo),FIELD(Global2FieldNo));
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          UNTIL NEXT = 0;
        END;
    END;

    LOCAL PROCEDURE ChangeGlobalsWithDimensionSet@109(RecordRefForProcessing@1000 : RecordRef);
    VAR
      Global1FieldNo@1001 : Integer;
      Global2FieldNo@1002 : Integer;
      DimSetIDFieldNo@1003 : Integer;
      DimSetID@1004 : Integer;
    BEGIN
      GetFieldNumbersFromTempTable(
        TempDimSetDimensionsFieldMap,RecordRefForProcessing.NUMBER,Global1FieldNo,Global2FieldNo,DimSetIDFieldNo);
      UpdateGeneralInfo(COMPANYNAME,RecordRefForProcessing.CAPTION,RecordRefForProcessing.COUNT);
      WITH RecordRefForProcessing DO
        IF FIND('-') THEN BEGIN
          REPEAT
            DimSetID := FIELD(DimSetIDFieldNo).VALUE;
            GetDimSetEntry(DimSetID,FIELD(Global1FieldNo),FIELD(Global2FieldNo));
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          UNTIL NEXT = 0;
        END;
    END;

    LOCAL PROCEDURE GetDimSetEntry@94(DimSetID@1000 : Integer;Global1FieldRef@1001 : FieldRef;Global2FieldRef@1002 : FieldRef);
    BEGIN
      IF ModifyDim1 THEN //**4PS.n  C-015604
        Global1FieldRef.VALUE := '';
      IF ModifyDim2 THEN //**4PS.n  C-015604
        Global2FieldRef.VALUE := '';

      DimSetEntry.SETRANGE("Dimension Set ID",DimSetID);
      IF DimSetEntry.FINDSET THEN
        REPEAT
          IF DimSetEntry."Dimension Code" = NewGlobalDim1Code THEN
            IF ModifyDim1 THEN //**4PS.n  C-015604
              Global1FieldRef.VALUE := DimSetEntry."Dimension Value Code";
          IF DimSetEntry."Dimension Code" = NewGlobalDim2Code THEN
            IF ModifyDim2 THEN //**4PS.n  C-015604
              Global2FieldRef.VALUE := DimSetEntry."Dimension Value Code";
        UNTIL DimSetEntry.NEXT = 0;
    END;

    LOCAL PROCEDURE CountRowsAndLockExceptionalCases@12();
    VAR
      TempRecRef@1000 : RecordRef;
    BEGIN
      TempRecRef.GETTABLE(SalesLineArchive);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
      TempRecRef.GETTABLE(PurchLineArchive);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
      TempRecRef.GETTABLE(CustLedgEntry);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
      TempRecRef.GETTABLE(VendorLedgEntry);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
      TempRecRef.GETTABLE(JobTask);
      CountRowsAndLock(TempRecRef,DatabaseRecords);
    END;

    LOCAL PROCEDURE UpdateExceptionalCases@231();
    VAR
      TempRecRef@1000 : RecordRef;
    BEGIN
      UpdateGeneralInfo(COMPANYNAME,SalesLineArchive.TABLECAPTION,SalesLineArchive.COUNT);
      WITH SalesLineArchive DO BEGIN
        SETCURRENTKEY("Document Type","Document No.","Line No.","Doc. No. Occurrence","Version No.");
        IF FIND('-') THEN BEGIN
          REPEAT
            TempRecRef.GETTABLE(SalesLineArchive);
            GetDimSetEntry(
              "Dimension Set ID",
              TempRecRef.FIELD(FIELDNO("Shortcut Dimension 1 Code")),TempRecRef.FIELD(FIELDNO("Shortcut Dimension 2 Code")));
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          UNTIL NEXT = 0;
        END;
      END;

      UpdateGeneralInfo(COMPANYNAME,PurchLineArchive.TABLECAPTION,PurchLineArchive.COUNT);
      WITH PurchLineArchive DO BEGIN
        SETCURRENTKEY("Document Type","Document No.","Line No.","Doc. No. Occurrence","Version No.");
        IF FIND('-') THEN BEGIN
          REPEAT
            TempRecRef.GETTABLE(PurchLineArchive);
            GetDimSetEntry(
              "Dimension Set ID",
              TempRecRef.FIELD(FIELDNO("Shortcut Dimension 1 Code")),TempRecRef.FIELD(FIELDNO("Shortcut Dimension 2 Code")));
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          UNTIL NEXT = 0;
        END;
      END;

      UpdateGeneralInfo(COMPANYNAME,CustLedgEntry.TABLECAPTION,CustLedgEntry.COUNT);
      DtldCustLedgEntry.SETCURRENTKEY("Cust. Ledger Entry No.");
      WITH CustLedgEntry DO
        IF FIND('-') THEN BEGIN
          REPEAT
            TempRecRef.GETTABLE(CustLedgEntry);
            GetDimSetEntry(
              "Dimension Set ID",
              TempRecRef.FIELD(FIELDNO("Global Dimension 1 Code")),TempRecRef.FIELD(FIELDNO("Global Dimension 2 Code")));
            MODIFY;
            DtldCustLedgEntry.SETRANGE("Cust. Ledger Entry No.","Entry No.");
            IF DtldCustLedgEntry.FIND('-') THEN
              REPEAT
                DtldCustLedgEntry."Initial Entry Global Dim. 1" := "Global Dimension 1 Code";
                DtldCustLedgEntry."Initial Entry Global Dim. 2" := "Global Dimension 2 Code";
                DtldCustLedgEntry.MODIFY;
              UNTIL DtldCustLedgEntry.NEXT = 0;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          UNTIL NEXT = 0;
        END;

      UpdateGeneralInfo(COMPANYNAME,VendorLedgEntry.TABLECAPTION,VendorLedgEntry.COUNT);
      DtldVendLedgEntry.SETCURRENTKEY("Vendor Ledger Entry No.");
      WITH VendorLedgEntry DO
        IF FIND('-') THEN BEGIN
          REPEAT
            TempRecRef.GETTABLE(VendorLedgEntry);
            GetDimSetEntry(
              "Dimension Set ID",
              TempRecRef.FIELD(FIELDNO("Global Dimension 1 Code")),TempRecRef.FIELD(FIELDNO("Global Dimension 2 Code")));
            MODIFY;
            DtldVendLedgEntry.SETRANGE("Vendor Ledger Entry No.","Entry No.");
            IF DtldVendLedgEntry.FIND('-') THEN
              REPEAT
                DtldVendLedgEntry."Initial Entry Global Dim. 1" := "Global Dimension 1 Code";
                DtldVendLedgEntry."Initial Entry Global Dim. 2" := "Global Dimension 2 Code";
                DtldVendLedgEntry.MODIFY;
              UNTIL DtldVendLedgEntry.NEXT = 0;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          UNTIL NEXT = 0;
        END;

      UpdateGeneralInfo(COMPANYNAME,JobTask.TABLECAPTION,JobTask.COUNT);
      WITH JobTask DO
        IF FINDSET THEN BEGIN
          REPEAT
            GetDefaultJobTaskDim(
              "Job No.",
              "Job Task No.",
              "Global Dimension 1 Code",
              "Global Dimension 2 Code");
            MODIFY;
            CheckedTableRecords := CheckedTableRecords + 1;
            UpdateProgressInfo;
          UNTIL NEXT = 0;
        END;
    END;

    LOCAL PROCEDURE CountRowsAndLock@164(RecRef@1000 : RecordRef;VAR NumberOfRecords@1001 : Integer);
    BEGIN
      WITH RecRef DO BEGIN
        LOCKTABLE;
        IF FINDLAST THEN;
      END;
      NumberOfRecords := NumberOfRecords + RecRef.COUNT;
    END;

    LOCAL PROCEDURE CountRowsAndLockTable@34(VAR TempDimensionsFieldMap@1000 : TEMPORARY Record 8383);
    VAR
      TempRecRef@1006 : RecordRef;
    BEGIN
      WITH TempDimensionsFieldMap DO BEGIN
        FINDSET;
        REPEAT
          TempRecRef.OPEN("Table No.");
          CountRowsAndLock(TempRecRef,DatabaseRecords);
          TempRecRef.CLOSE;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE AddToTempTable@26(VAR TempDimensionsFieldMap@1000 : TEMPORARY Record 8383;TableNo@1001 : Integer;Global1FieldNo@1002 : Integer;Global2FieldNo@1003 : Integer;IDFieldNo@1004 : Integer);
    BEGIN
      // populate the table with rows of the field numbers that we will use.
      TempDimensionsFieldMap."Table No." := TableNo;
      TempDimensionsFieldMap."Global Dim.1 Field No." := Global1FieldNo;
      TempDimensionsFieldMap."Global Dim.2 Field No." := Global2FieldNo;
      TempDimensionsFieldMap."ID Field No." := IDFieldNo;
      TempDimensionsFieldMap.INSERT;
    END;

    LOCAL PROCEDURE GetFieldNumbersFromTempTable@28(VAR TempDimensionsFieldMap@1003 : TEMPORARY Record 8383;TableNo@1004 : Integer;VAR Global1FieldNo@1000 : Integer;VAR Global2FieldNo@1001 : Integer;VAR IDFieldNo@1002 : Integer);
    BEGIN
      TempDimensionsFieldMap.GET(TableNo);
      Global1FieldNo := TempDimensionsFieldMap."Global Dim.1 Field No.";
      Global2FieldNo := TempDimensionsFieldMap."Global Dim.2 Field No.";
      IDFieldNo := TempDimensionsFieldMap."ID Field No.";
    END;

    PROCEDURE InitializeTablesForModification@199();
    BEGIN
      TempDefaultDimDimensionsFieldMap.DELETEALL;
      TempDimSetDimensionsFieldMap.DELETEALL;

      AddingDefaultValueDim;

      // Initialize the tables using the Dimension Set
      AddToDimSetTempTable(
        DATABASE::"G/L Entry",GLEntry.FIELDNO("Global Dimension 1 Code"),GLEntry.FIELDNO("Global Dimension 2 Code"),
        GLEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Cust. Ledger Entry",CustLedgEntry.FIELDNO("Global Dimension 1 Code"),
        CustLedgEntry.FIELDNO("Global Dimension 2 Code"),CustLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Vendor Ledger Entry",VendorLedgEntry.FIELDNO("Global Dimension 1 Code"),
        VendorLedgEntry.FIELDNO("Global Dimension 2 Code"),VendorLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Item Ledger Entry",ItemLedgEntry.FIELDNO("Global Dimension 1 Code"),
        ItemLedgEntry.FIELDNO("Global Dimension 2 Code"),ItemLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Job Ledger Entry",JobLedgEntry.FIELDNO("Global Dimension 1 Code"),JobLedgEntry.FIELDNO("Global Dimension 2 Code"),
        JobLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Res. Ledger Entry",ResLedgEntry.FIELDNO("Global Dimension 1 Code"),
        ResLedgEntry.FIELDNO("Global Dimension 2 Code"),ResLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Value Entry",ValueEntry.FIELDNO("Global Dimension 1 Code"),ValueEntry.FIELDNO("Global Dimension 2 Code"),
        ValueEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Capacity Ledger Entry",CapLedgEntry.FIELDNO("Global Dimension 1 Code"),
        CapLedgEntry.FIELDNO("Global Dimension 2 Code"),CapLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Bank Account Ledger Entry",BankAccLedgEntry.FIELDNO("Global Dimension 1 Code"),
        BankAccLedgEntry.FIELDNO("Global Dimension 2 Code"),BankAccLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Phys. Inventory Ledger Entry",PhysInvtLedgEntry.FIELDNO("Global Dimension 1 Code"),
        PhysInvtLedgEntry.FIELDNO("Global Dimension 2 Code"),PhysInvtLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"FA Ledger Entry",FALedgEntry.FIELDNO("Global Dimension 1 Code"),FALedgEntry.FIELDNO("Global Dimension 2 Code"),
        FALedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Maintenance Ledger Entry",MaintenanceLedgEntry.FIELDNO("Global Dimension 1 Code"),
        MaintenanceLedgEntry.FIELDNO("Global Dimension 2 Code"),MaintenanceLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Ins. Coverage Ledger Entry",InsCovLedgEntry.FIELDNO("Global Dimension 1 Code"),
        InsCovLedgEntry.FIELDNO("Global Dimension 2 Code"),InsCovLedgEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Ledger Entry",ServiceLedgerEntry.FIELDNO("Global Dimension 1 Code"),
        ServiceLedgerEntry.FIELDNO("Global Dimension 2 Code"),ServiceLedgerEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Warranty Ledger Entry",WarrantyLedgerEntry.FIELDNO("Global Dimension 1 Code"),
        WarrantyLedgerEntry.FIELDNO("Global Dimension 2 Code"),WarrantyLedgerEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Gen. Journal Line",GenJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        GenJnlLine.FIELDNO("Shortcut Dimension 2 Code"),GenJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Item Journal Line",ItemJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        ItemJnlLine.FIELDNO("Shortcut Dimension 2 Code"),ItemJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Res. Journal Line",ResJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        ResJnlLine.FIELDNO("Shortcut Dimension 2 Code"),ResJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Job Journal Line",JobJnlLine.FIELDNO("Shortcut Dimension 1 Code"),JobJnlLine.FIELDNO("Shortcut Dimension 2 Code"),
        JobJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Gen. Jnl. Allocation",GenJnlAlloc.FIELDNO("Shortcut Dimension 1 Code"),
        GenJnlAlloc.FIELDNO("Shortcut Dimension 2 Code"),GenJnlAlloc.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Requisition Line",ReqLine.FIELDNO("Shortcut Dimension 1 Code"),ReqLine.FIELDNO("Shortcut Dimension 2 Code"),
        ReqLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"FA Journal Line",FAJnlLine.FIELDNO("Shortcut Dimension 1 Code"),FAJnlLine.FIELDNO("Shortcut Dimension 2 Code"),
        FAJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Insurance Journal Line",InsuranceJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        InsuranceJnlLine.FIELDNO("Shortcut Dimension 2 Code"),InsuranceJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Planning Component",PlanningComponent.FIELDNO("Shortcut Dimension 1 Code"),
        PlanningComponent.FIELDNO("Shortcut Dimension 2 Code"),PlanningComponent.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard General Journal Line",StdGenJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdGenJnlLine.FIELDNO("Shortcut Dimension 2 Code"),StdGenJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard Item Journal Line",StdItemJnlLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdItemJnlLine.FIELDNO("Shortcut Dimension 2 Code"),StdItemJnlLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Header",SalesHeader.FIELDNO("Shortcut Dimension 1 Code"),SalesHeader.FIELDNO("Shortcut Dimension 2 Code"),
        SalesHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Line",SalesLine.FIELDNO("Shortcut Dimension 1 Code"),SalesLine.FIELDNO("Shortcut Dimension 2 Code"),
        SalesLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purchase Header",PurchHeader.FIELDNO("Shortcut Dimension 1 Code"),
        PurchHeader.FIELDNO("Shortcut Dimension 2 Code"),PurchHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purchase Line",PurchLine.FIELDNO("Shortcut Dimension 1 Code"),PurchLine.FIELDNO("Shortcut Dimension 2 Code"),
        PurchLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard Sales Line",StdSalesLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdSalesLine.FIELDNO("Shortcut Dimension 2 Code"),StdSalesLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard Purchase Line",StdPurchLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdPurchLine.FIELDNO("Shortcut Dimension 2 Code"),StdPurchLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Reminder Header",ReminderHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ReminderHeader.FIELDNO("Shortcut Dimension 2 Code"),ReminderHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Finance Charge Memo Header",FinChrgMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        FinChrgMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),FinChrgMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Header",ServHeader.FIELDNO("Shortcut Dimension 1 Code"),ServHeader.FIELDNO("Shortcut Dimension 2 Code"),
        ServHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Item Line",ServItemLine.FIELDNO("Shortcut Dimension 1 Code"),
        ServItemLine.FIELDNO("Shortcut Dimension 2 Code"),ServItemLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Line",ServLine.FIELDNO("Shortcut Dimension 1 Code"),ServLine.FIELDNO("Shortcut Dimension 2 Code"),
        ServLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Header Archive",SalesHeaderArchive.FIELDNO("Shortcut Dimension 1 Code"),
        SalesHeaderArchive.FIELDNO("Shortcut Dimension 2 Code"),SalesHeaderArchive.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purchase Header Archive",PurchHeaderArchive.FIELDNO("Shortcut Dimension 1 Code"),
        PurchHeaderArchive.FIELDNO("Shortcut Dimension 2 Code"),PurchHeaderArchive.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Header",TransferHeader.FIELDNO("Shortcut Dimension 1 Code"),
        TransferHeader.FIELDNO("Shortcut Dimension 2 Code"),TransferHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Line",TransferLine.FIELDNO("Shortcut Dimension 1 Code"),
        TransferLine.FIELDNO("Shortcut Dimension 2 Code"),TransferLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Standard Service Line",StdServLine.FIELDNO("Shortcut Dimension 1 Code"),
        StdServLine.FIELDNO("Shortcut Dimension 2 Code"),StdServLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Production Order",ProdOrder.FIELDNO("Shortcut Dimension 1 Code"),ProdOrder.FIELDNO("Shortcut Dimension 2 Code"),
        ProdOrder.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Prod. Order Line",ProdOrderLine.FIELDNO("Shortcut Dimension 1 Code"),
        ProdOrderLine.FIELDNO("Shortcut Dimension 2 Code"),ProdOrderLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Prod. Order Component",ProdOrderComp.FIELDNO("Shortcut Dimension 1 Code"),
        ProdOrderComp.FIELDNO("Shortcut Dimension 2 Code"),ProdOrderComp.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Shipment Header",SalesShptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        SalesShptHeader.FIELDNO("Shortcut Dimension 2 Code"),SalesShptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Shipment Line",SaleShptLine.FIELDNO("Shortcut Dimension 1 Code"),
        SaleShptLine.FIELDNO("Shortcut Dimension 2 Code"),SaleShptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Invoice Header",SalesInvHeader.FIELDNO("Shortcut Dimension 1 Code"),
        SalesInvHeader.FIELDNO("Shortcut Dimension 2 Code"),SalesInvHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Invoice Line",SalesInvLine.FIELDNO("Shortcut Dimension 1 Code"),
        SalesInvLine.FIELDNO("Shortcut Dimension 2 Code"),SalesInvLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Return Receipt Header",ReturnRcptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ReturnRcptHeader.FIELDNO("Shortcut Dimension 2 Code"),ReturnRcptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Return Receipt Line",ReturnRcptLine.FIELDNO("Shortcut Dimension 1 Code"),
        ReturnRcptLine.FIELDNO("Shortcut Dimension 2 Code"),ReturnRcptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Cr.Memo Header",SalesCrMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        SalesCrMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),SalesCrMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Cr.Memo Line",SalesCrMemoLine.FIELDNO("Shortcut Dimension 1 Code"),
        SalesCrMemoLine.FIELDNO("Shortcut Dimension 2 Code"),SalesCrMemoLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Shipment Header",ServShptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ServShptHeader.FIELDNO("Shortcut Dimension 2 Code"),ServShptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Shipment Line",ServShptLine.FIELDNO("Shortcut Dimension 1 Code"),
        ServShptLine.FIELDNO("Shortcut Dimension 2 Code"),ServShptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Invoice Header",ServInvHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ServInvHeader.FIELDNO("Shortcut Dimension 2 Code"),ServInvHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Invoice Line",ServInvLine.FIELDNO("Shortcut Dimension 1 Code"),
        ServInvLine.FIELDNO("Shortcut Dimension 2 Code"),ServInvLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Cr.Memo Header",ServCrMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ServCrMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),ServCrMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Sales Cr.Memo Line",ServCrMemoLine.FIELDNO("Shortcut Dimension 1 Code"),
        ServCrMemoLine.FIELDNO("Shortcut Dimension 2 Code"),ServCrMemoLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Rcpt. Header",PurchRcptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        PurchRcptHeader.FIELDNO("Shortcut Dimension 2 Code"),PurchRcptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Rcpt. Line",PurchRcptLine.FIELDNO("Shortcut Dimension 1 Code"),
        PurchRcptLine.FIELDNO("Shortcut Dimension 2 Code"),PurchRcptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Inv. Header",PurchInvHeader.FIELDNO("Shortcut Dimension 1 Code"),
        PurchInvHeader.FIELDNO("Shortcut Dimension 2 Code"),PurchInvHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Inv. Line",PurchInvLine.FIELDNO("Shortcut Dimension 1 Code"),
        PurchInvLine.FIELDNO("Shortcut Dimension 2 Code"),PurchInvLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Return Shipment Header",ReturnShptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ReturnShptHeader.FIELDNO("Shortcut Dimension 2 Code"),ReturnShptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Return Shipment Line",ReturnShptLine.FIELDNO("Shortcut Dimension 1 Code"),
        ReturnShptLine.FIELDNO("Shortcut Dimension 2 Code"),ReturnShptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Cr. Memo Hdr.",PurchCrMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        PurchCrMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),PurchCrMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Purch. Cr. Memo Line",PurchCrMemoLine.FIELDNO("Shortcut Dimension 1 Code"),
        PurchCrMemoLine.FIELDNO("Shortcut Dimension 2 Code"),PurchCrMemoLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Issued Reminder Header",IssuedReminderHeader.FIELDNO("Shortcut Dimension 1 Code"),
        IssuedReminderHeader.FIELDNO("Shortcut Dimension 2 Code"),IssuedReminderHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Issued Fin. Charge Memo Header",IssuedFinChrgMemoHeader.FIELDNO("Shortcut Dimension 1 Code"),
        IssuedFinChrgMemoHeader.FIELDNO("Shortcut Dimension 2 Code"),IssuedFinChrgMemoHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Shipment Header",TransferShipmentHeader.FIELDNO("Shortcut Dimension 1 Code"),
        TransferShipmentHeader.FIELDNO("Shortcut Dimension 2 Code"),TransferShipmentHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Shipment Line",TransferShipmentLine.FIELDNO("Shortcut Dimension 1 Code"),
        TransferShipmentLine.FIELDNO("Shortcut Dimension 2 Code"),TransferShipmentLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Receipt Header",TransferReceiptHeader.FIELDNO("Shortcut Dimension 1 Code"),
        TransferReceiptHeader.FIELDNO("Shortcut Dimension 2 Code"),TransferReceiptHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Transfer Receipt Line",TransferReceiptLine.FIELDNO("Shortcut Dimension 1 Code"),
        TransferReceiptLine.FIELDNO("Shortcut Dimension 2 Code"),TransferReceiptLine.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"G/L Budget Entry",GLBudgetEntry.FIELDNO("Global Dimension 1 Code"),
        GLBudgetEntry.FIELDNO("Global Dimension 2 Code"),GLBudgetEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"FA Allocation",FAAlloc.FIELDNO("Global Dimension 1 Code"),FAAlloc.FIELDNO("Global Dimension 2 Code"),
        FAAlloc.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Service Contract Header",ServCtrHeader.FIELDNO("Shortcut Dimension 1 Code"),
        ServCtrHeader.FIELDNO("Shortcut Dimension 2 Code"),ServCtrHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Filed Service Contract Header",FiledServCtrHeader.FIELDNO("Shortcut Dimension 1 Code"),
        FiledServCtrHeader.FIELDNO("Shortcut Dimension 2 Code"),FiledServCtrHeader.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Job WIP Entry",JobWIPEntry.FIELDNO("Global Dimension 1 Code"),JobWIPEntry.FIELDNO("Global Dimension 2 Code"),
        JobWIPEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Job WIP G/L Entry",JobWIPGLEntry.FIELDNO("Global Dimension 1 Code"),
        JobWIPGLEntry.FIELDNO("Global Dimension 2 Code"),JobWIPGLEntry.FIELDNO("Dimension Set ID"));
      AddToDimSetTempTable(
        DATABASE::"Item Budget Entry",ItemBudgetEntry.FIELDNO("Global Dimension 1 Code"),
        ItemBudgetEntry.FIELDNO("Global Dimension 2 Code"),ItemBudgetEntry.FIELDNO("Dimension Set ID"));
    END;

    LOCAL PROCEDURE AddingDefaultValueDim@4();
    BEGIN
      AddToDefaultDimTempTable(
        DATABASE::"G/L Account",GLAcc.FIELDNO("Global Dimension 1 Code"),GLAcc.FIELDNO("Global Dimension 2 Code"),
        GLAcc.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Customer,Cust.FIELDNO("Global Dimension 1 Code"),Cust.FIELDNO("Global Dimension 2 Code"),Cust.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Vendor,Vend.FIELDNO("Global Dimension 1 Code"),Vend.FIELDNO("Global Dimension 2 Code"),Vend.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Item,Item.FIELDNO("Global Dimension 1 Code"),Item.FIELDNO("Global Dimension 2 Code"),Item.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Resource Group",ResGr.FIELDNO("Global Dimension 1 Code"),ResGr.FIELDNO("Global Dimension 2 Code"),
        ResGr.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Resource,Res.FIELDNO("Global Dimension 1 Code"),Res.FIELDNO("Global Dimension 2 Code"),Res.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Job,Job.FIELDNO("Global Dimension 1 Code"),Job.FIELDNO("Global Dimension 2 Code"),Job.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Bank Account",BankAcc.FIELDNO("Global Dimension 1 Code"),BankAcc.FIELDNO("Global Dimension 2 Code"),
        BankAcc.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Employee,Employee.FIELDNO("Global Dimension 1 Code"),Employee.FIELDNO("Global Dimension 2 Code"),
        Employee.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Fixed Asset",FA.FIELDNO("Global Dimension 1 Code"),FA.FIELDNO("Global Dimension 2 Code"),FA.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::Insurance,Insurance.FIELDNO("Global Dimension 1 Code"),Insurance.FIELDNO("Global Dimension 2 Code"),
        Insurance.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Responsibility Center",RespCenter.FIELDNO("Global Dimension 1 Code"),
        RespCenter.FIELDNO("Global Dimension 2 Code"),RespCenter.FIELDNO(Code));
      AddToDefaultDimTempTable(
        DATABASE::"Salesperson/Purchaser",SalespersonPurchaser.FIELDNO("Global Dimension 1 Code"),
        SalespersonPurchaser.FIELDNO("Global Dimension 2 Code"),SalespersonPurchaser.FIELDNO(Code));
      AddToDefaultDimTempTable(
        DATABASE::Campaign,Campaign.FIELDNO("Global Dimension 1 Code"),Campaign.FIELDNO("Global Dimension 2 Code"),
        Campaign.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Customer Template",CustomerTemplate.FIELDNO("Global Dimension 1 Code"),
        CustomerTemplate.FIELDNO("Global Dimension 2 Code"),CustomerTemplate.FIELDNO(Code));
      AddToDefaultDimTempTable(
        DATABASE::"Item Charge",ItemCharge.FIELDNO("Global Dimension 1 Code"),ItemCharge.FIELDNO("Global Dimension 2 Code"),
        ItemCharge.FIELDNO("No."));
      AddToDefaultDimTempTable(
        DATABASE::"Work Center",WorkCenter.FIELDNO("Global Dimension 1 Code"),WorkCenter.FIELDNO("Global Dimension 2 Code"),
        WorkCenter.FIELDNO("No."));
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 84 Update Analysis Views
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW17.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Update Analysis Views;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 3400;    ;DataItem;                    ;
               DataItemTable=Table363;
               DataItemTableView=SORTING(Code);
               OnPreDataItem=BEGIN
                               LOCKTABLE;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF NOT Blocked THEN
                                    UpdateAnalysisView.Update("Analysis View",2,TRUE)
                                  ELSE
                                    BlockedOccured := TRUE;
                                END;

               OnPostDataItem=BEGIN
                                IF BlockedOccured THEN
                                  MESSAGE(Text000)
                                ELSE
                                  MESSAGE(Text001);
                              END;

               ReqFilterFields=Code }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      UpdateAnalysisView@1000 : Codeunit 410;
      Text000@1001 : TextConst 'ENU=One or more of the selected Analysis Views is Blocked, and could not be updated.';
      BlockedOccured@1002 : Boolean;
      Text001@1003 : TextConst 'ENU=All selected Analysis Views were updated successfully.';

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 85 Copy - VAT Posting Setup
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Copy - VAT Posting Setup;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 1756;    ;DataItem;                    ;
               DataItemTable=Table325;
               DataItemTableView=SORTING(VAT Bus. Posting Group,VAT Prod. Posting Group);
               OnPreDataItem=BEGIN
                               SETRANGE("VAT Bus. Posting Group",UseVATPostingSetup."VAT Bus. Posting Group");
                               SETRANGE("VAT Prod. Posting Group",UseVATPostingSetup."VAT Prod. Posting Group");
                             END;

               OnAfterGetRecord=BEGIN
                                  VATPostingSetup.FIND;
                                  IF VATSetup THEN BEGIN
                                    "VAT Calculation Type" := VATPostingSetup."VAT Calculation Type";
                                    "VAT %" := VATPostingSetup."VAT %";
                                    "Unrealized VAT Type" := VATPostingSetup."Unrealized VAT Type";
                                    "Adjust for Payment Discount" := VATPostingSetup."Adjust for Payment Discount";
                                    "VAT Identifier" := VATPostingSetup."VAT Identifier";
                                  END;

                                  IF Sales THEN BEGIN
                                    "Sales VAT Account" := VATPostingSetup."Sales VAT Account";
                                    "Sales VAT Unreal. Account" := VATPostingSetup."Sales VAT Unreal. Account";
                                  END;

                                  IF Purch THEN BEGIN
                                    "Purchase VAT Account" := VATPostingSetup."Purchase VAT Account";
                                    "Purch. VAT Unreal. Account" := VATPostingSetup."Purch. VAT Unreal. Account";
                                    "Reverse Chrg. VAT Acc." := VATPostingSetup."Reverse Chrg. VAT Acc.";
                                    "Reverse Chrg. VAT Unreal. Acc." := VATPostingSetup."Reverse Chrg. VAT Unreal. Acc.";
                                  END;

                                  IF CONFIRM(Text000,FALSE) THEN
                                    MODIFY;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF Selection = Selection::"All fields" THEN BEGIN
                     VATSetup := TRUE;
                     Sales := TRUE;
                     Purch := TRUE;
                   END;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 2   ;2   ;Field     ;
                  Name=VATBusPostingGroup;
                  CaptionML=ENU=VAT Bus. Posting Group;
                  SourceExpr=VATPostingSetup."VAT Bus. Posting Group";
                  TableRelation="VAT Business Posting Group" }

      { 4   ;2   ;Field     ;
                  Name=VATProdPostingGroup;
                  CaptionML=ENU=VAT Prod. Posting Group;
                  SourceExpr=VATPostingSetup."VAT Prod. Posting Group";
                  TableRelation="VAT Product Posting Group" }

      { 7   ;2   ;Field     ;
                  Name=Copy;
                  CaptionML=ENU=Copy;
                  OptionCaptionML=ENU=All fields,Selected fields;
                  SourceExpr=Selection;
                  OnValidate=BEGIN
                               IF Selection = Selection::"All fields" THEN
                                 AllfieldsSelectionOnValidate;
                             END;
                              }

      { 10  ;2   ;Field     ;
                  Name=VATetc;
                  CaptionML=ENU=VAT % etc.;
                  SourceExpr=VATSetup;
                  OnValidate=BEGIN
                               Selection := Selection::"Selected fields";
                             END;
                              }

      { 1   ;2   ;Field     ;
                  Name=SalesAccounts;
                  CaptionML=ENU=Sales Accounts;
                  SourceExpr=Sales;
                  OnValidate=BEGIN
                               Selection := Selection::"Selected fields";
                             END;
                              }

      { 17  ;2   ;Field     ;
                  Name=PurchaseAccounts;
                  CaptionML=ENU=Purchase Accounts;
                  SourceExpr=Purch;
                  OnValidate=BEGIN
                               Selection := Selection::"Selected fields";
                             END;
                              }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Copy VAT Posting Setup?';
      UseVATPostingSetup@1001 : Record 325;
      VATPostingSetup@1002 : Record 325;
      VATSetup@1003 : Boolean;
      Sales@1004 : Boolean;
      Purch@1005 : Boolean;
      Selection@1006 : 'All fields,Selected fields';

    PROCEDURE SetVATSetup@1(VATPostingSetup2@1000 : Record 325);
    BEGIN
      UseVATPostingSetup := VATPostingSetup2;
    END;

    LOCAL PROCEDURE AllfieldsSelectionOnPush@19052427();
    BEGIN
      VATSetup := TRUE;
      Sales := TRUE;
      Purch := TRUE;
    END;

    LOCAL PROCEDURE AllfieldsSelectionOnValidate@19034152();
    BEGIN
      AllfieldsSelectionOnPush;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 86 Adjust Add. Reporting Currency
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW18.00,4PS9.00;
  }
  PROPERTIES
  {
    Permissions=TableData 17=im,
                TableData 32=m,
                TableData 45=im,
                TableData 11072005=m,
                TableData 254=m,
                TableData 355=imd,
                TableData 5802=m;
    CaptionML=ENU=Adjust Add. Reporting Currency;
    ProcessingOnly=Yes;
    OnInitReport=BEGIN
                   IF GLSetup."Additional Reporting Currency" = '' THEN
                     GLSetup.GET;
                 END;

    OnPreReport=VAR
                  GenJnlLine@1000 : Record 81;
                BEGIN
                  Currency.GET(GLSetup."Additional Reporting Currency");
                  Currency.TESTFIELD("Amount Rounding Precision");
                  Currency.TESTFIELD("Unit-Amount Rounding Precision");
                  Currency.TESTFIELD("Residual Gains Account");
                  ResidualGLAcc.GET(Currency."Residual Gains Account");
                  ResidualGLAcc.TESTFIELD(Blocked,FALSE);
                  ResidualGLAcc.TESTFIELD("Account Type",ResidualGLAcc."Account Type"::Posting);
                  Currency.TESTFIELD("Residual Losses Account");
                  ResidualGLAcc.GET(Currency."Residual Losses Account");
                  ResidualGLAcc.TESTFIELD(Blocked,FALSE);
                  ResidualGLAcc.TESTFIELD("Account Type",ResidualGLAcc."Account Type"::Posting);
                  SourceCodeSetup.GET;
                  SourceCodeSetup.TESTFIELD("Adjust Add. Reporting Currency");

                  IF DocumentNo = '' THEN
                    ERROR(
                      Text000,GenJnlLine.FIELDCAPTION("Document No."));
                  IF RetainedEarningsGLAcc."No." = '' THEN
                    ERROR(Text001);
                END;

    OnPostReport=BEGIN
                   ReportIsExecuted := TRUE;
                 END;

  }
  DATASET
  {
    { 7612;    ;DataItem;                    ;
               DataItemTable=Table254;
               DataItemTableView=SORTING(Type,Closed)
                                 WHERE(Type=FILTER(Purchase..Sale));
               OnPreDataItem=VAR
                               GLSetup@1000 : Record 98;
                             BEGIN
                               Window.OPEN(
                                 Text002);
                               IF COUNT > 0 THEN
                                 VATEntryStep := 10000 * 100000 DIV COUNT;

                               GLSetup.GET;
                               IF NOT GLSetup."Unrealized VAT" THEN
                                 SETRANGE(Closed,FALSE);
                             END;

               OnAfterGetRecord=BEGIN
                                  VATEntryCount := VATEntryCount + VATEntryStep;
                                  IF VATEntryOldCount DIV 100000 <> VATEntryCount DIV 100000 THEN BEGIN
                                    Window.UPDATE(1,VATEntryCount DIV 100000);
                                    VATEntryOldCount := VATEntryCount;
                                  END;

                                  "Additional-Currency Amount" := ExchangeAmtLCYToFCY("Posting Date",Amount,FALSE);
                                  "Additional-Currency Base" := ExchangeAmtLCYToFCY("Posting Date",Base,FALSE);
                                  "Add.-Currency Unrealized Amt." := ExchangeAmtLCYToFCY("Posting Date","Unrealized Amount",FALSE);
                                  "Add.-Currency Unrealized Base" := ExchangeAmtLCYToFCY("Posting Date","Unrealized Base",FALSE);
                                  "Add.-Curr. Rem. Unreal. Amount" := ExchangeAmtLCYToFCY("Posting Date","Remaining Unrealized Amount",FALSE);
                                  "Add.-Curr. Rem. Unreal. Base" := ExchangeAmtLCYToFCY("Posting Date","Remaining Unrealized Base",FALSE);
                                  MODIFY;
                                END;

               OnPostDataItem=BEGIN
                                Window.CLOSE;
                              END;
                               }

    { 7069;    ;DataItem;                    ;
               DataItemTable=Table17;
               DataItemTableView=SORTING(Entry No.);
               OnPreDataItem=BEGIN
                               Window.OPEN(
                                 Text003 +
                                 Text004);
                             END;

               OnAfterGetRecord=VAR
                                  GLAccNo@1000 : Code[20];
                                BEGIN
                                  IF OldGLEntry."Posting Date" < "Posting Date" THEN BEGIN
                                    Window.UPDATE(1,"Posting Date");
                                    OldGLEntry := "G/L Entry";
                                  END;
                                  "Additional-Currency Amount" := ExchangeAmtLCYToFCY("Posting Date",Amount,FALSE);
                                  IF "Debit Amount" <> 0 THEN BEGIN
                                    "Add.-Currency Debit Amount" := "Additional-Currency Amount";
                                    "Add.-Currency Credit Amount" := 0;
                                  END ELSE BEGIN
                                    "Add.-Currency Debit Amount" := 0;
                                    "Add.-Currency Credit Amount" := -"Additional-Currency Amount";
                                  END;
                                  MODIFY;

                                  TotalAddCurrAmount := TotalAddCurrAmount + "Additional-Currency Amount";
                                  TotalAmount := TotalAmount + Amount;
                                  IF TotalAmount = 0 THEN
                                    IF TotalAddCurrAmount <> 0 THEN BEGIN
                                      IF TotalAddCurrAmount < 0 THEN
                                        GLAccNo := Currency."Residual Losses Account"
                                      ELSE
                                        GLAccNo := Currency."Residual Gains Account";
                                      InsertGLEntry(
                                        "Posting Date","Document Date","Document Type","Document No.",GLAccNo,
                                        "Journal Batch Name","Reason Code",-TotalAddCurrAmount);
                                      TotalAddCurrAmount := 0;
                                    END;

                                  IF "Entry No." = LastEntryNo THEN
                                    CurrReport.BREAK;

                                  IF "Posting Date" = CLOSINGDATE("Posting Date") THEN BEGIN
                                    TmpCloseIncomeStatementBuffer."Closing Date" := "Posting Date";
                                    TmpCloseIncomeStatementBuffer."G/L Account No." := "G/L Account No.";
                                    IF TmpCloseIncomeStatementBuffer.INSERT THEN;
                                  END;
                                END;

               OnPostDataItem=BEGIN
                                IF TmpCloseIncomeStatementBuffer.FIND('-') THEN
                                  REPEAT
                                    IF IsAccountingPeriodClosingDate(
                                         TmpCloseIncomeStatementBuffer."Closing Date")
                                    THEN BEGIN
                                      CheckCombination(TmpCloseIncomeStatementBuffer);

                                      CLEAR(TmpCloseIncomeStatementBuffer3);
                                      TmpCloseIncomeStatementBuffer3."Closing Date" := "Posting Date";
                                      TmpCloseIncomeStatementBuffer3."G/L Account No." := Currency."Residual Gains Account";
                                      IF TmpCloseIncomeStatementBuffer3.INSERT THEN;
                                      TmpCloseIncomeStatementBuffer3."Closing Date" := "Posting Date";
                                      TmpCloseIncomeStatementBuffer3."G/L Account No." := Currency."Residual Losses Account";
                                      IF TmpCloseIncomeStatementBuffer3.INSERT THEN;
                                    END;
                                  UNTIL TmpCloseIncomeStatementBuffer.NEXT = 0;

                                IF TmpCloseIncomeStatementBuffer3.FIND('-') THEN
                                  REPEAT
                                    CheckCombination(TmpCloseIncomeStatementBuffer3);
                                  UNTIL TmpCloseIncomeStatementBuffer3.NEXT = 0;

                                IF GLReg."To Entry No." <> 0 THEN
                                  GLReg.INSERT;
                                Window.CLOSE;
                              END;
                               }

    { 8894;    ;DataItem;                    ;
               DataItemTable=Table5802;
               DataItemTableView=SORTING(Item No.);
               OnPreDataItem=BEGIN
                               Window.OPEN(
                                 Text011 +
                                 Text006);
                             END;

               OnAfterGetRecord=VAR
                                  ItemLedgerEntry@1000 : Record 32;
                                  PostingDate@1001 : Date;
                                BEGIN
                                  IF OldValueEntry."Item No." <> "Item No." THEN BEGIN
                                    Window.UPDATE(1,"Item No.");
                                    OldValueEntry := "Value Entry";
                                  END;

                                  IF "Entry Type" = "Entry Type"::Revaluation THEN BEGIN
                                    ItemLedgerEntry.GET("Item Ledger Entry No.");
                                    PostingDate := ItemLedgerEntry."Posting Date";
                                  END ELSE
                                    PostingDate := "Posting Date";

                                  "Cost per Unit (ACY)" := ExchangeAmtLCYToFCY(PostingDate,"Cost per Unit",TRUE);
                                  "Cost Amount (Actual) (ACY)" := ExchangeAmtLCYToFCY(PostingDate,"Cost Amount (Actual)",FALSE);
                                  "Cost Amount (Expected) (ACY)" := ExchangeAmtLCYToFCY(PostingDate,"Cost Amount (Expected)",FALSE);
                                  "Cost Amount (Non-Invtbl.)(ACY)" := ExchangeAmtLCYToFCY(PostingDate,"Cost Amount (Non-Invtbl.)",FALSE);
                                  "Cost Posted to G/L (ACY)" := ExchangeAmtLCYToFCY(PostingDate,"Cost Posted to G/L",FALSE);

                                  MODIFY;
                                END;

               OnPostDataItem=BEGIN
                                Window.CLOSE;
                              END;
                               }

    { 5612;    ;DataItem;                    ;
               DataItemTable=Table11072005;
               DataItemTableView=SORTING(Job No.,Posting Date);
               OnPreDataItem=BEGIN
                               Window.OPEN(
                                 Text007 +
                                 Text008);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF OldJobLedgEntry."Job No." <> "Job No." THEN BEGIN
                                    Window.UPDATE(1,"Job No.");
                                    OldJobLedgEntry := "Job Ledger Entry";
                                  END;

                                  "Additional-Currency Total Cost" := ExchangeAmtLCYToFCY("Posting Date","Total Cost (LCY)",FALSE);
                                  "Add.-Currency Total Price" := ExchangeAmtLCYToFCY("Posting Date","Total Price (LCY)",FALSE);
                                  MODIFY;
                                END;
                                 }

    { 3581;    ;DataItem;                    ;
               DataItemTable=Table5406;
               DataItemTableView=SORTING(Status,Prod. Order No.,Line No.);
               OnPreDataItem=BEGIN
                               Window.OPEN(
                                 Text99000004 +
                                 Text99000002);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF OldProdOrderLine."Prod. Order No." <> "Prod. Order No." THEN BEGIN
                                    Window.UPDATE(1,"Prod. Order No.");
                                    OldProdOrderLine := "Prod. Order Line";
                                  END;

                                  "Cost Amount (ACY)" := ExchangeAmtLCYToFCY(WORKDATE,"Cost Amount",FALSE);
                                  "Unit Cost (ACY)" := ExchangeAmtLCYToFCY(WORKDATE,"Unit Cost",TRUE);
                                  MODIFY;
                                END;
                                 }

    { 5276;    ;DataItem;                    ;
               DataItemTable=Table1104;
               OnPreDataItem=BEGIN
                               Window.OPEN(
                                 Text012 +
                                 Text004);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF OldCostEntry."Posting Date" < "Posting Date" THEN BEGIN
                                    Window.UPDATE(1,"Posting Date");
                                    OldCostEntry := "Cost Entry";
                                  END;
                                  "Additional-Currency Amount" := ExchangeAmtLCYToFCY("Posting Date",Amount,FALSE);
                                  IF "Debit Amount" <> 0 THEN BEGIN
                                    "Add.-Currency Debit Amount" := "Additional-Currency Amount";
                                    "Add.-Currency Credit Amount" := 0;
                                  END ELSE BEGIN
                                    "Add.-Currency Debit Amount" := 0;
                                    "Add.-Currency Credit Amount" := -"Additional-Currency Amount";
                                  END;
                                  MODIFY;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnOpenPage=BEGIN
                   GLSetup.TESTFIELD("Additional Reporting Currency");
                   GLSetup2 := GLSetup;
                   //CurrencyFactor := CurrExchRate.ExchangeRate(WORKDATE,GLSetup."Additional Reporting Currency"); //**4PS.o
                   CurrencyFactor := CurrExchRate.ExchangeRate(0, '',WORKDATE,GLSetup."Additional Reporting Currency",TRUE); //**4PS.n
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 7   ;2   ;Field     ;
                  CaptionML=ENU=Additional Reporting Currency;
                  SourceExpr=GLSetup."Additional Reporting Currency";
                  Editable=TRUE;
                  OnValidate=BEGIN
                               GLSetup := GLSetup2;
                             END;

                  OnAssistEdit=BEGIN
                                 ChangeExchangeRate.SetParameter(GLSetup."Additional Reporting Currency",CurrencyFactor,WORKDATE);
                                 IF ChangeExchangeRate.RUNMODAL = ACTION::OK THEN
                                   CurrencyFactor := ChangeExchangeRate.GetParameter;
                                 CLEAR(ChangeExchangeRate);
                               END;
                                }

      { 1   ;2   ;Field     ;
                  Name=DocumentNo;
                  CaptionML=ENU=Document No.;
                  SourceExpr=DocumentNo }

      { 4   ;2   ;Field     ;
                  Name=RetainedEarningsAcc;
                  CaptionML=ENU=Retained Earnings Acc.;
                  SourceExpr=RetainedEarningsGLAcc."No.";
                  TableRelation="G/L Account";
                  OnValidate=BEGIN
                               IF RetainedEarningsGLAcc."No." <> '' THEN BEGIN
                                 RetainedEarningsGLAcc.FIND;
                                 RetainedEarningsGLAcc.CheckGLAcc;
                               END;
                             END;
                              }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Please enter a %1.';
      Text001@1001 : TextConst 'ENU=Please enter Retained Earnings Account No.';
      Text002@1002 : TextConst 'ENU=Processing VAT Entries @1@@@@@@@@@@\';
      Text003@1003 : TextConst 'ENU=Processing G/L Entries...\\';
      Text004@1004 : TextConst 'ENU=Posting Date #1##########\';
      Text006@1005 : TextConst 'ENU=Item No. #1##########\';
      Text007@1006 : TextConst 'ENU=Processing Job Ledger Entries...\\';
      Text008@1007 : TextConst 'ENU=Job No. #1##########\';
      Text010@1008 : TextConst 'ENU=Residual caused by rounding of %1';
      Text011@1009 : TextConst 'ENU=Processing Value Entries...\\';
      Text012@1012 : TextConst 'ENU=Processing Cost Entries...\\';
      Text99000002@1011 : TextConst 'ENU=Prod. Order No. #1##########\';
      Text99000004@1013 : TextConst 'ENU=Processing Finished Prod. Order Lines...\\';
      GLSetup@1014 : Record 98;
      GLSetup2@1015 : Record 98;
      SourceCodeSetup@1016 : Record 242;
      OldGLEntry@1017 : Record 17;
      OldValueEntry@1018 : Record 5802;
      OldJobLedgEntry@1019 : Record 11072005;
      OldProdOrderLine@1022 : Record 5406;
      OldCostEntry@1010 : Record 1104;
      CurrExchRate@1023 : Record 330;
      Currency@1024 : Record 4;
      GLEntry2@1025 : Record 17;
      GLReg@1026 : Record 45;
      AccountingPeriod@1027 : Record 50;
      TmpCloseIncomeStatementBuffer@1028 : TEMPORARY Record 347;
      TmpCloseIncomeStatementBuffer3@1029 : TEMPORARY Record 347;
      GLEntry3@1030 : Record 17;
      RetainedEarningsGLAcc@1031 : Record 15;
      ResidualGLAcc@1020 : Record 15;
      ChangeExchangeRate@1032 : Page 511;
      CurrencyFactor@1033 : Decimal;
      Window@1034 : Dialog;
      TotalAddCurrAmount@1035 : Decimal;
      TotalAmount@1036 : Decimal;
      NextEntryNo@1037 : Integer;
      LastEntryNo@1038 : Integer;
      NextTransactionNo@1039 : Integer;
      FiscalYearStartDate@1040 : Date;
      ReportIsExecuted@1041 : Boolean;
      VATEntryCount@1042 : Integer;
      VATEntryOldCount@1043 : Integer;
      VATEntryStep@1044 : Integer;
      FiscalYearStartDate2@1045 : Date;
      FiscalYearEndDate2@1046 : Date;
      LastDateChecked@1047 : Date;
      LastFiscalYearStartDate@1048 : Date;
      LastFiscalYearEndDate@1049 : Date;
      LastIsAccPeriodClosingDate@1050 : Boolean;
      DocumentNo@1051 : Code[20];

    PROCEDURE SetAddCurr@2(AddCurr@1000 : Code[10]);
    BEGIN
      GLSetup."Additional Reporting Currency" := AddCurr;
    END;

    PROCEDURE IsExecuted@3() : Boolean;
    BEGIN
      EXIT(ReportIsExecuted);
    END;

    LOCAL PROCEDURE ExchangeAmtLCYToFCY@1(PostingDate@1003 : Date;Amount@1000 : Decimal;IsUnitAmount@1001 : Boolean) : Decimal;
    VAR
      AmtRndgPrec@1002 : Decimal;
    BEGIN
      IF IsUnitAmount THEN
        AmtRndgPrec := Currency."Unit-Amount Rounding Precision"
      ELSE
        AmtRndgPrec := Currency."Amount Rounding Precision";
      EXIT(
        ROUND(
          CurrExchRate.ExchangeAmtLCYToFCY(
            0, '', //**4PS.n
            PostingDate,GLSetup."Additional Reporting Currency",Amount,
      //    CurrExchRate.ExchangeRate(PostingDate,GLSetup."Additional Reporting Currency")), //**4PS.o
            CurrExchRate.ExchangeRate(0, '',PostingDate,GLSetup."Additional Reporting Currency",TRUE),TRUE), //**4PS.n
          AmtRndgPrec));
    END;

    PROCEDURE IsAccountingPeriodClosingDate@5(Date@1000 : Date) : Boolean;
    VAR
      AccountingPeriod@1001 : Record 50;
      OK@1002 : Boolean;
    BEGIN
      IF Date <> LastDateChecked THEN BEGIN
        OK := AccountingPeriod.GET(NORMALDATE(Date) + 1);
        IF OK THEN
          OK := AccountingPeriod."New Fiscal Year";
        IF OK THEN BEGIN
          LastFiscalYearEndDate := CLOSINGDATE(Date);
          AccountingPeriod.SETRANGE("New Fiscal Year",TRUE);
          OK := AccountingPeriod.FIND('<');
          LastFiscalYearStartDate := AccountingPeriod."Starting Date";
          LastIsAccPeriodClosingDate := TRUE;
        END ELSE BEGIN
          LastIsAccPeriodClosingDate := FALSE;
          LastFiscalYearStartDate := 0D;
          LastFiscalYearEndDate := 0D;
        END;
      END;
      FiscalYearStartDate2 := LastFiscalYearStartDate;
      FiscalYearEndDate2 := LastFiscalYearEndDate;
      EXIT(LastIsAccPeriodClosingDate);
    END;

    PROCEDURE CheckCombination@7(CloseIncomeStmtBuffer2@1000 : Record 347);
    BEGIN
      CLEAR(GLEntry3);
      GLEntry3.SETCURRENTKEY("G/L Account No.","Posting Date");
      GLEntry3.SETRANGE("G/L Account No.",CloseIncomeStmtBuffer2."G/L Account No.");
      GLEntry3.SETRANGE("Posting Date",FiscalYearStartDate2,FiscalYearEndDate2);

      GLEntry3.CALCSUMS(Amount);
      IF GLEntry3.Amount = 0 THEN BEGIN
        GLEntry3.CALCSUMS("Additional-Currency Amount");
        IF GLEntry3."Additional-Currency Amount" <> 0 THEN BEGIN
          InsertGLEntry(
            FiscalYearEndDate2,FiscalYearEndDate2,GLEntry3."Document Type"::" ",DocumentNo,
            CloseIncomeStmtBuffer2."G/L Account No.",
            '','',-GLEntry3."Additional-Currency Amount");

          InsertGLEntry(
            FiscalYearEndDate2,FiscalYearEndDate2,GLEntry3."Document Type"::" ",DocumentNo,
            RetainedEarningsGLAcc."No.",
            '','',GLEntry3."Additional-Currency Amount");
        END;
      END;
    END;

    PROCEDURE InsertGLEntry@10(PostingDate@1000 : Date;DocumentDate@1001 : Date;DocumentType@1002 : Integer;DocumentNo@1003 : Code[20];GLAccountNo@1004 : Code[20];JnlBatchName@1005 : Code[10];ReasonCode@1006 : Code[10];AddCurrAmount@1007 : Decimal);
    BEGIN
      IF NextEntryNo = 0 THEN BEGIN
        IF GLEntry2.FINDLAST THEN BEGIN
          LastEntryNo := GLEntry2."Entry No.";
          NextEntryNo := GLEntry2."Entry No." + 1;
          NextTransactionNo := GLEntry2."Transaction No." + 1;
        END;

        AccountingPeriod.RESET;
        AccountingPeriod.SETCURRENTKEY(Closed);
        AccountingPeriod.SETRANGE(Closed,FALSE);
        AccountingPeriod.FINDFIRST;
        FiscalYearStartDate := AccountingPeriod."Starting Date";

        GLReg.LOCKTABLE;
        IF GLReg.FINDLAST THEN
          GLReg."No." := GLReg."No." + 1
        ELSE
          GLReg."No." := 1;
        GLReg.INIT;
        GLReg."From Entry No." := NextEntryNo;
        GLReg."From VAT Entry No." := 0;
        GLReg."To VAT Entry No." := 0;
        GLReg."Creation Date" := TODAY;
        GLReg."Source Code" := SourceCodeSetup."Adjust Add. Reporting Currency";
        GLReg."Journal Batch Name" := '';
        GLReg."User ID" := USERID;
      END ELSE
        NextEntryNo := NextEntryNo + 1;

      GLEntry2.INIT;
      GLEntry2."Posting Date" := PostingDate;
      GLEntry2."Document Date" := DocumentDate;
      GLEntry2."Document Type" := DocumentType;
      GLEntry2."Document No." := DocumentNo;
      GLEntry2."External Document No." := '';
      GLEntry2.Description :=
        COPYSTR(
          STRSUBSTNO(
            Text010,
            GLEntry2.FIELDCAPTION("Additional-Currency Amount")),
          1,MAXSTRLEN(GLEntry2.Description));
      GLEntry2."Source Code" := SourceCodeSetup."Adjust Add. Reporting Currency";
      GLEntry2."Source Type" := 0;
      GLEntry2."Source No." := '';
      GLEntry2."Job No." := '';
      GLEntry2.Quantity := 0;
      GLEntry2."Journal Batch Name" := JnlBatchName;
      GLEntry2."Reason Code" := ReasonCode;
      GLEntry2."Entry No." := NextEntryNo;
      GLEntry2."Transaction No." := NextTransactionNo;
      GLEntry2."G/L Account No." := GLAccountNo;
      GLEntry2.Amount := 0;
      GLEntry2."User ID" := USERID;
      GLEntry2."No. Series" := '';
      GLEntry2."System-Created Entry" := TRUE;
      GLEntry2."Prior-Year Entry" := GLEntry2."Posting Date" < FiscalYearStartDate;
      GLEntry2."Additional-Currency Amount" := AddCurrAmount;
      IF GLEntry2."Additional-Currency Amount" > 0 THEN BEGIN
        GLEntry2."Add.-Currency Debit Amount" := GLEntry2."Additional-Currency Amount";
        GLEntry2."Add.-Currency Credit Amount" := 0;
      END ELSE BEGIN
        GLEntry2."Add.-Currency Debit Amount" := 0;
        GLEntry2."Add.-Currency Credit Amount" := -GLEntry2."Additional-Currency Amount";
      END;
      //>>4PSSE.I009
      //GLEntry2.INSERT;
      GLEntry2.INSERT(TRUE);
      //<<4PSSE

      GLReg."To Entry No." := GLEntry2."Entry No.";
    END;

    PROCEDURE InitializeRequest@4(NewDocumentNo@1000 : Code[20];NewRetainedEarningsGLAccNo@1001 : Code[20]);
    BEGIN
      DocumentNo := NewDocumentNo;
      RetainedEarningsGLAcc."No." := NewRetainedEarningsGLAccNo;
      GLSetup2 := GLSetup;
      //CurrencyFactor := CurrExchRate.ExchangeRate(WORKDATE,GLSetup."Additional Reporting Currency"); //**4PS.o
      CurrencyFactor := CurrExchRate.ExchangeRate(0, '',WORKDATE,GLSetup."Additional Reporting Currency",TRUE); //**4PS.n
    END;

    BEGIN
    {
      4PS, Objects renumbered
    }
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 87 Copy - General Posting Setup
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00,NAVSE9.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Copy - General Posting Setup;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 5835;    ;DataItem;                    ;
               DataItemTable=Table252;
               DataItemTableView=SORTING(Gen. Bus. Posting Group,Gen. Prod. Posting Group);
               OnPreDataItem=BEGIN
                               SETRANGE("Gen. Bus. Posting Group",UseGenPostingSetup."Gen. Bus. Posting Group");
                               SETRANGE("Gen. Prod. Posting Group",UseGenPostingSetup."Gen. Prod. Posting Group");
                             END;

               OnAfterGetRecord=BEGIN
                                  GenPostingSetup.FIND;
                                  IF Sales THEN BEGIN
                                    "Sales Account" := GenPostingSetup."Sales Account";
                                    "Sales Credit Memo Account" := GenPostingSetup."Sales Credit Memo Account";
                                    "Sales Line Disc. Account" := GenPostingSetup."Sales Line Disc. Account";
                                    "Sales Inv. Disc. Account" := GenPostingSetup."Sales Inv. Disc. Account";
                                    "Sales Pmt. Disc. Debit Acc." := GenPostingSetup."Sales Pmt. Disc. Debit Acc.";
                                    "Sales Pmt. Disc. Credit Acc." := GenPostingSetup."Sales Pmt. Disc. Credit Acc.";
                                    "Sales Pmt. Tol. Debit Acc." := GenPostingSetup."Sales Pmt. Tol. Debit Acc.";
                                    "Sales Pmt. Tol. Credit Acc." := GenPostingSetup."Sales Pmt. Tol. Credit Acc.";
                                    "Sales Prepayments Account" := GenPostingSetup."Sales Prepayments Account";
                                  END;

                                  IF Purch THEN BEGIN
                                    "Purch. Account" := GenPostingSetup."Purch. Account";
                                    "Purch. Credit Memo Account" := GenPostingSetup."Purch. Credit Memo Account";
                                    "Purch. Line Disc. Account" := GenPostingSetup."Purch. Line Disc. Account";
                                    "Purch. Inv. Disc. Account" := GenPostingSetup."Purch. Inv. Disc. Account";
                                    "Purch. Pmt. Disc. Debit Acc." := GenPostingSetup."Purch. Pmt. Disc. Debit Acc.";
                                    "Purch. Pmt. Disc. Credit Acc." := GenPostingSetup."Purch. Pmt. Disc. Credit Acc.";
                                    "Purch. FA Disc. Account" := GenPostingSetup."Purch. FA Disc. Account";
                                    "Inward Reg. Bridging Account" := GenPostingSetup."Inward Reg. Bridging Account";
                                    "Purch. Pmt. Tol. Debit Acc." := GenPostingSetup."Purch. Pmt. Tol. Debit Acc.";
                                    "Purch. Pmt. Tol. Credit Acc." := GenPostingSetup."Purch. Pmt. Tol. Credit Acc.";
                                    "Purch. Prepayments Account" := GenPostingSetup."Purch. Prepayments Account";
                                  END;

                                  IF Invt THEN BEGIN
                                    "COGS Account" := GenPostingSetup."COGS Account";
                                    "COGS Account (Interim)" := GenPostingSetup."COGS Account (Interim)";
                                    "Inventory Adjmt. Account" := GenPostingSetup."Inventory Adjmt. Account";
                                    "Invt. Accrual Acc. (Interim)" := GenPostingSetup."Invt. Accrual Acc. (Interim)";
                                  END;

                                  IF Manufacturing THEN BEGIN
                                    "Direct Cost Applied Account" := GenPostingSetup."Direct Cost Applied Account";
                                    "Overhead Applied Account" := GenPostingSetup."Overhead Applied Account";
                                    "Purchase Variance Account" := GenPostingSetup."Purchase Variance Account";
                                  END;

                                  IF CONFIRM(Text000,FALSE) THEN
                                    MODIFY;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF Selection = Selection::"All fields" THEN BEGIN
                     Sales := TRUE;
                     Purch := TRUE;
                     Invt := TRUE;
                     Manufacturing := TRUE;
                   END;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 2   ;2   ;Field     ;
                  Name=GenBusPostingGroup;
                  CaptionML=ENU=Gen. Bus. Posting Group;
                  SourceExpr=GenPostingSetup."Gen. Bus. Posting Group";
                  TableRelation="Gen. Business Posting Group" }

      { 4   ;2   ;Field     ;
                  Name=GenProdPostingGroup;
                  CaptionML=ENU=Gen. Prod. Posting Group;
                  SourceExpr=GenPostingSetup."Gen. Prod. Posting Group";
                  TableRelation="Gen. Product Posting Group" }

      { 7   ;2   ;Field     ;
                  Name=Copy;
                  CaptionML=ENU=Copy;
                  OptionCaptionML=ENU=All fields,Selected fields;
                  SourceExpr=Selection;
                  OnValidate=BEGIN
                               IF Selection = Selection::"All fields" THEN
                                 AllfieldsSelectionOnValidate;
                             END;
                              }

      { 1   ;2   ;Field     ;
                  Name=SalesAccounts;
                  CaptionML=ENU=Sales Accounts;
                  SourceExpr=Sales;
                  OnValidate=BEGIN
                               Selection := Selection::"Selected fields";
                             END;
                              }

      { 17  ;2   ;Field     ;
                  Name=PurchaseAccounts;
                  CaptionML=ENU=Purchase Accounts;
                  SourceExpr=Purch;
                  OnValidate=BEGIN
                               Selection := Selection::"Selected fields";
                             END;
                              }

      { 19  ;2   ;Field     ;
                  Name=InventoryAccounts;
                  CaptionML=ENU=Inventory Accounts;
                  SourceExpr=Invt;
                  OnValidate=BEGIN
                               Selection := Selection::"Selected fields";
                             END;
                              }

      { 8   ;2   ;Field     ;
                  Name=ManufacturingAccounts;
                  CaptionML=ENU=Manufacturing Accounts;
                  SourceExpr=Manufacturing;
                  OnValidate=BEGIN
                               Selection := Selection::"Selected fields";
                             END;
                              }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Copy General Posting Setup?';
      UseGenPostingSetup@1001 : Record 252;
      GenPostingSetup@1002 : Record 252;
      Sales@1003 : Boolean;
      Purch@1004 : Boolean;
      Invt@1005 : Boolean;
      Manufacturing@1007 : Boolean;
      Selection@1008 : 'All fields,Selected fields';

    PROCEDURE SetGenPostingSetup@1(GenPostingSetup2@1000 : Record 252);
    BEGIN
      UseGenPostingSetup := GenPostingSetup2;
    END;

    LOCAL PROCEDURE AllfieldsSelectionOnPush@19052427();
    BEGIN
      Sales := TRUE;
      Purch := TRUE;
      Invt := TRUE;
      Manufacturing := TRUE;
    END;

    LOCAL PROCEDURE AllfieldsSelectionOnValidate@19034152();
    BEGIN
      AllfieldsSelectionOnPush;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 88 VAT- VIES Declaration Disk
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00,NAVDK9,4PSSE.DK;
  }
  PROPERTIES
  {
    Permissions=TableData 254=imd;
    CaptionML=ENU=VAT- VIES Declaration Disk;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  FileName := FileManagement.ServerTempFileName('txt');

                  Filler := ',';//NAVDK
                  //4PSSE
                  GLSetup.GET;
                  DKinfoEnable := GLSetup."Danish localization active";
                END;

    OnPostReport=BEGIN
                   IF NOT HideFileDialog THEN BEGIN
                     FileManagement.DownloadHandler(FileName ,'','',FileManagement.GetToFilterText('',FileName),Text007);
                     FileManagement.DeleteServerFile(FileName);
                   END
                 END;

  }
  DATASET
  {
    { 7612;    ;DataItem;                    ;
               DataItemTable=Table254;
               DataItemTableView=SORTING(Type,Country/Region Code,VAT Registration No.,VAT Bus. Posting Group,VAT Prod. Posting Group,Posting Date)
                                 WHERE(Type=CONST(Sale));
               OnPreDataItem=BEGIN
                               CLEAR(VATFile);
                               VATFile.TEXTMODE := TRUE;
                               VATFile.WRITEMODE := TRUE;
                               VATFile.CREATE(FileName);

                               CompanyInfo.GET;

                               IF NOT DKinfoEnable THEN BEGIN
                                 VATRegNo := CONVERTSTR(CompanyInfo."VAT Registration No.",Text001,'    ');
                                 VATFile.WRITE(FORMAT('00' + FORMAT(VATRegNo,8) + Text002,80));
                                 VATFile.WRITE(FORMAT('0100001',80));
                               END ELSE BEGIN
                                 VATRegNo := DeleteCountryPrefix(CompanyInfo."VAT Registration No.",CompanyInfo."Country/Region Code");
                                 VATRegNo := CONVERTSTR(VATRegNo,Text001,'    ');
                                 WriteToFile(AddFiller('0') + AddFiller(FORMAT(VATRegNo,8)) + AddFiller(Text002) +
                                   AddFiller('') + AddFiller('') + AddFiller('') + AddFiller('') + AddFiller(''));
                               END;

                               NoOfGrTotal := 0;
                               Period := GETRANGEMAX("Posting Date");
                               InternalReferenceNo := FORMAT(Period,4,2) + '000000';
                               //NAVDK
                               CurrReport.CREATETOTALS(TotalValueofItemSupplies,TotalValueofServiceSupplies,EU3PartyItemTradeAmt);
                               TotalValueofItemSuppliesTot := 0;
                               EU3PartyItemTradeAmtTot := 0;
                               TotalValueofServiceSuppliesTot := 0;
                             END;

               OnAfterGetRecord=VAR
                                  VATEntry@1001 : Record 254;
                                  TotalValueOfItemSupplies@1003 : Decimal;
                                  TotalValueOfServiceSupplies@1002 : Decimal;
                                  GroupTotal@1000 : Boolean;
                                BEGIN
                                  IF "EU Service" THEN BEGIN
                                    IF UseAmtsInAddCurr THEN
                                      TotalValueOfServiceSupplies := "Additional-Currency Base"
                                    ELSE
                                      TotalValueOfServiceSupplies := Base
                                  END ELSE
                                    IF UseAmtsInAddCurr THEN
                                      TotalValueOfItemSupplies := "Additional-Currency Base"
                                    ELSE
                                      TotalValueOfItemSupplies := Base;

                                  IF "EU 3-Party Trade" THEN BEGIN
                                    EU3PartyItemTradeAmt := EU3PartyItemTradeAmt + TotalValueOfItemSupplies;
                                    EU3PartyServiceTradeAmt := EU3PartyServiceTradeAmt + TotalValueOfServiceSupplies;
                                  END;
                                  TotalValueofItemSuppliesTotal += TotalValueOfItemSupplies;
                                  TotalValueofServiceSuppliesTot += TotalValueOfServiceSupplies;
                                  //>>NAVDK
                                  SalesToItemGrTotal += TotalValueOfItemSupplies;
                                  SalesTo3PartyGrTotal += EU3PartyItemTradeAmt;
                                  SalesToServicesGrTotal += TotalValueOfServiceSupplies;
                                  //<<NAVDK

                                  VATEntry.COPY("VAT Entry");
                                  IF VATEntry.NEXT = 1 THEN BEGIN
                                    IF (VATEntry."Country/Region Code" <> "Country/Region Code") OR
                                       (VATEntry."VAT Registration No." <> "VAT Registration No.")
                                    THEN
                                      GroupTotal := TRUE;
                                  END ELSE
                                    GroupTotal := TRUE;

                                  IF GroupTotal THEN BEGIN
                                    //>>NAVDK
                                    IF DKinfoEnable THEN BEGIN
                                      WriteGrTotalsToFileDK(SalesToItemGrTotal,SalesTo3PartyGrTotal,SalesToServicesGrTotal);
                                    END ELSE
                                    //<<NAVDK
                                      WriteGrTotalsToFile(TotalValueofServiceSuppliesTot,TotalValueofItemSuppliesTotal,
                                        EU3PartyServiceTradeAmt,EU3PartyItemTradeAmt);
                                    EU3PartyItemTradeTotalAmt += EU3PartyItemTradeAmt;
                                    EU3PartyServiceTradeTotalAmt += EU3PartyServiceTradeAmt;

                                    TotalValueofItemSuppliesTotal := 0;
                                    TotalValueofServiceSuppliesTot := 0;

                                    EU3PartyItemTradeAmt := 0;
                                    EU3PartyServiceTradeAmt := 0;
                                    //>>NAVDK
                                    EU3PartyTradeTotalAmt += SalesTo3PartyGrTotal;
                                    ServicesTotalAmt += SalesToServicesGrTotal;
                                    SalesToItemGrTotal := 0;
                                    SalesToServicesGrTotal := 0;
                                    SalesTo3PartyGrTotal := 0;
                                    //<<NAVDK

                                  END;
                                END;

               OnPostDataItem=BEGIN
                                //>>NAVDK
                                IF DKinfoEnable THEN BEGIN
                                        WriteToFile(
                                          AddFiller('10') +
                                          AddFiller(DecimalNumeralFormat(NoOfGrTotal,9)) +
                                          AddFiller(DecimalNumeralSign(-(TotalValueofItemSuppliesTot + TotalValueofServiceSuppliesTot + EU3PartyItemTradeAmtTot)) +
                                            DecimalNumeralFormat(TotalValueofItemSuppliesTot + TotalValueofServiceSuppliesTot + EU3PartyItemTradeAmtTot,15)) +
                                          AddFiller('') + AddFiller('') + AddFiller('') + AddFiller('') + AddFiller(''));
                                        VATFile.CLOSE;
                                        VATFile.OPEN(FileName);
                                        VATFile.SEEK(VATFile.LEN - 2);
                                        VATFile.TRUNC;
                                END ELSE
                                //<<NAVDK
                                VATFile.WRITE(
                                  FORMAT(
                                    '10' + DecimalNumeralZeroFormat(NoOfGrTotal,9) +
                                    DecimalNumeralZeroFormat(EU3PartyItemTradeTotalAmt,15) +
                                    DecimalNumeralSign(-EU3PartyItemTradeTotalAmt) +
                                    DecimalNumeralZeroFormat(EU3PartyServiceTradeTotalAmt,15) +
                                    DecimalNumeralSign(-EU3PartyServiceTradeTotalAmt),
                                    80));
                                VATFile.CLOSE;
                                //NAVDK
                                IF NOT IsRecordset THEN
                                  MESSAGE(Text009);
                              END;

               ReqFilterFields=VAT Bus. Posting Group,VAT Prod. Posting Group,Posting Date }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Show Amounts in Add. Reporting Currency;
                  SourceExpr=UseAmtsInAddCurr;
                  MultiLine=Yes }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text001@1001 : TextConst 'ENU=WwWw';
      Text002@1002 : TextConst '@@@="{Locked} ";ENU=LISTE';
      Text003@1003 : TextConst 'ENU="%1 was not filled in for all VAT entries in which %2 = %3."';
      Text004@1004 : TextConst 'ENU=It is not possible to display %1 in a field with a length of %2.';
      CompanyInfo@1005 : Record 79;
      Country@1006 : Record 9;
      Cust@1007 : Record 18;
      FileManagement@1000 : Codeunit 419;
      VATFile@1008 : File;
      TotalValueofServiceSuppliesTot@1021 : Decimal;
      TotalValueofItemSuppliesTotal@1013 : Decimal;
      EU3PartyServiceTradeAmt@1022 : Decimal;
      EU3PartyItemTradeAmt@1014 : Decimal;
      EU3PartyItemTradeTotalAmt@1016 : Decimal;
      EU3PartyTradeTotalAmt@1116 : Decimal;
      EU3PartyServiceTradeTotalAmt@1023 : Decimal;
      NoOfGrTotal@1020 : Integer;
      FileName@1009 : Text;
      VATRegNo@1010 : Code[20];
      InternalReferenceNo@1011 : Text[10];
      Period@1012 : Date;
      UseAmtsInAddCurr@1015 : Boolean;
      Text007@1018 : TextConst 'ENU=Default.txt';
      TotalValueofItemSupplies@1060007 : Decimal;
      TotalValueofServiceSupplies@1060009 : Decimal;
      IsRecordset@1060005 : Boolean;
      TotalValueofItemSuppliesTot@1060000 : Decimal;
      EU3PartyItemTradeAmtTot@1060002 : Decimal;
      SalesToItemGrTotal@1060004 : Decimal;
      SalesTo3PartyGrTotal@1060006 : Decimal;
      SalesToServicesGrTotal@1060011 : Decimal;
      ServicesTotalAmt@1060012 : Decimal;
      Text009@1060013 : TextConst 'ENU=The file is saved without transactions, because there is nothing to report.';
      Filler@1060014 : Text[1];
      HideFileDialog@1024 : Boolean;
      GLSetup@111285700 : Record 98;
      DKinfoEnable@11128570 : Boolean INDATASET;

    LOCAL PROCEDURE DecimalNumeralSign@1(DecimalNumeral@1000 : Decimal) : Text[1];
    BEGIN
      IF DecimalNumeral >= 0 THEN
        EXIT('+');
      EXIT('-');
    END;

    LOCAL PROCEDURE DecimalNumeralZeroFormat@2(DecimalNumeral@1000 : Decimal;Length@1001 : Integer) : Text[250];
    BEGIN
      EXIT(TextZeroFormat(DELCHR(FORMAT(ROUND(ABS(DecimalNumeral),1,'<'),0,1)),Length));
    END;

    LOCAL PROCEDURE TextZeroFormat@3(Text@1000 : Text[250];Length@1001 : Integer) : Text[250];
    BEGIN
      IF STRLEN(Text) > Length THEN
        ERROR(
          Text004,
          Text,Length);
      EXIT(PADSTR('',Length - STRLEN(Text),'0') + Text);
    END;

    LOCAL PROCEDURE DecimalNumeralFormat@1060011(DecimalNumeral@1060013 : Decimal;Length@1060012 : Integer) : Text[16];
    BEGIN
      //NAVDK
      EXIT(CheckLength(DELCHR(FORMAT(ROUND(ABS(DecimalNumeral),1,'<'),0,1)),Length));
    END;

    LOCAL PROCEDURE CheckLength@1060012(Text@1060014 : Text[16];Length@1060013 : Integer) : Text[16];
    BEGIN
      //NAVDK
      IF STRLEN(Text) > Length THEN
        ERROR(Text004,Text,Length);
      EXIT(Text);
    END;

    LOCAL PROCEDURE WriteGrTotalsToFile@4(TotalValueofServiceSupplies@1003 : Decimal;TotalValueofItemSupplies@1002 : Decimal;EU3PartyServiceTradeAmt@1001 : Decimal;EU3PartyItemTradeAmt@1000 : Decimal);
    BEGIN
      IF (ROUND(ABS(TotalValueofItemSupplies),1,'<') <> 0) OR (ROUND(ABS(TotalValueofServiceSupplies),1,'<') <> 0) OR
         (ROUND(ABS(EU3PartyItemTradeAmt),1,'<') <> 0) OR (ROUND(ABS(EU3PartyServiceTradeAmt),1,'<') <> 0)
      THEN
        WITH "VAT Entry" DO BEGIN
          IF "VAT Registration No." = '' THEN BEGIN
            Type := Type::Sale;
            ERROR(
              Text003,
              FIELDCAPTION("VAT Registration No."),FIELDCAPTION(Type),Type);
          END;

          Cust.GET("Bill-to/Pay-to No.");
          Cust.TESTFIELD("Country/Region Code");
          Country.GET(Cust."Country/Region Code");
          Cust.TESTFIELD("VAT Registration No.");
          Country.GET("Country/Region Code");
          Country.TESTFIELD("EU Country/Region Code");
          NoOfGrTotal := NoOfGrTotal + 1;

          InternalReferenceNo := INCSTR(InternalReferenceNo);
          SETRANGE("Country/Region Code","Country/Region Code");
          SETRANGE("Bill-to/Pay-to No.","Bill-to/Pay-to No.");
          MODIFYALL("Internal Ref. No.",InternalReferenceNo);
          SETRANGE("Country/Region Code");
          SETRANGE("Bill-to/Pay-to No.");

          VATFile.WRITE(
            FORMAT(
              '02' + FORMAT(InternalReferenceNo,10) +
              DecimalNumeralZeroFormat(DATE2DMY(Period,3) MOD 100,2) +
              DecimalNumeralZeroFormat(DATE2DMY(Period,2),2) +
              DecimalNumeralZeroFormat(DATE2DMY(Period,1),2) +
              FORMAT(VATRegNo,8) + FORMAT(Country."EU Country/Region Code",2) + FORMAT("VAT Registration No.",12) +
              DecimalNumeralZeroFormat(TotalValueofItemSupplies,15) + DecimalNumeralSign(-TotalValueofItemSupplies) + '0' +
              DecimalNumeralZeroFormat(TotalValueofServiceSupplies,15) + DecimalNumeralSign(-TotalValueofServiceSupplies) + '0' +
              DecimalNumeralZeroFormat(EU3PartyItemTradeAmt,15) + DecimalNumeralSign(-EU3PartyItemTradeAmt) + '0' +
              DecimalNumeralZeroFormat(EU3PartyServiceTradeAmt,15) + DecimalNumeralSign(-EU3PartyServiceTradeAmt),
              120));
        END;
    END;

    LOCAL PROCEDURE WriteGrTotalsToFileDK@14(SalesToCust@1002 : Decimal;EU3PartyTradeAmt@1001 : Decimal;ServicesTotalAmt@1060000 : Decimal);
    BEGIN
      //NAVDK
      IF (ROUND(ABS(SalesToCust),1,'<') <> 0) OR (ROUND(ABS(EU3PartyTradeAmt),1,'<') <> 0) OR
         (ROUND(ABS(ServicesTotalAmt),1,'<') <> 0)
      THEN
        WITH "VAT Entry" DO BEGIN
          IF "VAT Registration No." = '' THEN BEGIN
            Type := Type::Sale;
            ERROR(
              Text003,
              FIELDCAPTION("VAT Registration No."),FIELDCAPTION(Type),Type);
          END;

          Cust.GET("Bill-to/Pay-to No.");
          Cust.TESTFIELD("Country/Region Code");
          Country.GET(Cust."Country/Region Code");
          Cust.TESTFIELD("VAT Registration No.");
          Country.GET("Country/Region Code");
          Country.TESTFIELD("EU Country/Region Code");
          NoOfGrTotal := NoOfGrTotal + 1;

          InternalReferenceNo := INCSTR(InternalReferenceNo);
          SETRANGE("Country/Region Code","Country/Region Code");
          SETRANGE("Bill-to/Pay-to No.","Bill-to/Pay-to No.");
          MODIFYALL("Internal Ref. No.",InternalReferenceNo);
          SETRANGE("Country/Region Code");
          SETRANGE("Bill-to/Pay-to No.");

          WriteToFile(
            AddFiller('2') +
            AddFiller(CheckLength(FORMAT(InternalReferenceNo),10)) +
            AddFiller(FORMAT(DATE2DMY(Period,3)) + '-' +
              FillZero(FORMAT(DATE2DMY(Period,2)),2) + '-' +
              FillZero(FORMAT(DATE2DMY(Period,1)),2)) +
            AddFiller(FORMAT(VATRegNo,8)) +
            AddFiller(FORMAT(Country."EU Country/Region Code",2)) +
            AddFiller(CheckLength(FORMAT("VAT Registration No."),12)) +
            AddFiller(DecimalNumeralSign(-SalesToCust) + DecimalNumeralFormat(SalesToCust,15)) +
            AddFiller(DecimalNumeralSign(-EU3PartyItemTradeAmt) + DecimalNumeralFormat(EU3PartyTradeAmt,15)) +
            DecimalNumeralSign(-ServicesTotalAmt) + DecimalNumeralFormat(ServicesTotalAmt,15));
          IsRecordset := TRUE;
          TotalValueofItemSuppliesTot := TotalValueofItemSuppliesTot + ROUND(SalesToCust,1,'<');
          TotalValueofServiceSuppliesTot := TotalValueofServiceSuppliesTot + ROUND(EU3PartyTradeAmt,1,'<');
          EU3PartyItemTradeAmtTot := EU3PartyItemTradeAmtTot + ROUND(ServicesTotalAmt,1,'<');
        END;
    END;

    PROCEDURE WriteToFile@1060000(Text@1060000 : Text[89]);
    BEGIN
      //NAVDK
      VATFile.WRITE(Text);
    END;

    PROCEDURE DeleteCountryPrefix@1060001(VatRegNoParam@1060000 : Text[20];CountryCode@1060001 : Code[10]) VatRegNo : Text[20];
    BEGIN
      //NAVDK
      Country.GET(CountryCode);
      VatRegNo := VatRegNoParam;
      IF STRPOS(VatRegNo,Country."EU Country/Region Code") = 1 THEN
        VatRegNo := DELSTR(VatRegNo,1,STRLEN(Country."EU Country/Region Code"));
    END;

    PROCEDURE AddFiller@1060007(InputText@1060000 : Text[50]) : Text[50];
    BEGIN
      //NAVDK
      IF InputText <> '' THEN
        EXIT(InputText + Filler);
      EXIT(Filler);
    END;

    PROCEDURE FillZero@1060010(InputText@1060001 : Text[4];Length@1060000 : Integer) : Text[4];
    BEGIN
      //NAVDK
      EXIT(PADSTR('',Length - STRLEN(InputText),'0') + InputText);
    END;

    PROCEDURE GetFileName@6() : Text[1024];
    BEGIN
      EXIT(FileName);
    END;

    PROCEDURE InitializeRequest@5(NewHideFileDialog@1000 : Boolean);
    BEGIN
      HideFileDialog := NewHideFileDialog;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 840 Suggest Worksheet Lines
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00,4PS9.00;
  }
  PROPERTIES
  {
    Permissions=TableData 355=rimd,
                TableData 847=rimd;
    CaptionML=ENU=Suggest Worksheet Lines;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  IF CashFlowNo = '' THEN
                    ERROR(Text000);

                  IF NOT SelectionCashFlowForecast.GET(CashFlowNo) THEN
                    ERROR(Text001);

                  IF NoOptionsChosen THEN
                    ERROR(Text002,CashFlowNo);

                  CFSetup.GET;
                  GLSetup.GET;

                  Window.OPEN(
                    Text003 +
                    Text033 +
                    Text034);

                  Window.UPDATE(1,"Cash Flow Forecast"."No.");
                END;

  }
  DATASET
  {
    { 8965;    ;DataItem;                    ;
               DataItemTable=Table840;
               DataItemTableView=SORTING(No.)
                                 ORDER(Ascending);
               OnPreDataItem=BEGIN
                               SETRANGE("No.",CashFlowNo);
                               LineNo := 0;
                               NeedsManualPmtUpdate := FALSE;
                             END;

               OnAfterGetRecord=BEGIN
                                  Window.UPDATE(1,"No.");
                                END;

               OnPostDataItem=VAR
                                TempCashFlowForecast@1001 : TEMPORARY Record 840;
                              BEGIN
                                InsertWorksheetLines(TempCashFlowForecast);
                                DeleteEntries(TempCashFlowForecast);
                                IF NeedsManualPmtUpdate THEN
                                  MESSAGE(ManualPmtRevExpNeedsUpdateMsg,TempCashFlowForecast."No.");
                              END;
                               }

    { 6780;1   ;DataItem;                    ;
               DataItemTable=Table841;
               DataItemTableView=SORTING(No.)
                                 ORDER(Ascending)
                                 WHERE(G/L Integration=FILTER(Balance|Both),
                                       G/L Account Filter=FILTER(<>''));
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::"Liquid Funds"] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=VAR
                                  GLAcc@1000 : Record 15;
                                BEGIN
                                  GLAcc.SETFILTER("No.","G/L Account Filter");
                                  IF GLAcc.FINDSET THEN
                                    REPEAT
                                      GLAcc.CALCFIELDS(Balance);

                                      Window.UPDATE(2,Text004);
                                      Window.UPDATE(3,GLAcc."No.");
                                      InsertCFLineForGLAccount(GLAcc);
                                    UNTIL GLAcc.NEXT = 0;
                                END;
                                 }

    { 8503;1   ;DataItem;                    ;
               DataItemTable=Table21;
               DataItemTableView=SORTING(Open,Due Date)
                                 ORDER(Ascending)
                                 WHERE(Open=CONST(Yes),
                                       Remaining Amount=FILTER(<>0));
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::Receivables] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  Window.UPDATE(2,Text005);
                                  Window.UPDATE(3,"Entry No.");

                                  IF "Customer No." <> '' THEN
                                    Customer.GET("Customer No.")
                                  ELSE
                                    Customer.INIT;

                                  CALCFIELDS("Remaining Amt. (LCY)","Remaining Amount");

                                  InsertCFLineForCustLedgerEntry;
                                END;
                                 }

    { 4114;1   ;DataItem;                    ;
               DataItemTable=Table25;
               DataItemTableView=SORTING(Open,Due Date)
                                 ORDER(Ascending)
                                 WHERE(Open=CONST(Yes),
                                       Remaining Amount=FILTER(<>0));
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::Payables] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  Window.UPDATE(2,Text006);
                                  Window.UPDATE(3,"Entry No.");

                                  IF "Vendor No." <> '' THEN
                                    Vendor.GET("Vendor No.")
                                  ELSE
                                    Vendor.INIT;

                                  CALCFIELDS("Remaining Amt. (LCY)","Remaining Amount");

                                  InsertCFLineForVendorLedgEntry;
                                END;
                                 }

    { 6547;1   ;DataItem;                    ;
               DataItemTable=Table39;
               DataItemTableView=SORTING(Document Type,Document No.,Line No.)
                                 ORDER(Ascending)
                                 WHERE(Document Type=CONST(Order));
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::"Purchase Order"] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  Window.UPDATE(2,Text007);
                                  Window.UPDATE(3,"Document No.");

                                  PurchHeader.GET("Document Type","Document No.");
                                  IF PurchHeader."Buy-from Vendor No." <> '' THEN
                                    Vendor.GET(PurchHeader."Pay-to Vendor No.")
                                  ELSE
                                    Vendor.INIT;

                                  InsertCFLineForPurchaseLine;
                                END;
                                 }

    { 2844;1   ;DataItem;                    ;
               DataItemTable=Table37;
               DataItemTableView=SORTING(Document Type,Document No.,Line No.)
                                 ORDER(Ascending)
                                 WHERE(Document Type=CONST(Order));
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::"Sales Order"] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  Window.UPDATE(2,Text008);
                                  Window.UPDATE(3,"Document No.");

                                  SalesHeader.GET("Document Type","Document No.");
                                  IF SalesHeader."Sell-to Customer No." <> '' THEN
                                    Customer.GET(SalesHeader."Bill-to Customer No.")
                                  ELSE
                                    Customer.INIT;

                                  InsertCFLineForSalesLine;
                                END;
                                 }

    { 8549;1   ;DataItem;InvestmentFixedAsset;
               DataItemTable=Table5600;
               DataItemTableView=SORTING(No.)
                                 WHERE(Budgeted Asset=CONST(Yes));
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::"Budgeted Fixed Asset"] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;

                               FASetup.GET;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF FADeprBook.GET("No.",FASetup."Default Depr. Book") THEN BEGIN
                                    FADeprBook.CALCFIELDS("Acquisition Cost");

                                    Window.UPDATE(2,Text009);
                                    Window.UPDATE(3,"No.");

                                    InsertCFLineForInvestmentFixAs;
                                  END;
                                END;
                                 }

    { 1713;1   ;DataItem;SaleFixedAsset      ;
               DataItemTable=Table5600;
               DataItemTableView=SORTING(No.)
                                 WHERE(Budgeted Asset=CONST(No));
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::"Sale of Fixed Asset"] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;

                               FASetup.GET;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF FADeprBook.GET("No.",FASetup."Default Depr. Book") THEN
                                    IF (FADeprBook."Disposal Date" = 0D) AND
                                       (FADeprBook."Projected Disposal Date" <> 0D) AND
                                       (FADeprBook."Projected Proceeds on Disposal" <> 0)
                                    THEN BEGIN
                                      Window.UPDATE(2,Text010);
                                      Window.UPDATE(3,"No.");

                                      InsertCFLineForSaleFixedAsset;
                                    END;
                                END;
                                 }

    { 5017;1   ;DataItem;                    ;
               DataItemTable=Table850;
               DataItemTableView=SORTING(Code)
                                 ORDER(Ascending);
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::"Cash Flow Manual Expense"] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  Window.UPDATE(2,Text011);
                                  Window.UPDATE(3,Code);

                                  InsertCFLineForManualExpens;
                                END;
                                 }

    { 4269;1   ;DataItem;                    ;
               DataItemTable=Table849;
               DataItemTableView=SORTING(Code)
                                 ORDER(Ascending);
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::"Cash Flow Manual Revenue"] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  Window.UPDATE(2,Text012);
                                  Window.UPDATE(3,Code);

                                  InsertCFLineForManualRevenue;
                                END;
                                 }

    { 5339;1   ;DataItem;CFAccountForBudget  ;
               DataItemTable=Table841;
               DataItemTableView=SORTING(No.)
                                 ORDER(Ascending)
                                 WHERE(G/L Integration=FILTER(Budget|Both),
                                       G/L Account Filter=FILTER(<>''));
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::"G/L Budget"] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=VAR
                                  GLAcc@1000 : Record 15;
                                BEGIN
                                  GLAcc.SETFILTER("No.","G/L Account Filter");
                                  IF GLAcc.FINDSET THEN
                                    REPEAT
                                      Window.UPDATE(2,Text031);
                                      Window.UPDATE(3,GLAcc."No.");

                                      GLBudgEntry.SETRANGE("Budget Name",GLBudgName);
                                      GLBudgEntry.SETRANGE("G/L Account No.",GLAcc."No.");
                                      GLBudgEntry.SETRANGE(Date,"Cash Flow Forecast"."G/L Budget From","Cash Flow Forecast"."G/L Budget To");
                                      IF GLBudgEntry.FINDSET THEN
                                        REPEAT
                                          InsertCFLineForGLBudget(GLAcc);
                                        UNTIL GLBudgEntry.NEXT = 0;
                                    UNTIL GLAcc.NEXT = 0;
                                END;
                                 }

    { 6560;1   ;DataItem;                    ;
               DataItemTable=Table5902;
               DataItemTableView=SORTING(Document Type,Document No.,Line No.)
                                 WHERE(Document Type=CONST(Order));
               OnPreDataItem=BEGIN
                               IF NOT ConsiderSource[SourceType::"Service Orders"] THEN
                                 CurrReport.BREAK;

                               IF NOT READPERMISSION THEN
                                 CurrReport.BREAK;
                             END;

               OnAfterGetRecord=BEGIN
                                  Window.UPDATE(2,Text032);
                                  Window.UPDATE(3,"Document No.");

                                  ServiceHeader.GET("Document Type","Document No.");
                                  IF ServiceHeader."Bill-to Customer No." <> '' THEN
                                    Customer.GET(ServiceHeader."Bill-to Customer No.")
                                  ELSE
                                    Customer.INIT;

                                  InsertCFLineForServiceLine;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnInit=VAR
               CFManualExpense@1000 : Record 850;
               CFManualRevenue@1003 : Record 849;
               GLBudgetEntry@1001 : Record 96;
               GLAcc@1002 : Record 15;
             BEGIN
               IF ConsiderSource[SourceType::"Liquid Funds"] THEN
                 ConsiderSource[SourceType::"Liquid Funds"] := GLAcc.READPERMISSION;
               IF ConsiderSource[SourceType::Receivables] THEN
                 ConsiderSource[SourceType::Receivables] := "Cust. Ledger Entry".READPERMISSION;
               IF ConsiderSource[SourceType::Payables] THEN
                 ConsiderSource[SourceType::Payables] := "Vendor Ledger Entry".READPERMISSION;
               IF ConsiderSource[SourceType::"Purchase Order"] THEN
                 ConsiderSource[SourceType::"Purchase Order"] := "Purchase Line".READPERMISSION;
               IF ConsiderSource[SourceType::"Sales Order"] THEN
                 ConsiderSource[SourceType::"Sales Order"] := "Sales Line".READPERMISSION;
               IF ConsiderSource[SourceType::"Cash Flow Manual Expense"] THEN
                 ConsiderSource[SourceType::"Cash Flow Manual Expense"] := CFManualExpense.READPERMISSION;
               IF ConsiderSource[SourceType::"Cash Flow Manual Revenue"] THEN
                 ConsiderSource[SourceType::"Cash Flow Manual Revenue"] := CFManualRevenue.READPERMISSION;
               IF ConsiderSource[SourceType::"Budgeted Fixed Asset"] THEN
                 ConsiderSource[SourceType::"Budgeted Fixed Asset"] := InvestmentFixedAsset.READPERMISSION;
               IF ConsiderSource[SourceType::"Sale of Fixed Asset"] THEN
                 ConsiderSource[SourceType::"Sale of Fixed Asset"] := SaleFixedAsset.READPERMISSION;
               IF ConsiderSource[SourceType::"G/L Budget"] THEN
                 ConsiderSource[SourceType::"G/L Budget"] := GLBudgetEntry.READPERMISSION;
               IF ConsiderSource[SourceType::"Service Orders"] THEN
                 ConsiderSource[SourceType::"Service Orders"] := "Service Line".READPERMISSION;
             END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Cash Flow Forecast;
                  SourceExpr=CashFlowNo;
                  TableRelation="Cash Flow Forecast" }

      { 3   ;2   ;Group     ;
                  CaptionML=ENU=Source Types to Include:;
                  GroupType=Group }

      { 4   ;3   ;Field     ;
                  CaptionML=ENU=Liquid Funds;
                  SourceExpr=ConsiderSource[SourceType::"Liquid Funds"] }

      { 5   ;3   ;Field     ;
                  CaptionML=ENU=Receivables;
                  SourceExpr=ConsiderSource[SourceType::Receivables] }

      { 9   ;3   ;Field     ;
                  CaptionML=ENU=Sales Orders;
                  SourceExpr=ConsiderSource[SourceType::"Sales Order"] }

      { 2   ;3   ;Field     ;
                  CaptionML=ENU=Service Orders;
                  SourceExpr=ConsiderSource[SourceType::"Service Orders"] }

      { 13  ;3   ;Field     ;
                  CaptionML=ENU=Fixed Assets Disposal;
                  SourceExpr=ConsiderSource[SourceType::"Sale of Fixed Asset"] }

      { 8   ;3   ;Field     ;
                  CaptionML=ENU=Cash Flow Manual Revenues;
                  SourceExpr=ConsiderSource[SourceType::"Cash Flow Manual Revenue"] }

      { 6   ;3   ;Field     ;
                  CaptionML=ENU=Payables;
                  SourceExpr=ConsiderSource[SourceType::Payables] }

      { 7   ;3   ;Field     ;
                  CaptionML=ENU=Purchase Orders;
                  SourceExpr=ConsiderSource[SourceType::"Purchase Order"] }

      { 10  ;3   ;Field     ;
                  CaptionML=ENU=Fixed Assets Budget;
                  SourceExpr=ConsiderSource[SourceType::"Budgeted Fixed Asset"] }

      { 12  ;3   ;Field     ;
                  CaptionML=ENU=Cash Flow Manual Expenses;
                  SourceExpr=ConsiderSource[SourceType::"Cash Flow Manual Expense"] }

      { 16  ;3   ;Field     ;
                  CaptionML=ENU=G/L Budget;
                  SourceExpr=ConsiderSource[SourceType::"G/L Budget"] }

      { 17  ;3   ;Field     ;
                  CaptionML=ENU=G/L Budget Name;
                  SourceExpr=GLBudgName;
                  TableRelation="G/L Budget Name" }

      { 18  ;2   ;Field     ;
                  CaptionML=ENU=Group by Document Type;
                  SourceExpr=Summarized }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You must choose a cash flow forecast.';
      Text001@1001 : TextConst 'ENU=Choose a valid cash flow forecast.';
      Text002@1002 : TextConst 'ENU=Choose one option for filling the cash flow forecast no. %1.';
      Text003@1003 : TextConst 'ENU=Cash Flow Forecast No.      #1##########\\';
      Text004@1004 : TextConst 'ENU=Liquid Funds';
      Text005@1005 : TextConst 'ENU=Receivables';
      Text006@1006 : TextConst 'ENU=Payables';
      Text007@1007 : TextConst 'ENU=Purchase Orders';
      Text008@1008 : TextConst 'ENU=Sales Orders';
      Text009@1009 : TextConst 'ENU=Fixed Assets Budget';
      Text010@1010 : TextConst 'ENU=Fixed Assets Disposal';
      Text011@1011 : TextConst 'ENU=Cash Flow Manual Expenses';
      Text012@1012 : TextConst 'ENU=Cash Flow Manual Revenues';
      Text013@1013 : TextConst 'ENU="%1 Balance=%2"';
      Text025@1025 : TextConst 'ENU=%1 %2 %3';
      Text027@1027 : TextConst 'ENU="%1 AC= %2"';
      Text028@1028 : TextConst 'ENU=Cash Flow Manual Expenses %1';
      Text029@1029 : TextConst 'ENU=Cash Flow Manual Revenues %1';
      Text030@1030 : TextConst 'ENU="%1 Budget %2 "';
      Text031@1031 : TextConst 'ENU=G/L Budget';
      Text032@1032 : TextConst 'ENU=Service Orders';
      Text033@1033 : TextConst 'ENU=Search for          #2####################\';
      Text034@1034 : TextConst 'ENU=Record found        #3####################';
      CFSetup@1041 : Record 843;
      SelectionCashFlowForecast@1042 : Record 840;
      TempCFWorksheetLine@1016 : TEMPORARY Record 846;
      CFWorksheetLine2@1044 : Record 846;
      Customer@1045 : Record 18;
      Vendor@1046 : Record 23;
      PurchHeader@1048 : Record 38;
      SalesHeader@1049 : Record 36;
      ServiceHeader@1050 : Record 5900;
      FASetup@1052 : Record 5603;
      FADeprBook@1053 : Record 5612;
      GLBudgEntry@1061 : Record 96;
      GLSetup@1063 : Record 98;
      Currency@1100 : Record 4;
      CurrExchRate@1102 : Record 330;
      Window@1066 : Dialog;
      ConsiderSource@1014 : ARRAY [11] OF Boolean;
      SourceType@1015 : ',Receivables,Payables,Liquid Funds,Cash Flow Manual Expense,Cash Flow Manual Revenue,Sales Order,Purchase Order,Budgeted Fixed Asset,Sale of Fixed Asset,Service Orders,G/L Budget';
      CashFlowNo@1082 : Code[20];
      LineNo@1086 : Integer;
      DateLastExecution@1087 : Date;
      ExecutionDate@1088 : Date;
      GLBudgName@1089 : Code[10];
      TotalAmt@1056 : Decimal;
      MultiSalesLines@1037 : Boolean;
      Summarized@1036 : Boolean;
      NeedsManualPmtUpdate@1017 : Boolean;
      ManualPmtRevExpNeedsUpdateMsg@1018 : TextConst 'ENU=There are one or more Cash Flow Manual Revenues/Expenses with a Recurring Frequency.\But the Recurring Frequency cannot be applied because the Manual Payments To date in Cash Flow Forecast %1 is empty.\Fill in this date in order to get multiple lines.';

    LOCAL PROCEDURE InsertTempCFWorksheetLine@16(MaxPmtTolerance@1001 : Decimal);
    BEGIN
      WITH TempCFWorksheetLine DO BEGIN
        LineNo := LineNo + 100;
        TRANSFERFIELDS(CFWorksheetLine2);
        "Cash Flow Forecast No." := "Cash Flow Forecast"."No.";
        "Line No." := LineNo;

        CalculateCFAmountAndCFDate;

        IF ABS("Amount (LCY)") < ABS(MaxPmtTolerance) THEN
          "Amount (LCY)" := 0
        ELSE
          "Amount (LCY)" := "Amount (LCY)" - MaxPmtTolerance;

        IF "Amount (LCY)" <> 0 THEN
          INSERT;
      END;
    END;

    LOCAL PROCEDURE InsertWorksheetLines@21(VAR TempCashFlowForecast@1001 : TEMPORARY Record 840);
    VAR
      CFWorksheetLine@1000 : Record 846;
      LastCFForecastNo@1002 : Code[20];
    BEGIN
      CFWorksheetLine.LOCKTABLE;

      CFWorksheetLine.RESET;
      CFWorksheetLine.DELETEALL;

      TempCFWorksheetLine.RESET;
      TempCFWorksheetLine.SETCURRENTKEY("Cash Flow Forecast No.");
      IF TempCFWorksheetLine.FINDSET THEN
        REPEAT
          CFWorksheetLine := TempCFWorksheetLine;
          CFWorksheetLine.INSERT(TRUE);

          IF LastCFForecastNo <> CFWorksheetLine."Cash Flow Forecast No." THEN BEGIN
            TempCashFlowForecast."No." := CFWorksheetLine."Cash Flow Forecast No.";
            TempCashFlowForecast.INSERT;
            LastCFForecastNo := CFWorksheetLine."Cash Flow Forecast No.";
          END;
        UNTIL TempCFWorksheetLine.NEXT = 0;

      TempCFWorksheetLine.DELETEALL;
    END;

    LOCAL PROCEDURE DeleteEntries@22(VAR TempCashFlowForecast@1000 : TEMPORARY Record 840);
    VAR
      CFForecastEntry@1001 : Record 847;
    BEGIN
      TempCashFlowForecast.RESET;
      IF TempCashFlowForecast.FINDSET THEN BEGIN
        CFForecastEntry.LOCKTABLE;
        CFForecastEntry.RESET;
        REPEAT
          CFForecastEntry.SETRANGE("Cash Flow Forecast No.",TempCashFlowForecast."No.");
          CFForecastEntry.DELETEALL;
        UNTIL TempCashFlowForecast.NEXT = 0;
      END;
      TempCashFlowForecast.DELETEALL;
    END;

    LOCAL PROCEDURE InsertCFLineForGLAccount@1(GLAcc@1000 : Record 15);
    BEGIN
      WITH CFWorksheetLine2 DO BEGIN
        INIT;
        "Source Type" := "Source Type"::"Liquid Funds";
        "Source No." := GLAcc."No.";
        "Document No." := GLAcc."No.";
        "Cash Flow Account No." := "Cash Flow Account"."No.";
        Description :=
          COPYSTR(
            STRSUBSTNO(Text013,GLAcc.Name,FORMAT(GLAcc.Balance)),
            1,MAXSTRLEN(Description));
        "Cash Flow Date" := WORKDATE;
        "Amount (LCY)" := GLAcc.Balance;
        "Shortcut Dimension 2 Code" := GLAcc."Global Dimension 2 Code";
        "Shortcut Dimension 1 Code" := GLAcc."Global Dimension 1 Code";
        MoveDefualtDimToJnlLineDim(DATABASE::"G/L Account",GLAcc."No.","Dimension Set ID");
        InsertTempCFWorksheetLine(0);
      END;
    END;

    LOCAL PROCEDURE InsertCFLineForCustLedgerEntry@3();
    VAR
      MaxPmtTolerance@1000 : Decimal;
    BEGIN
      WITH CFWorksheetLine2 DO BEGIN
        INIT;
        "Source Type" := "Source Type"::Receivables;
        "Source No." := "Cust. Ledger Entry"."Document No.";
        "Document Type" := "Cust. Ledger Entry"."Document Type";
        "Document Date" := "Cust. Ledger Entry"."Document Date";
        "Shortcut Dimension 2 Code" := "Cust. Ledger Entry"."Global Dimension 2 Code";
        "Shortcut Dimension 1 Code" := "Cust. Ledger Entry"."Global Dimension 1 Code";
        "Dimension Set ID" := "Cust. Ledger Entry"."Dimension Set ID";
        "Cash Flow Account No." := CFSetup."Receivables CF Account No.";
        Description := COPYSTR(Customer.TABLECAPTION + ' ' + FORMAT("Document Type") + ' ' + '-' + ' ' +
            FORMAT("Cust. Ledger Entry"."Due Date") + ' ' + Customer.Name,1,MAXSTRLEN(Description));
        "Document No." := "Cust. Ledger Entry"."Document No.";
        "Cash Flow Date" := "Cust. Ledger Entry"."Due Date";
        "Amount (LCY)" := "Cust. Ledger Entry"."Remaining Amt. (LCY)";
        "Pmt. Discount Date" := "Cust. Ledger Entry"."Pmt. Discount Date";
        "Pmt. Disc. Tolerance Date" := "Cust. Ledger Entry"."Pmt. Disc. Tolerance Date";

        IF "Cust. Ledger Entry"."Currency Code" <> '' THEN
          Currency.GET("Cust. Ledger Entry"."Currency Code")
        ELSE
          Currency.InitRoundingPrecision;

        "Payment Discount" := ROUND("Cust. Ledger Entry"."Remaining Pmt. Disc. Possible" /
            "Cust. Ledger Entry"."Adjusted Currency Factor",Currency."Amount Rounding Precision");

        IF "Cash Flow Forecast"."Consider Pmt. Tol. Amount" THEN
          MaxPmtTolerance := ROUND("Cust. Ledger Entry"."Max. Payment Tolerance" /
              "Cust. Ledger Entry"."Adjusted Currency Factor",Currency."Amount Rounding Precision")
        ELSE
          MaxPmtTolerance := 0;

        IF "Cash Flow Forecast"."Consider CF Payment Terms" AND (Customer."Cash Flow Payment Terms Code" <> '') THEN
          "Payment Terms Code" := Customer."Cash Flow Payment Terms Code"
        ELSE
          "Payment Terms Code" := '';

        InsertTempCFWorksheetLine(MaxPmtTolerance);
      END;
    END;

    LOCAL PROCEDURE InsertCFLineForVendorLedgEntry@4();
    VAR
      MaxPmtTolerance@1000 : Decimal;
    BEGIN
      WITH CFWorksheetLine2 DO BEGIN
        INIT;
        "Source Type" := "Source Type"::Payables;
        "Source No." := "Vendor Ledger Entry"."Document No.";
        "Document Type" := "Vendor Ledger Entry"."Document Type";
        "Document Date" := "Vendor Ledger Entry"."Document Date";
        "Shortcut Dimension 2 Code" := "Vendor Ledger Entry"."Global Dimension 2 Code";
        "Shortcut Dimension 1 Code" := "Vendor Ledger Entry"."Global Dimension 1 Code";
        "Dimension Set ID" := "Vendor Ledger Entry"."Dimension Set ID";
        "Cash Flow Account No." := CFSetup."Payables CF Account No.";
        Description := COPYSTR(Vendor.TABLECAPTION + ' ' + FORMAT("Document Type") + ' ' + '-' + ' ' +
            FORMAT("Vendor Ledger Entry"."Due Date") + ' ' + Vendor.Name,1,MAXSTRLEN(Description));
        "Cash Flow Date" := "Vendor Ledger Entry"."Due Date";
        "Document No." := "Vendor Ledger Entry"."Document No.";
        "Amount (LCY)" := "Vendor Ledger Entry"."Remaining Amt. (LCY)";
        "Pmt. Discount Date" := "Vendor Ledger Entry"."Pmt. Discount Date";
        "Pmt. Disc. Tolerance Date" := "Vendor Ledger Entry"."Pmt. Disc. Tolerance Date";

        IF "Vendor Ledger Entry"."Currency Code" <> '' THEN
          Currency.GET("Vendor Ledger Entry"."Currency Code")
        ELSE
          Currency.InitRoundingPrecision;

        "Payment Discount" := ROUND("Vendor Ledger Entry"."Remaining Pmt. Disc. Possible" /
            "Vendor Ledger Entry"."Adjusted Currency Factor",Currency."Amount Rounding Precision");

        IF "Cash Flow Forecast"."Consider Pmt. Tol. Amount" THEN
          MaxPmtTolerance := ROUND("Vendor Ledger Entry"."Max. Payment Tolerance" /
              "Vendor Ledger Entry"."Adjusted Currency Factor",Currency."Amount Rounding Precision")
        ELSE
          MaxPmtTolerance := 0;

        IF "Cash Flow Forecast"."Consider CF Payment Terms" AND (Vendor."Cash Flow Payment Terms Code" <> '') THEN
          "Payment Terms Code" := Vendor."Cash Flow Payment Terms Code"
        ELSE
          "Payment Terms Code" := '';

        InsertTempCFWorksheetLine(MaxPmtTolerance);
      END;
    END;

    LOCAL PROCEDURE InsertCFLineForPurchaseLine@5();
    VAR
      PurchLine2@1000 : Record 39;
    BEGIN
      PurchLine2 := "Purchase Line";
      IF Summarized AND (PurchLine2.NEXT <> 0) AND (PurchLine2."Buy-from Vendor No." <> '') AND
         (PurchLine2."Document No." = "Purchase Line"."Document No.")
      THEN BEGIN
        TotalAmt += CalculateLineAmountForPurchaseLine(PurchHeader,"Purchase Line");
        MultiSalesLines := TRUE;
      END ELSE
        WITH CFWorksheetLine2 DO BEGIN
          INIT;
          "Source Type" := "Source Type"::"Purchase Orders";
          "Source No." := "Purchase Line"."Document No.";
          "Document Type" := "Document Type"::Invoice;
          "Document Date" := PurchHeader."Document Date";
          "Shortcut Dimension 1 Code" := PurchHeader."Shortcut Dimension 1 Code";
          "Shortcut Dimension 2 Code" := PurchHeader."Shortcut Dimension 2 Code";
          "Dimension Set ID" := PurchHeader."Dimension Set ID";
          "Cash Flow Account No." := CFSetup."Purch. Order CF Account No.";
          Description :=
            COPYSTR(
              STRSUBSTNO(
                Text025,PurchHeader.TABLECAPTION,PurchHeader."Buy-from Vendor Name",FORMAT(PurchHeader."Order Date")),
              1,MAXSTRLEN(Description));
          "Cash Flow Date" := PurchHeader."Due Date";
          "Document No." := "Purchase Line"."Document No.";

          "Amount (LCY)" := CalculateLineAmountForPurchaseLine(PurchHeader,"Purchase Line");

          IF Summarized AND MultiSalesLines THEN BEGIN
            "Amount (LCY)" := "Amount (LCY)" + TotalAmt;
            MultiSalesLines := FALSE;
            TotalAmt := 0;
          END;

          IF "Cash Flow Forecast"."Consider CF Payment Terms" AND (Vendor."Cash Flow Payment Terms Code" <> '') THEN
            "Payment Terms Code" := Vendor."Cash Flow Payment Terms Code"
          ELSE
            "Payment Terms Code" := PurchHeader."Payment Terms Code";

          InsertTempCFWorksheetLine(0);
        END;
    END;

    LOCAL PROCEDURE InsertCFLineForSalesLine@6();
    VAR
      SalesLine2@1000 : Record 37;
    BEGIN
      SalesLine2 := "Sales Line";
      IF Summarized AND (SalesLine2.NEXT <> 0) AND (SalesLine2."Sell-to Customer No." <> '') AND
         (SalesLine2."Document No." = "Sales Line"."Document No.")
      THEN BEGIN
        TotalAmt += CalculateLineAmountForSalesLine(SalesHeader,"Sales Line");
        MultiSalesLines := TRUE;
      END ELSE
        WITH CFWorksheetLine2 DO BEGIN
          INIT;
          "Document Type" := "Document Type"::Invoice;
          "Document Date" := SalesHeader."Document Date";
          "Source Type" := "Source Type"::"Sales Orders";
          "Source No." := "Sales Line"."Document No.";
          "Shortcut Dimension 1 Code" := SalesHeader."Shortcut Dimension 1 Code";
          "Shortcut Dimension 2 Code" := SalesHeader."Shortcut Dimension 2 Code";
          "Dimension Set ID" := SalesHeader."Dimension Set ID";
          "Cash Flow Account No." := CFSetup."Sales Order CF Account No.";
          Description :=
            COPYSTR(
              STRSUBSTNO(
                Text025,
                SalesHeader.TABLECAPTION,
                SalesHeader."Sell-to Customer Name",
                FORMAT(SalesHeader."Order Date")),
              1,MAXSTRLEN(Description));
          "Cash Flow Date" := SalesHeader."Due Date";
          "Document No." := "Sales Line"."Document No.";
          "Amount (LCY)" := CalculateLineAmountForSalesLine(SalesHeader,"Sales Line");

          IF Summarized AND MultiSalesLines THEN BEGIN
            "Amount (LCY)" := "Amount (LCY)" + TotalAmt;
            MultiSalesLines := FALSE;
            TotalAmt := 0;
          END;

          IF "Cash Flow Forecast"."Consider CF Payment Terms" AND (Customer."Cash Flow Payment Terms Code" <> '') THEN
            "Payment Terms Code" := Customer."Cash Flow Payment Terms Code"
          ELSE
            "Payment Terms Code" := SalesHeader."Payment Terms Code";

          InsertTempCFWorksheetLine(0);
        END;
    END;

    LOCAL PROCEDURE InsertCFLineForInvestmentFixAs@7();
    BEGIN
      WITH CFWorksheetLine2 DO BEGIN
        INIT;
        "Source Type" := "Source Type"::"Fixed Assets Budget";
        "Source No." := InvestmentFixedAsset."No.";
        "Document No." := InvestmentFixedAsset."No.";
        "Cash Flow Account No." := CFSetup."FA Budget CF Account No.";
        Description :=
          COPYSTR(
            STRSUBSTNO(
              Text027,InvestmentFixedAsset."No.",FORMAT(-FADeprBook."Acquisition Cost")),
            1,MAXSTRLEN(Description));
        "Cash Flow Date" := FADeprBook."Acquisition Date";
        "Amount (LCY)" := -FADeprBook."Acquisition Cost";
        "Shortcut Dimension 2 Code" := InvestmentFixedAsset."Global Dimension 2 Code";
        "Shortcut Dimension 1 Code" := InvestmentFixedAsset."Global Dimension 1 Code";
        MoveDefualtDimToJnlLineDim(DATABASE::"Fixed Asset",InvestmentFixedAsset."No.","Dimension Set ID");
        InsertTempCFWorksheetLine(0);
      END;
    END;

    LOCAL PROCEDURE InsertCFLineForSaleFixedAsset@8();
    BEGIN
      WITH CFWorksheetLine2 DO BEGIN
        INIT;
        "Source Type" := "Source Type"::"Fixed Assets Disposal";
        "Source No." := SaleFixedAsset."No.";
        "Document No." := SaleFixedAsset."No.";
        "Cash Flow Account No." := CFSetup."FA Disposal CF Account No.";
        Description :=
          COPYSTR(
            STRSUBSTNO(
              Text027,SaleFixedAsset."No.",FORMAT(FADeprBook."Projected Proceeds on Disposal")),
            1,MAXSTRLEN(Description));
        "Cash Flow Date" := FADeprBook."Projected Disposal Date";
        "Amount (LCY)" := FADeprBook."Projected Proceeds on Disposal" ;
        "Shortcut Dimension 2 Code" := SaleFixedAsset."Global Dimension 2 Code";
        "Shortcut Dimension 1 Code" := SaleFixedAsset."Global Dimension 1 Code";
        MoveDefualtDimToJnlLineDim(DATABASE::"Fixed Asset",SaleFixedAsset."No.","Dimension Set ID");
        InsertTempCFWorksheetLine(0);
      END;
    END;

    LOCAL PROCEDURE InsertCFLineForManualExpens@9();
    BEGIN
      WITH CFWorksheetLine2 DO BEGIN
        "Cash Flow Manual Expense".TESTFIELD("Starting Date");
        INIT;
        "Source Type" := "Source Type"::"Cash Flow Manual Expense";
        "Source No." := "Cash Flow Manual Expense".Code;
        "Document No." := "Cash Flow Manual Expense".Code;
        "Cash Flow Account No." := "Cash Flow Manual Expense"."Cash Flow Account No.";
        "Shortcut Dimension 1 Code" := "Cash Flow Manual Expense"."Global Dimension 1 Code";
        "Shortcut Dimension 2 Code" := "Cash Flow Manual Expense"."Global Dimension 2 Code";
        MoveDefualtDimToJnlLineDim(DATABASE::"Cash Flow Manual Expense","Cash Flow Manual Expense".Code,"Dimension Set ID");
        Description := COPYSTR(STRSUBSTNO(Text028,"Cash Flow Manual Expense".Description),1,MAXSTRLEN(Description));
        DateLastExecution := "Cash Flow Forecast"."Manual Payments To";
        IF ("Cash Flow Manual Expense"."Ending Date" <> 0D) AND
           ("Cash Flow Manual Expense"."Ending Date" < "Cash Flow Forecast"."Manual Payments To")
        THEN
          DateLastExecution := "Cash Flow Manual Expense"."Ending Date";
        ExecutionDate := "Cash Flow Manual Expense"."Starting Date";
        IF FORMAT("Cash Flow Manual Expense"."Recurring Frequency") <> '' THEN BEGIN
          IF DateLastExecution = 0D THEN BEGIN
            NeedsManualPmtUpdate := TRUE;
            InsertManualData(
              ExecutionDate,"Cash Flow Forecast",-"Cash Flow Manual Expense".Amount);
          END ELSE
            WHILE ExecutionDate <= DateLastExecution DO BEGIN
              InsertManualData(
                ExecutionDate,"Cash Flow Forecast",-"Cash Flow Manual Expense".Amount);
              ExecutionDate := CALCDATE("Cash Flow Manual Expense"."Recurring Frequency",ExecutionDate);
            END;
        END ELSE
          InsertManualData(ExecutionDate,"Cash Flow Forecast",-"Cash Flow Manual Expense".Amount);
      END;
    END;

    LOCAL PROCEDURE InsertCFLineForManualRevenue@11();
    BEGIN
      WITH CFWorksheetLine2 DO BEGIN
        "Cash Flow Manual Revenue".TESTFIELD("Starting Date");
        INIT;
        "Source Type" := "Source Type"::"Cash Flow Manual Revenue";
        "Source No." := "Cash Flow Manual Revenue".Code;
        "Document No." := "Cash Flow Manual Revenue".Code;
        "Cash Flow Account No." := "Cash Flow Manual Revenue"."Cash Flow Account No.";
        "Shortcut Dimension 1 Code" := "Cash Flow Manual Revenue"."Global Dimension 1 Code";
        "Shortcut Dimension 2 Code" := "Cash Flow Manual Revenue"."Global Dimension 2 Code";
        MoveDefualtDimToJnlLineDim(DATABASE::"Cash Flow Manual Revenue","Cash Flow Manual Revenue".Code,"Dimension Set ID");
        Description := COPYSTR(STRSUBSTNO(Text029,"Cash Flow Manual Revenue".Description),1,MAXSTRLEN(Description));
        DateLastExecution := "Cash Flow Forecast"."Manual Payments To";
        IF ("Cash Flow Manual Revenue"."Ending Date" <> 0D) AND
           ("Cash Flow Manual Revenue"."Ending Date" < "Cash Flow Forecast"."Manual Payments To")
        THEN
          DateLastExecution := "Cash Flow Manual Revenue"."Ending Date";
        ExecutionDate := "Cash Flow Manual Revenue"."Starting Date";
        IF FORMAT("Cash Flow Manual Revenue"."Recurring Frequency") <> '' THEN BEGIN
          IF DateLastExecution = 0D THEN BEGIN
            NeedsManualPmtUpdate := TRUE;
            InsertManualData(
              ExecutionDate,"Cash Flow Forecast","Cash Flow Manual Revenue".Amount);
          END ELSE
            WHILE ExecutionDate <= DateLastExecution DO BEGIN
              InsertManualData(
                ExecutionDate,"Cash Flow Forecast","Cash Flow Manual Revenue".Amount);
              ExecutionDate := CALCDATE("Cash Flow Manual Revenue"."Recurring Frequency",ExecutionDate);
            END;
        END ELSE
          InsertManualData(ExecutionDate,"Cash Flow Forecast","Cash Flow Manual Revenue".Amount);
      END;
    END;

    LOCAL PROCEDURE InsertCFLineForGLBudget@10(GLAcc@1000 : Record 15);
    BEGIN
      WITH CFWorksheetLine2 DO BEGIN
        INIT;
        "Source Type" := "Source Type"::"G/L Budget";
        "Source No." := GLAcc."No.";
        "G/L Budget Name" := GLBudgEntry."Budget Name";
        "Document No." := FORMAT(GLBudgEntry."Entry No.");
        "Cash Flow Account No." := CFAccountForBudget."No.";
        Description :=
          COPYSTR(
            STRSUBSTNO(
              Text030,GLAcc.Name,FORMAT(GLBudgEntry.Description)),
            1,MAXSTRLEN(Description));
        "Cash Flow Date" := GLBudgEntry.Date;
        "Amount (LCY)" := -GLBudgEntry.Amount;
        "Shortcut Dimension 1 Code" := GLBudgEntry."Global Dimension 1 Code";
        "Shortcut Dimension 2 Code" := GLBudgEntry."Global Dimension 2 Code";
        "Dimension Set ID" := GLBudgEntry."Dimension Set ID";
        InsertTempCFWorksheetLine(0);
      END;
    END;

    LOCAL PROCEDURE InsertCFLineForServiceLine@12();
    VAR
      ServiceLine2@1000 : Record 5902;
    BEGIN
      ServiceLine2 := "Service Line";
      IF Summarized AND (ServiceLine2.NEXT <> 0) AND (ServiceLine2."Customer No." <> '') AND
         (ServiceLine2."Document No." = "Service Line"."Document No.")
      THEN BEGIN
        TotalAmt += CalculateLineAmountForServiceLine("Service Line");

        MultiSalesLines := TRUE;
      END ELSE
        WITH CFWorksheetLine2 DO BEGIN
          INIT;
          "Source Type" := "Source Type"::"Service Orders";
          "Source No." := "Service Line"."Document No.";
          "Document Type" := "Document Type"::Invoice;
          "Document Date" := ServiceHeader."Document Date";
          "Shortcut Dimension 1 Code" := ServiceHeader."Shortcut Dimension 1 Code";
          "Shortcut Dimension 2 Code" := ServiceHeader."Shortcut Dimension 2 Code";
          "Dimension Set ID" := ServiceHeader."Dimension Set ID";
          "Cash Flow Account No." := CFSetup."Service CF Account No.";
          Description :=
            COPYSTR(
              STRSUBSTNO(
                Text025,
                ServiceHeader.TABLECAPTION,
                ServiceHeader.Name,
                FORMAT(ServiceHeader."Order Date")),
              1,MAXSTRLEN(Description));
          "Cash Flow Date" := ServiceHeader."Due Date";
          "Document No." := "Service Line"."Document No.";
          "Amount (LCY)" := CalculateLineAmountForServiceLine("Service Line");

          IF Summarized AND MultiSalesLines THEN BEGIN
            "Amount (LCY)" := "Amount (LCY)" + TotalAmt;
            MultiSalesLines := FALSE;
            TotalAmt := 0;
          END;

          IF "Cash Flow Forecast"."Consider CF Payment Terms" AND (Customer."Cash Flow Payment Terms Code" <> '') THEN
            "Payment Terms Code" := Customer."Cash Flow Payment Terms Code"
          ELSE
            "Payment Terms Code" := ServiceHeader."Payment Terms Code";

          InsertTempCFWorksheetLine(0);
        END;
    END;

    LOCAL PROCEDURE CalculateLineAmountForPurchaseLine@19(PurchHeader2@1001 : Record 38;PurchaseLine@1002 : Record 39) : Decimal;
    VAR
      PrepmtAmtInvLCY@1000 : Decimal;
    BEGIN
      IF PurchHeader2."Currency Code" <> '' THEN BEGIN
        Currency.GET(PurchHeader2."Currency Code");
        PrepmtAmtInvLCY :=
          ROUND(
            CurrExchRate.ExchangeAmtFCYToLCY(
      //        PurchHeader2."Posting Date",PurchHeader2."Currency Code",         //**4PS.o
      //        PurchaseLine."Prepmt. Amt. Inv.",PurchHeader2."Currency Factor"), //**4PS.o
              0, '',PurchHeader2."Posting Date",PurchHeader2."Currency Code",        //**4PS.n
              PurchaseLine."Prepmt. Amt. Inv.",PurchHeader2."Currency Factor",FALSE), //**4PS.n
            Currency."Amount Rounding Precision");
      END ELSE
        PrepmtAmtInvLCY := PurchaseLine."Prepmt. Amt. Inv.";

      Currency.InitRoundingPrecision;
      IF PurchHeader2."Prices Including VAT" THEN
        EXIT(-(GetPurchaseAmountForCFLine(PurchaseLine) - PrepmtAmtInvLCY));
      EXIT(
        -(GetPurchaseAmountForCFLine(PurchaseLine) -
          (PrepmtAmtInvLCY +
           ROUND(PrepmtAmtInvLCY * PurchaseLine."VAT %" / 100,Currency."Amount Rounding Precision",Currency.VATRoundingDirection))));
    END;

    LOCAL PROCEDURE CalculateLineAmountForSalesLine@14(SalesHeader2@1001 : Record 36;SalesLine@1002 : Record 37) : Decimal;
    VAR
      PrepmtAmtInvLCY@1000 : Decimal;
    BEGIN
      IF SalesHeader2."Currency Code" <> '' THEN BEGIN
        Currency.GET(SalesHeader2."Currency Code");
        PrepmtAmtInvLCY :=
          ROUND(
            CurrExchRate.ExchangeAmtFCYToLCY(
      //        SalesHeader2."Posting Date",SalesHeader2."Currency Code",      //**4PS.o
      //        SalesLine."Prepmt. Amt. Inv.",SalesHeader2."Currency Factor"), //**4PS.o
              0, '',SalesHeader2."Posting Date",SalesHeader2."Currency Code",     //**4PS.n
              SalesLine."Prepmt. Amt. Inv.",SalesHeader2."Currency Factor",TRUE), //**4PS.n
            Currency."Amount Rounding Precision");
      END ELSE
        PrepmtAmtInvLCY := SalesLine."Prepmt. Amt. Inv.";

      Currency.InitRoundingPrecision;
      IF SalesHeader2."Prices Including VAT" THEN
        EXIT(GetSalesAmountForCFLine(SalesLine) - PrepmtAmtInvLCY);
      EXIT(
        GetSalesAmountForCFLine(SalesLine) -
        (PrepmtAmtInvLCY +
         ROUND(PrepmtAmtInvLCY * SalesLine."VAT %" / 100,Currency."Amount Rounding Precision",Currency.VATRoundingDirection)));
    END;

    LOCAL PROCEDURE CalculateLineAmountForServiceLine@20(ServiceLine@1002 : Record 5902) : Decimal;
    BEGIN
      EXIT(GetServiceAmountForCFLine(ServiceLine));
    END;

    LOCAL PROCEDURE NoOptionsChosen@15() : Boolean;
    VAR
      SourceType@1000 : Integer;
    BEGIN
      FOR SourceType := 1 TO ARRAYLEN(ConsiderSource) DO
        IF ConsiderSource[SourceType] THEN
          EXIT(FALSE);
      EXIT(TRUE);
    END;

    PROCEDURE InitializeRequest@13(NewConsiderSource@1000 : ARRAY [11] OF Boolean;CFNo@1011 : Code[20];NewGLBudgetName@1012 : Code[10];GroupByDocumentType@1001 : Boolean);
    BEGIN
      COPYARRAY(ConsiderSource,NewConsiderSource,1);
      CashFlowNo := CFNo;
      GLBudgName := NewGLBudgetName;
      Summarized := GroupByDocumentType;
    END;

    LOCAL PROCEDURE InsertManualData@2(ExecutionDate@1001 : Date;CashFlowForecast@1002 : Record 840;ManualAmount@1000 : Decimal);
    BEGIN
      IF ((CashFlowForecast."Manual Payments From" <> 0D) AND
          (ExecutionDate < CashFlowForecast."Manual Payments From")) OR
         ((CashFlowForecast."Manual Payments To" <> 0D) AND
          (ExecutionDate > CashFlowForecast."Manual Payments To"))
      THEN
        EXIT;

      WITH CFWorksheetLine2 DO BEGIN
        "Cash Flow Date" := ExecutionDate;
        "Amount (LCY)" := ManualAmount;
        InsertTempCFWorksheetLine(0);
      END;
    END;

    LOCAL PROCEDURE GetPurchaseAmountForCFLine@23(PurchaseLine@1000 : Record 39) : Decimal;
    BEGIN
      EXIT(PurchaseLine."Outstanding Amount (LCY)" + PurchaseLine."Amt. Rcd. Not Invoiced (LCY)");
    END;

    LOCAL PROCEDURE GetSalesAmountForCFLine@24(SalesLine@1000 : Record 37) : Decimal;
    BEGIN
      EXIT(SalesLine."Outstanding Amount (LCY)" + SalesLine."Shipped Not Invoiced (LCY)");
    END;

    LOCAL PROCEDURE GetServiceAmountForCFLine@17(ServiceLine@1000 : Record 5902) : Decimal;
    BEGIN
      EXIT(ServiceLine."Outstanding Amount (LCY)" + ServiceLine."Shipped Not Invoiced (LCY)");
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 846 Cash Flow Date List
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00.00.45480;
  }
  PROPERTIES
  {
    CaptionML=ENU=Cash Flow Date List;
  }
  DATASET
  {
    { 2601;    ;DataItem;CashFlow            ;
               DataItemTable=Table840;
               ReqFilterFields=No. }

    { 10  ;1   ;Column  ;COMPANYNAME         ;
               SourceExpr=COMPANYNAME }

    { 16  ;1   ;Column  ;CurrReport_PAGENO   ;
               SourceExpr=CurrReport.PAGENO }

    { 3   ;1   ;Column  ;CashFlow__No__      ;
               SourceExpr="No." }

    { 5   ;1   ;Column  ;CashFlow_Description;
               SourceExpr=Description }

    { 13  ;1   ;Column  ;CurrReport_PAGENOCaption;
               SourceExpr=CurrReport_PAGENOCaptionLbl }

    { 19  ;1   ;Column  ;CashFlow_Date_ListCaption;
               SourceExpr=CashFlow_Date_ListCaptionLbl }

    { 4   ;1   ;Column  ;CashFlow__No__Caption;
               SourceExpr=FIELDCAPTION("No.") }

    { 6   ;1   ;Column  ;CashFlow_DescriptionCaption;
               SourceExpr=FIELDCAPTION(Description) }

    { 2418;1   ;DataItem;EditionPeriod       ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 ORDER(Ascending);
               OnPreDataItem=BEGIN
                               SETRANGE(Number,0,PeriodNumber + 1);
                               CashFlow.CalculateAllAmounts(0D,UserInputDateFrom - 1,Values,BeforeSumTotal);
                             END;

               OnAfterGetRecord=BEGIN
                                  CashFlow.SetCashFlowDateFilter(CurrentDateFrom,CurrentDateTo);
                                  CASE Number OF
                                    0:
                                      BEGIN
                                        CurrentDateTo := UserInputDateFrom - 1;
                                        CurrentDateFrom := 0D;
                                      END;
                                    PeriodNumber + 1:
                                      BEGIN
                                        CurrentDateFrom := CurrentDateTo + 1;
                                        CurrentDateTo := 0D;
                                      END;
                                    ELSE BEGIN
                                      CurrentDateFrom := CurrentDateTo + 1;
                                      CurrentDateTo := CALCDATE(Interval,CurrentDateFrom) - 1;
                                    END
                                  END;

                                  CashFlow.CalculateAllAmounts(CurrentDateFrom,CurrentDateTo,Values,CFSumTotal);
                                  NewCFSumTotal := NewCFSumTotal + CFSumTotal;
                                END;
                                 }

    { 70  ;2   ;Column  ;NewCFSumTotal       ;
               SourceExpr=NewCFSumTotal }

    { 71  ;2   ;Column  ;BeforeSumTotal      ;
               SourceExpr=BeforeSumTotal }

    { 65  ;2   ;Column  ;Liquidity           ;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Liquid Funds"] }

    { 35  ;2   ;Column  ;Receivables         ;
               SourceExpr=Values[CFForecastEntry."Source Type"::Receivables] }

    { 36  ;2   ;Column  ;Sales_Orders_       ;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Sales Order"] }

    { 57  ;2   ;Column  ;Service_Orders_     ;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Service Orders"] }

    { 37  ;2   ;Column  ;ManualRevenues      ;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Cash Flow Manual Revenue"] }

    { 38  ;2   ;Column  ;Payables            ;
               SourceExpr=Values[CFForecastEntry."Source Type"::Payables] }

    { 39  ;2   ;Column  ;Purchase_Orders_    ;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Purchase Order"] }

    { 40  ;2   ;Column  ;ManualExpenses      ;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Cash Flow Manual Expense"] }

    { 48  ;2   ;Column  ;InvFixedAssets      ;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Fixed Assets Budget"] }

    { 52  ;2   ;Column  ;SaleFixedAssets     ;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Fixed Assets Disposal"] }

    { 61  ;2   ;Column  ;GLBudget            ;
               SourceExpr=Values[CFForecastEntry."Source Type"::"G/L Budget"] }

    { 840 ;2   ;Column  ;EditionPeriod_Number;
               SourceExpr=Number }

    { 841 ;2   ;Column  ;Period_Number       ;
               SourceExpr=PeriodNumber }

    { 2   ;2   ;Column  ;Receivables_Control2;
               SourceExpr=Values[CFForecastEntry."Source Type"::Receivables] }

    { 9   ;2   ;Column  ;Sales_Orders__Control9;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Sales Order"] }

    { 12  ;2   ;Column  ;Payables_Control12  ;
               SourceExpr=Values[CFForecastEntry."Source Type"::Payables] }

    { 15  ;2   ;Column  ;Purchase_Orders__Control15;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Purchase Order"] }

    { 23  ;2   ;Column  ;ManualRevenues_Control23;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Cash Flow Manual Revenue"] }

    { 25  ;2   ;Column  ;ManualExpenses_Control25;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Cash Flow Manual Expense"] }

    { 27  ;2   ;Column  ;FORMAT_DateTo_      ;
               SourceExpr=FORMAT(CurrentDateTo) }

    { 29  ;2   ;Column  ;FORMAT_DateFrom_    ;
               SourceExpr=FORMAT(CurrentDateFrom) }

    { 49  ;2   ;Column  ;InvFixedAssets_Control49;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Fixed Assets Budget"] }

    { 51  ;2   ;Column  ;SaleFixedAssets_Control51;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Fixed Assets Disposal"] }

    { 1   ;2   ;Column  ;NewCFSumTotal_Control1;
               SourceExpr=NewCFSumTotal }

    { 59  ;2   ;Column  ;Service_Orders__Control59;
               SourceExpr=Values[CFForecastEntry."Source Type"::"Service Orders"] }

    { 60  ;2   ;Column  ;Service_Orders__Control59Caption;
               SourceExpr=Service_Orders__Control59CaptionLbl }

    { 20  ;2   ;Column  ;SumTotal_Control18Caption;
               SourceExpr=SumTotal_Control18CaptionLbl }

    { 17  ;2   ;Column  ;Purchase_Orders__Control15Caption;
               SourceExpr=Purchase_Orders__Control15CaptionLbl }

    { 14  ;2   ;Column  ;Payables_Control12Caption;
               SourceExpr=Payables_Control12CaptionLbl }

    { 11  ;2   ;Column  ;Sales_Orders__Control9Caption;
               SourceExpr=Sales_Orders__Control9CaptionLbl }

    { 8   ;2   ;Column  ;Receivables_Control2Caption;
               SourceExpr=Receivables_Control2CaptionLbl }

    { 24  ;2   ;Column  ;ManualRevenues_Control23Caption;
               SourceExpr=ManualRevenues_Control23CaptionLbl }

    { 26  ;2   ;Column  ;ManualExpenses_Control25Caption;
               SourceExpr=ManualExpenses_Control25CaptionLbl }

    { 30  ;2   ;Column  ;FORMAT_DateFrom_Caption;
               SourceExpr=FORMAT_DateFrom_CaptionLbl }

    { 28  ;2   ;Column  ;FORMAT_DateTo_Caption;
               SourceExpr=FORMAT_DateTo_CaptionLbl }

    { 47  ;2   ;Column  ;InvFixedAssets_Control49Caption;
               SourceExpr=InvFixedAssets_Control49CaptionLbl }

    { 54  ;2   ;Column  ;SaleFixedAssets_Control51Caption;
               SourceExpr=SaleFixedAssets_Control51CaptionLbl }

    { 34  ;2   ;Column  ;before_Caption      ;
               SourceExpr=before_CaptionLbl }

    { 32  ;2   ;Column  ;after_Caption       ;
               SourceExpr=after_CaptionLbl }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   UserInputDateFrom := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 1   ;2   ;Field     ;
                  Name=FromDate;
                  CaptionML=ENU=From Date;
                  SourceExpr=UserInputDateFrom }

      { 4   ;2   ;Field     ;
                  CaptionML=ENU=Number of Intervals;
                  SourceExpr=PeriodNumber }

      { 6   ;2   ;Field     ;
                  CaptionML=ENU=Interval Length;
                  SourceExpr=Interval }

    }
  }
  LABELS
  {
    { 62  ;GLBudget_Caption    ;CaptionML=ENU=G/L Budget }
    { 68  ;Liquidity_Caption   ;CaptionML=ENU=Liquidity }
  }
  CODE
  {
    VAR
      CFForecastEntry@1001 : Record 847;
      UserInputDateFrom@1002 : Date;
      CurrentDateFrom@1017 : Date;
      CurrentDateTo@1016 : Date;
      PeriodNumber@1004 : Integer;
      Interval@1005 : DateFormula;
      Values@1003 : ARRAY [11] OF Decimal;
      BeforeSumTotal@1000 : Decimal;
      NewCFSumTotal@1006 : Decimal;
      CFSumTotal@1007 : Decimal;
      CurrReport_PAGENOCaptionLbl@8565 : TextConst 'ENU=Page';
      CashFlow_Date_ListCaptionLbl@7401 : TextConst 'ENU=Cash Flow Date List';
      Service_Orders__Control59CaptionLbl@4779 : TextConst 'ENU=Service Orders';
      SumTotal_Control18CaptionLbl@5806 : TextConst 'ENU=Cash Flow Interference';
      Purchase_Orders__Control15CaptionLbl@7540 : TextConst 'ENU=Purchase Orders';
      Payables_Control12CaptionLbl@3548 : TextConst 'ENU=Payables';
      Sales_Orders__Control9CaptionLbl@9072 : TextConst 'ENU=Sales Orders';
      Receivables_Control2CaptionLbl@1444 : TextConst 'ENU=Receivables';
      ManualRevenues_Control23CaptionLbl@4572 : TextConst 'ENU=Cash Flow Manual Revenues';
      ManualExpenses_Control25CaptionLbl@4019 : TextConst 'ENU=Cash Flow Manual Expenses';
      FORMAT_DateFrom_CaptionLbl@2812 : TextConst 'ENU=From';
      FORMAT_DateTo_CaptionLbl@2848 : TextConst 'ENU=To';
      InvFixedAssets_Control49CaptionLbl@5287 : TextConst 'ENU=Fixed Assets Budget';
      SaleFixedAssets_Control51CaptionLbl@7506 : TextConst 'ENU=Fixed Assets Disposal';
      before_CaptionLbl@3235 : TextConst 'ENU=Before:';
      after_CaptionLbl@5455 : TextConst 'ENU=After:';

    PROCEDURE InitializeRequest@1(FromDate@1000 : Date;NumberOfIntervals@1001 : Integer;IntervalLength@1002 : DateFormula);
    BEGIN
      UserInputDateFrom := FromDate;
      PeriodNumber := NumberOfIntervals;
      Interval := IntervalLength;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>ad8270d7-ed74-4eb2-90f4-18fb3b11c9d2</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="COMPANYNAME">
          <DataField>COMPANYNAME</DataField>
        </Field>
        <Field Name="CurrReport_PAGENO">
          <DataField>CurrReport_PAGENO</DataField>
        </Field>
        <Field Name="CashFlow__No__">
          <DataField>CashFlow__No__</DataField>
        </Field>
        <Field Name="CashFlow_Description">
          <DataField>CashFlow_Description</DataField>
        </Field>
        <Field Name="CurrReport_PAGENOCaption">
          <DataField>CurrReport_PAGENOCaption</DataField>
        </Field>
        <Field Name="CashFlow_Date_ListCaption">
          <DataField>CashFlow_Date_ListCaption</DataField>
        </Field>
        <Field Name="CashFlow__No__Caption">
          <DataField>CashFlow__No__Caption</DataField>
        </Field>
        <Field Name="CashFlow_DescriptionCaption">
          <DataField>CashFlow_DescriptionCaption</DataField>
        </Field>
        <Field Name="NewCFSumTotal">
          <DataField>NewCFSumTotal</DataField>
        </Field>
        <Field Name="NewCFSumTotalFormat">
          <DataField>NewCFSumTotalFormat</DataField>
        </Field>
        <Field Name="BeforeSumTotal">
          <DataField>BeforeSumTotal</DataField>
        </Field>
        <Field Name="BeforeSumTotalFormat">
          <DataField>BeforeSumTotalFormat</DataField>
        </Field>
        <Field Name="Liquidity">
          <DataField>Liquidity</DataField>
        </Field>
        <Field Name="LiquidityFormat">
          <DataField>LiquidityFormat</DataField>
        </Field>
        <Field Name="Receivables">
          <DataField>Receivables</DataField>
        </Field>
        <Field Name="ReceivablesFormat">
          <DataField>ReceivablesFormat</DataField>
        </Field>
        <Field Name="Sales_Orders_">
          <DataField>Sales_Orders_</DataField>
        </Field>
        <Field Name="Sales_Orders_Format">
          <DataField>Sales_Orders_Format</DataField>
        </Field>
        <Field Name="Service_Orders_">
          <DataField>Service_Orders_</DataField>
        </Field>
        <Field Name="Service_Orders_Format">
          <DataField>Service_Orders_Format</DataField>
        </Field>
        <Field Name="ManualRevenues">
          <DataField>ManualRevenues</DataField>
        </Field>
        <Field Name="ManualRevenuesFormat">
          <DataField>ManualRevenuesFormat</DataField>
        </Field>
        <Field Name="Payables">
          <DataField>Payables</DataField>
        </Field>
        <Field Name="PayablesFormat">
          <DataField>PayablesFormat</DataField>
        </Field>
        <Field Name="Purchase_Orders_">
          <DataField>Purchase_Orders_</DataField>
        </Field>
        <Field Name="Purchase_Orders_Format">
          <DataField>Purchase_Orders_Format</DataField>
        </Field>
        <Field Name="ManualExpenses">
          <DataField>ManualExpenses</DataField>
        </Field>
        <Field Name="ManualExpensesFormat">
          <DataField>ManualExpensesFormat</DataField>
        </Field>
        <Field Name="InvFixedAssets">
          <DataField>InvFixedAssets</DataField>
        </Field>
        <Field Name="InvFixedAssetsFormat">
          <DataField>InvFixedAssetsFormat</DataField>
        </Field>
        <Field Name="SaleFixedAssets">
          <DataField>SaleFixedAssets</DataField>
        </Field>
        <Field Name="SaleFixedAssetsFormat">
          <DataField>SaleFixedAssetsFormat</DataField>
        </Field>
        <Field Name="GLBudget">
          <DataField>GLBudget</DataField>
        </Field>
        <Field Name="GLBudgetFormat">
          <DataField>GLBudgetFormat</DataField>
        </Field>
        <Field Name="EditionPeriod_Number">
          <DataField>EditionPeriod_Number</DataField>
        </Field>
        <Field Name="Period_Number">
          <DataField>Period_Number</DataField>
        </Field>
        <Field Name="Receivables_Control2">
          <DataField>Receivables_Control2</DataField>
        </Field>
        <Field Name="Receivables_Control2Format">
          <DataField>Receivables_Control2Format</DataField>
        </Field>
        <Field Name="Sales_Orders__Control9">
          <DataField>Sales_Orders__Control9</DataField>
        </Field>
        <Field Name="Sales_Orders__Control9Format">
          <DataField>Sales_Orders__Control9Format</DataField>
        </Field>
        <Field Name="Payables_Control12">
          <DataField>Payables_Control12</DataField>
        </Field>
        <Field Name="Payables_Control12Format">
          <DataField>Payables_Control12Format</DataField>
        </Field>
        <Field Name="Purchase_Orders__Control15">
          <DataField>Purchase_Orders__Control15</DataField>
        </Field>
        <Field Name="Purchase_Orders__Control15Format">
          <DataField>Purchase_Orders__Control15Format</DataField>
        </Field>
        <Field Name="ManualRevenues_Control23">
          <DataField>ManualRevenues_Control23</DataField>
        </Field>
        <Field Name="ManualRevenues_Control23Format">
          <DataField>ManualRevenues_Control23Format</DataField>
        </Field>
        <Field Name="ManualExpenses_Control25">
          <DataField>ManualExpenses_Control25</DataField>
        </Field>
        <Field Name="ManualExpenses_Control25Format">
          <DataField>ManualExpenses_Control25Format</DataField>
        </Field>
        <Field Name="FORMAT_DateTo_">
          <DataField>FORMAT_DateTo_</DataField>
        </Field>
        <Field Name="FORMAT_DateFrom_">
          <DataField>FORMAT_DateFrom_</DataField>
        </Field>
        <Field Name="InvFixedAssets_Control49">
          <DataField>InvFixedAssets_Control49</DataField>
        </Field>
        <Field Name="InvFixedAssets_Control49Format">
          <DataField>InvFixedAssets_Control49Format</DataField>
        </Field>
        <Field Name="SaleFixedAssets_Control51">
          <DataField>SaleFixedAssets_Control51</DataField>
        </Field>
        <Field Name="SaleFixedAssets_Control51Format">
          <DataField>SaleFixedAssets_Control51Format</DataField>
        </Field>
        <Field Name="NewCFSumTotal_Control1">
          <DataField>NewCFSumTotal_Control1</DataField>
        </Field>
        <Field Name="NewCFSumTotal_Control1Format">
          <DataField>NewCFSumTotal_Control1Format</DataField>
        </Field>
        <Field Name="Service_Orders__Control59">
          <DataField>Service_Orders__Control59</DataField>
        </Field>
        <Field Name="Service_Orders__Control59Format">
          <DataField>Service_Orders__Control59Format</DataField>
        </Field>
        <Field Name="Service_Orders__Control59Caption">
          <DataField>Service_Orders__Control59Caption</DataField>
        </Field>
        <Field Name="SumTotal_Control18Caption">
          <DataField>SumTotal_Control18Caption</DataField>
        </Field>
        <Field Name="Purchase_Orders__Control15Caption">
          <DataField>Purchase_Orders__Control15Caption</DataField>
        </Field>
        <Field Name="Payables_Control12Caption">
          <DataField>Payables_Control12Caption</DataField>
        </Field>
        <Field Name="Sales_Orders__Control9Caption">
          <DataField>Sales_Orders__Control9Caption</DataField>
        </Field>
        <Field Name="Receivables_Control2Caption">
          <DataField>Receivables_Control2Caption</DataField>
        </Field>
        <Field Name="ManualRevenues_Control23Caption">
          <DataField>ManualRevenues_Control23Caption</DataField>
        </Field>
        <Field Name="ManualExpenses_Control25Caption">
          <DataField>ManualExpenses_Control25Caption</DataField>
        </Field>
        <Field Name="FORMAT_DateFrom_Caption">
          <DataField>FORMAT_DateFrom_Caption</DataField>
        </Field>
        <Field Name="FORMAT_DateTo_Caption">
          <DataField>FORMAT_DateTo_Caption</DataField>
        </Field>
        <Field Name="InvFixedAssets_Control49Caption">
          <DataField>InvFixedAssets_Control49Caption</DataField>
        </Field>
        <Field Name="SaleFixedAssets_Control51Caption">
          <DataField>SaleFixedAssets_Control51Caption</DataField>
        </Field>
        <Field Name="before_Caption">
          <DataField>before_Caption</DataField>
        </Field>
        <Field Name="after_Caption">
          <DataField>after_Caption</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="CashFlowTable">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>0.64961in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.73819in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.73819in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.82677in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.76772in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.76772in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.76772in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.76772in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.74991in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.76772in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.76772in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.70866in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.703in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.74991in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.07874in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="EditionPeriod_Number_Control90">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!EditionPeriod_Number.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ffff00</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>53</ZIndex>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Period_Number">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!Period_Number.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ffff00</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>52</ZIndex>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox7">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox7</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="COMPANYNAME">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!COMPANYNAME.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>51</ZIndex>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="CurrReport_PAGENOCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!CurrReport_PAGENOCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>50</ZIndex>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox1</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="CashFlow_Date_ListCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!CashFlow_Date_ListCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>49</ZIndex>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox80">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox80</rd:DefaultName>
                          <ZIndex>48</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="CashFlow__No__Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!CashFlow__No__Caption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>47</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="CashFlow__No__">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!CashFlow__No__.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>46</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>13</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="CashFlow_DescriptionCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!CashFlow_DescriptionCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>45</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="CashFlow_Description">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!CashFlow_Description.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>44</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>13</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.66614in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DateFromCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!FORMAT_DateFrom_Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>43</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>0.15cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DateToCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!FORMAT_DateTo_Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>42</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingRight>0.225cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox8">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Parameters!Liquidity_Caption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox8</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.225cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Receivables_Control2Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!Receivables_Control2Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>41</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.225cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Sales_Orders__Control9Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!Sales_Orders__Control9Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>40</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Service_Orders__Control59Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!Service_Orders__Control59Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>40</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="SaleFixedAssets_Control51Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!SaleFixedAssets_Control51Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>39</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ManualRevenues_Control23Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!ManualRevenues_Control23Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>38</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Payables_Control12Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!Payables_Control12Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>37</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Purchase_Orders__Control15Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!Purchase_Orders__Control15Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>36</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="InvFixedAssets_Control49Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!InvFixedAssets_Control49Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>35</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ManualExpenses_Control25Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!ManualExpenses_Control25Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>34</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Parameters!GLBudget_Caption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox2</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="SumTotal_Control18Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!SumTotal_Control18Caption.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>33</ZIndex>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>8pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DateFrom">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!FORMAT_DateFrom_.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>32</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>0.15cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DateTo">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!FORMAT_DateTo_.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>31</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.15cm</PaddingLeft>
                            <PaddingRight>0.225cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox9">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Liquidity.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!LiquidityFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox9</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.225cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Receivables_Control2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Receivables.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Receivables_Control2Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>30</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.225cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Sales_Orders__Control9">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Sales_Orders_.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Sales_Orders__Control9Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>29</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Service_Orders_Control59">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Service_Orders_.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Sales_Orders__Control9Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>29</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="SaleFixedAssets_Control51">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!SaleFixedAssets.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!SaleFixedAssets_Control51Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>28</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ManualRevenues_Control23">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!ManualRevenues.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!ManualRevenues_Control23Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>27</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Payables_Control12">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Payables.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Payables_Control12Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>26</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Purchase_Orders__Control15">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Purchase_Orders_.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Purchase_Orders__Control15Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>25</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="InvFixedAssets_Control49">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!InvFixedAssets.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!InvFixedAssets_Control49Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>24</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ManualExpenses_Control25">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!ManualExpenses.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!ManualExpenses_Control25Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>23</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox3">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!GLBudget.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!GLBudgetFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox3</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="SumTotal_Control18">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!NewCFSumTotal.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!NewCFSumTotal_Control1Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>22</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <rd:Selected>true</rd:Selected>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="before_Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!before_Caption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>19</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>0.15cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox10">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Liquidity.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!LiquidityFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox10</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.225cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Receivables">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Receivables.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Receivables_Control2Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>18</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.225cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Sales_Orders">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Sales_Orders_.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Sales_Orders__Control9Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>17</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Service_Orders">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Service_Orders_.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Sales_Orders__Control9Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>17</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="SaleFixedAssets">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!SaleFixedAssets.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!SaleFixedAssets_Control51Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>16</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ManualRevenues">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!ManualRevenues.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!ManualRevenues_Control23Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>15</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Payables">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Payables.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Payables_Control12Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>14</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Purchase_Orders">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Purchase_Orders_.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Purchase_Orders__Control15Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>13</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="InvFixedAssets">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!InvFixedAssets.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!InvFixedAssets_Control49Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>12</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ManualExpenses">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!ManualExpenses.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!ManualExpenses_Control25Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>11</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox5">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!GLBudget.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!GLBudgetFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox5</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="SumTotal">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!BeforeSumTotal.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!BeforeSumTotalFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>10</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="after_Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!after_Caption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>9</ZIndex>
                          <Visibility>
                            <Hidden>=iif((Fields!EditionPeriod_Number.Value = Fields!Period_Number.Value + 1),FALSE,TRUE)</Hidden>
                          </Visibility>
                          <DataElementOutput>NoOutput</DataElementOutput>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>0.15cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox11">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Liquidity.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!LiquidityFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox11</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.225cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="L4Receivables">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Receivables.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Receivables_Control2Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>8</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.225cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="L4Sales_Orders">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Sales_Orders_.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Sales_Orders__Control9Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>7</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="L4Service_Orders">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Service_Orders_.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Sales_Orders__Control9Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>7</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="L4SaleFixedAssets">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!SaleFixedAssets.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!SaleFixedAssets_Control51Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>6</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="L4ManualRevenues">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!ManualRevenues.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!ManualRevenues_Control23Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>5</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="L4Payables">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Payables.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Payables_Control12Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>4</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="L4Purchase_Orders">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!Purchase_Orders_.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!Purchase_Orders__Control15Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>3</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="L4InvFixedAssets">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!InvFixedAssets.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!InvFixedAssets_Control49Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>2</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="L4ManualExpenses">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!ManualExpenses.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!ManualExpenses_Control25Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>1</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox6">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!GLBudget.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!GLBudgetFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox6</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="SumTotal_Control1">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!NewCFSumTotal.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!NewCFSumTotal_Control1Format.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>0.075cm</PaddingLeft>
                            <PaddingRight>0.075cm</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="Table1_Group1">
                    <GroupExpressions>
                      <GroupExpression>=Fields!CashFlow__No__.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <TablixMembers>
                    <TablixMember>
                      <KeepWithGroup>After</KeepWithGroup>
                      <RepeatOnNewPage>true</RepeatOnNewPage>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                    <TablixMember>
                      <KeepWithGroup>After</KeepWithGroup>
                      <RepeatOnNewPage>true</RepeatOnNewPage>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                    <TablixMember>
                      <KeepWithGroup>After</KeepWithGroup>
                      <RepeatOnNewPage>true</RepeatOnNewPage>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                    <TablixMember>
                      <KeepWithGroup>After</KeepWithGroup>
                      <RepeatOnNewPage>true</RepeatOnNewPage>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                    <TablixMember>
                      <Group Name="CashFlowTable_Details_Group">
                        <DataElementName>Detail</DataElementName>
                      </Group>
                      <TablixMembers>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=iif((Fields!EditionPeriod_Number.Value &gt; 0) AND (Fields!EditionPeriod_Number.Value &lt;= Fields!Period_Number.Value),FALSE,TRUE)</Hidden>
                          </Visibility>
                        </TablixMember>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=IIf(Fields!EditionPeriod_Number.Value&lt;&gt;0,true,false)</Hidden>
                          </Visibility>
                        </TablixMember>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=iif(Fields!EditionPeriod_Number.Value = Fields!Period_Number.Value + 1,FALSE,TRUE)</Hidden>
                          </Visibility>
                        </TablixMember>
                      </TablixMembers>
                      <DataElementName>Detail_Collection</DataElementName>
                      <DataElementOutput>Output</DataElementOutput>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
            <Height>4.00705cm</Height>
            <Width>26.59522cm</Width>
            <Style />
          </Tablix>
        </ReportItems>
        <Height>4.43007cm</Height>
        <Style />
      </Body>
      <Width>26.61168cm</Width>
      <Page>
        <PageHeader>
          <Height>1.37539cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="CashFlow_Date_ListCaption1">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=ReportItems!CashFlow_Date_ListCaption.Value</Value>
                      <Style>
                        <FontSize>8pt</FontSize>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Height>0.423cm</Height>
              <Width>7.5cm</Width>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CurrReport_PAGENOCaption1">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=ReportItems!CurrReport_PAGENOCaption.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>0.52938cm</Top>
              <Left>24.90782cm</Left>
              <Height>0.423cm</Height>
              <Width>0.75cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="COMPANYNAME1">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=ReportItems!COMPANYNAME.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>0.423cm</Top>
              <Height>0.423cm</Height>
              <Width>7.5cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ExecutionTimeTextBox">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Globals!ExecutionTime</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <Format>g</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.10638cm</Top>
              <Left>22.95782cm</Left>
              <Height>0.423cm</Height>
              <Width>3.15cm</Width>
              <ZIndex>3</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="UserIdTextBox">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=User!UserID</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.95238cm</Top>
              <Left>22.85782cm</Left>
              <Height>0.42301cm</Height>
              <Width>3.25cm</Width>
              <ZIndex>4</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="PageNumberTextBox">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Globals!PageNumber</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.52938cm</Top>
              <Left>25.65782cm</Left>
              <Height>0.423cm</Height>
              <Width>0.45cm</Width>
              <ZIndex>5</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
          </ReportItems>
          <Style />
        </PageHeader>
        <PageHeight>21cm</PageHeight>
        <PageWidth>29.7cm</PageWidth>
        <InteractiveHeight>11in</InteractiveHeight>
        <InteractiveWidth>8.5in</InteractiveWidth>
        <LeftMargin>1cm</LeftMargin>
        <RightMargin>2cm</RightMargin>
        <TopMargin>1.5cm</TopMargin>
        <BottomMargin>0cm</BottomMargin>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="GLBudget_Caption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>GLBudget_Caption</Value>
        </Values>
      </DefaultValue>
      <Prompt>GLBudget_Caption</Prompt>
    </ReportParameter>
    <ReportParameter Name="Liquidity_Caption">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Liquidity_Caption</Value>
        </Values>
      </DefaultValue>
      <Prompt>Liquidity_Caption</Prompt>
    </ReportParameter>
  </ReportParameters>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>feb5603b-5a53-4b83-8831-7450ca5a53cb</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 852 Cash Flow Dimensions - Detail
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00.00.45480;
  }
  PROPERTIES
  {
    CaptionML=ENU=Cash Flow Dimensions - Detail;
    OnPreReport=VAR
                  SelectedDim@1000 : Record 369;
                BEGIN
                  IF AnalysisViewCode = '' THEN
                    ERROR(Text000);

                  IF DateFilter = '' THEN
                    ERROR(Text001);

                  DimSelectionBuf.CompareDimText(
                    3,REPORT::"Cash Flow Dimensions - Detail",AnalysisViewCode,ColumnDim,Text002);

                  TempSelectedDim.RESET;
                  TempSelectedDim.SETFILTER("Dimension Value Filter",'<>%1','');
                  TempSelectedDim.SETFILTER("Dimension Code",TempCFAccount.TABLECAPTION);
                  IF TempSelectedDim.FIND('-') THEN
                    CFAccount.SETFILTER("No.",TempSelectedDim."Dimension Value Filter");
                  CFAccount.SETRANGE("Account Type",CFAccount."Account Type"::Entry);
                  IF CFAccount.FIND('-') THEN
                    REPEAT
                      TempCFAccount.INIT;
                      TempCFAccount := CFAccount;
                      TempCFAccount.INSERT;
                    UNTIL CFAccount.NEXT = 0;

                  TempCashFlowForecast.INIT;
                  TempCashFlowForecast.INSERT;
                  TempSelectedDim.SETFILTER("Dimension Code",CashFlowForecast.TABLECAPTION);
                  IF TempSelectedDim.FIND('-') THEN
                    CashFlowForecast.SETFILTER("No.",TempSelectedDim."Dimension Value Filter");
                  IF CashFlowForecast.FIND('-') THEN
                    REPEAT
                      TempCashFlowForecast.INIT;
                      TempCashFlowForecast := CashFlowForecast;
                      TempCashFlowForecast.INSERT;
                    UNTIL CashFlowForecast.NEXT = 0;

                  SelectedDim.GetSelectedDim(USERID,3,REPORT::"Cash Flow Dimensions - Detail",AnalysisViewCode,TempSelectedDim);
                  TempSelectedDim.RESET;
                  TempSelectedDim.SETCURRENTKEY("User ID","Object Type","Object ID","Analysis View Code",Level);
                  TempSelectedDim.SETFILTER(Level,'<>%1',TempSelectedDim.Level::" ");
                  DimVal.SETRANGE("Dimension Value Type",DimVal."Dimension Value Type"::Standard);
                  IF TempSelectedDim.FIND('-') THEN
                    REPEAT
                      TempDimVal.INIT;
                      TempDimVal.Code := '';
                      TempDimVal."Dimension Code" := COPYSTR(TempSelectedDim."Dimension Code",1,20);
                      TempDimVal.Name := Text003;
                      TempDimVal.INSERT;
                      DimVal.SETRANGE("Dimension Code",TempSelectedDim."Dimension Code");
                      IF TempSelectedDim."Dimension Value Filter" <> '' THEN
                        DimVal.SETFILTER(Code,TempSelectedDim."Dimension Value Filter")
                      ELSE
                        DimVal.SETRANGE(Code);
                      IF DimVal.FIND('-') THEN
                        REPEAT
                          TempDimVal.INIT;
                          TempDimVal := DimVal;
                          TempDimVal.INSERT;
                        UNTIL DimVal.NEXT = 0;
                    UNTIL TempSelectedDim.NEXT = 0;
                END;

  }
  DATASET
  {
    { 3400;    ;DataItem;                    ;
               DataItemTable=Table363;
               DataItemTableView=SORTING(Code);
               OnPreDataItem=BEGIN
                               SETRANGE(Code,AnalysisViewCode);
                             END;

               OnAfterGetRecord=VAR
                                  AccountingPeriod@1000 : Record 50;
                                  i@1001 : Integer;
                                  StartDate@1002 : Date;
                                  EndDate@1003 : Date;
                                BEGIN
                                  IF "Last Date Updated" <> 0D THEN
                                    ViewLastUpdatedText :=
                                      STRSUBSTNO('%1',"Last Date Updated")
                                  ELSE
                                    ViewLastUpdatedText := Text004;

                                  AnalysisViewEntry.RESET;
                                  AnalysisViewEntry.SETRANGE("Analysis View Code",Code);
                                  AnalysisViewEntry.SETFILTER("Cash Flow Forecast No.",CFFilter);
                                  AnalysisViewEntry.SETFILTER("Posting Date",DateFilter);
                                  StartDate := AnalysisViewEntry.GETRANGEMIN("Posting Date");
                                  EndDate := AnalysisViewEntry.GETRANGEMAX("Posting Date");
                                  CASE "Date Compression" OF
                                    "Date Compression"::Week:
                                      BEGIN
                                        StartDate := CALCDATE('<CW+1D-1W>',StartDate);
                                        EndDate := CLOSINGDATE(CALCDATE('<CW>',EndDate));
                                      END;
                                    "Date Compression"::Month:
                                      BEGIN
                                        StartDate := CALCDATE('<CM+1D-1M>',StartDate);
                                        EndDate := CLOSINGDATE(CALCDATE('<CM>',EndDate));
                                      END;
                                    "Date Compression"::Quarter:
                                      BEGIN
                                        StartDate := CALCDATE('<CQ+1D-1Q>',StartDate);
                                        EndDate := CLOSINGDATE(CALCDATE('<CQ>',EndDate));
                                      END;
                                    "Date Compression"::Year:
                                      BEGIN
                                        StartDate := CALCDATE('<CY+1D-1Y>',StartDate);
                                        EndDate := CLOSINGDATE(CALCDATE('<CY>',EndDate));
                                      END;
                                    "Date Compression"::Period:
                                      BEGIN
                                        AccountingPeriod.SETRANGE("Starting Date",0D,StartDate);
                                        IF AccountingPeriod.FIND('+') THEN
                                          StartDate := AccountingPeriod."Starting Date";
                                        AccountingPeriod.SETRANGE("Starting Date",EndDate,99991231D);
                                        IF AccountingPeriod.FIND('-') THEN
                                          IF AccountingPeriod.NEXT <> 0 THEN
                                            EndDate := CLOSINGDATE(AccountingPeriod."Starting Date" - 1);
                                      END;
                                  END;
                                  AnalysisViewEntry.SETRANGE("Posting Date",StartDate,EndDate);

                                  AnalysisViewEntry.FILTERGROUP(2);
                                  TempSelectedDim.RESET;
                                  TempSelectedDim.SETCURRENTKEY("User ID","Object Type","Object ID","Analysis View Code",Level);
                                  TempSelectedDim.SETFILTER("Dimension Value Filter",'<>%1','');
                                  DimFilterText := '';
                                  IF TempSelectedDim.FIND('-') THEN
                                    REPEAT
                                      CompileFilterCaptionString(TempSelectedDim."Dimension Code",TempSelectedDim."Dimension Value Filter");
                                      SetAnaViewEntryFilter(
                                        TempSelectedDim."Dimension Code",TempSelectedDim."Dimension Value Filter");
                                    UNTIL TempSelectedDim.NEXT = 0;

                                  IF CFFilter <> '' THEN
                                    CompileFilterCaptionString(Text007,CFFilter);

                                  AnalysisViewEntry.FILTERGROUP(0);

                                  TempSelectedDim.RESET;
                                  TempSelectedDim.SETCURRENTKEY("User ID","Object Type","Object ID","Analysis View Code",Level);
                                  TempSelectedDim.SETFILTER(Level,'<>%1',TempSelectedDim.Level::" ");
                                  i := 1;
                                  IF TempSelectedDim.FIND('-') THEN
                                    REPEAT
                                      DimCode[i] := TempSelectedDim."Dimension Code";
                                      LevelFilter[i] := TempSelectedDim."Dimension Value Filter";
                                      i := i + 1;
                                    UNTIL (TempSelectedDim.NEXT = 0) OR (i > 4);

                                  IF GLSetup."LCY Code" <> '' THEN
                                    HeaderText := STRSUBSTNO(Text005,GLSetup."LCY Code")
                                  ELSE
                                    HeaderText := '';
                                END;
                                 }

    { 2   ;1   ;Column  ;ViewLastUpdatedText ;
               SourceExpr=ViewLastUpdatedText }

    { 3   ;1   ;Column  ;CashFlowAnalysisViewName;
               SourceExpr=Name }

    { 6   ;1   ;Column  ;CashFlowAnalysisViewCode;
               SourceExpr=Code }

    { 7   ;1   ;Column  ;DateFilter          ;
               SourceExpr=DateFilter }

    { 28  ;1   ;Column  ;CompanyName         ;
               SourceExpr=COMPANYNAME }

    { 31  ;1   ;Column  ;HeaderText          ;
               SourceExpr=HeaderText }

    { 78  ;1   ;Column  ;DimFilterText       ;
               SourceExpr=DimFilterText }

    { 13  ;1   ;Column  ;PeriodCaption       ;
               SourceExpr=PeriodCaptionLbl }

    { 14  ;1   ;Column  ;AnalysisViewCaption ;
               SourceExpr=AnalysisViewCaptionLbl }

    { 20  ;1   ;Column  ;LastUpdatedCaption  ;
               SourceExpr=LastUpdatedCaptionLbl }

    { 21  ;1   ;Column  ;PageCaption         ;
               SourceExpr=PageCaptionLbl }

    { 29  ;1   ;Column  ;CashFlowDimensionsDetailCaption;
               SourceExpr=CashFlowDimensionsDetailCaptionLbl }

    { 80  ;1   ;Column  ;FiltersCaption      ;
               SourceExpr=FiltersCaptionLbl }

    { 46  ;1   ;Column  ;AmountCaption       ;
               SourceExpr=AmountCaptionLbl }

    { 47  ;1   ;Column  ;DescriptionCaption  ;
               SourceExpr=DescriptionCaptionLbl }

    { 49  ;1   ;Column  ;DocumentNoCaption   ;
               SourceExpr=DocumentNoCaptionLbl }

    { 50  ;1   ;Column  ;CashFlowDateCaption ;
               SourceExpr=CashFlowDateCaptionLbl }

    { 51  ;1   ;Column  ;CashFlowAccountNoCaption;
               SourceExpr=CashFlowAccountNoCaptionLbl }

    { 79  ;1   ;Column  ;EntryNoCaption      ;
               SourceExpr=EntryNoCaptionLbl }

    { 1982;1   ;DataItem;Level1              ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=BEGIN
                               IF DimCode[1] = '' THEN
                                 CurrReport.BREAK;
                               FindFirstDim[1] := TRUE;
                               FindFirstCFLedgEntry[1] := TRUE;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF NOT CalcLine(1) AND NOT PrintEmptyLines THEN
                                    CurrReport.SKIP;
                                END;
                                 }

    { 48  ;2   ;Column  ;DimValCode1         ;
               SourceExpr=DimValCode[1] }

    { 10  ;2   ;Column  ;DimCode1            ;
               SourceExpr=DimCode[1] }

    { 72  ;2   ;Column  ;DimValName1         ;
               SourceExpr=DimValName[1] }

    { 6891;2   ;DataItem;Level2              ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=BEGIN
                               IF DimCode[1] = '' THEN
                                 CurrReport.BREAK;
                               FindFirstDim[2] := TRUE;
                               FindFirstCFLedgEntry[2] := TRUE;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF DimCode[2] <> '' THEN BEGIN
                                    IF NOT CalcLine(2) AND NOT PrintEmptyLines THEN
                                      CurrReport.SKIP;
                                  END ELSE
                                    IF NOT PrintDetail(2) THEN
                                      CurrReport.BREAK;
                                END;
                                 }

    { 59  ;3   ;Column  ;DimValCode2         ;
               SourceExpr=DimValCode[2] }

    { 17  ;3   ;Column  ;DimCode2            ;
               SourceExpr=DimCode[2] }

    { 74  ;3   ;Column  ;DimValName2         ;
               SourceExpr=DimValName[2] }

    { 1   ;3   ;Column  ;TempCFLedgEntryCashFlowAccNo;
               SourceExpr=TempCFForecastEntry."Cash Flow Account No." }

    { 4   ;3   ;Column  ;TempCFLedgEntryCashFlowDate;
               SourceExpr=TempCFForecastEntry."Cash Flow Date" }

    { 5   ;3   ;Column  ;TempCFLedgEntryDocNo;
               SourceExpr=TempCFForecastEntry."Document No." }

    { 9   ;3   ;Column  ;TempCFLedgEntryDesc ;
               SourceExpr=TempCFForecastEntry.Description }

    { 11  ;3   ;Column  ;TempCFLedgEntryAmt  ;
               SourceExpr=TempCFForecastEntry."Amount (LCY)" }

    { 84  ;3   ;Column  ;TempCFLedgEntryEntryNo;
               SourceExpr=TempCFForecastEntry."Entry No." }

    { 2908;3   ;DataItem;Level3              ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=BEGIN
                               IF DimCode[2] = '' THEN
                                 CurrReport.BREAK;
                               FindFirstDim[3] := TRUE;
                               FindFirstCFLedgEntry[3] := TRUE;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF DimCode[3] <> '' THEN BEGIN
                                    IF NOT CalcLine(3) AND NOT PrintEmptyLines THEN
                                      CurrReport.SKIP;
                                  END ELSE
                                    IF NOT PrintDetail(3) THEN
                                      CurrReport.BREAK;
                                END;
                                 }

    { 22  ;4   ;Column  ;DimValCode3         ;
               SourceExpr=DimValCode[3] }

    { 18  ;4   ;Column  ;DimCode3            ;
               SourceExpr=DimCode[3] }

    { 76  ;4   ;Column  ;DimValName3         ;
               SourceExpr=DimValName[3] }

    { 16  ;4   ;Column  ;TempCFLedgEntryCashFlowDt_Level3;
               SourceExpr=TempCFForecastEntry."Cash Flow Date" }

    { 23  ;4   ;Column  ;TempCFLedgEntryDocNo_Level3;
               SourceExpr=TempCFForecastEntry."Document No." }

    { 24  ;4   ;Column  ;TempCFLedgEntryDesc_Level3;
               SourceExpr=TempCFForecastEntry.Description }

    { 25  ;4   ;Column  ;TempCFLedgEntryAmt_Level3;
               SourceExpr=TempCFForecastEntry."Amount (LCY)" }

    { 86  ;4   ;Column  ;TempCFLedgEntryEntryNo_Level3;
               SourceExpr=TempCFForecastEntry."Entry No." }

    { 1956;4   ;DataItem;Level4              ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=BEGIN
                               IF DimCode[3] = '' THEN
                                 CurrReport.BREAK;
                               FindFirstDim[4] := TRUE;
                               FindFirstCFLedgEntry[4] := TRUE;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF DimCode[4] <> '' THEN BEGIN
                                    IF NOT CalcLine(4) AND NOT PrintEmptyLines THEN
                                      CurrReport.SKIP;
                                  END ELSE
                                    IF NOT PrintDetail(4) THEN
                                      CurrReport.BREAK;
                                END;
                                 }

    { 40  ;5   ;Column  ;DimValCode4         ;
               SourceExpr=DimValCode[4] }

    { 19  ;5   ;Column  ;DimCode4            ;
               SourceExpr=DimCode[4] }

    { 77  ;5   ;Column  ;DimValName4         ;
               SourceExpr=DimValName[4] }

    { 33  ;5   ;Column  ;TempCFLedgEntryCashFlowDt_Level4;
               SourceExpr=TempCFForecastEntry."Cash Flow Date" }

    { 34  ;5   ;Column  ;TempCFLedgEntryDocNo_Level4;
               SourceExpr=TempCFForecastEntry."Document No." }

    { 35  ;5   ;Column  ;TempCFLedgEntryDesc_Level4;
               SourceExpr=TempCFForecastEntry.Description }

    { 36  ;5   ;Column  ;TempCFLedgEntryAmt_Level4;
               SourceExpr=TempCFForecastEntry."Amount (LCY)" }

    { 87  ;5   ;Column  ;TempCFLedgEntryEntryNo_Level4;
               SourceExpr=TempCFForecastEntry."Entry No." }

    { 5717;5   ;DataItem;Level5              ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=BEGIN
                               IF DimCode[4] = '' THEN
                                 CurrReport.BREAK;
                               FindFirstCFLedgEntry[5] := TRUE;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF NOT PrintDetail(5) THEN
                                    CurrReport.BREAK;
                                END;
                                 }

    { 88  ;6   ;Column  ;TempCFLedgEntryEntryNo_Level5;
               SourceExpr=TempCFForecastEntry."Entry No." }

    { 1256;5   ;DataItem;Level4e             ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=CONST(1));
               OnPostDataItem=BEGIN
                                Total[4] := 0;
                              END;
                               }

    { 43  ;6   ;Column  ;Total4              ;
               SourceExpr=Total[4];
               AutoFormatType=1 }

    { 1681;4   ;DataItem;Level3e             ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=CONST(1));
               OnPostDataItem=BEGIN
                                Total[3] := 0;
                              END;
                               }

    { 61  ;5   ;Column  ;Total3              ;
               SourceExpr=Total[3];
               AutoFormatType=1 }

    { 3989;3   ;DataItem;Level2e             ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=CONST(1));
               OnPostDataItem=BEGIN
                                Total[2] := 0;
                              END;
                               }

    { 66  ;4   ;Column  ;Total2              ;
               SourceExpr=Total[2];
               AutoFormatType=1 }

    { 3266;2   ;DataItem;Level1e             ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=CONST(1));
               OnPostDataItem=BEGIN
                                Total[1] := 0;
                              END;
                               }

    { 71  ;3   ;Column  ;Total1              ;
               SourceExpr=Total[1];
               AutoFormatType=1 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   GLSetup.GET;
                   UpdateColumnDim;
                 END;

    }
    CONTROLS
    {
      { 3   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 2   ;1   ;Group     ;
                  CaptionML=ENU=Options }

      { 11  ;2   ;Field     ;
                  Name=AnalysisViewCodes;
                  Lookup=Yes;
                  CaptionML=ENU=Analysis View Code;
                  SourceExpr=AnalysisViewCode;
                  TableRelation="Analysis View".Code;
                  OnValidate=BEGIN
                               UpdateColumnDim;
                             END;

                  OnLookup=VAR
                             AnalysisView@1002 : Record 363;
                           BEGIN
                             IF PAGE.RUNMODAL(PAGE::"Analysis View List",AnalysisView) = ACTION::LookupOK THEN BEGIN
                               AnalysisViewCode := AnalysisView.Code;
                               UpdateColumnDim;
                             END;
                           END;
                            }

      { 9   ;2   ;Field     ;
                  CaptionML=ENU=Include Dimensions;
                  SourceExpr=ColumnDim;
                  Editable=FALSE;
                  OnAssistEdit=BEGIN
                                 DimSelectionBuf.SetDimSelectionLevelCFAcc(3,REPORT::"Cash Flow Dimensions - Detail",AnalysisViewCode,ColumnDim);
                               END;
                                }

      { 1   ;2   ;Field     ;
                  Name=ForecastFilter;
                  CaptionML=ENU=Cash Flow Forecast Filter;
                  SourceExpr=CFFilter;
                  OnLookup=VAR
                             CashFlowForecastList@1000 : Page 849;
                           BEGIN
                             CashFlowForecastList.LOOKUPMODE(TRUE);
                             IF CashFlowForecastList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               Text := CashFlowForecastList.GetSelectionFilter;
                               EXIT(TRUE);
                             END;

                             EXIT(FALSE)
                           END;
                            }

      { 7   ;2   ;Field     ;
                  Name=DateFilters;
                  CaptionML=ENU=Date Filter;
                  SourceExpr=DateFilter;
                  OnValidate=VAR
                               ApplicationManagement@1001 : Codeunit 1;
                             BEGIN
                               IF ApplicationManagement.MakeDateFilter(DateFilter) = 0 THEN;
                               TempCFAccount.SETFILTER("Date Filter",DateFilter);
                               DateFilter := TempCFAccount.GETFILTER("Date Filter");
                             END;
                              }

      { 13  ;2   ;Field     ;
                  Name=PrintEmptyLine;
                  CaptionML=ENU=Print Empty Lines;
                  SourceExpr=PrintEmptyLines;
                  MultiLine=Yes }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=Enter an analysis view code.';
      Text001@1001 : TextConst 'ENU=Enter a date filter.';
      Text002@1002 : TextConst 'ENU=Include Dimensions';
      Text003@1003 : TextConst 'ENU=(no dimension value)';
      Text004@1004 : TextConst 'ENU=Not updated';
      Text005@1005 : TextConst 'ENU=All amounts are in %1.';
      Text006@1006 : TextConst 'ENU=(no business unit)';
      Text007@1033 : TextConst 'ENU=Cash Flow Forecast Filter';
      AnalysisViewEntry@1007 : Record 365;
      TempSelectedDim@1008 : TEMPORARY Record 369;
      CFAccount@1009 : Record 841;
      CashFlowForecast@1010 : Record 840;
      DimVal@1011 : Record 349;
      TempCFForecastEntry@1012 : TEMPORARY Record 847;
      TempCFAccount@1013 : TEMPORARY Record 841;
      TempCashFlowForecast@1014 : TEMPORARY Record 840;
      TempDimVal@1015 : TEMPORARY Record 349;
      DimSelectionBuf@1016 : Record 368;
      GLSetup@1017 : Record 98;
      PrintEmptyLines@1018 : Boolean;
      ViewLastUpdatedText@1019 : Text[30];
      ColumnDim@1020 : Text[250];
      AnalysisViewCode@1021 : Code[10];
      DateFilter@1022 : Text[250];
      FindFirstDim@1023 : ARRAY [4] OF Boolean;
      FindFirstCFLedgEntry@1024 : ARRAY [5] OF Boolean;
      DimCode@1025 : ARRAY [4] OF Text[30];
      DimValCode@1026 : ARRAY [4] OF Code[20];
      DimValName@1027 : ARRAY [4] OF Text[50];
      LevelFilter@1028 : ARRAY [4] OF Text[250];
      HeaderText@1029 : Text[100];
      Total@1030 : ARRAY [4] OF Decimal;
      DimFilterText@1031 : Text[250];
      CFFilter@1032 : Text[250];
      PeriodCaptionLbl@7978 : TextConst 'ENU=Period';
      AnalysisViewCaptionLbl@6599 : TextConst 'ENU=Analysis View';
      LastUpdatedCaptionLbl@8928 : TextConst 'ENU=Last Date Updated';
      PageCaptionLbl@6215 : TextConst 'ENU=Page';
      CashFlowDimensionsDetailCaptionLbl@4900 : TextConst 'ENU=Cash Flow Dimensions - Detail';
      FiltersCaptionLbl@8600 : TextConst 'ENU=Filters';
      AmountCaptionLbl@7794 : TextConst 'ENU=Amount';
      DescriptionCaptionLbl@3701 : TextConst 'ENU=Description';
      DocumentNoCaptionLbl@2552 : TextConst 'ENU=Document No.';
      CashFlowDateCaptionLbl@8758 : TextConst 'ENU=Cash Flow Date';
      CashFlowAccountNoCaptionLbl@3490 : TextConst 'ENU=Cash Flow Account No.';
      EntryNoCaptionLbl@8629 : TextConst 'ENU=Entry No.';

    LOCAL PROCEDURE CalcLine@1000(Level@1000 : Integer) : Boolean;
    VAR
      HasEntries@1001 : Boolean;
      i@1002 : Integer;
    BEGIN
      IF Level < 4 THEN
        FOR i := Level + 1 TO 4 DO
          SetAnaViewEntryFilter(DimCode[i],'*');
      IF Iteration(
           FindFirstDim[Level],DimCode[Level],DimValCode[Level],DimValName[Level],LevelFilter[Level])
      THEN BEGIN
        SetAnaViewEntryFilter(DimCode[Level],DimValCode[Level]);
        HasEntries := AnalysisViewEntry.FIND('-');
      END ELSE
        CurrReport.BREAK;
      EXIT(HasEntries);
    END;

    LOCAL PROCEDURE PrintDetail@1001(Level@1000 : Integer) : Boolean;
    VAR
      AnalysisViewEntryToGLEntries@1001 : Codeunit 413;
    BEGIN
      IF FindFirstCFLedgEntry[Level] THEN BEGIN
        FindFirstCFLedgEntry[Level] := FALSE;
        TempCFForecastEntry.RESET;
        TempCFForecastEntry.DELETEALL;
        IF AnalysisViewEntry.FIND('-') THEN BEGIN
          REPEAT
            AnalysisViewEntryToGLEntries.GetCFLedgEntries(AnalysisViewEntry,TempCFForecastEntry);
          UNTIL AnalysisViewEntry.NEXT = 0;
        END;
        TempCFForecastEntry.SETCURRENTKEY("Cash Flow Forecast No.","Cash Flow Account No.","Source Type","Cash Flow Date");
        TempCFForecastEntry.SETFILTER("Cash Flow Date",DateFilter);
        IF NOT TempCFForecastEntry.FIND('-') THEN
          EXIT(FALSE);
      END ELSE
        IF TempCFForecastEntry.NEXT = 0 THEN
          EXIT(FALSE);
      IF Level > 1 THEN
        CalcTotalAmounts(Level - 1);
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CalcTotalAmounts@1002(Level@1000 : Integer);
    VAR
      i@1001 : Integer;
    BEGIN
      FOR i := 1 TO Level DO
        Total[i] := Total[i] + TempCFForecastEntry."Amount (LCY)";
    END;

    LOCAL PROCEDURE UpdateColumnDim@1003();
    VAR
      SelectedDim@1000 : Record 369;
      TempDimSelectionBuf@1001 : TEMPORARY Record 368;
      AnalysisView@1002 : Record 363;
    BEGIN
      AnalysisView.CopyAnalysisViewFilters(3,REPORT::"Cash Flow Dimensions - Detail",AnalysisViewCode);
      ColumnDim := '';
      SelectedDim.SETRANGE("User ID",USERID);
      SelectedDim.SETRANGE("Object Type",3);
      SelectedDim.SETRANGE("Object ID",REPORT::"Cash Flow Dimensions - Detail");
      SelectedDim.SETRANGE("Analysis View Code",AnalysisViewCode);
      IF SelectedDim.FIND('-') THEN BEGIN
        REPEAT
          TempDimSelectionBuf.INIT;
          TempDimSelectionBuf.Code := SelectedDim."Dimension Code";
          TempDimSelectionBuf.Selected := TRUE;
          TempDimSelectionBuf."Dimension Value Filter" := SelectedDim."Dimension Value Filter";
          TempDimSelectionBuf.Level := SelectedDim.Level;
          TempDimSelectionBuf.INSERT;
        UNTIL SelectedDim.NEXT = 0;
        TempDimSelectionBuf.SetDimSelection(
          3,REPORT::"Cash Flow Dimensions - Detail",AnalysisViewCode,ColumnDim,TempDimSelectionBuf);
      END;
    END;

    LOCAL PROCEDURE Iteration@1004(VAR FindFirst@1000 : Boolean;IterationDimCode@1001 : Text[30];VAR IterationDimValCode@1002 : Code[20];VAR IterationDimValName@1003 : Text[50];IterationFilter@1004 : Text[250]) : Boolean;
    VAR
      SearchResult@1005 : Boolean;
    BEGIN
      CASE IterationDimCode OF
        TempCFAccount.TABLECAPTION:
          BEGIN
            TempCFAccount.RESET;
            TempCFAccount.SETFILTER("No.",IterationFilter);
            IF FindFirst THEN
              SearchResult := TempCFAccount.FIND('-')
            ELSE
              IF TempCFAccount.GET(IterationDimValCode) THEN
                SearchResult := (TempCFAccount.NEXT <> 0);
            IF SearchResult THEN BEGIN
              IterationDimValCode := TempCFAccount."No.";
              IterationDimValName := TempCFAccount.Name;
            END;
          END;
        TempCashFlowForecast.TABLECAPTION:
          BEGIN
            TempCashFlowForecast.RESET;
            TempCashFlowForecast.SETFILTER("No.",IterationFilter);
            IF FindFirst THEN
              SearchResult := TempCashFlowForecast.FIND('-')
            ELSE
              IF TempCashFlowForecast.GET(IterationDimValCode) THEN
                SearchResult := (TempCashFlowForecast.NEXT <> 0);
            IF SearchResult THEN BEGIN
              IterationDimValCode := TempCashFlowForecast."No.";
              IF TempCashFlowForecast."No." <> '' THEN
                IterationDimValName := TempCashFlowForecast.Description
              ELSE
                IterationDimValName := Text006;
            END;
          END;
        ELSE BEGIN
          TempDimVal.RESET;
          TempDimVal.SETRANGE("Dimension Code",IterationDimCode);
          TempDimVal.SETFILTER(Code,IterationFilter);
          IF FindFirst THEN
            SearchResult := TempDimVal.FIND('-')
          ELSE
            IF TempDimVal.GET(IterationDimCode,IterationDimValCode) THEN
              SearchResult := (TempDimVal.NEXT <> 0);
          IF SearchResult THEN BEGIN
            IterationDimValCode := TempDimVal.Code;
            IterationDimValName := TempDimVal.Name;
          END;
        END;
      END;
      IF NOT SearchResult THEN BEGIN
        IterationDimValCode := '';
        IterationDimValName := '';
      END;
      FindFirst := FALSE;
      EXIT(SearchResult);
    END;

    LOCAL PROCEDURE SetAnaViewEntryFilter@1005(AnalysisViewDimCode@1000 : Text[30];AnalysisViewFilter@1001 : Text[250]);
    BEGIN
      IF AnalysisViewFilter = '' THEN
        AnalysisViewFilter := '''''';
      CASE  AnalysisViewDimCode OF
        TempCFAccount.TABLECAPTION:
          IF AnalysisViewFilter = '*' THEN
            AnalysisViewEntry.SETRANGE("Account No.")
          ELSE BEGIN
            AnalysisViewEntry.SETFILTER("Account No.",AnalysisViewFilter);
            AnalysisViewEntry.SETRANGE("Account Source",AnalysisViewEntry."Account Source"::"Cash Flow Account");
          END;
        TempCashFlowForecast.TABLECAPTION:
          IF AnalysisViewFilter = '*' THEN
            AnalysisViewEntry.SETRANGE("Cash Flow Forecast No.")
          ELSE
            AnalysisViewEntry.SETFILTER("Cash Flow Forecast No.",AnalysisViewFilter);
        "Analysis View"."Dimension 1 Code":
          IF AnalysisViewFilter = '*' THEN
            AnalysisViewEntry.SETRANGE("Dimension 1 Value Code")
          ELSE
            AnalysisViewEntry.SETFILTER("Dimension 1 Value Code",AnalysisViewFilter);
        "Analysis View"."Dimension 2 Code":
          IF AnalysisViewFilter = '*' THEN
            AnalysisViewEntry.SETRANGE("Dimension 2 Value Code")
          ELSE
            AnalysisViewEntry.SETFILTER("Dimension 2 Value Code",AnalysisViewFilter);
        "Analysis View"."Dimension 3 Code":
          IF AnalysisViewFilter = '*' THEN
            AnalysisViewEntry.SETRANGE("Dimension 3 Value Code")
          ELSE
            AnalysisViewEntry.SETFILTER("Dimension 3 Value Code",AnalysisViewFilter);
        "Analysis View"."Dimension 4 Code":
          IF AnalysisViewFilter = '*' THEN
            AnalysisViewEntry.SETRANGE("Dimension 4 Value Code")
          ELSE
            AnalysisViewEntry.SETFILTER("Dimension 4 Value Code",AnalysisViewFilter);
      END;
    END;

    LOCAL PROCEDURE CompileFilterCaptionString@1(NewFilterCode@1001 : Text[250];NewFilterValue@1002 : Text[250]);
    VAR
      Prefix@1000 : Text[2];
    BEGIN
      IF DimFilterText <> '' THEN
        Prefix := ', ';

      DimFilterText := COPYSTR(DimFilterText + Prefix + NewFilterCode + ': ' + NewFilterValue,1,MAXSTRLEN(DimFilterText));
    END;

    PROCEDURE InitializeRequest@2(NewAnalysisViewCode@1000 : Code[10];NewCashFlowFilter@1002 : Text[100];NewDateFilter@1003 : Text[100];NewPrintEmptyLines@1004 : Boolean);
    BEGIN
      AnalysisViewCode := NewAnalysisViewCode;
      CFFilter := NewCashFlowFilter;
      UpdateColumnDim;
      DateFilter := NewDateFilter;
      PrintEmptyLines := NewPrintEmptyLines;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>2932ba67-40e9-407f-a822-131645cc744c</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="ViewLastUpdatedText">
          <DataField>ViewLastUpdatedText</DataField>
        </Field>
        <Field Name="CashFlowAnalysisViewName">
          <DataField>CashFlowAnalysisViewName</DataField>
        </Field>
        <Field Name="CashFlowAnalysisViewCode">
          <DataField>CashFlowAnalysisViewCode</DataField>
        </Field>
        <Field Name="DateFilter">
          <DataField>DateFilter</DataField>
        </Field>
        <Field Name="CompanyName">
          <DataField>CompanyName</DataField>
        </Field>
        <Field Name="HeaderText">
          <DataField>HeaderText</DataField>
        </Field>
        <Field Name="DimFilterText">
          <DataField>DimFilterText</DataField>
        </Field>
        <Field Name="PeriodCaption">
          <DataField>PeriodCaption</DataField>
        </Field>
        <Field Name="AnalysisViewCaption">
          <DataField>AnalysisViewCaption</DataField>
        </Field>
        <Field Name="LastUpdatedCaption">
          <DataField>LastUpdatedCaption</DataField>
        </Field>
        <Field Name="PageCaption">
          <DataField>PageCaption</DataField>
        </Field>
        <Field Name="CashFlowDimensionsDetailCaption">
          <DataField>CashFlowDimensionsDetailCaption</DataField>
        </Field>
        <Field Name="FiltersCaption">
          <DataField>FiltersCaption</DataField>
        </Field>
        <Field Name="AmountCaption">
          <DataField>AmountCaption</DataField>
        </Field>
        <Field Name="DescriptionCaption">
          <DataField>DescriptionCaption</DataField>
        </Field>
        <Field Name="DocumentNoCaption">
          <DataField>DocumentNoCaption</DataField>
        </Field>
        <Field Name="CashFlowDateCaption">
          <DataField>CashFlowDateCaption</DataField>
        </Field>
        <Field Name="CashFlowAccountNoCaption">
          <DataField>CashFlowAccountNoCaption</DataField>
        </Field>
        <Field Name="EntryNoCaption">
          <DataField>EntryNoCaption</DataField>
        </Field>
        <Field Name="DimValCode1">
          <DataField>DimValCode1</DataField>
        </Field>
        <Field Name="DimCode1">
          <DataField>DimCode1</DataField>
        </Field>
        <Field Name="DimValName1">
          <DataField>DimValName1</DataField>
        </Field>
        <Field Name="DimValCode2">
          <DataField>DimValCode2</DataField>
        </Field>
        <Field Name="DimCode2">
          <DataField>DimCode2</DataField>
        </Field>
        <Field Name="DimValName2">
          <DataField>DimValName2</DataField>
        </Field>
        <Field Name="TempCFLedgEntryCashFlowAccNo">
          <DataField>TempCFLedgEntryCashFlowAccNo</DataField>
        </Field>
        <Field Name="TempCFLedgEntryCashFlowDate">
          <DataField>TempCFLedgEntryCashFlowDate</DataField>
        </Field>
        <Field Name="TempCFLedgEntryDocNo">
          <DataField>TempCFLedgEntryDocNo</DataField>
        </Field>
        <Field Name="TempCFLedgEntryDesc">
          <DataField>TempCFLedgEntryDesc</DataField>
        </Field>
        <Field Name="TempCFLedgEntryAmt">
          <DataField>TempCFLedgEntryAmt</DataField>
        </Field>
        <Field Name="TempCFLedgEntryAmtFormat">
          <DataField>TempCFLedgEntryAmtFormat</DataField>
        </Field>
        <Field Name="TempCFLedgEntryEntryNo">
          <DataField>TempCFLedgEntryEntryNo</DataField>
        </Field>
        <Field Name="DimValCode3">
          <DataField>DimValCode3</DataField>
        </Field>
        <Field Name="DimCode3">
          <DataField>DimCode3</DataField>
        </Field>
        <Field Name="DimValName3">
          <DataField>DimValName3</DataField>
        </Field>
        <Field Name="TempCFLedgEntryCashFlowDt_Level3">
          <DataField>TempCFLedgEntryCashFlowDt_Level3</DataField>
        </Field>
        <Field Name="TempCFLedgEntryDocNo_Level3">
          <DataField>TempCFLedgEntryDocNo_Level3</DataField>
        </Field>
        <Field Name="TempCFLedgEntryDesc_Level3">
          <DataField>TempCFLedgEntryDesc_Level3</DataField>
        </Field>
        <Field Name="TempCFLedgEntryAmt_Level3">
          <DataField>TempCFLedgEntryAmt_Level3</DataField>
        </Field>
        <Field Name="TempCFLedgEntryAmt_Level3Format">
          <DataField>TempCFLedgEntryAmt_Level3Format</DataField>
        </Field>
        <Field Name="TempCFLedgEntryEntryNo_Level3">
          <DataField>TempCFLedgEntryEntryNo_Level3</DataField>
        </Field>
        <Field Name="DimValCode4">
          <DataField>DimValCode4</DataField>
        </Field>
        <Field Name="DimCode4">
          <DataField>DimCode4</DataField>
        </Field>
        <Field Name="DimValName4">
          <DataField>DimValName4</DataField>
        </Field>
        <Field Name="TempCFLedgEntryCashFlowDt_Level4">
          <DataField>TempCFLedgEntryCashFlowDt_Level4</DataField>
        </Field>
        <Field Name="TempCFLedgEntryDocNo_Level4">
          <DataField>TempCFLedgEntryDocNo_Level4</DataField>
        </Field>
        <Field Name="TempCFLedgEntryDesc_Level4">
          <DataField>TempCFLedgEntryDesc_Level4</DataField>
        </Field>
        <Field Name="TempCFLedgEntryAmt_Level4">
          <DataField>TempCFLedgEntryAmt_Level4</DataField>
        </Field>
        <Field Name="TempCFLedgEntryAmt_Level4Format">
          <DataField>TempCFLedgEntryAmt_Level4Format</DataField>
        </Field>
        <Field Name="TempCFLedgEntryEntryNo_Level4">
          <DataField>TempCFLedgEntryEntryNo_Level4</DataField>
        </Field>
        <Field Name="TempCFLedgEntryEntryNo_Level5">
          <DataField>TempCFLedgEntryEntryNo_Level5</DataField>
        </Field>
        <Field Name="Total4">
          <DataField>Total4</DataField>
        </Field>
        <Field Name="Total4Format">
          <DataField>Total4Format</DataField>
        </Field>
        <Field Name="Total3">
          <DataField>Total3</DataField>
        </Field>
        <Field Name="Total3Format">
          <DataField>Total3Format</DataField>
        </Field>
        <Field Name="Total2">
          <DataField>Total2</DataField>
        </Field>
        <Field Name="Total2Format">
          <DataField>Total2Format</DataField>
        </Field>
        <Field Name="Total1">
          <DataField>Total1</DataField>
        </Field>
        <Field Name="Total1Format">
          <DataField>Total1Format</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="CashFlowAnalysisViewTable">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.18504in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.15748in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.16157in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.15748in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.16157in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.15748in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.1222in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.36659in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>2.04724in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.90551in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.3937in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox207">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox207</rd:DefaultName>
                          <ZIndex>95</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>29</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="HeaderText">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!HeaderText.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>94</ZIndex>
                          <Style>
                            <Border />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>29</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox410">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox410</rd:DefaultName>
                          <ZIndex>93</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>29</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="FiltersCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!FiltersCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>92</ZIndex>
                          <Style>
                            <Border />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DimFilterText">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimFilterText.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>91</ZIndex>
                          <Style>
                            <Border />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>25</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox11">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox11</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox10">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox10</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox9">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox9</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox8">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox8</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox7">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox7</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox6">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox6</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox5">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox5</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox4">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox4</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox3">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox3</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox1</rd:DefaultName>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>20</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.27559in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox243">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>80</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>12</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="CashFlowAccountNoCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!CashFlowAccountNoCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>79</ZIndex>
                          <Style>
                            <Border />
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="CashFlowDateCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!CashFlowDateCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>78</ZIndex>
                          <Style>
                            <Border />
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DocumentNoCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DocumentNoCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>77</ZIndex>
                          <Style>
                            <Border />
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DescriptionCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DescriptionCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>76</ZIndex>
                          <Style>
                            <Border />
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="AmountCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!AmountCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>75</ZIndex>
                          <Style>
                            <Border />
                            <VerticalAlign>Bottom</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="EntryNoCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!EntryNoCaption.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>74</ZIndex>
                          <Style>
                            <Border />
                            <VerticalAlign>Bottom</VerticalAlign>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DimCode1">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimCode1.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>73</ZIndex>
                          <Style>
                            <Border />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DimValCode1">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValCode1.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>72</ZIndex>
                          <Style>
                            <Border />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DimValName1">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValName1.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>71</ZIndex>
                          <Style>
                            <Border />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>10</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox480">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox480</rd:DefaultName>
                          <ZIndex>70</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox379">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>69</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DimCode2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimCode2.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>68</ZIndex>
                          <Style>
                            <Border />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DimValCode2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValCode2.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>67</ZIndex>
                          <Style>
                            <Border />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="DimValName2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValName2.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>66</ZIndex>
                          <Style>
                            <Border />
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>10</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox236">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox236</rd:DefaultName>
                          <ZIndex>65</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>6</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox383">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>64</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox23">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimCode3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>63</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox107">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValCode3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>62</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox201">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValName3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>61</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>10</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox299">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox299</rd:DefaultName>
                          <ZIndex>60</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox387">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>59</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox199">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimCode4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>58</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox158">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValCode4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>57</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox211">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValName4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>56</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>10</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox264">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox264</rd:DefaultName>
                          <ZIndex>55</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox391">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>54</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>13</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox253">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryCashFlowAccNo.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox253</rd:DefaultName>
                          <ZIndex>53</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox291">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryCashFlowDate.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox291</rd:DefaultName>
                          <ZIndex>52</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox255">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryDocNo.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox255</rd:DefaultName>
                          <ZIndex>51</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox81">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryDesc.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox81</rd:DefaultName>
                          <ZIndex>50</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox24">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!TempCFLedgEntryAmt.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!TempCFLedgEntryAmtFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>49</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox65">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryEntryNo.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox65</rd:DefaultName>
                          <ZIndex>48</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox395">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>47</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>13</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox26">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryCashFlowAccNo.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>46</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox42">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryCashFlowDt_Level3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>45</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox266">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryDocNo_Level3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>44</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox287">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryDesc_Level3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>43</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox288">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!TempCFLedgEntryAmt_Level3.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!TempCFLedgEntryAmtFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>42</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox290">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryEntryNo_Level3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>41</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox399">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>40</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>13</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox91">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryCashFlowAccNo.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>39</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox126">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryCashFlowDt_Level4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>38</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox128">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryDocNo_Level4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>37</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox267">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryDesc_Level4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>36</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox268">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!TempCFLedgEntryAmt_Level4.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!TempCFLedgEntryAmtFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>35</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox270">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryEntryNo_Level4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>34</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox403">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>6</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>13</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox178">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryCashFlowAccNo.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>5</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox179">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryCashFlowDate.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>4</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox237">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryDocNo.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>3</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox247">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryDesc_Level3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>2</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox248">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!TempCFLedgEntryAmt_Level3.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!TempCFLedgEntryAmtFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>1</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox250">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TempCFLedgEntryEntryNo.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox407">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>13</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox219">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimCode4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>12</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox214">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValCode4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>11</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox212">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValName4.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>10</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>10</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox276">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox276</rd:DefaultName>
                          <ZIndex>9</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox164">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(SUM(Fields!Total4.Value))</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>=Max(Fields!Total4Format.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox164</rd:DefaultName>
                          <ZIndex>8</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox167">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!Total4Format.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox167</rd:DefaultName>
                          <ZIndex>7</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox4111">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>20</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox157">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimCode3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>19</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox165">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValCode3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>18</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox206">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValName3.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>17</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>10</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox305">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox305</rd:DefaultName>
                          <ZIndex>16</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox198">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(SUM(Fields!Total3.Value))</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>=Max(Fields!Total3Format.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>15</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox116">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!Total3Format.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox116</rd:DefaultName>
                          <ZIndex>14</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox415">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>27</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox41">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimCode2.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>26</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox275">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValCode2.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>25</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox257">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValName2.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>24</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>10</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox279">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox279</rd:DefaultName>
                          <ZIndex>23</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>4</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox114">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(SUM(Fields!Total2.Value))</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>=Max(Fields!Total2Format.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>22</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox62">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!Total2Format.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox62</rd:DefaultName>
                          <ZIndex>21</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.16654in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox376">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimCode1.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>33</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox56">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValCode1.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>32</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!DimValName1.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>31</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>10</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox222">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>30</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox60">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(SUM(Fields!Total1.Value))</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>=Max(Fields!Total1Format.Value)</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>29</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox50">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!Total1Format.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox50</rd:DefaultName>
                          <ZIndex>28</ZIndex>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <Group Name="table2_Group1">
                    <GroupExpressions>
                      <GroupExpression>=Fields!DimCode1.Value</GroupExpression>
                      <GroupExpression>=Fields!DimValCode1.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <TablixMembers>
                    <TablixMember>
                      <Visibility>
                        <Hidden>=IIF(Fields!DimCode1.Value&lt;&gt;"",FALSE,TRUE)</Hidden>
                      </Visibility>
                      <KeepWithGroup>After</KeepWithGroup>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                    <TablixMember>
                      <Group Name="table2_Group2">
                        <GroupExpressions>
                          <GroupExpression>=Fields!DimCode2.Value</GroupExpression>
                          <GroupExpression>=Fields!DimValCode2.Value</GroupExpression>
                        </GroupExpressions>
                      </Group>
                      <TablixMembers>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=IIF(Fields!DimCode2.Value&lt;&gt;"",FALSE,TRUE)</Hidden>
                          </Visibility>
                          <KeepWithGroup>After</KeepWithGroup>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                        <TablixMember>
                          <Group Name="table2_Group3">
                            <GroupExpressions>
                              <GroupExpression>=Fields!DimCode3.Value</GroupExpression>
                              <GroupExpression>=Fields!DimValCode3.Value</GroupExpression>
                            </GroupExpressions>
                          </Group>
                          <TablixMembers>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=IIF(Fields!DimCode3.Value&lt;&gt;"",FALSE,TRUE)</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                              <KeepTogether>true</KeepTogether>
                            </TablixMember>
                            <TablixMember>
                              <Group Name="table2_Group4">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!DimCode4.Value</GroupExpression>
                                  <GroupExpression>=Fields!DimValCode4.Value</GroupExpression>
                                </GroupExpressions>
                              </Group>
                              <TablixMembers>
                                <TablixMember>
                                  <Visibility>
                                    <Hidden>=IIF(Fields!DimCode4.Value&lt;&gt;"",FALSE,TRUE)</Hidden>
                                  </Visibility>
                                  <KeepWithGroup>After</KeepWithGroup>
                                  <KeepTogether>true</KeepTogether>
                                </TablixMember>
                                <TablixMember>
                                  <Group Name="CashFlowAnalysisViewTable_Details_Group">
                                    <DataElementName>Detail</DataElementName>
                                  </Group>
                                  <TablixMembers>
                                    <TablixMember>
                                      <Visibility>
                                        <Hidden>=IIF(Fields!TempCFLedgEntryEntryNo.Value &lt;&gt; 0 AND Fields!Total2.Value = "0" AND Fields!DimCode2.Value = "",FALSE,TRUE)</Hidden>
                                      </Visibility>
                                    </TablixMember>
                                    <TablixMember>
                                      <Visibility>
                                        <Hidden>=IIF(Fields!TempCFLedgEntryEntryNo_Level3.Value&lt;&gt;0 AND Fields!Total3.Value = "0" AND Fields!DimCode3.Value = "",FALSE,TRUE)</Hidden>
                                      </Visibility>
                                    </TablixMember>
                                    <TablixMember>
                                      <Visibility>
                                        <Hidden>=IIF(Fields!TempCFLedgEntryEntryNo_Level4.Value &lt;&gt;0 AND Fields!Total4.Value = "0" AND Fields!DimCode4.Value = "",FALSE,TRUE)</Hidden>
                                      </Visibility>
                                    </TablixMember>
                                    <TablixMember>
                                      <Visibility>
                                        <Hidden>=IIF(Fields!TempCFLedgEntryEntryNo_Level5.Value&lt;&gt;0,FALSE,TRUE)</Hidden>
                                      </Visibility>
                                    </TablixMember>
                                  </TablixMembers>
                                  <DataElementName>Detail_Collection</DataElementName>
                                  <DataElementOutput>Output</DataElementOutput>
                                  <KeepTogether>true</KeepTogether>
                                </TablixMember>
                                <TablixMember>
                                  <Visibility>
                                    <Hidden>=IIF(Fields!DimCode4.Value&lt;&gt;"",FALSE,TRUE)</Hidden>
                                  </Visibility>
                                  <KeepWithGroup>Before</KeepWithGroup>
                                  <KeepTogether>true</KeepTogether>
                                </TablixMember>
                              </TablixMembers>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=IIF(Fields!DimCode3.Value&lt;&gt;"",FALSE,TRUE)</Hidden>
                              </Visibility>
                              <KeepWithGroup>Before</KeepWithGroup>
                              <KeepTogether>true</KeepTogether>
                            </TablixMember>
                          </TablixMembers>
                        </TablixMember>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=IIF(Fields!DimCode2.Value&lt;&gt;"",FALSE,TRUE)</Hidden>
                          </Visibility>
                          <KeepWithGroup>Before</KeepWithGroup>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                    <TablixMember>
                      <Visibility>
                        <Hidden>=IIF(Fields!DimCode1.Value&lt;&gt;"",FALSE,TRUE)</Hidden>
                      </Visibility>
                      <KeepWithGroup>Before</KeepWithGroup>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
            <Top>0.31746cm</Top>
            <Height>7.891cm</Height>
            <Width>17.81912cm</Width>
            <Style />
          </Tablix>
        </ReportItems>
        <Height>8.20846cm</Height>
        <Style />
      </Body>
      <Width>18cm</Width>
      <Page>
        <PageHeader>
          <Height>2.538cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="CashFlowDimensionsDetailCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!CashFlowDimensionsDetailCaption.Value</Value>
                      <Style>
                        <FontSize>8pt</FontSize>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Height>0.423cm</Height>
              <Width>7.5cm</Width>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CurrReportPageNoCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!PageCaption.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>0.423cm</Top>
              <Left>16.5cm</Left>
              <Height>0.423cm</Height>
              <Width>0.75cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ViewLastUpdatedTextCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!LastUpdatedCaption.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.692cm</Top>
              <Height>0.423cm</Height>
              <Width>2.25cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CashFlowAnalysisViewCodeCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!AnalysisViewCaption.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.269cm</Top>
              <Height>0.423cm</Height>
              <Width>2.25cm</Width>
              <ZIndex>3</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="DateFilterCaption">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!PeriodCaption.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>0.846cm</Top>
              <Height>0.423cm</Height>
              <Width>2.25cm</Width>
              <ZIndex>4</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CompanyName">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!CompanyName.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>0.423cm</Top>
              <Height>0.423cm</Height>
              <Width>7.5cm</Width>
              <ZIndex>5</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="DateFilter">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!DateFilter.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>0.846cm</Top>
              <Left>2.4cm</Left>
              <Height>0.423cm</Height>
              <Width>5.1cm</Width>
              <ZIndex>6</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CashFlowAnalysisViewCode">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!CashFlowAnalysisViewCode.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.269cm</Top>
              <Left>2.4cm</Left>
              <Height>0.423cm</Height>
              <Width>2.1cm</Width>
              <ZIndex>7</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CashFlowAnalysisViewName">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!CashFlowAnalysisViewName.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.269cm</Top>
              <Left>4.65cm</Left>
              <Height>0.423cm</Height>
              <Width>5.1cm</Width>
              <ZIndex>8</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ViewLastUpdatedText">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Fields!ViewLastUpdatedText.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <Top>1.692cm</Top>
              <Left>2.4cm</Left>
              <Height>0.423cm</Height>
              <Width>5.1cm</Width>
              <ZIndex>9</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ExecutionTimeTextBox">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Globals!ExecutionTime</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <Format>g</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Left>14.55cm</Left>
              <Height>0.423cm</Height>
              <Width>3.15cm</Width>
              <ZIndex>10</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="UserIdTextBox">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=User!UserID</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.846cm</Top>
              <Left>14.45cm</Left>
              <Height>0.423cm</Height>
              <Width>3.25cm</Width>
              <ZIndex>11</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="PageNumberTextBox">
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Globals!PageNumber</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.423cm</Top>
              <Left>17.25cm</Left>
              <Height>0.423cm</Height>
              <Width>0.45cm</Width>
              <ZIndex>12</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
          </ReportItems>
          <Style />
        </PageHeader>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <InteractiveHeight>11in</InteractiveHeight>
        <InteractiveWidth>8.5in</InteractiveWidth>
        <LeftMargin>1.5cm</LeftMargin>
        <TopMargin>2cm</TopMargin>
        <BottomMargin>2cm</BottomMargin>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>765aedc3-c249-49ca-899c-48bb9728f22a</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 8610 Create G/L Acc. Journal Lines
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Create G/L Acc. Journal Lines;
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE(Text004);
                 END;

  }
  DATASET
  {
    { 1   ;    ;DataItem;                    ;
               DataItemTable=Table15;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               CheckJournalTemplate;
                               CheckBatchName;
                               CheckPostingDate;

                               GenJnlLine.SETRANGE("Journal Template Name",JournalTemplate);
                               GenJnlLine.SETRANGE("Journal Batch Name",BatchName);
                               IF GenJnlLine.FINDLAST THEN
                                 LineNo := GenJnlLine."Line No." + 10000
                               ELSE
                                 LineNo := 10000;

                               GenJnlBatch.GET(JournalTemplate,BatchName);
                               IF TemplateCode <> '' THEN
                                 StdGenJournal.GET(JournalTemplate,TemplateCode);
                             END;

               OnAfterGetRecord=VAR
                                  StdGenJournalLine@1000 : Record 751;
                                BEGIN
                                  GenJnlLine.INIT;
                                  IF GetStandardJournalLine THEN BEGIN
                                    Initialize(StdGenJournal,GenJnlBatch.Name);

                                    StdGenJournalLine.SETRANGE("Journal Template Name",StdGenJournal."Journal Template Name");
                                    StdGenJournalLine.SETRANGE("Standard Journal Code",StdGenJournal.Code);
                                    IF StdGenJournalLine.FINDSET THEN
                                      REPEAT
                                        CopyGenJnlFromStdJnl(StdGenJournalLine,GenJnlLine);
                                        GenJnlLine.VALIDATE("Document Type",DocumentTypes);
                                        GenJnlLine.VALIDATE("Account Type",GenJnlLine."Account Type"::"G/L Account");
                                        GenJnlLine.VALIDATE("Account No.","No.");
                                        GenJnlLine.VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");
                                        IF PostingDate <> 0D THEN
                                          GenJnlLine.VALIDATE("Posting Date",PostingDate);
                                        GenJnlLine.MODIFY(TRUE);
                                      UNTIL StdGenJournalLine.NEXT = 0;
                                  END ELSE BEGIN
                                    GenJnlLine.VALIDATE("Journal Template Name",JournalTemplate);
                                    GenJnlLine.VALIDATE("Journal Batch Name",BatchName);
                                    GenJnlLine."Line No." := LineNo;
                                    LineNo := LineNo + 10000;

                                    GenJnlLine.VALIDATE("Document Type",DocumentTypes);
                                    GenJnlLine.VALIDATE("Account Type",GenJnlLine."Account Type"::"G/L Account");
                                    GenJnlLine.VALIDATE("Account No.","No.");
                                    GenJnlLine.VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");

                                    IF PostingDate <> 0D THEN
                                      GenJnlLine.VALIDATE("Posting Date",PostingDate);

                                    IF NOT GenJnlLine.INSERT(TRUE) THEN
                                      GenJnlLine.MODIFY(TRUE);
                                  END;
                                END;

               ReqFilterFields=No.,Account Type,Blocked,Direct Posting,No. 2 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF PostingDate = 0D THEN
                     PostingDate := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=Document Type;
                  OptionCaptionML=ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                  SourceExpr=DocumentTypes }

      { 4   ;2   ;Field     ;
                  CaptionML=ENU=Posting Date;
                  SourceExpr=PostingDate;
                  OnValidate=BEGIN
                               CheckPostingDate;
                             END;
                              }

      { 6   ;2   ;Field     ;
                  CaptionML=ENU=Journal Template;
                  SourceExpr=JournalTemplate;
                  TableRelation="Gen. Journal Batch".Name;
                  OnValidate=BEGIN
                               CheckJournalTemplate;
                             END;

                  OnLookup=VAR
                             GenJnlTemplate@1001 : Record 80;
                             GenJnlTemplates@1000 : Page 101;
                           BEGIN
                             GenJnlTemplate.SETRANGE(Type,GenJnlTemplate.Type::General);
                             GenJnlTemplate.SETRANGE(Recurring,FALSE);
                             GenJnlTemplates.SETTABLEVIEW(GenJnlTemplate);

                             GenJnlTemplates.LOOKUPMODE := TRUE;
                             GenJnlTemplates.EDITABLE := FALSE;
                             IF GenJnlTemplates.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               GenJnlTemplates.GETRECORD(GenJnlTemplate);
                               JournalTemplate := GenJnlTemplate.Name;
                             END;
                           END;
                            }

      { 8   ;2   ;Field     ;
                  CaptionML=ENU=Batch Name;
                  SourceExpr=BatchName;
                  TableRelation="Gen. Journal Batch".Name;
                  OnValidate=BEGIN
                               CheckBatchName;
                             END;

                  OnLookup=VAR
                             GenJnlBatches@1001 : Page 251;
                           BEGIN
                             IF JournalTemplate <> '' THEN BEGIN
                               GenJnlBatch.SETRANGE("Journal Template Name",JournalTemplate);
                               GenJnlBatches.SETTABLEVIEW(GenJnlBatch);
                             END;

                             GenJnlBatches.LOOKUPMODE := TRUE;
                             GenJnlBatches.EDITABLE := FALSE;
                             IF GenJnlBatches.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               GenJnlBatches.GETRECORD(GenJnlBatch);
                               BatchName := GenJnlBatch.Name;
                             END;
                           END;
                            }

      { 10  ;2   ;Field     ;
                  CaptionML=ENU=Standard General Journal;
                  SourceExpr=TemplateCode;
                  TableRelation="Standard General Journal".Code;
                  OnLookup=VAR
                             StdGenJournal1@1005 : Record 750;
                             StdGenJnls@1000 : Page 750;
                           BEGIN
                             IF JournalTemplate <> '' THEN BEGIN
                               StdGenJournal1.SETRANGE("Journal Template Name",JournalTemplate);
                               StdGenJnls.SETTABLEVIEW(StdGenJournal1);
                             END;

                             StdGenJnls.LOOKUPMODE := TRUE;
                             StdGenJnls.EDITABLE := FALSE;
                             IF StdGenJnls.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               StdGenJnls.GETRECORD(StdGenJournal1);
                               TemplateCode := StdGenJournal1.Code;
                             END;
                           END;
                            }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      StdGenJournal@1007 : Record 750;
      GenJnlBatch@1006 : Record 232;
      GenJnlLine@1005 : Record 81;
      LastGenJnlLine@1002 : Record 81;
      DocumentTypes@1000 : ' ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund';
      PostingDate@1001 : Date;
      BatchName@1003 : Code[10];
      TemplateCode@1004 : Code[20];
      LineNo@1008 : Integer;
      Text001@1014 : TextConst 'ENU=Gen. Journal Template name is blank.';
      Text002@1009 : TextConst 'ENU=Gen. Journal Batch name is blank.';
      JournalTemplate@1012 : Text[10];
      Text004@1016 : TextConst 'ENU=General journal lines are successfully created.';
      PostingDateIsEmptyErr@1010 : TextConst 'ENU=The posting date is empty.';

    LOCAL PROCEDURE GetStandardJournalLine@3() : Boolean;
    VAR
      StdGenJounalLine@1000 : Record 751;
    BEGIN
      IF TemplateCode = '' THEN
        EXIT;
      StdGenJounalLine.SETRANGE("Journal Template Name",StdGenJournal."Journal Template Name");
      StdGenJounalLine.SETRANGE("Standard Journal Code",StdGenJournal.Code);
      EXIT(StdGenJounalLine.FINDFIRST);
    END;

    PROCEDURE Initialize@15(VAR StdGenJnl@1001 : Record 750;JnlBatchName@1000 : Code[10]);
    BEGIN
      GenJnlLine."Journal Template Name" := StdGenJnl."Journal Template Name";
      GenJnlLine."Journal Batch Name" := JnlBatchName;
      GenJnlLine.SETRANGE("Journal Template Name",StdGenJnl."Journal Template Name");
      GenJnlLine.SETRANGE("Journal Batch Name",JnlBatchName);

      LastGenJnlLine.SETRANGE("Journal Template Name",StdGenJnl."Journal Template Name");
      LastGenJnlLine.SETRANGE("Journal Batch Name",JnlBatchName);

      IF LastGenJnlLine.FINDLAST THEN;

      GenJnlBatch.SETRANGE("Journal Template Name",StdGenJnl."Journal Template Name");
      GenJnlBatch.SETRANGE(Name,JnlBatchName);

      IF GenJnlBatch.FINDFIRST THEN;
    END;

    LOCAL PROCEDURE CopyGenJnlFromStdJnl@1(StdGenJnlLine@1001 : Record 751;VAR GenJnlLine@1002 : Record 81);
    VAR
      GenJnlManagement@1000 : Codeunit 230;
      Balance@1007 : Decimal;
      TotalBalance@1006 : Decimal;
      ShowBalance@1005 : Boolean;
      ShowTotalBalance@1004 : Boolean;
    BEGIN
      GenJnlLine.INIT;
      GenJnlLine."Line No." := 0;
      GenJnlManagement.CalcBalance(GenJnlLine,LastGenJnlLine,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      GenJnlLine.SetUpNewLine(LastGenJnlLine,Balance,TRUE);
      IF LastGenJnlLine."Line No." <> 0 THEN
        GenJnlLine."Line No." := LastGenJnlLine."Line No." + 10000
      ELSE
        GenJnlLine."Line No." := 10000;

      GenJnlLine.TRANSFERFIELDS(StdGenJnlLine,FALSE);
      GenJnlLine.UpdateLineBalance;
      GenJnlLine.VALIDATE("Currency Code");

      IF GenJnlLine."VAT Prod. Posting Group" <> '' THEN
        GenJnlLine.VALIDATE("VAT Prod. Posting Group");
      IF (GenJnlLine."VAT %" <> 0) AND GenJnlBatch."Allow VAT Difference" THEN
        GenJnlLine.VALIDATE("VAT Amount",StdGenJnlLine."VAT Amount");
      GenJnlLine.VALIDATE("Bal. VAT Prod. Posting Group");

      IF GenJnlBatch."Allow VAT Difference" THEN
        GenJnlLine.VALIDATE("Bal. VAT Amount",StdGenJnlLine."Bal. VAT Amount");
      GenJnlLine.INSERT(TRUE);

      LastGenJnlLine := GenJnlLine;
    END;

    PROCEDURE InitializeRequest@2(DocumentTypesFrom@1000 : Option;PostingDateFrom@1001 : Date;JournalTemplateFrom@1002 : Text[10];BatchNameFrom@1003 : Code[10];StandardTemplateCodeFrom@1004 : Code[20]);
    BEGIN
      DocumentTypes := DocumentTypesFrom;
      PostingDate := PostingDateFrom;
      JournalTemplate := JournalTemplateFrom;
      BatchName := BatchNameFrom;
      TemplateCode := StandardTemplateCodeFrom;
    END;

    LOCAL PROCEDURE CheckPostingDate@24();
    BEGIN
      IF PostingDate = 0D THEN
        ERROR(PostingDateIsEmptyErr);
    END;

    LOCAL PROCEDURE CheckBatchName@32();
    BEGIN
      IF BatchName = '' THEN
        ERROR(Text002);
    END;

    LOCAL PROCEDURE CheckJournalTemplate@33();
    BEGIN
      IF JournalTemplate = '' THEN
        ERROR(Text001);
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 8611 Create Customer Journal Lines
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Create Customer Journal Lines;
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE(Text004);
                 END;

  }
  DATASET
  {
    { 1   ;    ;DataItem;                    ;
               DataItemTable=Table18;
               DataItemTableView=SORTING(No.)
                                 WHERE(Bill-to Customer No.=FILTER(''));
               OnPreDataItem=BEGIN
                               CheckJournalTemplate;
                               CheckBatchName;
                               CheckPostingDate;

                               GenJnlLine.SETRANGE("Journal Template Name",JournalTemplate);
                               GenJnlLine.SETRANGE("Journal Batch Name",BatchName);
                               IF GenJnlLine.FINDLAST THEN
                                 LineNo := GenJnlLine."Line No." + 10000
                               ELSE
                                 LineNo := 10000;

                               GenJnlBatch.GET(JournalTemplate,BatchName);
                               IF TemplateCode <> '' THEN
                                 StdGenJournal.GET(JournalTemplate,TemplateCode);
                             END;

               OnAfterGetRecord=VAR
                                  StdGenJournalLine@1000 : Record 751;
                                BEGIN
                                  GenJnlLine.INIT;
                                  IF GetStandardJournalLine THEN BEGIN
                                    Initialize(StdGenJournal,GenJnlBatch.Name);

                                    StdGenJournalLine.SETRANGE("Journal Template Name",StdGenJournal."Journal Template Name");
                                    StdGenJournalLine.SETRANGE("Standard Journal Code",StdGenJournal.Code);
                                    IF StdGenJournalLine.FINDSET THEN
                                      REPEAT
                                        CopyGenJnlFromStdJnl(StdGenJournalLine,GenJnlLine);

                                        IF PostingDate <> 0D THEN
                                          GenJnlLine.VALIDATE("Posting Date",PostingDate);

                                        GenJnlLine.VALIDATE("Document Type",DocumentTypes);
                                        GenJnlLine.VALIDATE("Account Type",GenJnlLine."Account Type"::Customer);
                                        GenJnlLine.VALIDATE("Account No.","No.");
                                        IF (GenJnlBatch."Bal. Account Type" = GenJnlBatch."Bal. Account Type"::"G/L Account") AND
                                           (GenJnlBatch."Bal. Account No." <> '')
                                        THEN BEGIN
                                          GenJnlLine.VALIDATE("Bal. Account Type",GenJnlLine."Bal. Account Type"::"G/L Account");
                                          GenJnlLine.VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");
                                        END ELSE
                                          IF "Customer Posting Group" <> '' THEN
                                            IF CustPostGrp.GET("Customer Posting Group") THEN BEGIN
                                              GenJnlLine.VALIDATE("Bal. Account Type",GenJnlLine."Bal. Account Type"::"G/L Account");
                                              GenJnlLine.VALIDATE("Bal. Account No.",CustPostGrp."Receivables Account");
                                            END;

                                        IF DocumentDate <> 0D THEN BEGIN
                                          GenJnlLine.VALIDATE("Posting Date",DocumentDate);
                                          GenJnlLine."Posting Date" := PostingDate;
                                        END;

                                        GenJnlLine.MODIFY(TRUE);
                                      UNTIL StdGenJournalLine.NEXT = 0;
                                  END ELSE BEGIN
                                    GenJnlLine.VALIDATE("Journal Template Name",GenJnlLine.GETFILTER("Journal Template Name"));
                                    GenJnlLine.VALIDATE("Journal Batch Name",BatchName);
                                    GenJnlLine."Line No." := LineNo;
                                    LineNo := LineNo + 10000;

                                    IF PostingDate <> 0D THEN
                                      GenJnlLine.VALIDATE("Posting Date",PostingDate);

                                    GenJnlLine.VALIDATE("Document Type",DocumentTypes);
                                    GenJnlLine.VALIDATE("Account Type",GenJnlLine."Account Type"::Customer);
                                    GenJnlLine.VALIDATE("Account No.","No.");
                                    IF (GenJnlBatch."Bal. Account Type" = GenJnlBatch."Bal. Account Type"::"G/L Account") AND
                                       (GenJnlBatch."Bal. Account No." <> '')
                                    THEN BEGIN
                                      GenJnlLine.VALIDATE("Bal. Account Type",GenJnlLine."Bal. Account Type"::"G/L Account");
                                      GenJnlLine.VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");
                                    END ELSE
                                      IF "Customer Posting Group" <> '' THEN
                                        IF CustPostGrp.GET("Customer Posting Group") THEN BEGIN
                                          GenJnlLine.VALIDATE("Bal. Account Type",GenJnlLine."Bal. Account Type"::"G/L Account");
                                          GenJnlLine.VALIDATE("Bal. Account No.",CustPostGrp."Receivables Account");
                                        END;
                                    IF DocumentDate <> 0D THEN BEGIN
                                      GenJnlLine.VALIDATE("Posting Date",DocumentDate);
                                      GenJnlLine."Posting Date" := PostingDate;
                                    END;

                                    IF NOT GenJnlLine.INSERT(TRUE) THEN
                                      GenJnlLine.MODIFY(TRUE);
                                  END;
                                END;

               ReqFilterFields=No.,Currency Code,Country/Region Code,Salesperson Code,Customer Posting Group,Blocked }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF PostingDate = 0D THEN
                     PostingDate := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=Document Type;
                  OptionCaptionML=ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                  SourceExpr=DocumentTypes }

      { 4   ;2   ;Field     ;
                  CaptionML=ENU=Posting Date;
                  SourceExpr=PostingDate;
                  OnValidate=BEGIN
                               CheckPostingDate;
                             END;
                              }

      { 6   ;2   ;Field     ;
                  CaptionML=ENU=Document Date;
                  SourceExpr=DocumentDate }

      { 12  ;2   ;Field     ;
                  CaptionML=ENU=Journal Template;
                  SourceExpr=JournalTemplate;
                  TableRelation="Gen. Journal Batch".Name;
                  OnValidate=BEGIN
                               CheckJournalTemplate;
                             END;

                  OnLookup=VAR
                             GenJnlTemplate@1001 : Record 80;
                             GenJnlTemplates@1000 : Page 101;
                           BEGIN
                             GenJnlTemplate.SETRANGE(Type,GenJnlTemplate.Type::General);
                             GenJnlTemplate.SETRANGE(Recurring,FALSE);
                             GenJnlTemplates.SETTABLEVIEW(GenJnlTemplate);

                             GenJnlTemplates.LOOKUPMODE := TRUE;
                             GenJnlTemplates.EDITABLE := FALSE;
                             IF GenJnlTemplates.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               GenJnlTemplates.GETRECORD(GenJnlTemplate);
                               JournalTemplate := GenJnlTemplate.Name;
                             END;
                           END;
                            }

      { 8   ;2   ;Field     ;
                  CaptionML=ENU=Batch Name;
                  SourceExpr=BatchName;
                  TableRelation="Gen. Journal Batch".Name;
                  OnValidate=BEGIN
                               CheckBatchName;
                             END;

                  OnLookup=VAR
                             GenJnlBatches@1001 : Page 251;
                           BEGIN
                             IF JournalTemplate <> '' THEN BEGIN
                               GenJnlBatch.SETRANGE("Journal Template Name",JournalTemplate);
                               GenJnlBatches.SETTABLEVIEW(GenJnlBatch);
                             END;

                             GenJnlBatches.LOOKUPMODE := TRUE;
                             GenJnlBatches.EDITABLE := FALSE;
                             IF GenJnlBatches.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               GenJnlBatches.GETRECORD(GenJnlBatch);
                               BatchName := GenJnlBatch.Name;
                             END;
                           END;
                            }

      { 10  ;2   ;Field     ;
                  CaptionML=ENU=Standard General Journal;
                  SourceExpr=TemplateCode;
                  TableRelation="Standard General Journal".Code;
                  OnLookup=VAR
                             StdGenJournal1@1005 : Record 750;
                             StdGenJnls@1000 : Page 750;
                           BEGIN
                             IF JournalTemplate <> '' THEN BEGIN
                               StdGenJournal1.SETRANGE("Journal Template Name",JournalTemplate);
                               StdGenJnls.SETTABLEVIEW(StdGenJournal1);
                             END;

                             StdGenJnls.LOOKUPMODE := TRUE;
                             StdGenJnls.EDITABLE := FALSE;
                             IF StdGenJnls.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               StdGenJnls.GETRECORD(StdGenJournal1);
                               TemplateCode := StdGenJournal1.Code;
                             END;
                           END;
                            }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      StdGenJournal@1007 : Record 750;
      GenJnlBatch@1006 : Record 232;
      GenJnlLine@1005 : Record 81;
      LastGenJnlLine@1012 : Record 81;
      CustPostGrp@1009 : Record 92;
      DocumentTypes@1000 : ' ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund';
      PostingDate@1001 : Date;
      DocumentDate@1002 : Date;
      BatchName@1003 : Code[10];
      TemplateCode@1004 : Code[20];
      LineNo@1008 : Integer;
      JournalTemplate@1015 : Text[10];
      Text001@1016 : TextConst 'ENU=Gen. Journal Template name is blank.';
      Text002@1013 : TextConst 'ENU=Gen. Journal Batch name is blank.';
      Text004@1017 : TextConst 'ENU=General journal lines are successfully created.';
      PostingDateIsEmptyErr@1010 : TextConst 'ENU=The posting date is empty.';

    LOCAL PROCEDURE GetStandardJournalLine@3() : Boolean;
    VAR
      StdGenJounalLine@1000 : Record 751;
    BEGIN
      IF TemplateCode = '' THEN
        EXIT(FALSE);
      StdGenJounalLine.SETRANGE("Journal Template Name",StdGenJournal."Journal Template Name");
      StdGenJounalLine.SETRANGE("Standard Journal Code",StdGenJournal.Code);
      EXIT(StdGenJounalLine.FINDFIRST)
    END;

    PROCEDURE Initialize@15(VAR StdGenJnl@1001 : Record 750;JnlBatchName@1000 : Code[10]);
    BEGIN
      GenJnlLine."Journal Template Name" := StdGenJnl."Journal Template Name";
      GenJnlLine."Journal Batch Name" := JnlBatchName;
      GenJnlLine.SETRANGE("Journal Template Name",StdGenJnl."Journal Template Name");
      GenJnlLine.SETRANGE("Journal Batch Name",JnlBatchName);

      LastGenJnlLine.SETRANGE("Journal Template Name",StdGenJnl."Journal Template Name");
      LastGenJnlLine.SETRANGE("Journal Batch Name",JnlBatchName);

      IF LastGenJnlLine.FINDLAST THEN;

      GenJnlBatch.SETRANGE("Journal Template Name",StdGenJnl."Journal Template Name");
      GenJnlBatch.SETRANGE(Name,JnlBatchName);

      IF GenJnlBatch.FINDFIRST THEN;
    END;

    LOCAL PROCEDURE CopyGenJnlFromStdJnl@1(StdGenJnlLine@1001 : Record 751;VAR GenJnlLine@1002 : Record 81);
    VAR
      GenJnlManagement@1000 : Codeunit 230;
      Balance@1007 : Decimal;
      TotalBalance@1006 : Decimal;
      ShowBalance@1005 : Boolean;
      ShowTotalBalance@1004 : Boolean;
    BEGIN
      GenJnlLine.INIT;
      GenJnlLine."Line No." := 0;
      GenJnlManagement.CalcBalance(GenJnlLine,LastGenJnlLine,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      GenJnlLine.SetUpNewLine(LastGenJnlLine,Balance,TRUE);
      IF LastGenJnlLine."Line No." <> 0 THEN
        GenJnlLine."Line No." := LastGenJnlLine."Line No." + 10000
      ELSE
        GenJnlLine."Line No." := 10000;

      GenJnlLine.TRANSFERFIELDS(StdGenJnlLine,FALSE);
      GenJnlLine.UpdateLineBalance;
      GenJnlLine.VALIDATE("Currency Code");

      IF GenJnlLine."VAT Prod. Posting Group" <> '' THEN
        GenJnlLine.VALIDATE("VAT Prod. Posting Group");
      IF (GenJnlLine."VAT %" <> 0) AND GenJnlBatch."Allow VAT Difference" THEN
        GenJnlLine.VALIDATE("VAT Amount",StdGenJnlLine."VAT Amount");
      GenJnlLine.VALIDATE("Bal. VAT Prod. Posting Group");

      IF GenJnlBatch."Allow VAT Difference" THEN
        GenJnlLine.VALIDATE("Bal. VAT Amount",StdGenJnlLine."Bal. VAT Amount");
      GenJnlLine.INSERT(TRUE);

      LastGenJnlLine := GenJnlLine;
    END;

    PROCEDURE InitializeRequest@2(DocumentTypesFrom@1000 : Option;PostingDateFrom@1001 : Date;DocumentDateFrom@1002 : Date);
    BEGIN
      DocumentTypes := DocumentTypesFrom;
      PostingDate := PostingDateFrom;
      DocumentDate := DocumentDateFrom;
    END;

    PROCEDURE InitializeRequestTemplate@4(JournalTemplateFrom@1000 : Text[10];BatchNameFrom@1001 : Code[10];TemplateCodeFrom@1002 : Code[20]);
    BEGIN
      JournalTemplate := JournalTemplateFrom;
      BatchName := BatchNameFrom;
      TemplateCode := TemplateCodeFrom;
    END;

    LOCAL PROCEDURE CheckPostingDate@24();
    BEGIN
      IF PostingDate = 0D THEN
        ERROR(PostingDateIsEmptyErr);
    END;

    LOCAL PROCEDURE CheckBatchName@32();
    BEGIN
      IF BatchName = '' THEN
        ERROR(Text002);
    END;

    LOCAL PROCEDURE CheckJournalTemplate@33();
    BEGIN
      IF JournalTemplate = '' THEN
        ERROR(Text001);
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 8612 Create Vendor Journal Lines
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Create Vendor Journal Lines;
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE(Text004);
                 END;

  }
  DATASET
  {
    { 1   ;    ;DataItem;                    ;
               DataItemTable=Table23;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               CheckJournalTemplate;
                               CheckBatchName;
                               CheckPostingDate;

                               GenJnlLine.SETRANGE("Journal Template Name",JournalTemplate);
                               GenJnlLine.SETRANGE("Journal Batch Name",BatchName);
                               IF GenJnlLine.FINDLAST THEN
                                 LineNo := GenJnlLine."Line No." + 10000
                               ELSE
                                 LineNo := 10000;

                               GenJnlBatch.GET(JournalTemplate,BatchName);
                               IF TemplateCode <> '' THEN
                                 StdGenJournal.GET(JournalTemplate,TemplateCode);
                             END;

               OnAfterGetRecord=VAR
                                  StdGenJournalLine@1000 : Record 751;
                                BEGIN
                                  GenJnlLine.INIT;
                                  IF GetStandardJournalLine THEN BEGIN
                                    Initialize(StdGenJournal,GenJnlBatch.Name);

                                    StdGenJournalLine.SETRANGE("Journal Template Name",StdGenJournal."Journal Template Name");
                                    StdGenJournalLine.SETRANGE("Standard Journal Code",StdGenJournal.Code);
                                    IF StdGenJournalLine.FINDSET THEN
                                      REPEAT
                                        CopyGenJnlFromStdJnl(StdGenJournalLine,GenJnlLine);
                                        IF PostingDate <> 0D THEN
                                          GenJnlLine.VALIDATE("Posting Date",PostingDate);

                                        GenJnlLine.VALIDATE("Document Type",DocumentTypes);
                                        GenJnlLine.VALIDATE("Account Type",GenJnlLine."Account Type"::Vendor);
                                        GenJnlLine.VALIDATE("Account No.","No.");
                                        IF (GenJnlBatch."Bal. Account Type" = GenJnlBatch."Bal. Account Type"::"G/L Account") AND
                                           (GenJnlBatch."Bal. Account No." <> '')
                                        THEN BEGIN
                                          GenJnlLine.VALIDATE("Bal. Account Type",GenJnlLine."Bal. Account Type"::"G/L Account");
                                          GenJnlLine.VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");
                                        END ELSE
                                          IF "Vendor Posting Group" <> '' THEN
                                            IF VendorPostGrp.GET("Vendor Posting Group") THEN BEGIN
                                              GenJnlLine.VALIDATE("Bal. Account Type",GenJnlLine."Bal. Account Type"::"G/L Account");
                                              GenJnlLine.VALIDATE("Bal. Account No.",VendorPostGrp."Payables Account");
                                            END;

                                        IF DocumentDate <> 0D THEN BEGIN
                                          GenJnlLine.VALIDATE("Posting Date",DocumentDate);
                                          GenJnlLine."Posting Date" := PostingDate;
                                        END;

                                        IF NOT GenJnlLine.INSERT(TRUE) THEN
                                          GenJnlLine.MODIFY(TRUE);
                                      UNTIL StdGenJournalLine.NEXT = 0;
                                  END ELSE BEGIN
                                    GenJnlLine.VALIDATE("Journal Template Name",GenJnlLine.GETFILTER("Journal Template Name"));
                                    GenJnlLine.VALIDATE("Journal Batch Name",BatchName);
                                    GenJnlLine."Line No." := LineNo;
                                    LineNo := LineNo + 10000;

                                    IF PostingDate <> 0D THEN
                                      GenJnlLine.VALIDATE("Posting Date",PostingDate);

                                    GenJnlLine.VALIDATE("Document Type",DocumentTypes);
                                    GenJnlLine.VALIDATE("Account Type",GenJnlLine."Account Type"::Vendor);
                                    GenJnlLine.VALIDATE("Account No.","No.");
                                    IF (GenJnlBatch."Bal. Account Type" = GenJnlBatch."Bal. Account Type"::"G/L Account") AND
                                       (GenJnlBatch."Bal. Account No." <> '')
                                    THEN BEGIN
                                      GenJnlLine.VALIDATE("Bal. Account Type",GenJnlLine."Bal. Account Type"::"G/L Account");
                                      GenJnlLine.VALIDATE("Bal. Account No.",GenJnlBatch."Bal. Account No.");
                                    END ELSE
                                      IF "Vendor Posting Group" <> '' THEN
                                        IF VendorPostGrp.GET("Vendor Posting Group") THEN BEGIN
                                          GenJnlLine.VALIDATE("Bal. Account Type",GenJnlLine."Bal. Account Type"::"G/L Account");
                                          GenJnlLine.VALIDATE("Bal. Account No.",VendorPostGrp."Payables Account");
                                        END;

                                    IF DocumentDate <> 0D THEN BEGIN
                                      GenJnlLine.VALIDATE("Posting Date",DocumentDate);
                                      GenJnlLine."Posting Date" := PostingDate;
                                    END;

                                    IF NOT GenJnlLine.INSERT(TRUE) THEN
                                      GenJnlLine.MODIFY(TRUE);
                                  END;
                                END;

               ReqFilterFields=No.,Currency Code,Country/Region Code,Vendor Posting Group,Blocked }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF PostingDate = 0D THEN
                     PostingDate := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=Document Type;
                  OptionCaptionML=ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                  SourceExpr=DocumentTypes }

      { 4   ;2   ;Field     ;
                  CaptionML=ENU=Posting Date;
                  SourceExpr=PostingDate;
                  OnValidate=BEGIN
                               CheckPostingDate;
                             END;
                              }

      { 6   ;2   ;Field     ;
                  CaptionML=ENU=Document Date;
                  SourceExpr=DocumentDate }

      { 12  ;2   ;Field     ;
                  CaptionML=ENU=Journal Template;
                  SourceExpr=JournalTemplate;
                  TableRelation="Gen. Journal Batch".Name;
                  OnValidate=BEGIN
                               CheckJournalTemplate;
                             END;

                  OnLookup=VAR
                             GenJnlTemplate@1001 : Record 80;
                             GenJnlTemplates@1000 : Page 101;
                           BEGIN
                             GenJnlTemplate.SETRANGE(Type,GenJnlTemplate.Type::General);
                             GenJnlTemplate.SETRANGE(Recurring,FALSE);
                             GenJnlTemplates.SETTABLEVIEW(GenJnlTemplate);

                             GenJnlTemplates.LOOKUPMODE := TRUE;
                             GenJnlTemplates.EDITABLE := FALSE;
                             IF GenJnlTemplates.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               GenJnlTemplates.GETRECORD(GenJnlTemplate);
                               JournalTemplate := GenJnlTemplate.Name;
                             END;
                           END;
                            }

      { 8   ;2   ;Field     ;
                  CaptionML=ENU=Batch Name;
                  SourceExpr=BatchName;
                  TableRelation="Gen. Journal Batch".Name;
                  OnValidate=BEGIN
                               CheckBatchName;
                             END;

                  OnLookup=VAR
                             GenJnlBatches@1001 : Page 251;
                           BEGIN
                             IF JournalTemplate <> '' THEN BEGIN
                               GenJnlBatch.SETRANGE("Journal Template Name",JournalTemplate);
                               GenJnlBatches.SETTABLEVIEW(GenJnlBatch);
                             END;

                             GenJnlBatches.LOOKUPMODE := TRUE;
                             GenJnlBatches.EDITABLE := FALSE;
                             IF GenJnlBatches.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               GenJnlBatches.GETRECORD(GenJnlBatch);
                               BatchName := GenJnlBatch.Name;
                             END;
                           END;
                            }

      { 10  ;2   ;Field     ;
                  CaptionML=ENU=Standard General Journal;
                  SourceExpr=TemplateCode;
                  TableRelation="Standard General Journal".Code;
                  OnLookup=VAR
                             StdGenJournal1@1005 : Record 750;
                             StdGenJnls@1000 : Page 750;
                           BEGIN
                             IF JournalTemplate <> '' THEN BEGIN
                               StdGenJournal1.SETRANGE("Journal Template Name",JournalTemplate);
                               StdGenJnls.SETTABLEVIEW(StdGenJournal1);
                             END;

                             StdGenJnls.LOOKUPMODE := TRUE;
                             StdGenJnls.EDITABLE := FALSE;
                             IF StdGenJnls.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               StdGenJnls.GETRECORD(StdGenJournal1);
                               TemplateCode := StdGenJournal1.Code;
                             END;
                           END;
                            }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      StdGenJournal@1007 : Record 750;
      GenJnlBatch@1011 : Record 232;
      GenJnlLine@1006 : Record 81;
      LastGenJnlLine@1005 : Record 81;
      VendorPostGrp@1009 : Record 93;
      DocumentTypes@1000 : ' ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund';
      PostingDate@1001 : Date;
      DocumentDate@1002 : Date;
      BatchName@1003 : Code[10];
      TemplateCode@1004 : Code[20];
      LineNo@1008 : Integer;
      JournalTemplate@1015 : Text[10];
      Text001@1016 : TextConst 'ENU=Gen. Journal Template name is blank.';
      Text002@1013 : TextConst 'ENU=Gen. Journal Batch name is blank.';
      Text004@1017 : TextConst 'ENU=General journal lines are successfully created.';
      PostingDateIsEmptyErr@1010 : TextConst 'ENU=The posting date is empty.';

    LOCAL PROCEDURE GetStandardJournalLine@3() : Boolean;
    VAR
      StdGenJounalLine@1000 : Record 751;
    BEGIN
      IF TemplateCode = '' THEN
        EXIT;
      StdGenJounalLine.SETRANGE("Journal Template Name",StdGenJournal."Journal Template Name");
      StdGenJounalLine.SETRANGE("Standard Journal Code",StdGenJournal.Code);
      EXIT(StdGenJounalLine.FINDFIRST);
    END;

    PROCEDURE Initialize@15(VAR StdGenJnl@1001 : Record 750;JnlBatchName@1000 : Code[10]);
    BEGIN
      GenJnlLine."Journal Template Name" := StdGenJnl."Journal Template Name";
      GenJnlLine."Journal Batch Name" := JnlBatchName;
      GenJnlLine.SETRANGE("Journal Template Name",StdGenJnl."Journal Template Name");
      GenJnlLine.SETRANGE("Journal Batch Name",JnlBatchName);

      LastGenJnlLine.SETRANGE("Journal Template Name",StdGenJnl."Journal Template Name");
      LastGenJnlLine.SETRANGE("Journal Batch Name",JnlBatchName);

      IF LastGenJnlLine.FINDLAST THEN;

      GenJnlBatch.SETRANGE("Journal Template Name",StdGenJnl."Journal Template Name");
      GenJnlBatch.SETRANGE(Name,JnlBatchName);

      IF GenJnlBatch.FINDFIRST THEN;
    END;

    LOCAL PROCEDURE CopyGenJnlFromStdJnl@1(StdGenJnlLine@1001 : Record 751;VAR GenJnlLine@1002 : Record 81);
    VAR
      GenJnlManagement@1000 : Codeunit 230;
      Balance@1007 : Decimal;
      TotalBalance@1006 : Decimal;
      ShowBalance@1005 : Boolean;
      ShowTotalBalance@1004 : Boolean;
    BEGIN
      GenJnlLine.INIT;
      GenJnlLine."Line No." := 0;
      GenJnlManagement.CalcBalance(GenJnlLine,LastGenJnlLine,Balance,TotalBalance,ShowBalance,ShowTotalBalance);
      GenJnlLine.SetUpNewLine(LastGenJnlLine,Balance,TRUE);
      IF LastGenJnlLine."Line No." <> 0 THEN
        GenJnlLine."Line No." := LastGenJnlLine."Line No." + 10000
      ELSE
        GenJnlLine."Line No." := 10000;

      GenJnlLine.TRANSFERFIELDS(StdGenJnlLine,FALSE);
      GenJnlLine.UpdateLineBalance;
      GenJnlLine.VALIDATE("Currency Code");

      IF GenJnlLine."VAT Prod. Posting Group" <> '' THEN
        GenJnlLine.VALIDATE("VAT Prod. Posting Group");
      IF (GenJnlLine."VAT %" <> 0) AND GenJnlBatch."Allow VAT Difference" THEN
        GenJnlLine.VALIDATE("VAT Amount",StdGenJnlLine."VAT Amount");
      GenJnlLine.VALIDATE("Bal. VAT Prod. Posting Group");

      IF GenJnlBatch."Allow VAT Difference" THEN
        GenJnlLine.VALIDATE("Bal. VAT Amount",StdGenJnlLine."Bal. VAT Amount");
      GenJnlLine.INSERT(TRUE);

      LastGenJnlLine := GenJnlLine;
    END;

    PROCEDURE InitializeRequest@2(DocumentTypesFrom@1000 : Option;PostingDateFrom@1001 : Date;DocumentDateFrom@1002 : Date);
    BEGIN
      DocumentTypes := DocumentTypesFrom;
      PostingDate := PostingDateFrom;
      DocumentDate := DocumentDateFrom;
    END;

    PROCEDURE InitializeRequestTemplate@4(JournalTemplateFrom@1000 : Text[10];BatchNameFrom@1001 : Code[10];TemplateCodeFrom@1002 : Code[20]);
    BEGIN
      JournalTemplate := JournalTemplateFrom;
      BatchName := BatchNameFrom;
      TemplateCode := TemplateCodeFrom;
    END;

    LOCAL PROCEDURE CheckPostingDate@24();
    BEGIN
      IF PostingDate = 0D THEN
        ERROR(PostingDateIsEmptyErr);
    END;

    LOCAL PROCEDURE CheckBatchName@32();
    BEGIN
      IF BatchName = '' THEN
        ERROR(Text002);
    END;

    LOCAL PROCEDURE CheckJournalTemplate@33();
    BEGIN
      IF JournalTemplate = '' THEN
        ERROR(Text001);
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 8613 Create Item Journal Lines
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Create Item Journal Lines;
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE(Text004);
                 END;

  }
  DATASET
  {
    { 1   ;    ;DataItem;                    ;
               DataItemTable=Table27;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               CheckJournalTemplate;
                               CheckBatchName;
                               CheckPostingDate;

                               ItemJnlLine.SETRANGE("Journal Template Name",JournalTemplate);
                               ItemJnlLine.SETRANGE("Journal Batch Name",BatchName);
                               IF ItemJnlLine.FINDLAST THEN
                                 LineNo := ItemJnlLine."Line No." + 10000
                               ELSE
                                 LineNo := 10000;

                               ItemJnlBatch.GET(JournalTemplate,BatchName);
                               IF TemplateCode <> '' THEN
                                 StdItemJnl.GET(JournalTemplate,TemplateCode);
                             END;

               OnAfterGetRecord=VAR
                                  StdItemJnlLine@1000 : Record 753;
                                BEGIN
                                  ItemJnlLine.INIT;
                                  IF GetStandardJournalLine THEN BEGIN
                                    Initialize(StdItemJnl,ItemJnlBatch.Name);

                                    StdItemJnlLine.SETRANGE("Journal Template Name",StdItemJnl."Journal Template Name");
                                    StdItemJnlLine.SETRANGE("Standard Journal Code",StdItemJnl.Code);
                                    IF StdItemJnlLine.FINDSET THEN
                                      REPEAT
                                        CopyItemJnlFromStdJnl(StdItemJnlLine,ItemJnlLine);
                                        ItemJnlLine.VALIDATE("Entry Type",EntryTypes);
                                        ItemJnlLine.VALIDATE("Item No.","No.");

                                        IF PostingDate <> 0D THEN
                                          ItemJnlLine.VALIDATE("Posting Date",PostingDate);

                                        IF DocumentDate <> 0D THEN BEGIN
                                          ItemJnlLine.VALIDATE("Posting Date",DocumentDate);
                                          ItemJnlLine."Posting Date" := PostingDate;
                                        END;

                                        IF NOT ItemJnlLine.INSERT(TRUE) THEN
                                          ItemJnlLine.MODIFY(TRUE);
                                      UNTIL StdItemJnlLine.NEXT = 0;
                                  END ELSE BEGIN
                                    ItemJnlLine.VALIDATE("Journal Template Name",ItemJnlLine.GETFILTER("Journal Template Name"));
                                    ItemJnlLine.VALIDATE("Journal Batch Name",BatchName);
                                    ItemJnlLine."Line No." := LineNo;
                                    LineNo := LineNo + 10000;

                                    ItemJnlLine.VALIDATE("Entry Type",EntryTypes);
                                    ItemJnlLine.VALIDATE("Item No.","No.");

                                    IF PostingDate <> 0D THEN
                                      ItemJnlLine.VALIDATE("Posting Date",PostingDate);

                                    IF DocumentDate <> 0D THEN BEGIN
                                      ItemJnlLine.VALIDATE("Posting Date",DocumentDate);
                                      ItemJnlLine."Posting Date" := PostingDate;
                                    END;

                                    IF NOT ItemJnlLine.INSERT(TRUE) THEN
                                      ItemJnlLine.MODIFY(TRUE);
                                  END;
                                END;

               ReqFilterFields=No.,Statistics Group,Vendor No.,Blocked }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF PostingDate = 0D THEN
                     PostingDate := WORKDATE;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=Entry Type;
                  OptionCaptionML=ENU=Purchase,Sale,Positive Adjmt.,Negative Adjmt.;
                  SourceExpr=EntryTypes }

      { 4   ;2   ;Field     ;
                  CaptionML=ENU=Posting Date;
                  SourceExpr=PostingDate;
                  OnValidate=BEGIN
                               CheckPostingDate;
                             END;
                              }

      { 6   ;2   ;Field     ;
                  CaptionML=ENU=Document Date;
                  SourceExpr=DocumentDate }

      { 12  ;2   ;Field     ;
                  CaptionML=ENU=Journal Template;
                  SourceExpr=JournalTemplate;
                  TableRelation="Gen. Journal Batch".Name;
                  OnValidate=BEGIN
                               CheckJournalTemplate;
                             END;

                  OnLookup=VAR
                             ItemJnlTemplate@1001 : Record 82;
                             ItemJnlTemplates@1000 : Page 102;
                           BEGIN
                             ItemJnlTemplate.SETRANGE(Type,ItemJnlTemplate.Type::Item);
                             ItemJnlTemplate.SETRANGE(Recurring,FALSE);
                             ItemJnlTemplates.SETTABLEVIEW(ItemJnlTemplate);

                             ItemJnlTemplates.LOOKUPMODE := TRUE;
                             ItemJnlTemplates.EDITABLE := FALSE;
                             IF ItemJnlTemplates.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               ItemJnlTemplates.GETRECORD(ItemJnlTemplate);
                               JournalTemplate := ItemJnlTemplate.Name;
                             END;
                           END;
                            }

      { 8   ;2   ;Field     ;
                  CaptionML=ENU=Batch Name;
                  SourceExpr=BatchName;
                  OnValidate=BEGIN
                               CheckBatchName;
                             END;

                  OnLookup=VAR
                             ItemJnlBatches@1000 : Page 262;
                           BEGIN
                             IF JournalTemplate <> '' THEN BEGIN
                               ItemJnlBatch.SETRANGE("Journal Template Name",JournalTemplate);
                               ItemJnlBatches.SETTABLEVIEW(ItemJnlBatch);
                             END;

                             ItemJnlBatches.LOOKUPMODE := TRUE;
                             ItemJnlBatches.EDITABLE := FALSE;
                             IF ItemJnlBatches.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               ItemJnlBatches.GETRECORD(ItemJnlBatch);
                               BatchName := ItemJnlBatch.Name;
                             END;
                           END;
                            }

      { 10  ;2   ;Field     ;
                  CaptionML=ENU=Standard Item Journal;
                  SourceExpr=TemplateCode;
                  TableRelation="Standard Item Journal".Code;
                  OnLookup=VAR
                             StdItemJnl1@1001 : Record 752;
                             StdItemJnls@1000 : Page 753;
                           BEGIN
                             IF JournalTemplate <> '' THEN BEGIN
                               StdItemJnl1.SETRANGE("Journal Template Name",JournalTemplate);
                               StdItemJnls.SETTABLEVIEW(StdItemJnl1);
                             END;

                             StdItemJnls.LOOKUPMODE := TRUE;
                             StdItemJnls.EDITABLE := FALSE;
                             IF StdItemJnls.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               StdItemJnls.GETRECORD(StdItemJnl1);
                               TemplateCode := StdItemJnl1.Code;
                             END;
                           END;
                            }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      StdItemJnl@1007 : Record 752;
      ItemJnlBatch@1006 : Record 233;
      LastItemJnlLine@1012 : Record 83;
      ItemJnlLine@1011 : Record 83;
      EntryTypes@1000 : 'Purchase,Sale,Positive Adjmt.,Negative Adjmt.';
      PostingDate@1001 : Date;
      DocumentDate@1002 : Date;
      BatchName@1003 : Code[10];
      TemplateCode@1004 : Code[20];
      LineNo@1008 : Integer;
      JournalTemplate@1015 : Text[10];
      Text001@1018 : TextConst 'ENU=Item Journal Template name is blank.';
      Text002@1017 : TextConst 'ENU=Item Journal Batch name is blank.';
      Text004@1005 : TextConst 'ENU=Item Journal lines are successfully created.';
      PostingDateIsEmptyErr@1009 : TextConst 'ENU=The Posting Date is empty.';

    LOCAL PROCEDURE GetStandardJournalLine@3() : Boolean;
    VAR
      StdItemJnlLine@1000 : Record 753;
    BEGIN
      IF TemplateCode = '' THEN
        EXIT;
      StdItemJnlLine.SETRANGE("Journal Template Name",StdItemJnl."Journal Template Name");
      StdItemJnlLine.SETRANGE("Standard Journal Code",StdItemJnl.Code);
      EXIT(StdItemJnlLine.FINDFIRST);
    END;

    PROCEDURE Initialize@2(StdItemJnl@1000 : Record 752;JnlBatchName@1001 : Code[10]);
    BEGIN
      ItemJnlLine."Journal Template Name" := StdItemJnl."Journal Template Name";
      ItemJnlLine."Journal Batch Name" := JnlBatchName;
      ItemJnlLine.SETRANGE("Journal Template Name",StdItemJnl."Journal Template Name");
      ItemJnlLine.SETRANGE("Journal Batch Name",JnlBatchName);

      LastItemJnlLine.SETRANGE("Journal Template Name",StdItemJnl."Journal Template Name");
      LastItemJnlLine.SETRANGE("Journal Batch Name",JnlBatchName);

      IF LastItemJnlLine.FINDLAST THEN;
    END;

    LOCAL PROCEDURE CopyItemJnlFromStdJnl@7(StdItemJnlLine@1000 : Record 753;VAR ItemJnlLine@1001 : Record 83);
    BEGIN
      ItemJnlLine.INIT;
      ItemJnlLine."Line No." := 0;
      ItemJnlLine.SetUpNewLine(LastItemJnlLine);
      IF LastItemJnlLine."Line No." <> 0 THEN
        ItemJnlLine."Line No." := LastItemJnlLine."Line No." + 10000
      ELSE
        ItemJnlLine."Line No." := 10000;

      ItemJnlLine.TRANSFERFIELDS(StdItemJnlLine,FALSE);

      IF (ItemJnlLine."Item No." <> '') AND (ItemJnlLine."Unit Amount" = 0) THEN
        ItemJnlLine.RecalculateUnitAmount;

      IF (ItemJnlLine."Entry Type" = ItemJnlLine."Entry Type"::Output) AND
         (ItemJnlLine."Value Entry Type" <> ItemJnlLine."Value Entry Type"::Revaluation)
      THEN
        ItemJnlLine."Invoiced Quantity" := 0
      ELSE
        ItemJnlLine."Invoiced Quantity" := ItemJnlLine.Quantity;
      ItemJnlLine.TESTFIELD("Qty. per Unit of Measure");
      ItemJnlLine."Invoiced Qty. (Base)" := ROUND(ItemJnlLine."Invoiced Quantity" * ItemJnlLine."Qty. per Unit of Measure",0.00001);

      ItemJnlLine.INSERT(TRUE);

      LastItemJnlLine := ItemJnlLine;
    END;

    PROCEDURE InitializeRequest@1(EntryTypesFrom@1000 : Option;PostingDateFrom@1001 : Date;DocumentDateFrom@1002 : Date);
    BEGIN
      EntryTypes := EntryTypesFrom;
      PostingDate := PostingDateFrom;
      DocumentDate := DocumentDateFrom;
    END;

    PROCEDURE InitializeRequestTemplate@4(JournalTemplateFrom@1000 : Text[10];BatchNameFrom@1001 : Code[10];TemplateCodeFrom@1002 : Code[20]);
    BEGIN
      JournalTemplate := JournalTemplateFrom;
      BatchName := BatchNameFrom;
      TemplateCode := TemplateCodeFrom;
    END;

    LOCAL PROCEDURE CheckPostingDate@24();
    BEGIN
      IF PostingDate = 0D THEN
        ERROR(PostingDateIsEmptyErr);
    END;

    LOCAL PROCEDURE CheckBatchName@32();
    BEGIN
      IF BatchName = '' THEN
        ERROR(Text002);
    END;

    LOCAL PROCEDURE CheckJournalTemplate@33();
    BEGIN
      IF JournalTemplate = '' THEN
        ERROR(Text001);
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 8614 Get Config. Tables
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW19.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Get Config. Tables;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 1   ;    ;DataItem;                    ;
               DataItemTable=Table2000000038;
               DataItemTableView=WHERE(Object Type=CONST(Table),
                                       Object ID=FILTER(..1999999999|2000000004|2000000005));
               OnPreDataItem=BEGIN
                               ConfigMgt.GetConfigTables(
                                 AllObj,IncludeWithDataOnly,IncludeRelatedTables,IncludeDimensionTables,IncludeLicensedTablesOnly,TRUE);
                               CurrReport.BREAK;
                             END;

               ReqFilterFields=Object ID,Object Name }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 5   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 4   ;1   ;Group     ;
                  CaptionML=ENU=Options }

      { 3   ;2   ;Field     ;
                  CaptionML=ENU=Include With Data Only;
                  SourceExpr=IncludeWithDataOnly }

      { 1   ;2   ;Field     ;
                  CaptionML=ENU=Include Related Tables;
                  OptionCaptionML=ENU=Purchase,Sale,Positive Adjmt.,Negative Adjmt.;
                  SourceExpr=IncludeRelatedTables }

      { 2   ;2   ;Field     ;
                  CaptionML=ENU=Include Dimension Tables;
                  SourceExpr=IncludeDimensionTables }

      { 6   ;2   ;Field     ;
                  CaptionML=ENU=Include Licensed Tables Only;
                  SourceExpr=IncludeLicensedTablesOnly }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ConfigMgt@1000 : Codeunit 8616;
      IncludeRelatedTables@1001 : Boolean;
      IncludeDimensionTables@1002 : Boolean;
      IncludeWithDataOnly@1003 : Boolean;
      IncludeLicensedTablesOnly@1004 : Boolean;

    PROCEDURE InitializeRequest@1(NewIncludeWithDataOnly@1000 : Boolean;NewIncludeRelatedTables@1002 : Boolean;NewIncludeDimensionTables@1001 : Boolean;NewIncludeLicensedTablesOnly@1003 : Boolean);
    BEGIN
      IncludeWithDataOnly := NewIncludeWithDataOnly;
      IncludeRelatedTables := NewIncludeRelatedTables;
      IncludeDimensionTables := NewIncludeDimensionTables;
      IncludeLicensedTablesOnly := NewIncludeLicensedTablesOnly;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 8615 Copy Package
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW17.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Copy - VAT Posting Setup;
    ProcessingOnly=Yes;
  }
  DATASET
  {
    { 1756;    ;DataItem;                    ;
               DataItemTable=Table8623;
               DataItemTableView=SORTING(Code);
               OnPreDataItem=BEGIN
                               SETRANGE(Code,UseConfigPackage.Code);
                             END;

               OnAfterGetRecord=BEGIN
                                  ConfigPackage.INIT;
                                  ConfigPackage.TRANSFERFIELDS(UseConfigPackage);
                                  ConfigPackage.Code := NewPackageCode;
                                  ConfigPackage.INSERT;

                                  ConfigPackageTable.SETRANGE("Package Code",Code);
                                  IF ConfigPackageTable.FINDSET THEN
                                    REPEAT
                                      ConfigPackageTable2.TRANSFERFIELDS(ConfigPackageTable);
                                      ConfigPackageTable2."Package Code" := ConfigPackage.Code;
                                      ConfigPackageTable2.INSERT;
                                    UNTIL ConfigPackageTable.NEXT = 0;

                                  ConfigPackageField.SETRANGE("Package Code",Code);
                                  IF ConfigPackageField.FINDSET THEN
                                    REPEAT
                                      ConfigPackageField2.TRANSFERFIELDS(ConfigPackageField);
                                      ConfigPackageField2."Package Code" := ConfigPackage.Code;
                                      ConfigPackageField2.INSERT;
                                    UNTIL ConfigPackageField.NEXT = 0;

                                  ConfigPackageFilter.SETRANGE("Package Code",Code);
                                  IF ConfigPackageFilter.FINDSET THEN
                                    REPEAT
                                      ConfigPackageFilter2.TRANSFERFIELDS(ConfigPackageFilter);
                                      ConfigPackageFilter2."Package Code" := ConfigPackage.Code;
                                      ConfigPackageFilter2.INSERT;
                                    UNTIL ConfigPackageFilter.NEXT = 0;

                                  IF CopyData THEN BEGIN
                                    ConfigPackageRecord.SETRANGE("Package Code",Code);
                                    IF ConfigPackageRecord.FINDSET THEN
                                      REPEAT
                                        ConfigPackageRecord2.TRANSFERFIELDS(ConfigPackageRecord);
                                        ConfigPackageRecord2."Package Code" := ConfigPackage.Code;
                                        ConfigPackageRecord2.Invalid := FALSE;
                                        ConfigPackageRecord2.INSERT;
                                      UNTIL ConfigPackageRecord.NEXT = 0;

                                    ConfigPackageData.SETRANGE("Package Code",Code);
                                    IF ConfigPackageData.FINDSET THEN
                                      REPEAT
                                        ConfigPackageData2.TRANSFERFIELDS(ConfigPackageData);
                                        ConfigPackageData2."Package Code" := ConfigPackage.Code;
                                        ConfigPackageData2.Invalid := FALSE;
                                        ConfigPackageData2.INSERT;
                                      UNTIL ConfigPackageData.NEXT = 0;
                                  END;
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=ENU=Options }

      { 2   ;2   ;Field     ;
                  Name=Package;
                  CaptionML=ENU=New Package Code;
                  SourceExpr=NewPackageCode;
                  OnValidate=BEGIN
                               IF ConfigPackage.GET(NewPackageCode) THEN
                                 ERROR(Text002,NewPackageCode);
                             END;
                              }

      { 1   ;2   ;Field     ;
                  Name=CopyData;
                  CaptionML=ENU=Copy Data;
                  SourceExpr=CopyData }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      UseConfigPackage@1001 : Record 8623;
      ConfigPackage@1002 : Record 8623;
      ConfigPackageTable@1003 : Record 8613;
      ConfigPackageTable2@1008 : Record 8613;
      ConfigPackageField@1004 : Record 8616;
      ConfigPackageField2@1009 : Record 8616;
      ConfigPackageData@1005 : Record 8615;
      ConfigPackageData2@1010 : Record 8615;
      ConfigPackageRecord@1006 : Record 8614;
      ConfigPackageRecord2@1011 : Record 8614;
      ConfigPackageFilter@1015 : Record 8626;
      ConfigPackageFilter2@1016 : Record 8626;
      NewPackageCode@1013 : Code[20];
      CopyData@1007 : Boolean;
      Text002@1014 : TextConst 'ENU=Package %1 already exists.';

    PROCEDURE Set@1(ConfigPackage2@1000 : Record 8623);
    BEGIN
      UseConfigPackage := ConfigPackage2;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 8616 Get Package Tables
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW17.00;
  }
  PROPERTIES
  {
    CaptionML=ENU=Get Package Tables;
    ProcessingOnly=Yes;
    OnPreReport=VAR
                  ConfigLine@1000 : Record 8622;
                BEGIN
                  IF PackageCode = '' THEN
                    ERROR(Text001);

                  TempConfigSelection.RESET;
                  TempConfigSelection.SETRANGE("Line Type",TempConfigSelection."Line Type"::Table);
                  TempConfigSelection.SETRANGE(Selected,TRUE);
                  IF TempConfigSelection.FINDSET THEN
                    REPEAT
                      IF DataExists(TempConfigSelection."Table ID") AND NOT ConfigPackageTable.GET(PackageCode,TempConfigSelection."Table ID") THEN BEGIN
                        ConfigPackageTable.INIT;
                        ConfigPackageTable.VALIDATE("Package Code",PackageCode);
                        ConfigPackageTable.VALIDATE("Table ID",TempConfigSelection."Table ID");
                        ConfigPackageTable.INSERT(TRUE);
                        ConfigLine.GET(TempConfigSelection."Line No.");
                        IF ConfigLine."Package Code" = '' THEN BEGIN
                          ConfigLine."Package Code" := PackageCode;
                          ConfigLine.MODIFY;
                        END;
                      END;
                    UNTIL TempConfigSelection.NEXT = 0;

                  CurrReport.BREAK;
                END;

  }
  DATASET
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnInit=BEGIN
               InitSelection;
             END;

    }
    CONTROLS
    {
      { 8   ;0   ;Container ;
                  ContainerType=ContentArea }

      { 7   ;1   ;Group     ;
                  CaptionML=ENU=Options }

      { 2   ;2   ;Field     ;
                  Name=SelectTables;
                  CaptionML=ENU=Select Tables;
                  SourceExpr=SelectedTables;
                  Editable=FALSE;
                  OnAssistEdit=VAR
                                 ConfigSelection@1000 : Page 8628;
                               BEGIN
                                 ConfigSelection.Set(TempConfigSelection);
                                 COMMIT;
                                 IF ConfigSelection.RUNMODAL = ACTION::OK THEN
                                   SelectedTables := ConfigSelection.Get(TempConfigSelection);
                               END;
                                }

      { 6   ;2   ;Field     ;
                  Name=WithDataOnly;
                  CaptionML=ENU=With Data Only;
                  OptionCaptionML=ENU=Purchase,Sale,Positive Adjmt.,Negative Adjmt.;
                  SourceExpr=WithDataOnly }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ConfigPackageTable@1007 : Record 8613;
      TempConfigSelection@1003 : TEMPORARY Record 8621;
      TableInfo@1006 : Record 2000000028;
      SelectedTables@1008 : Integer;
      PackageCode@1001 : Code[20];
      WithDataOnly@1005 : Boolean;
      Text001@1009 : TextConst 'ENU=Package is not set.';

    PROCEDURE Set@2(NewPackageCode@1001 : Code[20]);
    BEGIN
      PackageCode := NewPackageCode;
    END;

    LOCAL PROCEDURE DataExists@4(TableID@1000 : Integer) : Boolean;
    BEGIN
      IF NOT WithDataOnly THEN
        EXIT(TRUE);

      TableInfo.SETRANGE("Company Name",COMPANYNAME);
      TableInfo.SETRANGE("Table No.",TableID);
      IF TableInfo.FINDFIRST THEN
        IF TableInfo."No. of Records" > 0 THEN
          EXIT(TRUE);

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE InitSelection@1();
    VAR
      ConfigLine@1000 : Record 8622;
    BEGIN
      WITH TempConfigSelection DO BEGIN
        RESET;
        ConfigLine.SETFILTER("Table ID",'<>0');
        IF ConfigLine.FINDSET THEN
          REPEAT
            IF (ConfigLine."Line Type" <> ConfigLine."Line Type"::Table) OR
               ((ConfigLine."Line Type" = ConfigLine."Line Type"::Table) AND (ConfigLine."Package Code" = ''))
            THEN
              IF NOT GET(ConfigLine."Line No.") THEN BEGIN
                INIT;
                "Line No." := ConfigLine."Line No.";
                "Table ID" := ConfigLine."Table ID";
                Name := ConfigLine.Name;
                "Line Type" := ConfigLine."Line Type";
                INSERT;
              END;
          UNTIL ConfigLine.NEXT = 0;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 8621 Config. Package - Process
{
  OBJECT-PROPERTIES
  {
    Date=;
    Time=;
    Version List=NAVW18.00;
  }
  PROPERTIES
  {
    TransactionType=UpdateNoLocks;
    CaptionML=ENU=Config. Package - Process;
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  ERROR(ThereIsNothingToProcessErr);
                END;

  }
  DATASET
  {
    { 1   ;    ;DataItem;                    ;
               DataItemTable=Table8613;
               DataItemTableView=SORTING(Package Code,Table ID)
                                 ORDER(Ascending);
               OnAfterGetRecord=BEGIN
                                  ProcessCustomRulesExample("Config. Package Table");
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      SourceTable=Table8613;
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ThereIsNothingToProcessErr@1001 : TextConst 'ENU=There is nothing to process.\\Implement processing logic in Report 8621 - Config. Package - Process.';

    PROCEDURE ProcessCustomRulesExample@5(ConfigPackageTable@1000 : Record 8613);
    VAR
      Customer@1001 : Record 18;
      BankAccount@1002 : Record 270;
      PaymentTerms@1003 : Record 3;
      ConfigTextTransformation@1004 : Record 8640;
    BEGIN
      CASE ConfigPackageTable."Table ID" OF
        DATABASE::"Payment Terms":
          BEGIN
            ConfigTextTransformation."Transformation Type" := ConfigTextTransformation."Transformation Type"::"Title Case";
            ApplyTextTransformation(ConfigPackageTable,PaymentTerms.FIELDNO(Description),ConfigTextTransformation);
          END;
        DATABASE::"Bank Account":
          BEGIN
            ConfigTextTransformation."Transformation Type" :=
              ConfigTextTransformation."Transformation Type"::"Remove Non-Alphanumeric Characters";

            ApplyTextTransformation(ConfigPackageTable,BankAccount.FIELDNO("SWIFT Code"),ConfigTextTransformation);
            ApplyTextTransformation(ConfigPackageTable,BankAccount.FIELDNO(IBAN),ConfigTextTransformation);

            ConfigTextTransformation."Transformation Type" :=
              ConfigTextTransformation."Transformation Type"::"Remove Non-Alphanumeric Characters";

            ApplyTextTransformation(ConfigPackageTable,BankAccount.FIELDNO("SWIFT Code"),ConfigTextTransformation);
            ApplyTextTransformation(ConfigPackageTable,BankAccount.FIELDNO(IBAN),ConfigTextTransformation);
          END;
        DATABASE::Customer:
          BEGIN
            ConfigTextTransformation."Transformation Type" := ConfigTextTransformation."Transformation Type"::Replace;
            ConfigTextTransformation."Current Value" := 'Mister';
            ConfigTextTransformation."New Value" := 'Mr.';

            ApplyTextTransformation(ConfigPackageTable,Customer.FIELDNO(Name),ConfigTextTransformation);
          END;
      END;
    END;

    PROCEDURE TransformText@1(ConfigTextTransformation@1000 : Record 8640;OldValue@1001 : Text) : Text;
    VAR
      NewValue@1002 : Text;
    BEGIN
      NewValue := OldValue;

      CASE ConfigTextTransformation."Transformation Type" OF
        ConfigTextTransformation."Transformation Type"::Uppercase:
          NewValue := UPPERCASE(OldValue);
        ConfigTextTransformation."Transformation Type"::Lowercase:
          NewValue := LOWERCASE(OldValue);
        ConfigTextTransformation."Transformation Type"::"Title Case":
          NewValue := TextToTitleCase(ConfigTextTransformation,OldValue);
        ConfigTextTransformation."Transformation Type"::Trim:
          NewValue := DELCHR(OldValue,'<>');
        ConfigTextTransformation."Transformation Type"::Substring:
          NewValue := Substring(OldValue,ConfigTextTransformation);
        ConfigTextTransformation."Transformation Type"::Replace:
          NewValue := StringReplace(OldValue,ConfigTextTransformation."Current Value",ConfigTextTransformation."New Value");
        ConfigTextTransformation."Transformation Type"::"Regular Expression":
          NewValue := RegularExpression(OldValue,ConfigTextTransformation."Current Value",ConfigTextTransformation."New Value");
        ConfigTextTransformation."Transformation Type"::"Remove Non-Alphanumeric Characters":
          NewValue := RemoveNonAplhaNumericCharacters(OldValue);
        ConfigTextTransformation."Transformation Type"::"Date and Time Formatting":
          NewValue := DateTimeFormatting(OldValue,ConfigTextTransformation);
      END;

      EXIT(NewValue);
    END;

    LOCAL PROCEDURE TextToTitleCase@17(ConfigTextTransformation@1000 : Record 8640;OldValue@1001 : Text) : Text;
    VAR
      CultureInfo@1002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.CultureInfo";
    BEGIN
      CultureInfo := CultureInfo.GetCultureInfo(ConfigTextTransformation.GetLanguageID);
      EXIT(CultureInfo.TextInfo.ToTitleCase(OldValue));
    END;

    LOCAL PROCEDURE StringReplace@2(StringToReplace@1000 : Text;OldValue@1001 : Text;NewValue@1002 : Text) : Text;
    VAR
      DotNetString@1003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.String";
      NewString@1004 : Text;
    BEGIN
      DotNetString := StringToReplace;
      NewString := DotNetString.Replace(OldValue,NewValue);
      EXIT(NewString);
    END;

    LOCAL PROCEDURE RegularExpression@3(StringToReplace@1000 : Text;Pattern@1001 : Text;NewValue@1002 : Text) : Text;
    VAR
      Regex@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Text.RegularExpressions.Regex";
      RegexOptions@1005 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Text.RegularExpressions.RegexOptions";
      NewString@1004 : Text;
    BEGIN
      Regex := Regex.Regex(Pattern,RegexOptions.IgnoreCase);
      NewString := Regex.Replace(StringToReplace,NewValue);
      EXIT(NewString);
    END;

    LOCAL PROCEDURE RemoveNonAplhaNumericCharacters@19(OldValue@1003 : Text) : Text;
    VAR
      DotNetChar@1002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Char";
      NewValue@1001 : Text;
      I@1000 : Integer;
    BEGIN
      NewValue := '';
      FOR I := 1 TO STRLEN(OldValue) DO BEGIN
        IF DotNetChar.IsLetterOrDigit(OldValue[I]) THEN
          NewValue += FORMAT(OldValue[I]);
      END;

      EXIT(NewValue);
    END;

    LOCAL PROCEDURE DateTimeFormatting@20(OldValue@1001 : Text;ConfigTextTransformation@1002 : Record 8640) : Text;
    VAR
      DotNetDateTime@1004 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime";
      CultureInfo@1000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.CultureInfo";
      DotNetDateTimeStyles@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.DateTimeStyles";
      NewValue@1003 : Text;
    BEGIN
      NewValue := OldValue;

      DotNetDateTime := DotNetDateTime.DateTime(1);
      CultureInfo := CultureInfo.GetCultureInfo(ConfigTextTransformation.GetLanguageID);

      IF DotNetDateTime.TryParse(OldValue,CultureInfo,DotNetDateTimeStyles.None,DotNetDateTime) THEN
        NewValue := DotNetDateTime.ToString(ConfigTextTransformation.Format,CultureInfo);

      EXIT(NewValue);
    END;

    LOCAL PROCEDURE ApplyTextTransformation@25(ConfigPackageTable@1001 : Record 8613;FieldNo@1002 : Integer;ConfigTextTransformation@1000 : Record 8640);
    VAR
      ConfigPackageData@1003 : Record 8615;
    BEGIN
      IF GetConfigPackageData(ConfigPackageData,ConfigPackageTable,FieldNo) THEN
        REPEAT
          ConfigPackageData.Value := COPYSTR(TransformText(ConfigTextTransformation,ConfigPackageData.Value),1,250);
          ConfigPackageData.MODIFY;
        UNTIL ConfigPackageData.NEXT = 0;
    END;

    LOCAL PROCEDURE GetConfigPackageData@4(VAR ConfigPackageData@1004 : Record 8615;ConfigPackageTable@1000 : Record 8613;FieldId@1001 : Integer) : Boolean;
    BEGIN
      ConfigPackageData.SETRANGE("Package Code",ConfigPackageTable."Package Code");
      ConfigPackageData.SETRANGE("Table ID",ConfigPackageTable."Table ID");
      ConfigPackageData.SETRANGE("Field ID",FieldId);
      EXIT(ConfigPackageData.FINDSET(TRUE,FALSE));
    END;

    LOCAL PROCEDURE Substring@7(OldValue@1000 : Text;ConfigTextTransformation@1001 : Record 8640) : Text;
    VAR
      StartPosition@1002 : Integer;
      Length@1003 : Integer;
    BEGIN
      StartPosition := ConfigTextTransformation."Start Position";
      Length := ConfigTextTransformation.Length;

      IF StartPosition = 0 THEN
        StartPosition := 1;

      IF Length = 0 THEN
        Length := STRLEN(OldValue);

      EXIT(COPYSTR(OldValue,StartPosition,Length));
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

